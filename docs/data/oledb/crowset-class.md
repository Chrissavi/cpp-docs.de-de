---
title: CRowset-Klasse
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: e67e385a8ce0eb9a6b041d4a4f0d43e2db551c79
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/24/2020
ms.locfileid: "80211288"
---
# <a name="crowset-class"></a>CRowset-Klasse

Kapselt ein OLE DB Rowsetobjekt und mehrere verknüpfte Schnittstellen und stellt Manipulationsmethoden für Rowsetdaten bereit.

## <a name="syntax"></a>Syntax

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Parameter

*TAccessor*<br/>
Eine Accessor-Klasse. Der Standardwert lautet `CAccessorBase`.

## <a name="requirements"></a>Requirements (Anforderungen)

**Header:** atldbcli.h

## <a name="members"></a>Members

### <a name="methods"></a>Methoden

|||
|-|-|
|[AddRefRows](#addrefrows)|Erhöht den Verweis Zähler, der der aktuellen Zeile zugeordnet ist.|
|[Close](#close)|Gibt Zeilen und die aktuelle `IRowset`-Schnittstelle frei.|
|[Vergleichen](#compare)|Vergleicht zwei Lesezeichen mit [IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).|
|[CRowset](#crowset)|Erstellt ein neues `CRowset`-Objekt und ordnet es (optional) einer `IRowset`-Schnittstelle zu, die als Parameter angegeben wird.|
|[Löschen](#delete)|Löscht Zeilen aus dem Rowset mithilfe von [IRowsetChange: DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)).|
|[FindNextRow](#findnextrow)|Sucht nach dem angegebenen Lesezeichen nach der nächsten übereinstimmenden Zeile.|
|[GetApproximatePosition](#getapproximateposition)|Gibt die ungefähre Position einer Zeile zurück, die einem Lesezeichen entspricht.|
|[GetData](#getdata)|Ruft Daten von der Zeilenkopie des Rowsets ab.|
|[GetDataHere](#getdatahere)|Ruft Daten aus dem angegebenen Puffer ab.|
|[GetOriginalData](#getoriginaldata)|Ruft die Daten ab, die zuletzt aus der Datenquelle abgerufen oder an die Datenquelle übertragen wurden, wobei ausstehende Änderungen ignoriert werden.|
|[GetRowStatus](#getrowstatus)|Gibt den Status aller Zeilen zurück.|
|[Einfügen](#insert)|Erstellt eine neue Zeile und fügt Sie mithilfe von [IRowsetChange: InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85))ein.|
|[IsSameRow](#issamerow)|Vergleicht die angegebene Zeile mit der aktuellen Zeile.|
|[MoveFirst](#movefirst)|Positioniert den Speicherort für das nächste abrufen an der ursprünglichen Position.|
|[MoveLast](#movelast)|Wechselt zum letzten Datensatz.|
|[MoveNext](#movenext)|Ruft Daten aus der nächsten sequenziellen Zeile oder einer angegebenen Anzahl von Positionen nach der nächsten Zeile ab.|
|[MovePrev](#moveprev)|Wechselt zum vorherigen Datensatz.|
|[MoveToBookmark](#movetobookmark)|Ruft die Zeile ab, die durch ein Lesezeichen oder die Zeile an einem angegebenen Offset aus diesem Lesezeichen gekennzeichnet ist.|
|[MoveToRatio](#movetoratio)|Ruft Zeilen ab einer Bruch Position im Rowset ab.|
|[ReleaseRows](#releaserows)|Ruft [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) auf, um das aktuelle Zeilen Handle freizugeben.|
|[SetData](#setdata)|Legt Datenwerte in einer oder mehreren Spalten einer Zeile mit [IRowsetChange: SetData](/previous-versions/windows/desktop/ms721232(v=vs.85))fest.|
|[Rückgängig](#undo)|Macht Änderungen an einer Zeile seit dem letzten Abrufen oder [Aktualisieren](../../data/oledb/crowset-update.md)unverändert.|
|[Aktualisieren](#update)|Überträgt alle ausstehenden Änderungen, die seit dem letzten Abrufen oder aktualisieren an der aktuellen Zeile vorgenommen wurden.|
|[UpdateAll](#updateall)|Überträgt alle ausstehenden Änderungen, die seit dem letzten Abrufen oder aktualisieren an allen Zeilen vorgenommen wurden.|

## <a name="remarks"></a>Bemerkungen

In OLE DB ist ein Rowset das Objekt, über das ein Programm Daten festlegt und abruft.

Diese Klasse soll nicht instanziiert, sondern als Vorlagen Parameter an `CTable` oder `CCommand` übergeben werden (`CRowset` ist die Standardeinstellung).

## <a name="crowsetaddrefrows"></a><a name="addrefrows"></a>CRowset:: adressfrows

Ruft [IRowset:: adressfrows](/previous-versions/windows/desktop/ms719619(v=vs.85)) auf, um den Verweis Zähler (um einen) zu erhöhen, der dem aktuellen Zeilen Handle zugeordnet ist.

### <a name="syntax"></a>Syntax

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Diese Methode erhöht den Verweis Zähler für das aktuelle Zeilen handle. Ruft [ReleaseRows](../../data/oledb/crowset-releaserows.md) auf, um die Anzahl zu verringern. Zeilen, die von den Verschiebungs Methoden zurückgegeben werden, haben einen Verweis Zähler von 1.

## <a name="crowsetclose"></a><a name="close"></a>CRowset:: Close

Gibt Zeilen und die aktuelle [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) -Schnittstelle frei.

### <a name="syntax"></a>Syntax

```cpp
void Close() throw();
```

### <a name="remarks"></a>Bemerkungen

Diese Methode gibt alle aktuell im Rowset aktuell im Rowset-Zeilen frei.

## <a name="crowsetcompare"></a><a name="compare"></a>CRowset:: Compare

Vergleicht zwei Lesezeichen mit [IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).

### <a name="syntax"></a>Syntax

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Parameter

*Bookmark1 zuweisen*<br/>
in Das erste zu vergleichende Lesezeichen.

*Bookmark2*<br/>
in Das zweite zu vergleichende Lesezeichen.

*pcomparison*<br/>
vorgenommen Ein Zeiger auf das Ergebnis des Vergleichs.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Diese Methode erfordert die optionale Schnittstelle `IRowsetLocate`, die möglicherweise nicht für alle Anbieter unterstützt wird. Wenn dies der Fall ist, gibt die Methode E_NOINTERFACE zurück. Sie müssen auch `DBPROP_IRowsetLocate` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält.

Weitere Informationen zum Verwenden von Lesezeichen in Consumern finden Sie unter [Verwenden von Lesezeichen](../../data/oledb/using-bookmarks.md).

## <a name="crowsetcrowset"></a><a name="crowset"></a>CRowset:: CRowset

Erstellt ein neues `CRowset`-Objekt und ordnet es (optional) einer [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) -Schnittstelle zu, die als Parameter angegeben wird.

### <a name="syntax"></a>Syntax

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Parameter

*prowset*<br/>
in Ein Zeiger auf eine `IRowset`-Schnittstelle, die dieser Klasse zugeordnet werden soll.

## <a name="crowsetdelete"></a><a name="delete"></a>CRowset::D Elete

Ruft [IRowsetChange::D eleterows](/previous-versions/windows/desktop/ms724362(v=vs.85)) auf, um die aktuelle Zeile aus dem Rowset zu löschen.

### <a name="syntax"></a>Syntax

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

## <a name="crowsetfindnextrow"></a><a name="findnextrow"></a>CRowset:: FindNextRow

Sucht nach dem angegebenen Lesezeichen nach der nächsten übereinstimmenden Zeile.

### <a name="syntax"></a>Syntax

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Parameter

*schel*<br/>
in Der zum Vergleichen von Zeilen Werten zu verwendende Vorgang. Weitere Informationen zu-Werten finden Sie unter [IRowsetFind:: FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
in Ein Zeiger auf den Wert, der abgeglichen werden soll.

*wType*<br/>
in Gibt den Datentyp des wertteils des Puffers an. Weitere Informationen zu Typindikatoren finden Sie unter [Datentypen](/previous-versions/windows/desktop/ms723969(v=vs.85)) in der *OLE DB Programmierer-Referenz* im Windows SDK.

*nlength*<br/>
in Die Länge (in Byte) der consumerdatenstruktur, die dem Datenwert zugeordnet ist. Weitere Informationen finden Sie in der Beschreibung `cbMaxLen` in [DBBINDING-Strukturen](/previous-versions/windows/desktop/ms716845(v=vs.85)) in der *OLE DB Programmierer-Referenz.*

*bPrecision*<br/>
in Die maximale Genauigkeit, die bei der Datenbeschaffung verwendet wird. Wird nur verwendet, wenn *wType* DBTYPE_NUMERIC ist. Weitere Informationen finden Sie unter [Konvertierungen im Zusammenhang mit DBTYPE_NUMERIC oder DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) in der *OLE DB Programmierer-Referenz*.

*bScale*<br/>
in Die beim Daten Einsatz verwendete Skala. Wird nur verwendet, wenn *wType* DBTYPE_NUMERIC oder DBTYPE_DECIMAL ist. Weitere Informationen finden Sie unter [Konvertierungen im Zusammenhang mit DBTYPE_NUMERIC oder DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) in der *OLE DB Programmierer-Referenz*.

*bskipcurrent*<br/>
in Die Anzahl der Zeilen aus dem Lesezeichen, an dem eine Suche gestartet werden soll.

*pBookmark*<br/>
in Das Lesezeichen für die Position, an der eine Suche gestartet werden soll.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Diese Methode erfordert die optionale Schnittstelle `IRowsetFind`, die möglicherweise nicht für alle Anbieter unterstützt wird. Wenn dies der Fall ist, gibt die Methode E_NOINTERFACE zurück. Sie müssen auch `DBPROP_IRowsetFind` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält.

Weitere Informationen zum Verwenden von Lesezeichen in Consumern finden Sie unter [Verwenden von Lesezeichen](../../data/oledb/using-bookmarks.md).

## <a name="crowsetgetapproximateposition"></a><a name="getapproximateposition"></a>CRowset:: getapproximateposition

Gibt die ungefähre Position einer Zeile zurück, die einem Lesezeichen entspricht.

### <a name="syntax"></a>Syntax

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Parameter

*pBookmark*<br/>
in Ein Zeiger auf ein Lesezeichen, das die Zeile identifiziert, deren Position gefunden werden soll. NULL, wenn nur die Zeilen Anzahl erforderlich ist.

*pposition*<br/>
vorgenommen Ein Zeiger auf den Speicherort, an dem `GetApproximatePosition` die Position der Zeile zurückgibt. NULL, wenn die Position nicht erforderlich ist.

*pcRows*<br/>
vorgenommen Ein Zeiger auf den Speicherort, an dem `GetApproximatePosition` die Gesamtzahl der Zeilen zurückgibt. NULL, wenn die Zeilen Anzahl nicht erforderlich ist.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Diese Methode erfordert die optionale Schnittstelle `IRowsetScroll`, die möglicherweise nicht für alle Anbieter unterstützt wird. Wenn dies der Fall ist, gibt die Methode E_NOINTERFACE zurück. Sie müssen auch `DBPROP_IRowsetScroll` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält.

Weitere Informationen zum Verwenden von Lesezeichen in Consumern finden Sie unter [Verwenden von Lesezeichen](../../data/oledb/using-bookmarks.md).

## <a name="crowsetgetdata"></a><a name="getdata"></a>CRowset:: GetData

Ruft Daten von der Zeilenkopie des Rowsets ab.

### <a name="syntax"></a>Syntax

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Parameter

*naccessor*<br/>
in Die Indexnummer (Null Offset) der Zugriffsmethode, die für den Zugriff auf die Daten verwendet werden soll.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Wenn Sie einen Accessor angeben, der in [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md)keinen Autoaccessor ist, verwenden Sie diese Methode, um die Daten explizit durch übergeben der Accessornummer zu erhalten.

## <a name="crowsetgetdatahere"></a><a name="getdatahere"></a>CRowset:: GetDataHere

Ruft Daten aus der aktuellen Zeile ab und platziert Sie in den angegebenen Puffer.

### <a name="syntax"></a>Syntax

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Parameter

*naccessor*<br/>
in Die Indexnummer des Accessors, der für den Zugriff auf die Daten verwendet werden soll.

*pBuffer*<br/>
vorgenommen Ein Puffer, in den die Daten für den aktuellen Datensatz platziert werden sollen.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Ein Beispiel für die Verwendung dieser Funktion finden Sie im Beispiel für [MultiRead](../../overview/visual-cpp-samples.md).

## <a name="crowsetgetoriginaldata"></a><a name="getoriginaldata"></a>CRowset:: GetOriginalData

Ruft `IRowsetUpdate::GetOriginalData` auf, um die Daten abzurufen, die zuletzt abgerufen oder an die Datenquelle übertragen wurden.

### <a name="syntax"></a>Syntax

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Mit dieser Methode werden die Daten abgerufen, die zuletzt aus der Datenquelle abgerufen oder an die Datenquelle übertragen wurden. Er ruft keine Werte basierend auf ausstehenden Änderungen ab.

Diese Methode erfordert die optionale Schnittstelle `IRowsetUpdate`, die möglicherweise nicht für alle Anbieter unterstützt wird. Wenn dies der Fall ist, gibt die Methode E_NOINTERFACE zurück. Sie müssen auch `DBPROP_IRowsetUpdate` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält.

## <a name="crowsetgetrowstatus"></a><a name="getrowstatus"></a>CRowset:: GetRowStatus

Gibt den Status aller Zeilen zurück.

### <a name="syntax"></a>Syntax

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Parameter

*pstatus*<br/>
vorgenommen Ein Zeiger auf einen Speicherort, an dem `GetRowStatus` den Statuswert zurückgibt. Weitere Informationen finden Sie unter dbpdingstatus in der OLE DB-Programmier Referenz.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Diese Methode erfordert die optionale Schnittstelle `IRowsetUpdate`, die möglicherweise nicht für alle Anbieter unterstützt wird. Wenn dies der Fall ist, gibt die Methode E_NOINTERFACE zurück. Sie müssen auch `DBPROP_IRowsetUpdate` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält.

## <a name="crowsetinsert"></a><a name="insert"></a>CRowset:: INSERT

Erstellt und Initialisiert eine neue Zeile unter Verwendung von Daten aus dem-Accessor.

### <a name="syntax"></a>Syntax

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Parameter

*naccessor*<br/>
in Die Nummer des Accessors, der zum Einfügen der Daten verwendet werden soll.

*bgethrow*<br/>
in Gibt an, ob das Handle für die eingefügte Zeile abgerufen wird.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Diese Methode erfordert die optionale Schnittstelle `IRowsetChange`, die möglicherweise nicht für alle Anbieter unterstützt wird. Wenn dies der Fall ist, gibt die Methode E_NOINTERFACE zurück. Sie müssen auch `DBPROP_IRowsetChange` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält.

INSERT schlägt möglicherweise fehl, wenn eine oder mehrere Spalten nicht beschreibbar sind. Ändern Sie die Cursorzuordnung, um diesen Fehler zu beheben.

### <a name="example"></a>Beispiel

Im folgenden Beispiel wird gezeigt, wie Sie über ein Rowset auf eine Datenquelle zugreifen und dann mithilfe einer Tabelle in diesem Rowset eine Zeichenfolge einfügen.

Erstellen Sie zunächst eine Tabellen Klasse, indem Sie ein neues ATL-Objekt in das Projekt einfügen. Klicken Sie beispielsweise mit der rechten Maustaste auf das Projekt im Arbeitsbereich, und wählen Sie **Neues ATL-Objekt**aus. Wählen Sie in der Kategorie **Datenzugriff** die Option **Consumer**aus. Erstellen Sie ein Consumer-Objekt vom Typ **Table**. (Durch Auswahl von **Tabelle** wird ein Rowset direkt aus der Tabelle erstellt. Wenn Sie den **Befehl** auswählen, wird ein Rowset mithilfe eines SQL-Befehls erstellt.) Wählen Sie eine Datenquelle aus, und geben Sie eine Tabelle an, über die Sie auf diese Datenquelle zugreifen. Wenn Sie Ihr Consumerobjekt **ccustomertable**aufzurufen, würden Sie den einfügecode wie folgt implementieren:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="crowsetissamerow"></a><a name="issamerow"></a>CRowset:: IsSameRow

Vergleicht die angegebene Zeile mit der aktuellen Zeile.

### <a name="syntax"></a>Syntax

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Parameter

*HROW*<br/>
in Ein Handle für die Zeile, die mit der aktuellen Zeile verglichen werden soll.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard. S_OK gibt an, dass die Zeilen identisch sind. Weitere Informationen finden Sie unter [IRow-tindentity:: IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) in der *OLE DB-Programmier Referenz* im Windows SDK.

## <a name="crowsetmovefirst"></a><a name="movefirst"></a>CRowset:: muvefirst

Verschiebt den Cursor an die ursprüngliche Position und ruft die erste Zeile ab.

### <a name="syntax"></a>Syntax

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Ruft [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) auf, um den Speicherort für das nächste abrufen an der ursprünglichen Position (der Position, an der sich der nächste Abruf Speicherort befand, als das Rowset erstellt wurde) neu zu positionieren und die anfängliche Zeile abzurufen.

## <a name="crowsetmovelast"></a><a name="movelast"></a>CRowset:: muvelast

Verschiebt den Cursor in die letzte Zeile.

### <a name="syntax"></a>Syntax

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Ruft [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) auf, um den Speicherort für das nächste abrufen an der letzten Position neu zu positionieren, und ruft die letzte Zeile ab.

Diese Methode erfordert, dass Sie `DBPROP_CANSCROLLBACKWARDS` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält. (Um eine bessere Leistung zu erzielen, können Sie auch `DBPROP_QUICKRESTART` auf VARIANT_TRUE festlegen.)

## <a name="crowsetmovenext"></a><a name="movenext"></a>CRowset:: wvenext

Verschiebt den Cursor auf den nächsten Datensatz.

### <a name="syntax"></a>Syntax

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Parameter

*lskip*<br/>
in Die Anzahl der Zeilen, die vor dem Abrufen übersprungen werden sollen.

*bForward*<br/>
in Übergeben Sie " **true** ", um zum nächsten Datensatz zu gelangen, " **false** ", um rückwärts zu wechseln.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard. Wenn das Ende des Rowsets erreicht ist, gibt DB_S_ENDOFROWSET zurück.

### <a name="remarks"></a>Bemerkungen

Ruft die nächste sequenzielle Zeile aus dem `CRowset`-Objekt ab, wobei die vorherige Position abgerufen wird. Optional können Sie auswählen, *dass Zeilen übersprungen oder* rückwärts verschoben werden.

Diese Methode erfordert, dass Sie die folgenden Eigenschaften festlegen, bevor Sie `Open` für die Tabelle oder den Befehl, der das Rowset enthält, aufrufen:

- `DBPROP_CANSCROLLBACKWARDS` muss VARIANT_TRUE sein, wenn *lskip* < 0

- `DBPROP_CANFETCHBACKWARDS` muss VARIANT_TRUE sein, wenn *bForward* = false

Andernfalls müssen Sie keine zusätzlichen Eigenschaften festlegen, wenn *lskip* > = 0 und *bForward* = true) ist.

## <a name="crowsetmoveprev"></a><a name="moveprev"></a>CRowset:: wveprev

Verschiebt den Cursor zum vorherigen Datensatz.

### <a name="syntax"></a>Syntax

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Diese Methode erfordert, dass Sie entweder `DBPROP_CANFETCHBACKWARDS` oder `DBPROP_CANSCROLLBACKWARDS` VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält.

## <a name="crowsetmovetobookmark"></a><a name="movetobookmark"></a>CRowset:: muvechanbookmark

Ruft die Zeile ab, die durch ein Lesezeichen oder die Zeile an einem angegebenen Offset (*lskip*) aus diesem Lesezeichen gekennzeichnet ist.

### <a name="syntax"></a>Syntax

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Parameter

*Lesezeichen*<br/>
in Ein Lesezeichen, das den Speicherort markiert, von dem aus Sie Daten abrufen möchten.

*lskip*<br/>
in Die Anzahl der Zeilen aus dem Lesezeichen in die Zielzeile. Wenn *lskip* 0 (null) ist, wird die erste abgerufene Zeile in der Zeile mit Lesezeichen angezeigt. Wenn *lskip* den Wert 1 hat, ist die erste abgerufene Zeile die Zeile nach der Zeile mit Lesezeichen. Wenn *lskip* den Wert-1 hat, ist die erste Zeile, die abgerufen wird, die Zeile vor der Zeile mit Lesezeichen.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Diese Methode erfordert die optionale Schnittstelle `IRowsetLocate`, die möglicherweise nicht für alle Anbieter unterstützt wird. Wenn dies der Fall ist, gibt die Methode E_NOINTERFACE zurück. Sie müssen auch `DBPROP_IRowsetLocate` auf VARIANT_TRUE festlegen und `DBPROP_CANFETCHBACKWARDS` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl, der das Rowset enthält, aufrufen.

Weitere Informationen zum Verwenden von Lesezeichen in Consumern finden Sie unter [Verwenden von Lesezeichen](../../data/oledb/using-bookmarks.md).

## <a name="crowsetmovetoratio"></a><a name="movetoratio"></a>CRowset:: muvetoratio

Ruft Zeilen ab einer Bruch Position im Rowset ab.

### <a name="syntax"></a>Syntax

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Parameter

*nzähler*<br/>
in Der Zähler, der verwendet wird, um die Bruch Komma Breite zu bestimmen, aus der Daten abgerufen werden sollen.

*nnenner*<br/>
in Der Nenner, der verwendet wird, um die Bruch Komma Breite zu bestimmen, aus der Daten abgerufen werden sollen.

*bForward*<br/>
in Gibt an, ob vorwärts oder rückwärts verschoben werden soll. Der Standardwert ist "Forward".

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

`MoveToRatio` Zeilen gemäß der folgenden Formel abrufen:

`(nNumerator *  RowsetSize ) / nDenominator`

Dabei ist `RowsetSize` die Größe des Rowsets (in Zeilen gemessen). Die Genauigkeit dieser Formel hängt vom jeweiligen Anbieter ab. Weitere Informationen finden Sie unter [IRowsetScroll:: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Diese Methode erfordert die optionale Schnittstelle `IRowsetScroll`, die möglicherweise nicht für alle Anbieter unterstützt wird. Wenn dies der Fall ist, gibt die Methode E_NOINTERFACE zurück. Sie müssen auch `DBPROP_IRowsetScroll` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält.

## <a name="crowsetreleaserows"></a><a name="releaserows"></a>CRowset:: ReleaseRows

Ruft [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) auf, um das aktuelle Zeilen Handle freizugeben.

### <a name="syntax"></a>Syntax

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

## <a name="crowsetsetdata"></a><a name="setdata"></a>CRowset:: SetData

Legt Datenwerte in einer oder mehreren Spalten einer Zeile fest.

### <a name="syntax"></a>Syntax

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Parameter

*naccessor*<br/>
in Die Nummer der Zugriffsmethode, die für den Zugriff auf die Daten verwendet werden soll.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Für das `SetData` Formular, das keine Argumente akzeptiert, werden alle Accessoren für die Aktualisierung verwendet. In der Regel werden `SetData` aufgerufen, um Datenwerte in Spalten in einer Zeile festzulegen. Anschließend wird [Update](../../data/oledb/crowset-update.md) aufgerufen, um diese Änderungen zu übertragen.

Diese Methode erfordert die optionale Schnittstelle `IRowsetChange`, die möglicherweise nicht für alle Anbieter unterstützt wird. Wenn dies der Fall ist, gibt die Methode E_NOINTERFACE zurück. Sie müssen auch `DBPROP_IRowsetChange` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält.

Der Einstellungs Vorgang kann fehlschlagen, wenn eine oder mehrere Spalten nicht beschreibbar sind. Ändern Sie die Cursorzuordnung, um diesen Fehler zu beheben.

## <a name="crowsetundo"></a><a name="undo"></a>CRowset:: Undo

Macht Änderungen an einer Zeile seit dem letzten Abrufen oder [Aktualisieren](../../data/oledb/crowset-update.md)unverändert.

### <a name="syntax"></a>Syntax

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parameter

*pcRows*<br/>
vorgenommen Ein Zeiger auf den Speicherort, an dem `Undo` die Anzahl der Zeilen zurückgibt, die bei Bedarf rückgängig gemacht werden mussten.

*phrow*<br/>
vorgenommen Ein Zeiger auf den Speicherort, an dem `Undo` ein Array von Handles für alle Zeilen zurückgibt, die bei Bedarf rückgängig gemacht werden sollen.

*pstatus*<br/>
vorgenommen Ein Zeiger auf den Speicherort, an dem `Undo` den Zeilen Statuswert zurückgibt. Wenn *pstatus* NULL ist, wird kein Status zurückgegeben.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Diese Methode erfordert die optionale Schnittstelle `IRowsetUpdate`, die möglicherweise nicht für alle Anbieter unterstützt wird. Wenn dies der Fall ist, gibt die Methode E_NOINTERFACE zurück. Sie müssen auch `DBPROP_IRowsetUpdate` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält.

## <a name="crowsetupdate"></a><a name="update"></a>CRowset:: Update

Überträgt alle ausstehenden Änderungen, die seit dem letzten Abrufen oder `Update`-Aufrufs an der aktuellen Zeile vorgenommen wurden.

### <a name="syntax"></a>Syntax

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parameter

*pcRows*<br/>
vorgenommen Ein Zeiger auf den Speicherort, an dem `Update` die Anzahl der zu aktualisierenden Zeilen zurückgibt (falls erforderlich).

*phrow*<br/>
vorgenommen Ein Zeiger auf den Speicherort, an dem `Update` das Handle der Zeile zurückgibt, die aktualisiert werden soll. Wenn *phrow* NULL ist, wird kein Handle zurückgegeben.

*pstatus*<br/>
vorgenommen Ein Zeiger auf den Speicherort, an dem `Update` den Zeilen Statuswert zurückgibt. Wenn *pstatus* NULL ist, wird kein Status zurückgegeben.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

### <a name="remarks"></a>Bemerkungen

Überträgt alle ausstehenden Änderungen, die an der aktuellen Zeile vorgenommen wurden, seit diese Zeile zuletzt abgerufen oder aktualisiert wurde (mit `Update` oder [UpdateAll](../../data/oledb/crowset-updateall.md)). In der Regel wird [SetData](../../data/oledb/crowset-setdata.md) aufgerufen, um Datenwerte in Spalten in einer Zeile festzulegen, und dann `Update` aufgerufen, um diese Änderungen zu übertragen.

Diese Methode erfordert die optionale Schnittstelle `IRowsetUpdate`, die möglicherweise nicht für alle Anbieter unterstützt wird. Wenn dies der Fall ist, gibt die Methode E_NOINTERFACE zurück. Sie müssen auch `DBPROP_IRowsetUpdate` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält.

## <a name="crowsetupdateall"></a><a name="updateall"></a>CRowset:: UpdateAll

Überträgt alle ausstehenden Änderungen, die seit dem letzten Abrufen oder `Update`-Aufrufs an allen Zeilen vorgenommen wurden.

### <a name="syntax"></a>Syntax

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Parameter

*pcRows*<br/>
vorgenommen Ein Zeiger auf den Speicherort, an dem `UpdateAll` die Anzahl der zu aktualisierenden Zeilen zurückgibt (falls erforderlich).

*pphrow*<br/>
vorgenommen Ein Zeiger auf den Arbeitsspeicher, in `UpdateAll` das Handle der Zeile zurückgegeben wird, die aktualisiert werden soll. Wenn *pphrow* NULL ist, wird kein Handle zurückgegeben.

*ppstatus*<br/>
vorgenommen Ein Zeiger auf den Speicherort, an dem `Update` den Zeilen Statuswert zurückgibt. Wenn *ppstatus* NULL ist, wird kein Status zurückgegeben.

### <a name="remarks"></a>Bemerkungen

Überträgt alle ausstehenden Änderungen, die an allen Zeilen vorgenommen wurden, da diese Zeilen zuletzt mithilfe von [Update](../../data/oledb/crowset-update.md) oder `UpdateAll`abgerufen oder aktualisiert wurden. `UpdateAll` aktualisieren jede Zeile, die geändert wurde, unabhängig davon, ob Sie noch über das Handle verfügen (siehe *pphrow*).

Wenn Sie z. b. `Insert` zum Einfügen von fünf Zeilen in ein Rowset verwendet haben, können Sie entweder `Update` fünfmal aufzurufen oder `UpdateAll` einmal aufzurufen, um alle zu aktualisieren.

Diese Methode erfordert die optionale Schnittstelle `IRowsetUpdate`, die möglicherweise nicht für alle Anbieter unterstützt wird. Wenn dies der Fall ist, gibt die Methode E_NOINTERFACE zurück. Sie müssen auch `DBPROP_IRowsetUpdate` auf VARIANT_TRUE festlegen, bevor Sie `Open` für die Tabelle oder den Befehl aufrufen, der das Rowset enthält.

### <a name="return-value"></a>Rückgabewert

Ein HRESULT-Standard.

## <a name="see-also"></a>Weitere Informationen

[DBViewer-Beispiel](../../overview/visual-cpp-samples.md)<br/>
[Multilesebeispiel](../../overview/visual-cpp-samples.md)<br/>
[Beispiel für multigelesene Attribute](../../overview/visual-cpp-samples.md)<br/>
[OLE DB-Consumervorlagen](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Referenz der OLE DB-Consumervorlagen](../../data/oledb/ole-db-consumer-templates-reference.md)
