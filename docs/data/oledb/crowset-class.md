---
title: CRowset-Klasse
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- MoveToRatio
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- ReleaseRows
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: eda4bb09865698a657828c6d4684a8df92ffe9b6
ms.sourcegitcommit: 5cecccba0a96c1b4ccea1f7a1cfd91f259cc5bde
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/01/2019
ms.locfileid: "58779455"
---
# <a name="crowset-class"></a>CRowset-Klasse

Kapselt ein OLE DB-Rowset-Objekt, und einige im Zusammenhang Schnittstellen und bietet Methoden für die Rowsetdaten bearbeiten.

## <a name="syntax"></a>Syntax

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Parameter

*TAccessor*<br/>
Ein Accessor-Klasse. Die Standardeinstellung ist `CAccessorBase`.

## <a name="requirements"></a>Anforderungen

**Header:** atldbcli.h

## <a name="members"></a>Member

### <a name="methods"></a>Methoden

|||
|-|-|
|[AddRefRows](#addrefrows)|Inkrementiert der Verweiszähler fest, die der aktuellen Zeile zugeordnet ist.|
|[Schließen](#close)|Versionen von Zeilen und der aktuelle `IRowset` Schnittstelle.|
|[Compare](#compare)|Vergleicht zwei Lesezeichen mit [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).|
|[CRowset](#crowset)|Erstellt ein neues `CRowset` -Objekt und ordnet sie (optional) eine `IRowset` Schnittstelle, die als Parameter übergeben.|
|[Löschen](#delete)|Löscht Zeilen aus dem Rowset mit [IRowsetChange:DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)).|
|[FindNextRow](#findnextrow)|Sucht nach der nächsten Zeile nach dem angegebenen Lesezeichen.|
|[GetApproximatePosition](#getapproximateposition)|Gibt die ungefähre Position eine Zeile zu einem Lesezeichen zurück.|
|[GetData](#getdata)|Ruft Daten aus der Zeile des Rowsets ab.|
|[GetDataHere](#getdatahere)|Ruft Daten aus dem angegebenen Puffer ab.|
|[GetOriginalData](#getoriginaldata)|Ruft ab, die Daten zuletzt von abgerufen oder übertragen mit der Datenquelle, die ausstehende Änderungen werden ignoriert.|
|[GetRowStatus](#getrowstatus)|Der Status aller Zeilen zurückgegeben.|
|[Einfügen](#insert)|Erstellt und fügt eine neue Zeile mit [IRowsetChange:InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85)).|
|[IsSameRow](#issamerow)|Vergleicht die angegebene Zeile mit der aktuellen Zeile.|
|[MoveFirst](#movefirst)|Positioniert den weiter-Fetch-Speicherort auf die ursprüngliche Position.|
|[MoveLast](#movelast)|Wechselt zum letzten Datensatz.|
|[MoveNext](#movenext)|Ruft Daten aus der nächsten sequenziellen Zeile oder eine angegebene Anzahl von Positionen nach der nächsten Zeile ab.|
|[MovePrev](#moveprev)|Wechselt zum vorherigen Datensatz.|
|[MoveToBookmark](#movetobookmark)|Ruft die Zeile, die durch ein Lesezeichen markiert oder auf die Zeile an einem angegebenen Offset aus diesem Lesezeichen ab.|
|[MoveToRatio](#movetoratio)|Ruft Zeilen ab der ein Bruchteil Ausgangsposition im Rowset ab.|
|[ReleaseRows](#releaserows)|Aufrufe [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) zum Freigeben des Handles der aktuellen Zeile.|
|[SetData](#setdata)|Legt Datenwerte in einer oder mehreren Spalten einer Zeile mit [IRowsetChange:SetData](/previous-versions/windows/desktop/ms721232(v=vs.85)).|
|[Rückgängig machen](#undo)|Macht alle Änderungen, die auf eine Zeile seit der letzten Fetch oder [Update](../../data/oledb/crowset-update.md).|
|[Update (Aktualisieren)](#update)|Sendet alle ausstehenden Änderungen an der aktuellen Zeile seit der letzten Fetch oder aktualisieren.|
|[UpdateAll](#updateall)|Sendet alle ausstehenden Änderungen, die seit der letzten Fetch oder ein Update auf alle Zeilen.|

## <a name="remarks"></a>Hinweise

In der OLE DB ist ein Rowset für das Objekt über dem ein Programm, legt sie fest, und ruft Daten ab.

Diese Klasse ist nicht vorgesehen, werden instanziiert, sondern stattdessen als einen Vorlagenparameter übergeben `CTable` oder `CCommand` (`CRowset` ist die Standardeinstellung).

## <a name="addrefrows"></a> CRowset::AddRefRows

Aufrufe [IRowset::AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) zugeordnet mit dem Zeilenhandle der aktuellen (durch eine) der Verweiszähler inkrementiert werden soll.

### <a name="syntax"></a>Syntax

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Diese Methode inkrementiert den Verweiszähler für das aktuelle Zeilenhandle. Rufen Sie [ReleaseRows](../../data/oledb/crowset-releaserows.md) um die Anzahl der zu verringern. Die Move-Methoden zurückgegebene Zeilen haben einen Verweiszähler eines.

## <a name="close"></a> CRowset::Close

Versionen von Zeilen und der aktuelle [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) Schnittstelle.

### <a name="syntax"></a>Syntax

```cpp
void Close() throw();
```

### <a name="remarks"></a>Hinweise

Diese Methode gibt alle Zeilen im Rowset frei.

## <a name="compare"></a> CRowset:: Compare

Vergleicht zwei Lesezeichen mit [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).

### <a name="syntax"></a>Syntax

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Parameter

*Bookmark1*<br/>
[in] Das erste zu vergleichende Lesezeichen.

*Bookmark2*<br/>
[in] Das zweite zu vergleichende Lesezeichen.

*pComparison*<br/>
[out] Ein Zeiger auf das Ergebnis des Vergleichs.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Diese Methode erfordert die optionale Schnittstelle `IRowsetLocate`, ist der Fall, die für alle Anbieter, wenn diese möglicherweise nicht unterstützt wird, wird die Methode, wird E_NOINTERFACE zurückgegeben. Sie müssen auch festlegen, `DBPROP_IRowsetLocate` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

Weitere Informationen zur Verwendung von Lesezeichen im Consumer, finden Sie unter [mithilfe von Lesezeichen](../../data/oledb/using-bookmarks.md).

## <a name="crowset"></a> CRowset::CRowset

Erstellt ein neues `CRowset` -Objekt und ordnet sie (optional) eine [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) Schnittstelle, die als Parameter übergeben.

### <a name="syntax"></a>Syntax

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Parameter

*pRowset*<br/>
[in] Ein Zeiger auf ein `IRowset` Schnittstelle mit dieser Klasse zugeordnet werden soll.

## <a name="delete"></a> CRowset::Delete

Aufrufe [IRowsetChange:: DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)) auf die aktuelle Zeile aus dem Rowset gelöscht.

### <a name="syntax"></a>Syntax

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

## <a name="findnextrow"></a> CRowset::FindNextRow

Sucht nach der nächsten Zeile nach dem angegebenen Lesezeichen.

### <a name="syntax"></a>Syntax

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Parameter

*op*<br/>
[in] Der Vorgang zum Vergleichen von Zeilenwerten verwenden. Werte, finden Sie unter [irowsetfind:: FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
[in] Ein Zeiger auf den Wert, der zugeordnet werden.

*wType*<br/>
[in] Gibt an, der den Datentyp des Value-Teil des Puffers. Informationen zu typindikatoren, finden Sie unter [Datentypen](/previous-versions/windows/desktop/ms723969(v=vs.85)) in die *OLE DB-Programmierreferenz* im Windows SDK.

*nLength*<br/>
[in] Die Länge in Bytes der Consumer-Datenstruktur, die für den Datenwert zugeordnet. Weitere Informationen finden Sie unter der Beschreibung der `cbMaxLen` in [DBBINDING-Strukturen](/previous-versions/windows/desktop/ms716845(v=vs.85)) in die *OLE DB-Programmiererreferenz.*

*bPrecision*<br/>
[in] Die maximale Genauigkeit, die beim Abrufen von Daten verwendet wird. Nur verwendet werden, wenn *wType* DBTYPE_NUMERIC ist. Weitere Informationen finden Sie unter [Konvertierungen, die im Zusammenhang mit DBTYPE_NUMERIC oder DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) in die *OLE DB-Programmierreferenz*.

*bScale*<br/>
[in] Die Skalierung, die beim Abrufen von Daten verwendet. Nur verwendet werden, wenn *wType* DBTYPE_NUMERIC oder DBTYPE_DECIMAL ist. Weitere Informationen finden Sie unter [Konvertierungen, die im Zusammenhang mit DBTYPE_NUMERIC oder DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) in die *OLE DB-Programmierreferenz*.

*bSkipCurrent*<br/>
[in] Die Anzahl der Zeilen aus das Lesezeichen, an dem eine Suche zu beginnen.

*pBookmark*<br/>
[in] Das Lesezeichen für die Position, an dem mit eine Suche begonnen werden soll.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Diese Methode erfordert die optionale Schnittstelle `IRowsetFind`, ist der Fall, die für alle Anbieter, wenn diese möglicherweise nicht unterstützt wird, wird die Methode, wird E_NOINTERFACE zurückgegeben. Sie müssen auch festlegen, `DBPROP_IRowsetFind` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

Weitere Informationen zur Verwendung von Lesezeichen im Consumer, finden Sie unter [mithilfe von Lesezeichen](../../data/oledb/using-bookmarks.md).

## <a name="getapproximateposition"></a> CRowset::GetApproximatePosition

Gibt die ungefähre Position eine Zeile zu einem Lesezeichen zurück.

### <a name="syntax"></a>Syntax

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Parameter

*pBookmark*<br/>
[in] Ein Zeiger auf ein Lesezeichen, das die Zeile identifiziert, dessen Position gesucht wird. NULL, wenn nur die Anzahl der Zeilen erforderlich ist.

*pPosition*<br/>
[out] Ein Zeiger auf den Speicherort, in denen `GetApproximatePosition` gibt die Position der Zeile zurück. NULL, wenn die Position nicht erforderlich ist.

*pcRows*<br/>
[out] Ein Zeiger auf den Speicherort, in denen `GetApproximatePosition` gibt die Gesamtzahl der Zeilen zurück. NULL, wenn die Anzahl der Zeilen nicht erforderlich ist.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Diese Methode erfordert die optionale Schnittstelle `IRowsetScroll`, ist der Fall, die für alle Anbieter, wenn diese möglicherweise nicht unterstützt wird, wird die Methode, wird E_NOINTERFACE zurückgegeben. Sie müssen auch festlegen, `DBPROP_IRowsetScroll` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

Weitere Informationen zur Verwendung von Lesezeichen im Consumer, finden Sie unter [mithilfe von Lesezeichen](../../data/oledb/using-bookmarks.md).

## <a name="getdata"></a> CRowset::GetData

Ruft Daten aus der Zeile des Rowsets ab.

### <a name="syntax"></a>Syntax

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Parameter

*nAccessor*<br/>
[in] Die Indexnummer des (0 (null)-Offset) des Accessors, für den Zugriff auf die Daten verwenden.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Wenn Sie einen Accessor angeben, die keinen Autoaccessor in [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), verwenden Sie diese Methode, um die Daten durch Übergeben der Anzahl der Accessor explizit zu erhalten.

## <a name="getdatahere"></a> CRowset::GetDataHere

Ruft Daten aus der aktuellen Zeile ab, und setzt es in den angegebenen Puffer.

### <a name="syntax"></a>Syntax

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Parameter

*nAccessor*<br/>
[in] Die Indexnummer des Accessors, für den Zugriff auf die Daten verwendet werden soll.

*pBuffer*<br/>
[out] Ein Puffer, in dem die Daten für den aktuellen Datensatz platziert werden soll.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Ein Beispiel dafür, wie Sie diese Funktion verwenden, finden Sie die [MultiRead-Beispiel](../../overview/visual-cpp-samples.md).

## <a name="getoriginaldata"></a> CRowset::GetOriginalData

Aufrufe `IRowsetUpdate::GetOriginalData` zum Abrufen der Daten, die zuletzt von abgerufen oder an die Datenquelle übertragen.

### <a name="syntax"></a>Syntax

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Diese Methode ruft die Daten aus den zuletzt abgerufen oder übertragen werden, mit der Datenquelle ab; Werte, die basierend auf ausstehende Änderungen werden nicht abgerufen werden.

Diese Methode erfordert die optionale Schnittstelle `IRowsetUpdate`, ist der Fall, die für alle Anbieter, wenn diese möglicherweise nicht unterstützt wird, wird die Methode, wird E_NOINTERFACE zurückgegeben. Sie müssen auch festlegen, `DBPROP_IRowsetUpdate` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

## <a name="getrowstatus"></a> CRowset::GetRowStatus

Der Status aller Zeilen zurückgegeben.

### <a name="syntax"></a>Syntax

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Parameter

*pStatus*<br/>
[out] Ein Zeiger auf einen Speicherort, in denen `GetRowStatus` gibt den Statuswert zurück. Finden Sie unter DBPENDINGSTATUS in der OLE DB Programmer's Reference.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Diese Methode erfordert die optionale Schnittstelle `IRowsetUpdate`, ist der Fall, die für alle Anbieter, wenn diese möglicherweise nicht unterstützt wird, wird die Methode, wird E_NOINTERFACE zurückgegeben. Sie müssen auch festlegen, `DBPROP_IRowsetUpdate` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

## <a name="insert"></a> CRowset:: Insert

Erstellt und initialisiert eine neue Zeile mit Daten aus der Zugriffsmethode.

### <a name="syntax"></a>Syntax

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Parameter

*nAccessor*<br/>
[in] Die Anzahl der Accessor für das Einfügen von Daten verwenden.

*bGetHRow*<br/>
[in] Gibt an, ob das Handle für die eingefügte Zeile abgerufen wird.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Diese Methode erfordert die optionale Schnittstelle `IRowsetChange`, ist der Fall, die für alle Anbieter, wenn diese möglicherweise nicht unterstützt wird, wird die Methode, wird E_NOINTERFACE zurückgegeben. Sie müssen auch festlegen, `DBPROP_IRowsetChange` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

INSERT kann fehlschlagen, wenn eine oder mehrere Spalten ist nicht beschreibbar. Ändern Sie die Cursorzuordnung, um diesen Fehler zu beheben.

### <a name="example"></a>Beispiel

Das folgende Beispiel zeigt, wie Sie auf eine Datenquelle zugreifen, bis ein Rowset aus, und fügen Sie dann eine Zeichenfolge, die Verwendung einer Tabelle in dieses Rowset besitzt.

Erstellen Sie zunächst eine Tabellenklasse, durch Einfügen eines neuen ATL-Objekts in Ihr Projekt. Beispielsweise mit der rechten Maustaste in des Projekts im Bereich "Arbeitsbereich", und wählen Sie **neue ATL-Objekt**. Von der **Datenzugriff** Kategorie **Consumer**. Erstellen Sie ein Consumerobjekt des Typs **Tabelle**. (Auswahl **Tabelle** erstellt ein Rowset direkt aus der Tabelle; wählen **Befehl** erstellt ein Rowset über einen SQL‑Befehl.) Wählen Sie eine Datenquelle, die Angabe einer Tabelle durch die diese Datenquelle zugreifen. Wenn Sie das Consumerobjekt Aufrufen **CCustomerTable**, dann implementieren Sie Ihren Code einfügen wie folgt:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="issamerow"></a> CRowset::IsSameRow

Vergleicht die angegebene Zeile mit der aktuellen Zeile.

### <a name="syntax"></a>Syntax

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Parameter

*hRow*<br/>
[in] Ein Handle für die Zeile, auf die aktuelle Zeile verglichen werden soll.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT. S_OK gibt an, dass die Zeilen identisch sind. Weitere Werte finden Sie unter [IRowsetIndentity::IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) in die *OLE DB-Programmierreferenz* im Windows SDK.

## <a name="movefirst"></a> CRowset::MoveFirst

Verschiebt den Cursor auf die ursprüngliche Position und ruft die erste Zeile ab.

### <a name="syntax"></a>Syntax

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Aufrufe [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) um den weiter-Fetch-Speicherort zu verschieben, um die ursprüngliche Position (die Position, die den weiter-Fetch-Speicherort wurde, wenn das Rowset erstellt wurde) und ruft die erste Zeile ab.

## <a name="movelast"></a> CRowset::MoveLast

Verschiebt den Cursor auf die letzte Zeile an.

### <a name="syntax"></a>Syntax

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Aufrufe [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) um den nächsten-Fetch-Speicherort mit dem letzten neu positionieren, und ruft die letzte Zeile ab.

Diese Methode erfordert, dass Sie festlegen, `DBPROP_CANSCROLLBACKWARDS` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält. (Sie können auch festlegen, zur Verbesserung der Leistung `DBPROP_QUICKRESTART` auf VARIANT_TRUE fest.)

## <a name="movenext"></a> CRowset::MoveNext

Verschiebt den Cursor auf den nächsten Datensatz.

### <a name="syntax"></a>Syntax

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Parameter

*lSkip*<br/>
[in] Die Anzahl der zu überspringenden vor dem Abrufen der Zeilen.

*bForward*<br/>
[in] Übergeben Sie **"true"** auf den nächsten Datensatz, voranschreiten **"false"** um rückwärts zu bewegen.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT. Wenn das Ende des Rowsets erreicht wurde, gibt die DB_S_ENDOFROWSET zurück.

### <a name="remarks"></a>Hinweise

Dadurch wird die nächste sequenzielle Zeile aus der `CRowset` Objekt speichert die vorherige Position. Optional können Sie entscheiden zu überspringenden *lSkip* Zeilen "oder" Rückwärts navigieren.

Diese Methode erfordert, dass Sie festlegen, dass die folgenden Eigenschaften vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält:

- `DBPROP_CANSCROLLBACKWARDS` muss auf VARIANT_TRUE festgelegt werden, wenn *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` muss auf VARIANT_TRUE festgelegt werden, wenn *bForward* = "false"

Andernfalls (Wenn *lSkip* > = 0 und *bForward* = True), Sie müssen keine zusätzlichen Eigenschaften festlegen.

## <a name="moveprev"></a> CRowset::MovePrev

Verschiebt den Cursor zum vorherigen Datensatz.

### <a name="syntax"></a>Syntax

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Diese Methode erfordert, dass Sie, entweder festlegen `DBPROP_CANFETCHBACKWARDS` oder `DBPROP_CANSCROLLBACKWARDS` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

## <a name="movetobookmark"></a> CRowset::MoveToBookmark

Dadurch wird die Zeile, die durch ein Lesezeichen oder auf die Zeile an einem angegebenen Offset gekennzeichnet (*lSkip*) von diesem Lesezeichen.

### <a name="syntax"></a>Syntax

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Parameter

*bookmark*<br/>
[in] Ein Lesezeichen, markieren den Speicherort, von dem Daten abgerufen werden sollen.

*lSkip*<br/>
[in] Die Anzahl Anzahl von Zeilen aus das Lesezeichen die Zielzeile. Wenn *lSkip* 0 (null), wird die erste Zeile abgerufen wird, den mit Lesezeichen versehenen Zeile. Wenn *lSkip* 1 ist, die erste Zeile abgerufen wird die Zeile nach der Lesezeichen versehenen Zeile. Wenn *lSkip* ist-1. die erste Zeile abgerufen wird die Zeile vor den mit Lesezeichen versehenen Zeile.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Diese Methode erfordert die optionale Schnittstelle `IRowsetLocate`, ist der Fall, die für alle Anbieter, wenn diese möglicherweise nicht unterstützt wird, wird die Methode, wird E_NOINTERFACE zurückgegeben. Sie müssen auch festlegen `DBPROP_IRowsetLocate` auf VARIANT_TRUE fest und `DBPROP_CANFETCHBACKWARDS` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

Weitere Informationen zur Verwendung von Lesezeichen im Consumer, finden Sie unter [mithilfe von Lesezeichen](../../data/oledb/using-bookmarks.md).

## <a name="movetoratio"></a> CRowset::MoveToRatio

Ruft Zeilen ab der ein Bruchteil Ausgangsposition im Rowset ab.

### <a name="syntax"></a>Syntax

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Parameter

*nNumerator*<br/>
[in] Der Zähler verwendet, um zu bestimmen, die Nachkommastellen mit Feldern fester Breite aus der zum Abrufen von Daten.

*nDenominator*<br/>
[in] Der Nenner verwendet, um zu bestimmen, die Nachkommastellen mit Feldern fester Breite aus der zum Abrufen von Daten.

*bForward*<br/>
[in] Gibt an, ob vorwärts oder rückwärts verschoben werden soll. Der Standardwert ist.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

`MoveToRatio` Ruft die Zeilen, die gemäß der folgenden Formel ungefähr ab:

`(nNumerator *  RowsetSize ) / nDenominator`

Wo `RowsetSize` ist die Größe des Rowsets, gemessen in Zeilen. Die Genauigkeit zu dieser Formel hängt von dem Anbieter ab. Weitere Informationen finden Sie unter [IRowsetScroll:: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Diese Methode erfordert die optionale Schnittstelle `IRowsetScroll`, ist der Fall, die für alle Anbieter, wenn diese möglicherweise nicht unterstützt wird, wird die Methode, wird E_NOINTERFACE zurückgegeben. Sie müssen auch festlegen, `DBPROP_IRowsetScroll` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

## <a name="releaserows"></a> CRowset::ReleaseRows

Aufrufe [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) zum Freigeben des Handles der aktuellen Zeile.

### <a name="syntax"></a>Syntax

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

## <a name="setdata"></a> CRowset::SetData

Legt Datenwerte in einer oder mehreren Spalten einer Zeile fest.

### <a name="syntax"></a>Syntax

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Parameter

*nAccessor*<br/>
[in] Die Anzahl des Accessors, für den Zugriff auf die Daten verwendet werden soll.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Für die `SetData` Form, die akzeptiert keine Argumente, die alle Accessoren werden für die Aktualisierung verwendet. Rufen Sie in der Regel `SetData` rufen Sie dann zum Festlegen von Datenwerten in Spalten in einer Zeile [Update](../../data/oledb/crowset-update.md) , diese Änderungen zu übertragen.

Diese Methode erfordert die optionale Schnittstelle `IRowsetChange`, ist der Fall, die für alle Anbieter, wenn diese möglicherweise nicht unterstützt wird, wird die Methode, wird E_NOINTERFACE zurückgegeben. Sie müssen auch festlegen, `DBPROP_IRowsetChange` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

Der Vorgang fehlschlagen, wenn eine oder mehrere Spalten ist nicht beschreibbar. Ändern Sie die Cursorzuordnung, um diesen Fehler zu beheben.

## <a name="undo"></a> CRowset::Undo

Macht alle Änderungen, die auf eine Zeile seit der letzten Fetch oder [Update](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Syntax

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parameter

*pcRows*<br/>
[out] Ein Zeiger auf den Speicherort, in denen `Undo` gibt die Anzahl der Zeilen, die versucht wurde, rückgängig machen, wenn erforderlich.

*phRow*<br/>
[out] Ein Zeiger auf den Speicherort, in denen `Undo` gibt ein Array von Handles, alle Zeilen, die versucht wurde, rückgängig machen, wenn erforderlich.

*pStatus*<br/>
[out] Ein Zeiger auf den Speicherort, in denen `Undo` den Statuswert Zeile zurückgibt. Es wird kein Status zurückgegeben, wenn *pStatus* ist null.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Diese Methode erfordert die optionale Schnittstelle `IRowsetUpdate`, ist der Fall, die für alle Anbieter, wenn diese möglicherweise nicht unterstützt wird, wird die Methode, wird E_NOINTERFACE zurückgegeben. Sie müssen auch festlegen, `DBPROP_IRowsetUpdate` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

## <a name="update"></a> CRowset::Update

Überträgt alle ausstehenden Änderungen an der aktuellen Zeile seit der letzten Fetch oder `Update` für ihn aufrufen.

### <a name="syntax"></a>Syntax

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parameter

*pcRows*<br/>
[out] Ein Zeiger auf den Speicherort, in denen `Update` gibt die Anzahl der Zeilen, die versucht wurde, aktualisieren, falls erforderlich.

*phRow*<br/>
[out] Ein Zeiger auf den Speicherort, in denen `Update` gibt das Handle der Zeile, die es versucht, zu aktualisieren. Kein Handle wird zurückgegeben, wenn *PhRow* ist null.

*pStatus*<br/>
[out] Ein Zeiger auf den Speicherort, in denen `Update` den Statuswert Zeile zurückgibt. Es wird kein Status zurückgegeben, wenn *pStatus* ist null.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

### <a name="remarks"></a>Hinweise

Überträgt alle Änderungen an der aktuellen Zeile vorgenommen werden, da die Zeile zuletzt abgerufen oder aktualisiert wurde (mit `Update` oder [UpdateAll](../../data/oledb/crowset-updateall.md)). Rufen Sie in der Regel [SetData](../../data/oledb/crowset-setdata.md) von Datenwerten in Spalten in einer Zeile, und rufen Sie dann `Update` , diese Änderungen zu übertragen.

Diese Methode erfordert die optionale Schnittstelle `IRowsetUpdate`, ist der Fall, die für alle Anbieter, wenn diese möglicherweise nicht unterstützt wird, wird die Methode, wird E_NOINTERFACE zurückgegeben. Sie müssen auch festlegen, `DBPROP_IRowsetUpdate` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

## <a name="updateall"></a> CRowset::UpdateAll

Überträgt alle ausstehenden Änderungen, die seit der letzten Abruf auf alle Zeilen oder `Update` für ihn aufrufen.

### <a name="syntax"></a>Syntax

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Parameter

*pcRows*<br/>
[out] Ein Zeiger auf den Speicherort, in denen `UpdateAll` gibt die Anzahl der Zeilen, die versucht wurde, aktualisieren, falls erforderlich.

*pphRow*<br/>
[out] Ein Zeiger auf Speicher, in den `UpdateAll` gibt das Handle der Zeile, die es versucht, zu aktualisieren. Kein Handle wird zurückgegeben, wenn *PphRow* ist null.

*ppStatus*<br/>
[out] Ein Zeiger auf den Speicherort, in denen `Update` den Statuswert Zeile zurückgibt. Es wird kein Status zurückgegeben, wenn *PpStatus* ist null.

### <a name="remarks"></a>Hinweise

Überträgt alle Änderungen an allen Zeilen vorgenommen werden, da die Zeilen zuletzt abgerufen wurden oder mithilfe von aktualisiert [Update](../../data/oledb/crowset-update.md) oder `UpdateAll`. `UpdateAll` Jede Zeile, die geändert wurde unabhängig davon, ob Sie das Handle für diese immer noch, aktualisiert (finden Sie unter *PphRow*) oder nicht.

Angenommen, Sie verwendet `Insert` um fünf Zeilen in einem Rowset einzufügen, können Sie entweder Aufruf `Update` fünfmal oder Aufruf `UpdateAll` einmal, um alle zu aktualisieren.

Diese Methode erfordert die optionale Schnittstelle `IRowsetUpdate`, ist der Fall, die für alle Anbieter, wenn diese möglicherweise nicht unterstützt wird, wird die Methode, wird E_NOINTERFACE zurückgegeben. Sie müssen auch festlegen, `DBPROP_IRowsetUpdate` auf VARIANT_TRUE fest, vor dem Aufruf `Open` für die Tabelle oder einen Befehl, der das Rowset enthält.

### <a name="return-value"></a>Rückgabewert

Ein standard-HRESULT.

## <a name="see-also"></a>Siehe auch

[DBViewer-Beispiel](../../overview/visual-cpp-samples.md)<br/>
[MultiRead-Beispiel](../../overview/visual-cpp-samples.md)<br/>
[Beispiel für MultiRead-Attribute](../../overview/visual-cpp-samples.md)<br/>
[OLE DB-Consumervorlagen](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Referenz der OLE DB-Consumervorlagen](../../data/oledb/ole-db-consumer-templates-reference.md)