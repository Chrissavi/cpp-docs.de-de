---
title: COleClientItem-Klasse
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: ce321c9709b752602a664142f283884f4d17b50b
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753959"
---
# <a name="coleclientitem-class"></a>COleClientItem-Klasse

Definiert die Containerschnittstelle zu OLE-Elementen.

## <a name="syntax"></a>Syntax

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Member

### <a name="public-constructors"></a>Öffentliche Konstruktoren

|Name|BESCHREIBUNG|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Erstellt ein `COleClientItem`-Objekt.|

### <a name="public-methods"></a>Öffentliche Methoden

|Name|BESCHREIBUNG|
|----------|-----------------|
|[COleClientItem::Aktivieren](#activate)|Öffnet das OLE-Element für einen Vorgang und führt dann das angegebene Verb aus.|
|[COleClientItem::ActivateAs](#activateas)|Aktiviert das Element als einen anderen Typ.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Greift auf die Daten im OLE-Objekt zu.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Gibt an, ob eine Containeranwendung ein eingebettetes Objekt erstellen kann.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Gibt an, ob eine Containeranwendung ein verknüpftes Objekt erstellen kann.|
|[COleClientItem::CanPaste](#canpaste)|Gibt an, ob die Zwischenablage ein einbettbares oder statisches OLE-Element enthält.|
|[COleClientItem::CanPasteLink](#canpastelink)|Gibt an, ob die Zwischenablage ein verklinkbares OLE-Element enthält.|
|[COleClientItem::Schließen](#close)|Schließt eine Verknüpfung zu einem Server, zerstört jedoch nicht das OLE-Element.|
|[COleClientItem::Convertto](#convertto)|Konvertiert das Element in einen anderen Typ.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Kopiert das OLE-Element in die Zwischenablage.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Erstellt ein Duplikat eines vorhandenen Elements.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Erstellt ein eingebettetes Element aus der Zwischenablage.|
|[COleClientItem::CreateFromData](#createfromdata)|Erstellt ein eingebettetes Element aus einem Datenobjekt.|
|[COleClientItem::CreateFromFile](#createfromfile)|Erstellt ein eingebettetes Element aus einer Datei.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Erstellt ein verknüpftes Element aus der Zwischenablage.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Erstellt ein verknüpftes Element aus einem Datenobjekt.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Erstellt ein verknüpftes Element aus einer Datei.|
|[COleClientItem::CreateNewItem](#createnewitem)|Erstellt ein neues eingebettetes Element, indem die Serveranwendung gestartet wird.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Erstellt ein statisches Element aus der Zwischenablage.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Erstellt ein statisches Element aus einem Datenobjekt.|
|[COleClientItem::Deactivate](#deactivate)|Deaktiviert das Element.|
|[COleClientItem::DeactivateUI](#deactivateui)|Stellt den ursprünglichen Zustand der Containeranwendung wieder her.|
|[COleClientItem::Delete](#delete)|Löscht oder schließt das OLE-Element, wenn es sich um ein verknüpftes Element handelt.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Führt einen Drag-and-Drop-Vorgang aus.|
|[COleClientItem::DoVerb](#doverb)|Führt das angegebene Verb aus.|
|[COleClientItem::Draw](#draw)|Zeichnet das OLE-Element.|
|[COleClientItem::GetActiveView](#getactiveview)|Ruft die Ansicht ab, in der das Element aktiviert ist.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Gibt die Grenzen des Rechtecks des OLE-Elements zurück.|
|[COleClientItem::GetClassID](#getclassid)|Ruft die Klassen-ID des aktuellen Elements ab.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Ruft die Daten ab, die in der `CopyToClipboard` Zwischenablage platziert würden, indem die Memberfunktion aufgerufen wird.|
|[COleClientItem::GetDocument](#getdocument)|Gibt `COleDocument` das Objekt zurück, das das vorliegende Element enthält.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Ruft die aktuelle Ansicht des Elements zum Rendern ab.|
|[COleClientItem::GetExtent](#getextent)|Gibt die Grenzen des Rechtecks des OLE-Elements zurück.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Ruft ein Handle zu einem Symbol ab, das dem Server einer bestimmten CLSID zugeordnet ist.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Ruft die Metadatei ab, die zum Zeichnen des Elementsymbols verwendet wird.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Gibt einen Zeiger auf das ortsnahe Bearbeitungsfenster des Elements zurück.|
|[COleClientItem::GetItemState](#getitemstate)|Ruft den aktuellen Status des Elements ab.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Gibt den Status des letzten OLE-Vorgangs zurück.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Gibt den Aktualisierungsmodus für ein verknüpftes Element zurück (erweitertefunktion).|
|[COleClientItem::GetType](#gettype)|Gibt den Typ (eingebettet, verknüpft oder statisch) des OLE-Elements zurück.|
|[COleClientItem::GetUserType](#getusertype)|Ruft eine Zeichenfolge ab, die den Typ des Elements beschreibt.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Gibt TRUE zurück, wenn das Element aktiv ist.|
|[COleClientItem::IsLinkUptoDate](#islinkuptodate)|Gibt TRUE zurück, wenn ein verknüpftes Element mit seinem Quelldokument auf dem neuesten Stand ist.|
|[COleClientItem::IsModified](#ismodified)|Gibt TRUE zurück, wenn das Element seit dem letzten Speichern geändert wurde.|
|[COleClientItem::IsOpen](#isopen)|Gibt TRUE zurück, wenn das Element derzeit in der Serveranwendung geöffnet ist.|
|[COleClientItem::IsRunning](#isrunning)|Gibt TRUE zurück, wenn die Serveranwendung des Elements ausgeführt wird.|
|[COleClientItem::OnActivate](#onactivate)|Wird vom Framework aufgerufen, um das Element zu benachrichtigen, dass es aktiviert ist.|
|[COleClientItem::OnActivateUI](#onactivateui)|Wird vom Framework aufgerufen, um das Element zu benachrichtigen, dass es aktiviert ist, und sollte seine Benutzeroberfläche anzeigen.|
|[COleClientItem::OnChange](#onchange)|Wird aufgerufen, wenn der Server das OLE-Element ändert. Implementierung erforderlich.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Wird vom Framework aufgerufen, wenn ein Element deaktiviert ist.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Wird vom Framework aufgerufen, wenn der Server die an Ort und Stelle eingerichtete Benutzeroberfläche entfernt hat.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Wird vom Framework aufgerufen, um die Zu-und Nachbereiten der Daten in die Zwischenablage zu erhalten.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Wird vom Framework aufgerufen, um ein zusammengesetztes Menü zu erstellen.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Wird vom Framework aufgerufen, um die Menüs des Containers aus einem zusammengesetzten Menü zu entfernen.|
|[COleClientItem::OnsetMenu](#onsetmenu)|Wird vom Framework aufgerufen, um ein zusammengesetztes Menü zu installieren und zu entfernen.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Wird vom Framework aufgerufen, um Steuerleisten einzublenden und auszublenden.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Wird vom Framework aufgerufen, um die Titelleiste des Rahmenfensters zu aktualisieren.|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Reaktiviert das Element und macht den letzten an Ort und Stelle aufarbeiteten Vorgang.|
|[COleClientItem::Release](#release)|Gibt die Verbindung zu einem ole verknüpften Element frei und schließt sie, wenn sie geöffnet war. Zerstört das Clientelement nicht.|
|[COleClientItem::Neuladen](#reload)|Lädt das Element nach `ActivateAs`einem Aufruf von neu.|
|[COleClientItem::Ausführen](#run)|Führt die dem Element zugeordnete Anwendung aus.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Legt die aktuelle Ansicht des Elements für das Rendern fest.|
|[COleClientItem::SetExtent](#setextent)|Legt das umgrenzende Rechteck des OLE-Elements fest.|
|[COleClientItem::SetHostNames](#sethostnames)|Legt die Namen fest, die der Server beim Bearbeiten des OLE-Elements anzeigt.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Speichert die Metadatei zwischen, die zum Zeichnen des Elementsymbols verwendet wird.|
|[COleClientItem::SetItemRects](#setitemrects)|Legt das umgrenzende Rechteck des Elements fest.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Legt den Aktualisierungsmodus für ein verknüpftes Element fest (erweiterteFunktion).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Legt das Druckzielgerät für dieses Clientelement fest.|
|[COleClientItem::UpdateLink](#updatelink)|Aktualisiert den Präsentationscache eines Elements.|

### <a name="protected-methods"></a>Geschützte Methoden

|Name|BESCHREIBUNG|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Wird vom Framework aufgerufen, um zu bestimmen, ob eine ortsnahe Aktivierung zulässig ist.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Wird vom Framework aufgerufen, wenn sich die Position eines Elements ändert.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Wird vom Framework aufgerufen, um es nach der Aktivierung rückgängig zu machen.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Wird vom Framework aufgerufen, um die Rückgängig-Statusinformationen des Elements zu verwerfen.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Wird vom Framework aufgerufen, um die Clipping-Rechteck-Koordinaten des Elements abzurufen.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Wird vom Framework aufgerufen, um die Position des Elements relativ zur Ansicht abzuzeigen.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Wird vom Framework aufgerufen, wenn ein Element aktiviert ist.|
|[COleClientItem::OnScrollby](#onscrollby)|Wird vom Framework aufgerufen, um das Element in die Ansicht zu scrollen.|
|[COleClientItem::OnShowItem](#onshowitem)|Wird vom Framework aufgerufen, um das OLE-Element anzuzeigen.|

## <a name="remarks"></a>Bemerkungen

Ein OLE-Element stellt Daten dar, die von einer Serveranwendung erstellt und verwaltet werden, die "nahtlos" in ein Dokument integriert werden können, sodass es dem Benutzer als ein einzelnes Dokument erscheint. Das Ergebnis ist ein "zusammengesetztes Dokument", das aus dem OLE-Element und einem enthaltenden Dokument besteht.

Ein OLE-Element kann eingebettet oder verknüpft werden. Wenn es eingebettet ist, werden seine Daten als Teil des zusammengesetzten Dokuments gespeichert. Wenn sie verknüpft ist, werden ihre Daten als Teil einer separaten Datei gespeichert, die von der Serveranwendung erstellt wurde, und nur ein Link zu dieser Datei wird im zusammengesetzten Dokument gespeichert. Alle OLE-Elemente enthalten Informationen, die die Serveranwendung angeben, die aufgerufen werden soll, um sie zu bearbeiten.

`COleClientItem`definiert mehrere überschreibbare Funktionen, die als Reaktion auf Anforderungen der Serveranwendung aufgerufen werden. diese Überschreibbaren fungieren in der Regel als Benachrichtigungen. Auf diese Weise kann die Serveranwendung den Container über Änderungen informieren, die der Benutzer beim Bearbeiten des OLE-Elements vornimmt, oder Informationen abrufen, die während der Bearbeitung benötigt werden.

`COleClientItem`kann entweder mit der [COleDocument](../../mfc/reference/coledocument-class.md)-, [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)- oder [cOleServerDoc-Klasse](../../mfc/reference/coleserverdoc-class.md) verwendet werden. Um `COleClientItem`zu verwenden, leiten Sie daraus eine Klasse ab, und implementieren Sie die [OnChange-Memberfunktion,](#onchange) die definiert, wie der Container auf Änderungen am Element reagiert. Um die ortsnahe Aktivierung zu unterstützen, überschreiben Sie die [OnGetItemPosition-Memberfunktion.](#ongetitemposition) Diese Funktion enthält Informationen zur angezeigten Position des OLE-Elements.

Weitere Informationen zur Verwendung der Containerschnittstelle finden Sie in den Artikeln [Container: Implementieren eines Containers](../../mfc/containers-implementing-a-container.md) und [Aktivierung](../../mfc/activation-cpp.md).

> [!NOTE]
> Das Windows SDK bezeichnet eingebettete und verknüpfte Elemente als "Objekte" und bezeichnet Elementtypen als "Klassen". Dieser Verweis verwendet den Begriff "Element", um die OLE-Entität vom entsprechenden C++-Objekt und den Begriff "Typ" zu unterscheiden, um die OLE-Kategorie von der C++-Klasse zu unterscheiden.

## <a name="inheritance-hierarchy"></a>Vererbungshierarchie

[Cobject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Requirements (Anforderungen)

**Kopfzeile:** afxole.h

## <a name="coleclientitemactivate"></a><a name="activate"></a>COleClientItem::Aktivieren

Rufen Sie diese Funktion auf, um das angegebene Verb anstelle von [DoVerb](#doverb) auszuführen, damit Sie Ihre eigene Verarbeitung durchführen können, wenn eine Ausnahme ausgelöst wird.

```cpp
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parameter

*nVerb*<br/>
Gibt das auszuführende Verb an. Folgende Werte sind möglich:

|Wert|Bedeutung|Symbol|
|-----------|-------------|------------|
|- 0|Primäres Verb|OLEIVERB_PRIMARY|
|- 1|Sekundäres Verb|(Keine)|
|- 1|Element zur Bearbeitung anzeigen|OLEIVERB_SHOW|
|- 2|Bearbeiten des Elements in einem separaten Fenster|OLEIVERB_OPEN|
|- 3|Ausblenden von Gegenständen|OLEIVERB_HIDE|

Der -1-Wert ist in der Regel ein Alias für ein anderes Verb. Wenn die offene Bearbeitung nicht unterstützt wird, hat -2 den gleichen Effekt wie -1. Weitere Werte finden Sie unter [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) im Windows SDK.

*Pview*<br/>
Zeiger auf das Containeransichtsfenster, das das OLE-Element enthält; Dies wird von der Serveranwendung für die ortsspezifische Aktivierung verwendet. Dieser Parameter sollte NULL sein, wenn der Container keine ortsbezogene Aktivierung unterstützt.

*lpMsg*<br/>
Zeigen Sie auf die Meldung, die dazu geführt hat, dass das Element aktiviert wurde.

### <a name="remarks"></a>Bemerkungen

Wenn die Serveranwendung mit der Microsoft Foundation-Klassenbibliothek geschrieben wurde, bewirkt `COleServerItem` diese Funktion, dass die [OnDoVerb-Memberfunktion](../../mfc/reference/coleserveritem-class.md#ondoverb) des entsprechenden Objekts ausgeführt wird.

Wenn das primäre Verb Bearbeiten ist und Null im *nVerb-Parameter* angegeben ist, wird die Serveranwendung gestartet, damit das OLE-Element bearbeitet werden kann. Wenn die Containeranwendung die ortsspezifische Aktivierung unterstützt, kann die Bearbeitung durchgeführt werden. Wenn der Container keine ortsbezogene Aktivierung unterstützt (oder wenn das Verb Open angegeben ist), wird der Server in einem separaten Fenster gestartet, und die Bearbeitung kann dort durchgeführt werden. Wenn der Benutzer der Containeranwendung auf das OLE-Element doppelklickt, bestimmt der Wert für das primäre Verb im *NVerb-Parameter* in der Regel, welche Aktion der Benutzer ausführen kann. Wenn der Server jedoch nur eine Aktion unterstützt, wird diese Aktion ausgeführt, unabhängig davon, welcher Wert im *nVerb-Parameter* angegeben ist.

Weitere Informationen finden Sie unter [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) im Windows SDK.

## <a name="coleclientitemactivateas"></a><a name="activateas"></a>COleClientItem::ActivateAs

Verwendet die Objektkonvertierungsfunktionen von OLE, um das Element so zu aktivieren, als wäre es ein Element des von *clsidNew*angegebenen Typs.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parameter

*lpszUserType*<br/>
Zeigen Sie mit dem Zeiger auf eine Zeichenfolge, die den Zielbenutzertyp darstellt, z. B. "Word-Dokument".

*clsidOld*<br/>
Ein Verweis auf die aktuelle Klassen-ID des Elements. Die Klassen-ID sollte den Typ des eigentlichen Objekts als gespeichert darstellen, es sei denn, es handelt sich um eine Verknüpfung. In diesem Fall sollte es die CLSID des Elements sein, auf das sich der Link bezieht. Der [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) stellt automatisch die richtige Klassen-ID für das Element bereit.

*clsidNeu*<br/>
Ein Verweis auf die Zielklassen-ID.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Dies wird automatisch von [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert)aufgerufen. Es wird in der Regel nicht direkt aufgerufen.

## <a name="coleclientitemattachdataobject"></a><a name="attachdataobject"></a>COleClientItem::AttachDataObject

Rufen Sie diese Funktion auf, um ein [COleDataObject](../../mfc/reference/coledataobject-class.md) für den Zugriff auf die Daten im OLE-Element zu initialisieren.

```cpp
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parameter

*rDataObject*<br/>
Verweis auf `COleDataObject` ein Objekt, das initialisiert wird, um den Zugriff auf die Daten im OLE-Element zu ermöglichen.

## <a name="coleclientitemcanactivate"></a><a name="canactivate"></a>COleClientItem::CanActivate

Wird vom Framework aufgerufen, wenn der Benutzer eine ortsspezifische Aktivierung des OLE-Elements anfordert; Der Rückgabewert dieser Funktion bestimmt, ob die an Ort und Stelle aktiviert werden darf.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn eine an Ort und Stelle aktiviert werden darf; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Die Standardimplementierung ermöglicht die ortsbezogene Aktivierung, wenn der Container über ein gültiges Fenster verfügt. Überschreiben Sie diese Funktion, um eine spezielle Logik zum Akzeptieren oder Ablehnen der Aktivierungsanforderung zu implementieren. Beispielsweise kann eine Aktivierungsanforderung abgelehnt werden, wenn das OLE-Element zu klein oder derzeit nicht sichtbar ist.

Weitere Informationen finden Sie unter [IOleInPlaceSite::CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) im Windows SDK.

## <a name="coleclientitemcancreatefromdata"></a><a name="cancreatefromdata"></a>COleClientItem::CanCreateFromData

Überprüft, ob eine Containeranwendung ein eingebettetes Objekt aus dem angegebenen `COleDataObject` Objekt erstellen kann.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parameter

*pDataObject*<br/>
Zeiger auf das [COleDataObject-Objekt,](../../mfc/reference/coledataobject-class.md) aus dem das OLE-Element erstellt werden soll.

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn `COleDataObject` der Container ein eingebettetes Objekt aus dem Objekt erstellen kann; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Die `COleDataObject` Klasse wird bei Datenübertragungen zum Abrufen von Daten in verschiedenen Formaten aus der Zwischenablage, per Drag & Drop oder aus einem eingebetteten OLE-Element verwendet.

Container können diese Funktion verwenden, um ihre Befehle Zum Einfügen bearbeiten und Einfügen deaktivieren zu deaktivieren.

Weitere Informationen finden Sie im Artikel [Datenobjekte und Datenquellen (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcancreatelinkfromdata"></a><a name="cancreatelinkfromdata"></a>COleClientItem::CanCreateLinkFromData

Überprüft, ob eine Containeranwendung ein verknüpftes Objekt aus dem angegebenen `COleDataObject` Objekt erstellen kann.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parameter

*pDataObject*<br/>
Zeiger auf das [COleDataObject-Objekt,](../../mfc/reference/coledataobject-class.md) aus dem das OLE-Element erstellt werden soll.

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn `COleDataObject` der Container ein verknüpftes Objekt aus dem Objekt erstellen kann.

### <a name="remarks"></a>Bemerkungen

Die `COleDataObject` Klasse wird bei Datenübertragungen zum Abrufen von Daten in verschiedenen Formaten aus der Zwischenablage, per Drag & Drop oder aus einem eingebetteten OLE-Element verwendet.

Container können diese Funktion verwenden, um ihre Befehle Zum Einfügen spezial bearbeiten und Einfügen verknüpfung bearbeiten zu deaktivieren.

Weitere Informationen finden Sie im Artikel [Datenobjekte und Datenquellen (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcanpaste"></a><a name="canpaste"></a>COleClientItem::CanPaste

Rufen Sie diese Funktion auf, um zu sehen, ob ein eingebettetes OLE-Element aus der Zwischenablage eingefügt werden kann.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn ein eingebettetes OLE-Element aus der Zwischenablage eingefügt werden kann. andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Weitere Informationen finden Sie unter [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) und [OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) im Windows SDK.

## <a name="coleclientitemcanpastelink"></a><a name="canpastelink"></a>COleClientItem::CanPasteLink

Rufen Sie diese Funktion auf, um zu sehen, ob ein verknüpftes OLE-Element aus der Zwischenablage eingefügt werden kann.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn ein verknüpftes OLE-Element aus der Zwischenablage eingefügt werden kann; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Weitere Informationen finden Sie unter [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) und [OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) im Windows SDK.

## <a name="coleclientitemclose"></a><a name="close"></a>COleClientItem::Schließen

Rufen Sie diese Funktion auf, um den Status eines OLE-Elements vom ausgeführten Zustand in den geladenen Zustand zu ändern, d. h. mit dem Handler im Arbeitsspeicher geladen, aber mit dem Server, der nicht ausgeführt wird.

```cpp
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parameter

*dwCloseOption*<br/>
Flag, das angibt, unter welchen Umständen das OLE-Element gespeichert wird, wenn es in den geladenen Zustand zurückkehrt. Die Variable muss einen der folgenden Werte aufweisen:

- OLECLOSE_SAVEIFDIRTY Speichern Des OLE-Elements.

- OLECLOSE_NOSAVE Speichern Sie das OLE-Element nicht.

- OLECLOSE_PROMPTSAVE Den Benutzer aufzufordern, das OLE-Element zu speichern.

### <a name="remarks"></a>Bemerkungen

Diese Funktion hat keine Auswirkungen, wenn das OLE-Element nicht ausgeführt wird.

Weitere Informationen finden Sie unter [IOleObject::Schließen](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) im Windows SDK.

## <a name="coleclientitemcoleclientitem"></a><a name="coleclientitem"></a>COleClientItem::COleClientItem

Erstellt ein `COleClientItem` Objekt und fügt es der Auflistung von Dokumentelementen des Containerdokuments hinzu, das nur das C++-Objekt erstellt und keine OLE-Initialisierung durchführt.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parameter

*pContainerDoc*<br/>
Zeigen Sie mit dem Zeiger auf das Containerdokument, das dieses Element enthält. Dies kann eine beliebige [COleDocument-Ableitung](../../mfc/reference/coledocument-class.md) sein.

### <a name="remarks"></a>Bemerkungen

Wenn Sie einen NULL-Zeiger übergeben, wird dem Containerdokument kein Hinzufügen vorgenommen. Sie müssen [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem)explizit aufrufen.

Sie müssen eine der folgenden Erstellungsmemberfunktionen aufrufen, bevor Sie das OLE-Element verwenden:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [Createfromfile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

## <a name="coleclientitemconvertto"></a><a name="convertto"></a>COleClientItem::Convertto

Rufen Sie diese Memberfunktion auf, um das Element in den von *clsidNew*angegebenen Typ zu konvertieren.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parameter

*clsidNeu*<br/>
Die Klassen-ID des Zieltyps.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Dies wird automatisch von [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)aufgerufen. Es ist nicht notwendig, es direkt anzurufen.

## <a name="coleclientitemcopytoclipboard"></a><a name="copytoclipboard"></a>COleClientItem::CopyToClipboard

Rufen Sie diese Funktion auf, um das OLE-Element in die Zwischenablage zu kopieren.

```cpp
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parameter

*bIncludeLink*<br/>
TRUE, wenn Verknüpfungsinformationen in die Zwischenablage kopiert werden sollen, sodass ein verknüpftes Element eingefügt werden kann. andernfalls FALSE.

### <a name="remarks"></a>Bemerkungen

In der Regel rufen Sie diese Funktion auf, wenn Sie Nachrichtenhandler für die Befehle Kopieren oder Ausschneiden aus dem Menü Bearbeiten schreiben. Sie müssen die Elementauswahl in Ihrer Containeranwendung implementieren, wenn Sie die Befehle Kopieren oder Ausschneiden implementieren möchten.

Weitere Informationen finden Sie unter [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) im Windows SDK.

## <a name="coleclientitemcreateclonefrom"></a><a name="createclonefrom"></a>COleClientItem::CreateCloneFrom

Rufen Sie diese Funktion auf, um eine Kopie des angegebenen OLE-Elements zu erstellen.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parameter

*pSrcItem*<br/>
Zeigen Sie auf das zu duplizierende OLE-Element.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Die Kopie ist identisch mit dem Quellelement. Sie können diese Funktion verwenden, um Rückgängig-Vorgänge zu unterstützen.

## <a name="coleclientitemcreatefromclipboard"></a><a name="createfromclipboard"></a>COleClientItem::CreateFromClipboard

Rufen Sie diese Funktion auf, um ein eingebettetes Element aus dem Inhalt der Zwischenablage zu erstellen.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*erbringen*<br/>
Flag, das angibt, wie der Server das OLE-Element rendert. Informationen zu den möglichen Werten finden Sie unter [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) im Windows SDK.

*cfFormat*<br/>
Gibt das Datenformat der Zwischenablage an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC-Struktur,](/windows/win32/api/objidl/ns-objidl-formatetc) die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW wird. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatinformationen angeben möchten, die über das von *cfFormat*angegebene Zwischenablageformat hinausgehen. Wenn Sie diesen Parameter weglassen, werden Standardwerte `FORMATETC` für die anderen Felder in der Struktur verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Normalerweise rufen Sie diese Funktion über den Nachrichtenhandler für den Befehl Einfügen im Menü Bearbeiten auf. (Der Befehl Einfügen wird durch das Framework aktiviert, wenn die [CanPaste-Memberfunktion](#canpaste) einen Wert ungleich Null zurückgibt.)

Weitere Informationen finden Sie unter [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) im Windows SDK.

## <a name="coleclientitemcreatefromdata"></a><a name="createfromdata"></a>COleClientItem::CreateFromData

Rufen Sie diese Funktion auf, `COleDataObject` um ein eingebettetes Element aus einem Objekt zu erstellen.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*pDataObject*<br/>
Zeiger auf das [COleDataObject-Objekt,](../../mfc/reference/coledataobject-class.md) aus dem das OLE-Element erstellt werden soll.

*erbringen*<br/>
Flag, das angibt, wie der Server das OLE-Element rendert. Informationen zu den möglichen Werten finden Sie unter [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) im Windows SDK.

*cfFormat*<br/>
Gibt das Datenformat der Zwischenablage an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC-Struktur,](/windows/win32/api/objidl/ns-objidl-formatetc) die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW wird. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatinformationen angeben möchten, die über das von *cfFormat*angegebene Zwischenablageformat hinausgehen. Wenn Sie diesen Parameter weglassen, werden Standardwerte `FORMATETC` für die anderen Felder in der Struktur verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Datenübertragungsvorgänge, z. B. das Einfügen aus der Zwischenablage oder Drag-and-Drop-Vorgänge, stellen `COleDataObject` Objekte bereit, die die von einer Serveranwendung angebotenen Informationen enthalten. Es wird in der Regel in Ihrer Außerkraftsetzung von [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop)verwendet.

Weitere Informationen finden Sie unter [OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) im Windows SDK.

## <a name="coleclientitemcreatefromfile"></a><a name="createfromfile"></a>COleClientItem::CreateFromFile

Rufen Sie diese Funktion auf, um ein eingebettetes OLE-Element aus einer Datei zu erstellen.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*lpszFileName*<br/>
Zeiger auf den Namen der Datei, aus der das OLE-Element erstellt werden soll.

*clsid*<br/>
Für die zukünftige Verwendung reserviert.

*erbringen*<br/>
Flag, das angibt, wie der Server das OLE-Element rendert. Informationen zu den möglichen Werten finden Sie unter [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) im Windows SDK.

*cfFormat*<br/>
Gibt das Datenformat der Zwischenablage an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC-Struktur,](/windows/win32/api/objidl/ns-objidl-formatetc) die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW wird. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatinformationen angeben möchten, die über das von *cfFormat*angegebene Zwischenablageformat hinausgehen. Wenn Sie diesen Parameter weglassen, werden Standardwerte `FORMATETC` für die anderen Felder in der Struktur verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Das Framework ruft diese Funktion aus [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) auf, wenn der Benutzer im Dialogfeld Objekt einfügen ok auswählt, wenn die Schaltfläche Aus Datei erstellen ausgewählt ist.

Weitere Informationen finden Sie unter [OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) im Windows SDK.

## <a name="coleclientitemcreatelinkfromclipboard"></a><a name="createlinkfromclipboard"></a>COleClientItem::CreateLinkFromClipboard

Rufen Sie diese Funktion auf, um ein verknüpftes Element aus dem Inhalt der Zwischenablage zu erstellen.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*erbringen*<br/>
Flag, das angibt, wie der Server das OLE-Element rendert. Informationen zu den möglichen Werten finden Sie unter [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) im Windows SDK.

*cfFormat*<br/>
Gibt das Datenformat der Zwischenablage an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC-Struktur,](/windows/win32/api/objidl/ns-objidl-formatetc) die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW wird. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatinformationen angeben möchten, die über das von *cfFormat*angegebene Zwischenablageformat hinausgehen. Wenn Sie diesen Parameter weglassen, werden Standardwerte `FORMATETC` für die anderen Felder in der Struktur verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Normalerweise rufen Sie diese Funktion über den Nachrichtenhandler für den Befehl Verknüpfung einfügen im Menü Bearbeiten auf. (Der Befehl Verknüpfung einfügen ist in der Standardimplementierung von [COleDocument](../../mfc/reference/coledocument-class.md) aktiviert, wenn die Zwischenablage ein OLE-Element enthält, mit dem verknüpft werden kann.)

Weitere Informationen finden Sie unter [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) im Windows SDK.

## <a name="coleclientitemcreatelinkfromdata"></a><a name="createlinkfromdata"></a>COleClientItem::CreateLinkFromData

Rufen Sie diese Funktion auf, `COleDataObject` um ein verknüpftes Element aus einem Objekt zu erstellen.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*pDataObject*<br/>
Zeiger auf das [COleDataObject-Objekt,](../../mfc/reference/coledataobject-class.md) aus dem das OLE-Element erstellt werden soll.

*erbringen*<br/>
Flag, das angibt, wie der Server das OLE-Element rendert. Informationen zu den möglichen Werten finden Sie unter [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) im Windows SDK.

*cfFormat*<br/>
Gibt das Datenformat der Zwischenablage an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC-Struktur,](/windows/win32/api/objidl/ns-objidl-formatetc) die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW wird. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatinformationen angeben möchten, die über das von *cfFormat*angegebene Zwischenablageformat hinausgehen. Wenn Sie diesen Parameter weglassen, werden Standardwerte `FORMATETC` für die anderen Felder in der Struktur verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Rufen Sie dies während eines Ablagevorgangs auf, wenn der Benutzer angibt, dass eine Verknüpfung erstellt werden soll. Es kann auch verwendet werden, um den Befehl Einfügen bearbeiten zu behandeln. Es wird vom Framework `COleClientItem::CreateLinkFromClipboard` in und in [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) aufgerufen, wenn die Option Link ausgewählt wurde.

Weitere Informationen finden Sie unter [OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) im Windows SDK.

## <a name="coleclientitemcreatelinkfromfile"></a><a name="createlinkfromfile"></a>COleClientItem::CreateLinkFromFile

Rufen Sie diese Funktion auf, um ein verknüpftes OLE-Element aus einer Datei zu erstellen.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*lpszFileName*<br/>
Zeiger auf den Namen der Datei, aus der das OLE-Element erstellt werden soll.

*erbringen*<br/>
Flag, das angibt, wie der Server das OLE-Element rendert. Informationen zu den möglichen Werten finden Sie unter [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) im Windows SDK.

*cfFormat*<br/>
Gibt das Datenformat der Zwischenablage an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC-Struktur,](/windows/win32/api/objidl/ns-objidl-formatetc) die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW wird. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatinformationen angeben möchten, die über das von *cfFormat*angegebene Zwischenablageformat hinausgehen. Wenn Sie diesen Parameter weglassen, werden Standardwerte `FORMATETC` für die anderen Felder in der Struktur verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Das Framework ruft diese Funktion auf, wenn der Benutzer im Dialogfeld Objekt einfügen ok auswählt, wenn die Schaltfläche Aus Datei erstellen aktiviert ist und das Kontrollkästchen Verknüpfung aktiviert ist. Es wird von [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem)aufgerufen.

Weitere Informationen finden Sie unter OleCreateLinkToFile , OLERENDER und FORMATETC im Windows SDK.For more information, see [OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) in the Windows SDK.

## <a name="coleclientitemcreatenewitem"></a><a name="createnewitem"></a>COleClientItem::CreateNewItem

Rufen Sie diese Funktion auf, um ein eingebettetes Element zu erstellen. Mit dieser Funktion wird die Serveranwendung gestartet, mit der der Benutzer das OLE-Element erstellen kann.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*clsid*<br/>
ID, die den Typ des zu erstellenden OLE-Elements eindeutig identifiziert.

*erbringen*<br/>
Flag, das angibt, wie der Server das OLE-Element rendert. Informationen zu den möglichen Werten finden Sie unter [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) im Windows SDK.

*cfFormat*<br/>
Gibt das Datenformat der Zwischenablage an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC-Struktur,](/windows/win32/api/objidl/ns-objidl-formatetc) die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW wird. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatinformationen angeben möchten, die über das von *cfFormat*angegebene Zwischenablageformat hinausgehen. Wenn Sie diesen Parameter weglassen, werden Standardwerte `FORMATETC` für die anderen Felder in der Struktur verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Das Framework ruft diese Funktion auf, wenn der Benutzer im Dialogfeld Objekt einfügen OK auswählt, wenn die Schaltfläche Neu erstellen ausgewählt ist.

Weitere Informationen finden Sie unter [OleCreate](/windows/win32/api/ole/nf-ole-olecreate), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) im Windows SDK.

## <a name="coleclientitemcreatestaticfromclipboard"></a><a name="createstaticfromclipboard"></a>COleClientItem::CreateStaticFromClipboard

Rufen Sie diese Funktion auf, um ein statisches Element aus dem Inhalt der Zwischenablage zu erstellen.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*erbringen*<br/>
Flag, das angibt, wie der Server das OLE-Element rendert. Informationen zu den möglichen Werten finden Sie unter [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) im Windows SDK.

*cfFormat*<br/>
Gibt das Datenformat der Zwischenablage an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC-Struktur,](/windows/win32/api/objidl/ns-objidl-formatetc) die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW wird. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatinformationen angeben möchten, die über das von *cfFormat*angegebene Zwischenablageformat hinausgehen. Wenn Sie diesen Parameter weglassen, werden Standardwerte `FORMATETC` für die anderen Felder in der Struktur verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Ein statisches Element enthält die Präsentationsdaten, jedoch nicht die systemeigenen Daten. daher kann sie nicht bearbeitet werden. Normalerweise rufen Sie diese Funktion auf, wenn die [CreateFromClipboard-Memberfunktion](#createfromclipboard) fehlschlägt.

Weitere Informationen finden Sie unter [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) im Windows SDK.

## <a name="coleclientitemcreatestaticfromdata"></a><a name="createstaticfromdata"></a>COleClientItem::CreateStaticFromData

Rufen Sie diese Funktion auf, `COleDataObject` um ein statisches Element aus einem Objekt zu erstellen.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*pDataObject*<br/>
Zeiger auf das [COleDataObject-Objekt,](../../mfc/reference/coledataobject-class.md) aus dem das OLE-Element erstellt werden soll.

*erbringen*<br/>
Flag, das angibt, wie der Server das OLE-Element rendert. Informationen zu den möglichen Werten finden Sie unter [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) im Windows SDK.

*cfFormat*<br/>
Gibt das Datenformat der Zwischenablage an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC-Struktur,](/windows/win32/api/objidl/ns-objidl-formatetc) die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW wird. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatinformationen angeben möchten, die über das von *cfFormat*angegebene Zwischenablageformat hinausgehen. Wenn Sie diesen Parameter weglassen, werden Standardwerte `FORMATETC` für die anderen Felder in der Struktur verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Ein statisches Element enthält die Präsentationsdaten, jedoch nicht die systemeigenen Daten. folglich kann sie nicht bearbeitet werden. Dies ist im Wesentlichen dasselbe wie [CreateStaticFromClipboard,](#createstaticfromclipboard) mit `COleDataObject`der Ausnahme, dass ein statisches Element aus einem beliebigen, nicht nur aus der Zwischenablage erstellt werden kann.

Wird in [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) verwendet, wenn Static ausgewählt ist.

Weitere Informationen finden Sie unter OleCreateStaticFromData , OLERENDER und FORMATETC im Windows SDK.For more information, see [OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) in the Windows SDK.

## <a name="coleclientitemdeactivate"></a><a name="deactivate"></a>COleClientItem::Deactivate

Rufen Sie diese Funktion auf, um das OLE-Element zu deaktivieren und alle zugeordneten Ressourcen freizugeben.

```cpp
void Deactivate();
```

### <a name="remarks"></a>Bemerkungen

In der Regel deaktivieren Sie ein direkt esbliches aktives OLE-Element, wenn der Benutzer mit der Maus auf den Clientbereich außerhalb der Grenzen des Elements klickt. Beachten Sie, dass durch das Deaktivieren des OLE-Elements der Rückgängig-Zustand verworfen wird, sodass die [Mitgliedsfunktion ReactivateAndUndo](#reactivateandundo) nicht mehr aufzurufen ist.

Wenn Ihre Anwendung Rückgängig machen `Deactivate`unterstützt, rufen Sie nicht auf; Rufen Sie stattdessen [DeactivateUI](#deactivateui)auf.

Weitere Informationen finden Sie unter [IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) im Windows SDK.

## <a name="coleclientitemdeactivateui"></a><a name="deactivateui"></a>COleClientItem::DeactivateUI

Rufen Sie diese Funktion auf, wenn der Benutzer ein Element deaktiviert, das an Ort und Stelle aktiviert wurde.

```cpp
void DeactivateUI();
```

### <a name="remarks"></a>Bemerkungen

Diese Funktion stellt die Benutzeroberfläche der Containeranwendung in ihren ursprünglichen Zustand zurück und blendt alle Menüs und andere Steuerelemente aus, die für die aktive Aktivierung an Ort und Stelle erstellt wurden.

Diese Funktion löscht die Rückgängig-Statusinformationen für das Element nicht. Diese Informationen werden beibehalten, sodass [ReactivateAndUndo](#reactivateandundo) später verwendet werden kann, um einen Rückgängig-Befehl in der Serveranwendung auszuführen, falls der Befehl Rückgängig des Containers unmittelbar nach dem Deaktivieren des Elements ausgewählt wird.

Weitere Informationen finden Sie unter [IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) im Windows SDK.

## <a name="coleclientitemdelete"></a><a name="delete"></a>COleClientItem::Delete

Rufen Sie diese Funktion auf, um das OLE-Element aus dem Containerdokument zu löschen.

```cpp
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parameter

*bAutoDelete*<br/>
Gibt an, ob das Element aus dem Dokument entfernt werden soll.

### <a name="remarks"></a>Bemerkungen

Diese Funktion ruft die Release-Memberfunktion [auf,](#release) die wiederum das C++-Objekt für das Element löscht und das OLE-Element dauerhaft aus dem Dokument entfernt. Wenn das OLE-Element eingebettet ist, werden die systemeigenen Daten für das Element gelöscht. Es schließt immer einen laufenden Server; Wenn es sich bei dem Element um eine offene Verknüpfung handelt, wird es daher von dieser Funktion geschlossen.

## <a name="coleclientitemdodragdrop"></a><a name="dodragdrop"></a>COleClientItem::DoDragDrop

Rufen `DoDragDrop` Sie die Memberfunktion auf, um einen Drag-and-Drop-Vorgang auszuführen.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parameter

*lpItemRect*<br/>
Das Rechteck des Elements auf dem Bildschirm in Clientkoordinaten (Pixel).

*ptOffset*<br/>
Der Offset von *lpItemRect,* an dem sich die Mausposition zum Zeitpunkt des Ziehens befand.

*bIncludeLink*<br/>
Legen Sie diesen Wert auf TRUE fest, wenn die Verknüpfungsdaten in die Zwischenablage kopiert werden sollen. Legen Sie sie auf FALSE fest, wenn Ihre Serveranwendung keine Links unterstützt.

*dwEffects*<br/>
Bestimmt die Effekte, die die Ziehquelle im Ziehvorgang zulässt.

*lpRectStartDrag*<br/>
Zeigen Sie mit dem Zeiger auf das Rechteck, das definiert, wo der Ziehvorgang tatsächlich beginnt. Weitere Informationen finden Sie im folgenden Abschnitt "Hinweise".

### <a name="return-value"></a>Rückgabewert

Ein DROPEFFECT-Wert. Wenn es sich um DROPEFFECT_MOVE, sollten die ursprünglichen Daten entfernt werden.

### <a name="remarks"></a>Bemerkungen

Der Drag-and-Drop-Vorgang wird nicht sofort gestartet. Es wartet, bis der Mauszeiger das von *lpRectStartDrag* angegebene Rechteck verlässt oder bis eine angegebene Anzahl von Millisekunden vergangen ist. Wenn *lpRectStartDrag* NULL ist, beträgt die Größe des Rechtecks ein Pixel.

Die Verzögerungszeit wird durch eine Registrierungsschlüsseleinstellung angegeben. Sie können die Verzögerungszeit ändern, indem Sie [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) oder [CWinApp::WriteProfileInt aufrufen.](../../mfc/reference/cwinapp-class.md#writeprofileint) Wenn Sie die Verzögerungszeit nicht angeben, wird ein Standardwert von 200 Millisekunden verwendet. Die Verzögerungszeit des Ziehvorgangs wird wie folgt gespeichert:

- Die Verzögerungszeit für den Windows NT-Drag-Verzögerungszeit wird in HKEY_LOCAL_MACHINE-SOFTWARE-Microsoft-Windows-,NT-Nt-CurrentVersion-IniFileMapping-Win.ini-Windows-DragDelay gespeichert.

- Windows 3.x Drag Delay Time wird in der WIN gespeichert. INI-Datei unter dem Abschnitt [Windows".

- Windows 95/98 Drag Delay Time wird in einer zwischengespeicherten Version von WIN gespeichert. Ini.

Weitere Informationen dazu, wie Drag Delay-Informationen in der Registrierung oder im gespeichert werden. INI-Datei, siehe [WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) im Windows SDK.

## <a name="coleclientitemdoverb"></a><a name="doverb"></a>COleClientItem::DoVerb

Rufen `DoVerb` Sie auf, um das angegebene Verb auszuführen.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parameter

*nVerb*<br/>
Gibt das auszuführende Verb an. Es kann eine der folgenden enthalten:

|Wert|Bedeutung|Symbol|
|-----------|-------------|------------|
|- 0|Primäres Verb|OLEIVERB_PRIMARY|
|- 1|Sekundäres Verb|(Keine)|
|- 1|Element zur Bearbeitung anzeigen|OLEIVERB_SHOW|
|- 2|Bearbeiten des Elements in einem separaten Fenster|OLEIVERB_OPEN|
|- 3|Ausblenden von Gegenständen|OLEIVERB_HIDE|

Der -1-Wert ist in der Regel ein Alias für ein anderes Verb. Wenn die offene Bearbeitung nicht unterstützt wird, hat -2 den gleichen Effekt wie -1. Weitere Werte finden Sie unter [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) im Windows SDK.

*Pview*<br/>
Zeiger auf das Ansichtsfenster; Dies wird vom Server für die ortsspezifische Aktivierung verwendet. Dieser Parameter sollte NULL sein, wenn die Containeranwendung keine ortsbezogene Aktivierung zulässt.

*lpMsg*<br/>
Zeigen Sie auf die Meldung, die dazu geführt hat, dass das Element aktiviert wurde.

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn das Verb erfolgreich ausgeführt wurde; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Diese Funktion ruft die [Memberfunktion Aktivieren](#activate) auf, um das Verb auszuführen. Außerdem werden Ausnahmen abgefangen und dem Benutzer ein Meldungsfeld angezeigt, wenn eines ausgelöst wird.

Wenn das primäre Verb Bearbeiten ist und Null im *nVerb-Parameter* angegeben ist, wird die Serveranwendung gestartet, damit das OLE-Element bearbeitet werden kann. Wenn die Containeranwendung die ortsspezifische Aktivierung unterstützt, kann die Bearbeitung durchgeführt werden. Wenn der Container keine ortsbezogene Aktivierung unterstützt (oder wenn das Verb Open angegeben ist), wird der Server in einem separaten Fenster gestartet, und die Bearbeitung kann dort durchgeführt werden. Wenn der Benutzer der Containeranwendung auf das OLE-Element doppelklickt, bestimmt der Wert für das primäre Verb im *NVerb-Parameter* in der Regel, welche Aktion der Benutzer ausführen kann. Wenn der Server jedoch nur eine Aktion unterstützt, wird diese Aktion ausgeführt, unabhängig davon, welcher Wert im *nVerb-Parameter* angegeben ist.

## <a name="coleclientitemdraw"></a><a name="draw"></a>COleClientItem::Draw

Rufen Sie diese Funktion auf, um das OLE-Element mithilfe des angegebenen Gerätekontexts in das angegebene Umkreisrechteck zu zeichnen.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Zeiger auf [CDC](../../mfc/reference/cdc-class.md) ein CDC-Objekt, das zum Zeichnen des OLE-Elements verwendet wird.

*lpBounds*<br/>
Zeiger auf ein CRect-Objekt oder `RECT` eine [CRect-Struktur,](../../atl-mfc-shared/reference/crect-class.md) das das umgebende Rechteck definiert, in dem das OLE-Element gezeichnet werden soll (in logischen Einheiten, die durch den Gerätekontext bestimmt werden).

*nDrawAspect*<br/>
Gibt den Aspekt des OLE-Elements an, d. h., wie es angezeigt werden soll. Wenn *nDrawAspect* -1 ist, wird der letzte Aspekt verwendet, der mit [SetDrawAspect](#setdrawaspect) festgelegt wurde. Weitere Informationen zu möglichen Werten für dieses Flag finden Sie unter [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Die Funktion kann die Metadateidarstellung des OLE-Elements verwenden, `COleServerItem`das von der [OnDraw-Memberfunktion](../../mfc/reference/coleserveritem-class.md#ondraw) von erstellt wurde.

In der `Draw` Regel verwenden Sie für die Bildschirmanzeige, übergeben den Bildschirmgerätekontext als *pDC*. In diesem Fall müssen Sie nur die ersten beiden Parameter angeben.

Der Parameter *lpBounds* identifiziert das Rechteck im Zielgerätekontext (relativ zum aktuellen Zuordnungsmodus). Das Rendern kann eine Skalierung des Bildes beinhalten und kann von Containeranwendungen verwendet werden, um eine Ansicht zu erzwingen, die zwischen der angezeigten Ansicht und dem endgültigen gedruckten Bild skaliert wird.

Weitere Informationen finden Sie unter [IViewObject::Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) im Windows SDK.

## <a name="coleclientitemgetactiveview"></a><a name="getactiveview"></a>COleClientItem::GetActiveView

Gibt die Ansicht zurück, für die das Element an Ort und Stelle aktiviert ist.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf die Ansicht; ANDERNFALLS NULL, wenn das Element nicht sofort aktiviert ist.

## <a name="coleclientitemgetcachedextent"></a><a name="getcachedextent"></a>COleClientItem::GetCachedExtent

Rufen Sie diese Funktion auf, um die Größe des OLE-Elements abzurufen.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parameter

*lpSize*<br/>
Zeiger auf `SIZE` eine Struktur oder ein [CSize-Objekt,](../../atl-mfc-shared/reference/csize-class.md) das die Größeninformationen empfängt.

*nDrawAspect*<br/>
Gibt den Aspekt des OLE-Elements an, dessen Grenzen abgerufen werden sollen. Mögliche Werte finden Sie unter [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich; 0, wenn das OLE-Element leer ist.

### <a name="remarks"></a>Bemerkungen

Diese Funktion stellt dieselben Informationen wie [GetExtent](#getextent)bereit. Sie können jedoch `GetCachedExtent` aufrufen, um Während der Verarbeitung anderer OLE-Handler, z. B. [OnChange](#onchange), Erweiterungsinformationen abzurufen. Die Bemaßungen befinden sich in MM_HIMETRIC Einheiten.

Dies ist `GetCachedExtent` möglich, weil die [IViewObject2-Schnittstelle](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) verwendet wird, anstatt die [IOleObject-Schnittstelle](/windows/win32/api/oleidl/nn-oleidl-ioleobject) zu verwenden, um die Ausdehnung dieses Elements abzubekommen. Das `IViewObject2` COM-Objekt speichert die Ausdehnungsinformationen zwischen, die beim vorherigen Aufruf von [IViewObject::Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw)verwendet wurden.

Weitere Informationen finden Sie unter [IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) im Windows SDK.

## <a name="coleclientitemgetclassid"></a><a name="getclassid"></a>COleClientItem::GetClassID

Gibt die Klassen-ID des Elements in den Speicher zurück, auf den *pClassID*zeigt.

```cpp
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parameter

*pClassID*<br/>
Zeiger auf einen Bezeichner vom Typ [CLSID,](/windows/win32/com/clsid-key-hklm) um die Klassen-ID abzurufen. Informationen zu CLSID finden Sie im Windows SDK.

### <a name="remarks"></a>Bemerkungen

Die Klassen-ID ist eine 128-Bit-Nummer, die die Anwendung, die das Element befolgt, eindeutig identifiziert.

Weitere Informationen finden Sie unter [IPersist::GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) im Windows SDK.

## <a name="coleclientitemgetclipboarddata"></a><a name="getclipboarddata"></a>COleClientItem::GetClipboardData

Rufen Sie diese `COleDataSource` Funktion auf, um ein Objekt abzurufen, das alle Daten enthält, die durch einen Aufruf der [CopyToClipboard-Memberfunktion](#copytoclipboard) in der Zwischenablage platziert würden.

```cpp
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parameter

*pDataSource*<br/>
Zeiger auf ein [COleDataSource-Objekt,](../../mfc/reference/coledatasource-class.md) das die im OLE-Element enthaltenen Daten empfängt.

*bIncludeLink*<br/>
TRUE, wenn Verknüpfungsdaten eingeschlossen werden sollen; andernfalls FALSE.

*lpOffset*<br/>
Der Versatz des Mauszeigers vom Ursprung des Objekts in Pixeln.

*lpSize*<br/>
Die Größe des Objekts in Pixel.

### <a name="remarks"></a>Bemerkungen

`GetClipboardData`wird als Standardimplementierung von [OnGetClipboardData](#ongetclipboarddata)aufgerufen. Überschreiben `OnGetClipboardData` Sie nur, wenn Sie datenformate `CopyToClipboard`zusätzlich zu den von angebotenen anbieten möchten. Platzieren Sie diese `COleDataSource` Formate vor `CopyToClipboard`oder nach `COleDataSource` dem Aufruf im Objekt, und übergeben Sie das Objekt dann an die [Funktion COleDataSource::SetClipboard.](../../mfc/reference/coledatasource-class.md#setclipboard) Wenn Sie z. B. möchten, dass die Position des OLE-Elements in seinem Containerdokument darin in der Zwischenablage liegt, definieren Sie ein eigenes Format für die Weitergabe dieser Informationen und platzieren es in der vor dem `COleDataSource` Aufruf `CopyToClipboard`.

## <a name="coleclientitemgetdocument"></a><a name="getdocument"></a>COleClientItem::GetDocument

Rufen Sie diese Funktion auf, um einen Zeiger auf das Dokument abzurufen, das das OLE-Element enthält.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf das Dokument, das das OLE-Element enthält. NULL, wenn das Element nicht Teil eines Dokuments ist.

### <a name="remarks"></a>Bemerkungen

Dieser Zeiger ermöglicht den `COleDocument` Zugriff auf das Objekt, `COleClientItem` das Sie als Argument an den Konstruktor übergeben haben.

## <a name="coleclientitemgetdrawaspect"></a><a name="getdrawaspect"></a>COleClientItem::GetDrawAspect

Rufen `GetDrawAspect` Sie die Memberfunktion auf, um den aktuellen "Aspekt" oder die Ansicht des Elements zu bestimmen.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Rückgabewert

Ein Wert aus der DVASPECT-Enumeration, dessen Werte in der Referenz für [SetDrawAspect](#setdrawaspect)aufgeführt sind.

### <a name="remarks"></a>Bemerkungen

Der Aspekt gibt an, wie das Element gerendert werden soll.

## <a name="coleclientitemgetextent"></a><a name="getextent"></a>COleClientItem::GetExtent

Rufen Sie diese Funktion auf, um die Größe des OLE-Elements abzurufen.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parameter

*lpSize*<br/>
Zeiger auf `SIZE` eine Struktur `CSize` oder ein Objekt, das die Größeninformationen empfängt.

*nDrawAspect*<br/>
Gibt den Aspekt des OLE-Elements an, dessen Grenzen abgerufen werden sollen. Mögliche Werte finden Sie unter [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich; 0, wenn das OLE-Element leer ist.

### <a name="remarks"></a>Bemerkungen

Wenn die Serveranwendung mit der Microsoft Foundation-Klassenbibliothek geschrieben wurde, bewirkt `COleServerItem` diese Funktion, dass die [OnGetExtent-Memberfunktion](../../mfc/reference/coleserveritem-class.md#ongetextent) des entsprechenden Objekts aufgerufen wird. Beachten Sie, dass die abgerufene Größe von der Größe abweichen kann, die zuletzt von der [SetExtent-Memberfunktion](#setextent) festgelegt wurde. die von `SetExtent` angegebene Größe wird als Vorschlag behandelt. Die Bemaßungen befinden sich in MM_HIMETRIC Einheiten.

> [!NOTE]
> Rufen Sie `GetExtent` während der Verarbeitung eines OLE-Handlers, z. B. [OnChange](#onchange), nicht auf. Rufen Sie stattdessen [GetCachedExtent](#getcachedextent) auf.

Weitere Informationen finden Sie unter [IOleObject::GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) im Windows SDK.

## <a name="coleclientitemgeticonfromregistry"></a><a name="geticonfromregistry"></a>COleClientItem::GetIconFromRegistry

Rufen Sie diese Memberfunktion auf, um ein Handle zu einer Symbolressource abzurufen, die dem Server einer bestimmten CLSID zugeordnet ist.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parameter

*clsid*<br/>
Ein Verweis auf die CLSID für den Server, der dem Symbol zugeordnet ist.

### <a name="return-value"></a>Rückgabewert

Ein gültiges Handle für die Symbolressource oder NULL, wenn das Symbol des Servers oder ein Standardsymbol nicht gefunden werden kann.

### <a name="remarks"></a>Bemerkungen

Diese Memberfunktion startet den Server nicht oder ruft ein Symbol dynamisch ab, auch wenn der Server bereits ausgeführt wird. Stattdessen öffnet diese Memberfunktion das ausführbare Abbild des Servers und ruft das statische Symbol ab, das dem Server bei der Registrierung zugeordnet ist.

## <a name="coleclientitemgeticonicmetafile"></a><a name="geticonicmetafile"></a>COleClientItem::GetIconicMetafile

Ruft die Metadatei ab, die zum Zeichnen des Elementsymbols verwendet wird.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Rückgabewert

Ein Handle für die Metadatei, wenn erfolgreich; andernfalls NULL.

### <a name="remarks"></a>Bemerkungen

Wenn kein aktuelles Symbol vorhanden ist, wird ein Standardsymbol zurückgegeben. Dies wird automatisch von den MFC/OLE-Dialogen aufgerufen und wird in der Regel nicht direkt aufgerufen.

Diese Funktion ruft auch [SetIconicMetafile](#seticonicmetafile) auf, um die Metadatei für die spätere Verwendung zwischenzuspeichern.

## <a name="coleclientitemgetinplacewindow"></a><a name="getinplacewindow"></a>COleClientItem::GetInPlaceWindow

Rufen `GetInPlaceWindow` Sie die Memberfunktion auf, um einen Zeiger auf das Fenster zu erhalten, in dem das Element für die ortsnahe Bearbeitung geöffnet wurde.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf das ortsnahe Bearbeitungsfenster des Elements; NULL, wenn das Element nicht aktiv ist oder sein Server nicht verfügbar ist.

### <a name="remarks"></a>Bemerkungen

Diese Funktion sollte nur für Elemente aufgerufen werden, die aktiv sind.

## <a name="coleclientitemgetitemstate"></a><a name="getitemstate"></a>COleClientItem::GetItemState

Rufen Sie diese Funktion auf, um den aktuellen Status des OLE-Elements abzurufen.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Rückgabewert

Ein `COleClientItem::ItemState` aufgezählter Wert, der einer der `emptyState`folgenden `loadedState` `openState`Werte `activeState` `activeUIState`sein kann: , , , , . Weitere Informationen zu diesen Zuständen finden Sie im Artikel [Container: Client-Item States](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Bemerkungen

Um benachrichtigt zu werden, wenn sich der [OnChange](#onchange) Status des OLE-Elements ändert, verwenden Sie die OnChange-Memberfunktion.

Weitere Informationen finden Sie im Artikel [Container: Client-Item States](../../mfc/containers-client-item-states.md).

## <a name="coleclientitemgetlaststatus"></a><a name="getlaststatus"></a>COleClientItem::GetLastStatus

Gibt den Statuscode des letzten OLE-Vorgangs zurück.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Rückgabewert

Ein SCODE-Wert.

### <a name="remarks"></a>Bemerkungen

Für Memberfunktionen, die einen BOOL-Wert von FALSE zurückgeben, oder andere Memberfunktionen, die NULL zurückgeben, `GetLastStatus` gibt detailliertere Fehlerinformationen zurück. Beachten Sie, dass die meisten OLE-Memberfunktionen Ausnahmen für schwerwiegendere Fehler auslösen. Die spezifischen Informationen zur Interpretation des SCODE hängen vom zugrunde liegenden OLE-Aufruf ab, der zuletzt einen SCODE-Wert zurückgegeben hat.

Weitere Informationen zu SCODE finden Sie unter [Struktur von COM-Fehlercodes](/windows/win32/com/structure-of-com-error-codes) in der Windows SDK-Dokumentation.

## <a name="coleclientitemgetlinkupdateoptions"></a><a name="getlinkupdateoptions"></a>COleClientItem::GetLinkUpdateOptions

Rufen Sie diese Funktion auf, um den aktuellen Wert der Link-Update-Option für das OLE-Element abzurufen.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Rückgabewert

Einer der folgenden Werte:

- OLEUPDATE_ALWAYS das verknüpfte Element nach Möglichkeit aktualisieren. Diese Option unterstützt das Optionsfeld Automatische Link-Update im Dialogfeld Links.

- OLEUPDATE_ONCALL das verknüpfte Element nur auf Anforderung der Containeranwendung aktualisieren (wenn die [UpdateLink-Memberfunktion](#updatelink) aufgerufen wird). Diese Option unterstützt das Manual link-update-Optionsfeld im Dialogfeld Links.

### <a name="remarks"></a>Bemerkungen

Dies ist eine erweiterte Operation.

Diese Funktion wird automatisch von der [COleLinksDialog-Klasse](../../mfc/reference/colelinksdialog-class.md) aufgerufen.

Weitere Informationen finden Sie unter [IOleLink::GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) im Windows SDK.

## <a name="coleclientitemgettype"></a><a name="gettype"></a>COleClientItem::GetType

Rufen Sie diese Funktion auf, um zu bestimmen, ob das OLE-Element eingebettet oder verknüpft oder statisch ist.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Rückgabewert

Eine ganzzahlige Nicht-Zeichen-Zahl mit einem der folgenden Werte:

- OT_LINK Das OLE-Element ist ein Link.

- OT_EMBEDDED Das OLE-Element ist eingebettet.

- OT_STATIC Das OLE-Element ist statisch, d. h. es enthält nur Präsentationsdaten, keine systemeigenen Daten und kann daher nicht bearbeitet werden.

## <a name="coleclientitemgetusertype"></a><a name="getusertype"></a>COleClientItem::GetUserType

Rufen Sie diese Funktion auf, um die vom Benutzer sichtbare Zeichenfolge abzurufen, die den Typ des OLE-Elements beschreibt, z. B. "Word-Dokument".

```cpp
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parameter

*nUserClassType*<br/>
Ein Wert, der die gewünschte Variante der Zeichenfolge angibt, die den Typ des OLE-Elements beschreibt. Dies kann einen der folgenden Werte haben:

- USERCLASSTYPE_FULL Der vollständige Typname, der dem Benutzer angezeigt wird.

- USERCLASSTYPE_SHORT Ein kurzleistoscher Name (maximal 15 Zeichen) für die Verwendung in Popupmenüs und im Dialogfeld Links bearbeiten.

- USERCLASSTYPE_APPNAME Name der Anwendung, die die Klasse bedient.

*rString*<br/>
Ein Verweis auf ein [CString-Objekt,](../../atl-mfc-shared/reference/cstringt-class.md) an das die Zeichenfolge, die den Typ des OLE-Elements beschreibt, zurückgegeben werden soll.

### <a name="remarks"></a>Bemerkungen

Dies ist häufig der Eintrag in der Systemregistrierungsdatenbank.

Wenn der vollständige Typname angefordert, aber nicht verfügbar ist, wird stattdessen der Kurzname verwendet. Wenn in der Registrierungsdatenbank kein Eintrag für den Typ des OLE-Elements gefunden wird oder keine Benutzertypen für den Typ des OLE-Elements registriert sind, wird der derzeit im OLE-Element gespeicherte Benutzertyp verwendet. Wenn dieser Benutzertypname eine leere Zeichenfolge ist, wird "Unknown Object" verwendet.

Weitere Informationen finden Sie unter [IOleObject::GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) im Windows SDK.

## <a name="coleclientitemisinplaceactive"></a><a name="isinplaceactive"></a>COleClientItem::IsInPlaceActive

Rufen Sie diese Funktion auf, um zu sehen, ob das OLE-Element aktiv ist.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn das OLE-Element aktiv ist; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Es ist üblich, unterschiedliche Logik auszuführen, je nachdem, ob das Element an Ort und Stelle bearbeitet wird. Die Funktion prüft, ob der aktuelle `activeState` Elementstatus `activeUIState`entweder dem oder dem entspricht.

## <a name="coleclientitemislinkuptodate"></a><a name="islinkuptodate"></a>COleClientItem::IsLinkUptoDate

Rufen Sie diese Funktion auf, um festzustellen, ob das OLE-Element auf dem neuesten Stand ist.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn das OLE-Element auf dem neuesten Stand ist; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Ein verknüpftes Element kann veraltet sein, wenn das Quelldokument aktualisiert wurde. Ein eingebettetes Element, das Verknüpfungen darin enthält, kann ebenfalls veraltet sein. Die Funktion führt eine rekursive Überprüfung des OLE-Elements durch. Beachten Sie, dass das Bestimmen, ob ein OLE-Element veraltet ist, genauso teuer sein kann wie die Durchführung einer Aktualisierung.

Dies wird automatisch von der [COleLinksDialog-Implementierung](../../mfc/reference/colelinksdialog-class.md) aufgerufen.

Weitere Informationen finden Sie unter [IOleObject::IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) im Windows SDK.

## <a name="coleclientitemismodified"></a><a name="ismodified"></a>COleClientItem::IsModified

Rufen Sie diese Funktion auf, um zu sehen, ob das OLE-Element verschmutzt ist (geändert seit dem letzten Speichern).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn das OLE-Element verschmutzt ist; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Weitere Informationen finden Sie unter [IPersistStorage::IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) im Windows SDK.

## <a name="coleclientitemisopen"></a><a name="isopen"></a>COleClientItem::IsOpen

Rufen Sie diese Funktion auf, um zu sehen, ob das OLE-Element geöffnet ist. d. h. in einer Instanz der Serveranwendung geöffnet, die in einem separaten Fenster ausgeführt wird.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn das OLE-Element geöffnet ist; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Es wird verwendet, um zu bestimmen, wann das Objekt mit einem Schraffurmuster gezeichnet werden soll. Ein offenes Objekt sollte ein Schraffurmuster über dem Objekt zeichnen. Sie können dazu ein [CRectTracker-Objekt](../../mfc/reference/crecttracker-class.md) verwenden.

## <a name="coleclientitemisrunning"></a><a name="isrunning"></a>COleClientItem::IsRunning

Rufen Sie diese Funktion auf, um zu sehen, ob das OLE-Element ausgeführt wird. , ob das Element in der Serveranwendung geladen und ausgeführt wird.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn das OLE-Element ausgeführt wird; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Weitere Informationen finden Sie unter [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) im Windows SDK.

## <a name="coleclientitemonactivate"></a><a name="onactivate"></a>COleClientItem::OnActivate

Wird vom Framework aufgerufen, um das Element zu benachrichtigen, dass es gerade aktiviert wurde.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Bemerkungen

Beachten Sie, dass diese Funktion aufgerufen wird, um anzuzeigen, dass der Server ausgeführt wird, und nicht, um anzugeben, dass seine Benutzeroberfläche in der Containeranwendung installiert wurde. Zu diesem Zeitpunkt verfügt das Objekt nicht über `activeUIState`eine aktive Benutzeroberfläche (ist nicht ). Es hat seine Menüs oder Symbolleiste nicht installiert. Die [OnActivateUI-Memberfunktion](#onactivateui) wird aufgerufen, wenn dies geschieht.

Die Standardimplementierung ruft die [OnChange-Memberfunktion](#onchange) mit OLE_CHANGEDSTATE als Parameter auf. Überschreiben Sie diese Funktion, um eine benutzerdefinierte Verarbeitung durchzuführen, wenn ein Element an Ort und Stelle aktiv wird.

## <a name="coleclientitemonactivateui"></a><a name="onactivateui"></a>COleClientItem::OnActivateUI

Das Framework `OnActivateUI` ruft auf, wenn das Objekt in den status der aktiven Benutzeroberfläche eingegeben wurde.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Bemerkungen

Das Objekt hat nun seine Werkzeugleiste und Menüs installiert.

Die Standardimplementierung merkt sich die HWND des Servers für spätere `GetServerWindow` Aufrufe.

## <a name="coleclientitemonchange"></a><a name="onchange"></a>COleClientItem::OnChange

Wird vom Framework aufgerufen, wenn der Benutzer das OLE-Element ändert, speichert oder schließt.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parameter

*nCode*<br/>
Der Grund, warum der Server dieses Element geändert hat. Die Variable muss einen der folgenden Werte aufweisen:

- OLE_CHANGED Das Erscheinungsbild des OLE-Elements hat sich geändert.

- OLE_SAVED Das OLE-Element wurde gespeichert.

- OLE_CLOSED Das OLE-Element wurde geschlossen.

- OLE_CHANGED_STATE Das OLE-Element wurde von einem Zustand in einen anderen geändert.

*dwParam*<br/>
Wenn *nCode* OLE_SAVED oder OLE_CLOSED ist, wird dieser Parameter nicht verwendet. Wenn *nCode* OLE_CHANGED ist, gibt dieser Parameter den Aspekt des OLE-Elements an, das geändert wurde. Mögliche Werte finden Sie im *dwParam-Parameter* von [COleClientItem::Draw](#draw). Wenn *nCode* OLE_CHANGED_STATE ist, `COleClientItem::ItemState` ist dieser Parameter ein aufgezählter Wert und beschreibt den eingegebenen Status. Es kann einen der folgenden `emptyState` `loadedState`Werte `openState` `activeState`haben: `activeUIState`, , , , oder .

### <a name="remarks"></a>Bemerkungen

(Wenn die Serveranwendung mit der Microsoft Foundation-Klassenbibliothek geschrieben wird, wird diese Funktion als Reaktion auf die `Notify` Memberfunktionen von `COleServerDoc` oder `COleServerItem`aufgerufen.) Die Standardimplementierung kennzeichnet das Containerdokument als geändert, wenn *nCode* OLE_CHANGED oder OLE_SAVED ist.

Für OLE_CHANGED_STATE ist der aktuelle Status, der von [GetItemState](#getitemstate) zurückgegeben wird, immer noch der alte Status, d. h. der Zustand, der vor dieser Statusänderung aktuell war.

Überschreiben Sie diese Funktion, um auf Änderungen im Zustand des OLE-Elements zu reagieren. In der Regel aktualisieren Sie die Darstellung des Elements, indem Sie den Bereich, in dem das Element angezeigt wird, ungültig machen. Rufen Sie die Basisklassenimplementierung zu Beginn der Außerkraftsetzung auf.

## <a name="coleclientitemonchangeitemposition"></a><a name="onchangeitemposition"></a>COleClientItem::OnChangeItemPosition

Wird vom Framework aufgerufen, um den Container darüber zu informieren, dass sich die Ausdehnung des OLE-Elements während der Ortsaktivierung geändert hat.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parameter

*rectPos*<br/>
Gibt die Position des Elements relativ zum Clientbereich der Containeranwendung an.

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn die Position des Elements erfolgreich geändert wurde; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Die Standardimplementierung bestimmt das neue sichtbare Rechteck des OLE-Elements und ruft [SetItemRects](#setitemrects) mit den neuen Werten auf. Die Standardimplementierung berechnet das sichtbare Rechteck für das Element und übergibt diese Informationen an den Server.

Überschreiben Sie diese Funktion, um spezielle Regeln auf den Änderungs-/Verschiebungsvorgang anzuwenden. Wenn die Anwendung in MFC geschrieben wird, führt dieser Aufruf dazu, dass der Server [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange)aufgerufen hat.

## <a name="coleclientitemondeactivate"></a><a name="ondeactivate"></a>COleClientItem::OnDeactivate

Wird vom Framework aufgerufen, wenn das OLE-Element vom `activeState`aktiven Status ( ) an Ort und Stelle in den geladenen Zustand übergeht, was bedeutet, dass es nach einer aktiven Aktivierung deaktiviert wird.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Bemerkungen

Beachten Sie, dass diese Funktion aufgerufen wird, um anzuzeigen, dass das OLE-Element geschlossen ist, und nicht, dass seine Benutzeroberfläche aus der Containeranwendung entfernt wurde. In diesem Fall wird die [OnDeactivateUI-Memberfunktion](#ondeactivateui) aufgerufen.

Die Standardimplementierung ruft die [OnChange-Memberfunktion](#onchange) mit OLE_CHANGEDSTATE als Parameter auf. Überschreiben Sie diese Funktion, um eine benutzerdefinierte Verarbeitung durchzuführen, wenn ein aktives Element an Ort und Stelle deaktiviert ist. Wenn Sie z. B. den Befehl Rückgängig in Ihrer Containeranwendung unterstützen, können Sie diese Funktion überschreiben, um den Rückgängig-Zustand zu verwerfen, was darauf hinweist, dass der letzte Vorgang, der für das OLE-Element ausgeführt wurde, nicht rückgängig gemacht werden kann, sobald das Element deaktiviert ist.

## <a name="coleclientitemondeactivateandundo"></a><a name="ondeactivateandundo"></a>COleClientItem::OnDeactivateAndUndo

Wird vom Framework aufgerufen, wenn der Benutzer den Befehl Rückgängig aufruft, nachdem er das OLE-Element aktiviert hat.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Bemerkungen

Die Standardimplementierung ruft [DeactivateUI](#deactivateui) auf, um die Benutzeroberfläche des Servers zu deaktivieren. Überschreiben Sie diese Funktion, wenn Sie den Befehl Rückgängig in Ihrer Containeranwendung implementieren. Rufen Sie in ihrer Außerkraftsetzung die Basisklassenversion der Funktion auf, und machen Sie dann den letzten Befehl rückgängig, der in Ihrer Anwendung ausgeführt wurde.

Weitere Informationen finden Sie unter [IOleInPlaceSite::DeactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) im Windows SDK.

## <a name="coleclientitemondeactivateui"></a><a name="ondeactivateui"></a>COleClientItem::OnDeactivateUI

Wird aufgerufen, wenn der Benutzer ein Element deaktiviert, das an Ort und Stelle aktiviert wurde.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parameter

*bUndoable*<br/>
Gibt an, ob die Bearbeitungsänderungen rückgängig gemacht werden können.

### <a name="remarks"></a>Bemerkungen

Diese Funktion stellt die Benutzeroberfläche der Containeranwendung in ihren ursprünglichen Zustand zurück und blendt alle Menüs und andere Steuerelemente aus, die für die aktive Aktivierung an Ort und Stelle erstellt wurden.

Wenn *bUndoable* FALSE ist, sollte der Container den Befehl Rückgängig deaktivieren und den Rückgängig-Status des Containers faktisch verwerfen, da er angibt, dass der letzte vom Server ausgeführte Vorgang nicht rückgängig gemacht werden kann.

## <a name="coleclientitemondiscardundostate"></a><a name="ondiscardundostate"></a>COleClientItem::OnDiscardUndoState

Wird vom Framework aufgerufen, wenn der Benutzer eine Aktion ausführt, die den Rückgängig-Status beim Bearbeiten des OLE-Elements verwirft.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Bemerkungen

Bei der Standardimplementierung wird keine Aktion ausgeführt. Überschreiben Sie diese Funktion, wenn Sie den Befehl Rückgängig in Ihrer Containeranwendung implementieren. Verwerfen Sie in der Außerkraftsetzung den Rückgängig-Status der Containeranwendung.

Wenn der Server mit der Microsoft Foundation-Klassenbibliothek geschrieben wurde, kann der Server dazu führen, dass diese Funktion aufgerufen wird, indem [cOleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate)aufgerufen wird.

Weitere Informationen finden Sie unter [IOleInPlaceSite::DiscardUndoState](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) im Windows SDK.

## <a name="coleclientitemongetclipboarddata"></a><a name="ongetclipboarddata"></a>COleClientItem::OnGetClipboardData

Wird vom Framework aufgerufen, um ein `COleDataSource` Objekt abzurufen, das alle Daten enthält, die durch einen Aufruf der [CopyToClipboard](#copytoclipboard) oder der [DoDragDrop-Memberfunktion](#dodragdrop) in der Zwischenablage platziert würden.

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parameter

*bIncludeLink*<br/>
Legen Sie diesen Wert auf TRUE fest, wenn Verknüpfungsdaten in die Zwischenablage kopiert werden sollen. Legen Sie diesen Satz auf FALSE fest, wenn Ihre Serveranwendung keine Links unterstützt.

*lpOffset*<br/>
Zeiger auf den Versatz des Mauszeigers vom Ursprung des Objekts in Pixel.

*lpSize*<br/>
Zeiger auf die Größe des Objekts in Pixel.

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf ein [COleDataSource-Objekt,](../../mfc/reference/coledatasource-class.md) das die Zwischenablagedaten enthält.

### <a name="remarks"></a>Bemerkungen

Die Standardimplementierung dieser Funktion ruft [GetClipboardData](#getclipboarddata)auf.

## <a name="coleclientitemongetcliprect"></a><a name="ongetcliprect"></a>COleClientItem::OnGetClipRect

Das Framework `OnGetClipRect` ruft die Memberfunktion auf, um die Clipping-Rechteck-Koordinaten des Elements abzurufen, das bearbeitet wird.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parameter

*rClipRect*<br/>
Zeiger auf ein Objekt der Klasse [CRect,](../../atl-mfc-shared/reference/crect-class.md) das die Clipping-Rechteck-Koordinaten des Elements enthält.

### <a name="remarks"></a>Bemerkungen

Koordinaten sind in Pixel relativ zum Clientbereich des Containeranwendungsfensters.

Die Standardimplementierung gibt einfach das Clientrechteck der Ansicht zurück, für die das Element an Ort und Stelle aktiv ist.

## <a name="coleclientitemongetitemposition"></a><a name="ongetitemposition"></a>COleClientItem::OnGetItemPosition

Das Framework `OnGetItemPosition` ruft die Memberfunktion auf, um die Koordinaten des Elements abzurufen, das bearbeitet wird.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parameter

*Rposition*<br/>
Verweis auf das [CRect-Objekt,](../../atl-mfc-shared/reference/crect-class.md) das die Positionskoordinaten des Elements enthält.

### <a name="remarks"></a>Bemerkungen

Koordinaten sind in Pixel relativ zum Clientbereich des Containeranwendungsfensters.

Bei der Standardimplementierung dieser Funktion wird keine Aktion ausgeführt. Anwendungen, die die ortsspezifische Bearbeitung unterstützen, erfordern die Implementierung.

## <a name="coleclientitemongetwindowcontext"></a><a name="ongetwindowcontext"></a>COleClientItem::OnGetWindowContext

Wird vom Framework aufgerufen, wenn ein Element aktiviert ist.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parameter

*ppMainFrame*<br/>
Zeiger auf einen Zeiger auf das Hauptrahmenfenster.

*ppDocFrame*<br/>
Zeiger auf einen Zeiger auf das Dokumentrahmenfenster.

*lpFrameInfo*<br/>
Zeiger auf eine [OLEINPLACEFRAMEINFO-Struktur,](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) die Framefensterinformationen empfängt.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Diese Funktion wird verwendet, um Informationen über das übergeordnete Fenster des OLE-Elements abzurufen.

Wenn es sich bei dem Container um eine MDI-Anwendung handelt, gibt die Standardimplementierung einen Zeiger auf das [CMDIFrameWnd-Objekt](../../mfc/reference/cmdiframewnd-class.md) in *ppMainFrame* und einen Zeiger auf das aktive [CMDIChildWnd-Objekt](../../mfc/reference/cmdichildwnd-class.md) in *ppDocFrame*zurück. Wenn es sich bei dem Container um eine SDI-Anwendung handelt, gibt die Standardimplementierung einen Zeiger auf das [CFrameWnd-Objekt](../../mfc/reference/cframewnd-class.md) in *ppMainFrame* und NULL in *ppDocFrame*zurück. Die Standardimplementierung füllt auch die Member von *lpFrameInfo*aus.

Überschreiben Sie diese Funktion nur, wenn die Standardimplementierung nicht zu Ihrer Anwendung passt. Wenn Ihre Anwendung beispielsweise über ein Benutzeroberflächenparadigma verfügt, das sich von SDI oder MDI unterscheidet. Dies ist ein fortgeschrittenes Überridable.

Weitere Informationen finden Sie unter [IOleInPlaceSite::GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) und die [OLEINPLACEFRAMEINFO-Struktur](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) im Windows SDK.

## <a name="coleclientitemoninsertmenus"></a><a name="oninsertmenus"></a>COleClientItem::OnInsertMenus

Wird vom Framework während der Ortsaktivierung aufgerufen, um die Menüs der Containeranwendung in ein leeres Menü einzufügen.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parameter

*pMenuShared*<br/>
Zeigt auf ein leeres Menü.

*lpMenuWidths*<br/>
Zeigt auf ein Array von sechs LONG-Werten, die angeben, wie viele Menüs sich in jeder der folgenden Menügruppen befinden: Datei, Bearbeiten, Container, Objekt, Fenster, Hilfe. Die Containeranwendung ist für die Menügruppen Datei, Container und Fenster verantwortlich, die den Elementen 0, 2 und 4 dieses Arrays entsprechen.

### <a name="remarks"></a>Bemerkungen

Dieses Menü wird dann an den Server übergeben, der seine eigenen Menüs einfügt und ein zusammengesetztes Menü erstellt. Diese Funktion kann wiederholt aufgerufen werden, um mehrere zusammengesetzte Menüs zu erstellen.

Die Standardimplementierung fügt in *pMenuShared* die in-Place-Containermenüs ein. d. h. die Menügruppen Datei, Container und Fenster. [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) wird verwendet, um diese Menüressource festzulegen. Die Standardimplementierung weist den Elementen 0, 2 und 4 in *lpMenuWidths*je nach Menüressource auch die entsprechenden Werte zu. Überschreiben Sie diese Funktion, wenn die Standardimplementierung für Ihre Anwendung nicht geeignet ist. Wenn Ihre Anwendung beispielsweise keine Dokumentvorlagen zum Zuordnen von Ressourcen zu Dokumenttypen verwendet. Wenn Sie diese Funktion überschreiben, sollten Sie auch [OnSetMenu](#onsetmenu) und [OnRemoveMenus](#onremovemenus)überschreiben. Dies ist ein fortgeschrittenes Überridable.

Weitere Informationen finden Sie unter [IOleInPlaceFrame::InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) im Windows SDK.

## <a name="coleclientitemonremovemenus"></a><a name="onremovemenus"></a>COleClientItem::OnRemoveMenus

Wird vom Framework aufgerufen, um die Menüs des Containers aus dem angegebenen zusammengesetzten Menü zu entfernen, wenn die Aktivierung an Ort und Stelle endet.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parameter

*pMenuShared*<br/>
Zeigt auf das zusammengesetzte Menü, das durch Aufrufe der [OnInsertMenus-Memberfunktion](#oninsertmenus) erstellt wurde.

### <a name="remarks"></a>Bemerkungen

Die Standardimplementierung entfernt aus *pMenuShared* die ortsseitigen Containermenüs, d. h. die Menügruppen Datei, Container und Fenster. Überschreiben Sie diese Funktion, wenn die Standardimplementierung für Ihre Anwendung nicht geeignet ist. Wenn Ihre Anwendung beispielsweise keine Dokumentvorlagen zum Zuordnen von Ressourcen zu Dokumenttypen verwendet. Wenn Sie diese Funktion überschreiben, sollten Sie wahrscheinlich auch [OnInsertMenus](#oninsertmenus) und [OnSetMenu](#onsetmenu) überschreiben. Dies ist ein fortgeschrittenes Überridable.

Die Untermenüs auf *pMenuShared* können von mehr als einem `OnInsertMenus`zusammengesetzten Menü gemeinsam genutzt werden, wenn der Server wiederholt aufgerufen hat. Daher sollten Sie keine Untermenüs in `OnRemoveMenus`Ihrer Außerkraftsetzung von löschen. Sie sollten sie nur lösen.

Weitere Informationen finden Sie unter [IOleInPlaceFrame::RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) im Windows SDK.

## <a name="coleclientitemonscrollby"></a><a name="onscrollby"></a>COleClientItem::OnScrollby

Wird vom Framework aufgerufen, um das OLE-Element als Antwort auf Anforderungen des Servers zu scrollen.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parameter

*sizeExtent*<br/>
Gibt die Entfernungen in Pixel an, um in die x- und y-Richtung zu scrollen.

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn das Element gescrollt wurde; 0, wenn das Element nicht gescrollt werden konnte.

### <a name="remarks"></a>Bemerkungen

Wenn das OLE-Element beispielsweise teilweise sichtbar ist und der Benutzer sich während der direkt ausgeführten Bearbeitung außerhalb des sichtbaren Bereichs bewegt, wird diese Funktion aufgerufen, um den Cursor sichtbar zu halten. Bei der Standardimplementierung wird keine Aktion ausgeführt. Überschreiben Sie diese Funktion, um das Element um den angegebenen Betrag zu scrollen. Beachten Sie, dass sich der sichtbare Teil des OLE-Elements durch einen Bildlauf ändern kann. Rufen Sie [SetItemRects](#setitemrects) auf, um das sichtbare Rechteck des Elements zu aktualisieren.

Weitere Informationen finden Sie unter [IOleInPlaceSite::Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) im Windows SDK.

## <a name="coleclientitemonsetmenu"></a><a name="onsetmenu"></a>COleClientItem::OnsetMenu

Wird vom Framework zweimal aufgerufen, wenn die aktivierung an Ort beginnt und endet. das erste Mal, um das zusammengesetzte Menü zu installieren, und das zweite Mal (mit *Holemenu* gleich NULL), um es zu entfernen.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parameter

*pMenuShared*<br/>
Zeiger auf das zusammengesetzte Menü, das durch Aufrufe der `InsertMenu` [OnInsertMenus-Memberfunktion](#oninsertmenus) und der Funktion erstellt wurde.

*holemenu*<br/>
Handle für die Menübeschreibung, `OleCreateMenuDescriptor` die von der Funktion zurückgegeben wird, oder NULL, wenn der Dispatching-Code entfernt werden soll.

*hwndActiveObject*<br/>
Behandeln Sie das Bearbeitungsfenster für das OLE-Element. Dies ist das Fenster, das Bearbeitungsbefehle von OLE empfängt.

### <a name="remarks"></a>Bemerkungen

Die Standardimplementierung installiert oder entfernt das zusammengesetzte Menü und ruft dann die [OleSetMenuDescriptor-Funktion](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) auf, um den Dispatching-Code zu installieren oder zu entfernen. Überschreiben Sie diese Funktion, wenn die Standardimplementierung für Ihre Anwendung nicht geeignet ist. Wenn Sie diese Funktion überschreiben, sollten Sie wahrscheinlich auch [OnInsertMenus](#oninsertmenus) und [OnRemoveMenus](#onremovemenus) überschreiben. Dies ist ein fortgeschrittenes Überridable.

Weitere Informationen finden Sie unter [OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)und [IOleInPlaceFrame::SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) im Windows SDK.

## <a name="coleclientitemonshowcontrolbars"></a><a name="onshowcontrolbars"></a>COleClientItem::OnShowControlBars

Wird vom Framework aufgerufen, um die Steuerelementleisten der Containeranwendung einzublenden und auszublenden.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parameter

*pFrameWnd*<br/>
Zeigen Sie mit dem Zeiger auf das Rahmenfenster der Containeranwendung. Dies kann entweder ein Hauptrahmenfenster oder ein untergeordnetes MDI-Fenster sein.

*bShow*<br/>
Gibt an, ob Steuerleisten angezeigt oder ausgeblendet werden sollen.

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn der Funktionsaufruf eine Änderung des Zustands der Kontrollleisten bewirkt. 0, wenn der Aufruf keine Änderung bewirkt oder wenn *pFrameWnd* nicht auf das Rahmenfenster des Containers zeigt.

### <a name="remarks"></a>Bemerkungen

Diese Funktion gibt 0 zurück, wenn sich die Steuerleisten bereits in dem von bShow angegebenen Zustand *befinden.* Dies würde z. B. auftreten, wenn die Steuerleisten ausgeblendet sind und *bShow* FALSE ist.

Die Standardimplementierung entfernt die Symbolleiste aus dem Rahmenfenster der obersten Ebene.

## <a name="coleclientitemonshowitem"></a><a name="onshowitem"></a>COleClientItem::OnShowItem

Wird vom Framework aufgerufen, um das OLE-Element anzuzeigen, sodass es während der Bearbeitung vollständig sichtbar wird.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Bemerkungen

Sie wird verwendet, wenn Ihre Containeranwendung Links zu eingebetteten Elementen unterstützt (d. h., wenn Sie Ihre Dokumentklasse von [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)abgeleitet haben). Diese Funktion wird während der ortsansässigen Aktivierung oder wenn das OLE-Element eine Linkquelle ist und der Benutzer es bearbeiten möchte, aufgerufen. Die Standardimplementierung aktiviert die erste Ansicht im Containerdokument. Überschreiben Sie diese Funktion, um das Dokument zu scrollen, damit das OLE-Element sichtbar ist.

## <a name="coleclientitemonupdateframetitle"></a><a name="onupdateframetitle"></a>COleClientItem::OnUpdateFrameTitle

Wird vom Framework während der ortsnahe Aktivierung aufgerufen, um die Titelleiste des Rahmenfensters zu aktualisieren.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn diese Funktion den Frametitel erfolgreich aktualisiert hat, andernfalls Null.

### <a name="remarks"></a>Bemerkungen

Die Standardimplementierung ändert den Framefenstertitel nicht. Überschreiben Sie diese Funktion, wenn Sie einen anderen Frametitel für Ihre Anwendung wünschen, z. B. *"Server-App-Element* - *item* in *docname*" (wie in "Microsoft Excel - Tabelle in REPORT. DOC"). Dies ist ein fortgeschrittenes Überridable.

## <a name="coleclientitemreactivateandundo"></a><a name="reactivateandundo"></a>COleClientItem::ReactivateAndUndo

Rufen Sie diese Funktion auf, um das OLE-Element erneut zu aktivieren und den letzten Vorgang rückgängig zu machen, der vom Benutzer während der ortsansässigen Bearbeitung ausgeführt wird.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Wenn Ihre Containeranwendung den Befehl Rückgängig unterstützt, rufen Sie diese Funktion auf, wenn der Benutzer den Befehl Rückgängig sofort nach dem Deaktivieren des OLE-Elements auswählt.

Wenn die Serveranwendung mit den Microsoft Foundation-Klassenbibliotheken geschrieben wird, bewirkt diese Funktion, dass der Server [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo)aufruft.

Weitere Informationen finden Sie unter [IOleInPlaceObject::ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) im Windows SDK.

## <a name="coleclientitemrelease"></a><a name="release"></a>COleClientItem::Release

Rufen Sie diese Funktion auf, um Ressourcen zu bereinigen, die vom OLE-Element verwendet werden.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parameter

*dwCloseOption*<br/>
Flag, das angibt, unter welchen Umständen das OLE-Element gespeichert wird, wenn es in den geladenen Zustand zurückkehrt. Eine Liste möglicher Werte finden Sie unter [COleClientItem::Close](#close).

### <a name="remarks"></a>Bemerkungen

`Release`wird vom `COleClientItem` Destruktor aufgerufen.

Weitere Informationen finden Sie unter [IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) im Windows SDK.

## <a name="coleclientitemreload"></a><a name="reload"></a>COleClientItem::Neuladen

Schließt und lädt das Element neu.

```
BOOL Reload();
```

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Rufen `Reload` Sie die Funktion auf, nachdem Sie das Element als Element eines anderen Typs durch einen Aufruf von [ActivateAs](#activateas)aktiviert haben.

## <a name="coleclientitemrun"></a><a name="run"></a>COleClientItem::Ausführen

Führt die diesem Element zugeordnete Anwendung aus.

```cpp
void Run();
```

### <a name="remarks"></a>Bemerkungen

Rufen `Run` Sie die Memberfunktion auf, um die Serveranwendung zu starten, bevor Sie das Element aktivieren. Dies geschieht automatisch durch [Activate](#activate) und [DoVerb](#doverb), so dass es in der Regel nicht notwendig ist, diese Funktion aufzurufen. Rufen Sie diese Funktion auf, wenn es erforderlich ist, den Server auszuführen, um ein Elementattribut wie [SetExtent](#setextent)festzulegen, bevor [DoVerb](#doverb)ausgeführt wird.

## <a name="coleclientitemsetdrawaspect"></a><a name="setdrawaspect"></a>COleClientItem::SetDrawAspect

Rufen `SetDrawAspect` Sie die Memberfunktion auf, um den "Aspekt" oder die Ansicht des Elements festzulegen.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parameter

*nDrawAspect*<br/>
Ein Wert aus der DVASPECT-Enumeration. Dieser Parameter kann einen der folgenden Werte aufweisen:

- DVASPECT_CONTENT-Element wird so dargestellt, dass es als eingebettetes Objekt in seinem Container angezeigt werden kann.

- DVASPECT_THUMBNAIL Element wird in einer "Miniaturansicht"-Darstellung gerendert, sodass es in einem Browsertool angezeigt werden kann.

- DVASPECT_ICON Element wird durch ein Symbol dargestellt.

- DVASPECT_DOCPRINT-Element wird dargestellt, als ob es mit dem Befehl Drucken aus dem Menü Datei gedruckt würde.

### <a name="remarks"></a>Bemerkungen

Der Aspekt gibt an, wie das Element von [Draw](#draw) gerendert werden soll, wenn der Standardwert für das *nDrawAspect-Argument* dieser Funktion verwendet wird.

Diese Funktion wird automatisch vom Änderungssymbol (und anderen Dialogfeldern, die das Dialogfeld Symbol ändern direkt aufrufen) aufgerufen, um den ikonischen Anzeigeaspekt zu aktivieren, wenn der Benutzer dies verlangt.

## <a name="coleclientitemsetextent"></a><a name="setextent"></a>COleClientItem::SetExtent

Rufen Sie diese Funktion auf, um anzugeben, wie viel Speicherplatz für das OLE-Element verfügbar ist.

```cpp
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parameter

*size*<br/>
Ein [CSize-Objekt,](../../atl-mfc-shared/reference/csize-class.md) das die Größeninformationen enthält.

*nDrawAspect*<br/>
Gibt den Aspekt des OLE-Elements an, dessen Grenzen festgelegt werden sollen. Mögliche Werte finden Sie unter [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Bemerkungen

Wenn die Serveranwendung mit der Microsoft Foundation-Klassenbibliothek geschrieben wurde, wird `COleServerItem` die [OnSetExtent-Memberfunktion](../../mfc/reference/coleserveritem-class.md#onsetextent) des entsprechenden Objekts aufgerufen. Das OLE-Element kann dann seine Anzeige entsprechend anpassen. Die Bemaßungen müssen sich in MM_HIMETRIC Einheiten befinden. Rufen Sie diese Funktion auf, wenn der Benutzer die Größe des OLE-Elements ändert oder wenn Sie eine Form der Layoutaushandlung unterstützen.

Weitere Informationen finden Sie unter [IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) im Windows SDK.

## <a name="coleclientitemsethostnames"></a><a name="sethostnames"></a>COleClientItem::SetHostNames

Rufen Sie diese Funktion auf, um den Namen der Containeranwendung und den Namen des Containers für ein eingebettetes OLE-Element anzugeben.

```cpp
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parameter

*lpszHost*<br/>
Zeigen Sie auf den vom Benutzer sichtbaren Namen der Containeranwendung.

*lpszHostObj*<br/>
Zeigen Sie mit dem Zeiger auf eine identifizierende Zeichenfolge des Containers, der das OLE-Element enthält.

### <a name="remarks"></a>Bemerkungen

Wenn die Serveranwendung mit der Microsoft Foundation-Klassenbibliothek geschrieben wurde, ruft `COleServerDoc` diese Funktion die [OnSetHostNames-Memberfunktion](../../mfc/reference/coleserverdoc-class.md#onsethostnames) des Dokuments auf, das das OLE-Element enthält. Diese Informationen werden in Fenstertiteln verwendet, wenn das OLE-Element bearbeitet wird. Jedes Mal, wenn ein Containerdokument geladen wird, ruft das Framework diese Funktion für alle OLE-Elemente im Dokument auf. `SetHostNames`gilt nur für eingebettete Elemente. Es ist nicht erforderlich, diese Funktion jedes Mal aufzurufen, wenn ein eingebettetes OLE-Element für die Bearbeitung aktiviert wird.

Dies wird auch automatisch mit dem Anwendungsnamen und dokumentnamen aufgerufen, wenn ein Objekt geladen wird oder wenn eine Datei unter einem anderen Namen gespeichert wird. Dementsprechend ist es in der Regel nicht notwendig, diese Funktion direkt aufzurufen.

Weitere Informationen finden Sie unter [IOleObject::SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) im Windows SDK.

## <a name="coleclientitemseticonicmetafile"></a><a name="seticonicmetafile"></a>COleClientItem::SetIconicMetafile

Speichert die Metadatei zwischen, die zum Zeichnen des Elementsymbols verwendet wird.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parameter

*hMetaPict*<br/>
Ein Handle für die Metadatei, die zum Zeichnen des Elementsymbols verwendet wird.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Bemerkungen

Verwenden Sie [GetIconicMetafile,](#geticonicmetafile) um die Metadatei abzurufen.

Der Parameter *hMetaPict* wird in das Element kopiert. daher muss *hMetaPict* vom Aufrufer freigegeben werden.

## <a name="coleclientitemsetitemrects"></a><a name="setitemrects"></a>COleClientItem::SetItemRects

Rufen Sie diese Funktion auf, um das umgrenzende Rechteck oder das sichtbare Rechteck des OLE-Elements festzulegen.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parameter

*lprcPosRect*<br/>
Zeigen Sie mit dem Zeiger auf das Rechteck, das die Grenzen des OLE-Elements relativ zum übergeordneten Fenster in Clientkoordinaten enthält.

*lprcClipRect*<br/>
Zeigen Sie mit dem Zeiger auf das Rechteck, das die Grenzen des sichtbaren Teils des OLE-Elements relativ zum übergeordneten Fenster in Clientkoordinaten enthält.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn erfolgreich, andernfalls 0 (null).

### <a name="remarks"></a>Bemerkungen

Diese Funktion wird von der Standardimplementierung der [OnChangeItemPosition-Memberfunktion](#onchangeitemposition) aufgerufen. Sie sollten diese Funktion aufrufen, wenn sich die Position oder der sichtbare Teil des OLE-Elements ändert. Normalerweise bedeutet dies, dass Sie es aus den [OnSize-](../../mfc/reference/cwnd-class.md#onsize) und [OnScrollBy-Memberfunktionen](../../mfc/reference/cview-class.md#onscrollby) Ihrer Ansicht aufrufen.

Weitere Informationen finden Sie unter [IOleInPlaceObject::SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) im Windows SDK.

## <a name="coleclientitemsetlinkupdateoptions"></a><a name="setlinkupdateoptions"></a>COleClientItem::SetLinkUpdateOptions

Rufen Sie diese Funktion auf, um die Option link-update für die Darstellung des angegebenen verknüpften Elements festzulegen.

```cpp
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parameter

*dwUpdateOpt*<br/>
Der Wert der Option link-update für dieses Element. Dieser Wert muss einer der folgenden sein:

- OLEUPDATE_ALWAYS das verknüpfte Element nach Möglichkeit aktualisieren. Diese Option unterstützt das Optionsfeld Automatische Link-Update im Dialogfeld Links.

- OLEUPDATE_ONCALL das verknüpfte Element nur auf Anforderung der Containeranwendung aktualisieren (wenn die [UpdateLink-Memberfunktion](#updatelink) aufgerufen wird). Diese Option unterstützt das Manual link-update-Optionsfeld im Dialogfeld Links.

### <a name="remarks"></a>Bemerkungen

In der Regel sollten Sie die vom Benutzer im Dialogfeld Links ausgewählten Aktualisierungsoptionen nicht ändern.

Weitere Informationen finden Sie unter [IOleLink::SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) im Windows SDK.

## <a name="coleclientitemsetprintdevice"></a><a name="setprintdevice"></a>COleClientItem::SetPrintDevice

Rufen Sie diese Funktion auf, um das Druckzielgerät für dieses Element zu ändern.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parameter

*Ptd*<br/>
Zeiger auf eine [DVTARGETDEVICE-Datenstruktur,](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) die Informationen über das neue Druckzielgerät enthält. Kann den Wert NULL haben.

*Ppd*<br/>
Zeiger auf eine [PRINTDLG-Datenstruktur,](/windows/win32/api/commdlg/ns-commdlg-printdlga) die Informationen über das neue Druckzielgerät enthält. Kann den Wert NULL haben.

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich Null, wenn die Funktion erfolgreich war; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Diese Funktion aktualisiert das Druckzielgerät für das Element, aktualisiert jedoch nicht den Präsentationscache. Um den Präsentationscache für ein Element zu aktualisieren, rufen Sie [UpdateLink](#updatelink)auf.

Die Argumente für diese Funktion enthalten Informationen, die das OLE-System zum Identifizieren des Zielgeräts verwendet. Die `PRINTDLG` Struktur enthält Informationen, die Windows zum Initialisieren des allgemeinen Dialogfelds Drucken verwendet. Nachdem der Benutzer das Dialogfeld geschlossen hat, gibt Windows Informationen über die Auswahl des Benutzers in dieser Struktur zurück. Das `m_pd` Element eines [CPrintDialog-Objekts](../../mfc/reference/cprintdialog-class.md) ist eine `PRINTDLG` Struktur.

Weitere Informationen zu dieser Struktur finden Sie unter [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) im Windows SDK.

Weitere Informationen finden Sie unter [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) im Windows SDK.

## <a name="coleclientitemupdatelink"></a><a name="updatelink"></a>COleClientItem::UpdateLink

Rufen Sie diese Funktion auf, um die Präsentationsdaten des OLE-Elements sofort zu aktualisieren.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Rückgabewert

Bei Erfolg ein Wert ungleich 0 (null), andernfalls 0 (null).

### <a name="remarks"></a>Bemerkungen

Bei verknüpften Elementen sucht die Funktion die Linkquelle, um eine neue Präsentation für das OLE-Element abzuerhalten. Bei diesem Vorgang kann eine oder mehrere Serveranwendungen ausgeführt werden, was zeitaufwändig sein kann. Bei eingebetteten Elementen arbeitet die Funktion rekursiv, überprüft, ob das eingebettete Element Links enthält, die möglicherweise veraltet sind, und aktualisiert sie. Der Benutzer kann auch einzelne Links manuell über das Dialogfeld Links aktualisieren.

Weitere Informationen finden Sie unter [IOleLink::Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) im Windows SDK.

## <a name="see-also"></a>Weitere Informationen

[MFC-Beispiel MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[MFC-Beispiel OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[CDocItem-Klasse](../../mfc/reference/cdocitem-class.md)<br/>
[Hierarchiediagramm](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem-Klasse](../../mfc/reference/coleserveritem-class.md)
