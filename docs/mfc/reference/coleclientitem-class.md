---
title: COleClientItem-Klasse
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: 9f97f117f0fd8570855079aca7bdfd7a63118bc5
ms.sourcegitcommit: 180f63704f6ddd07a4172a93b179cf0733fd952d
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/06/2019
ms.locfileid: "70740880"
---
# <a name="coleclientitem-class"></a>COleClientItem-Klasse

Definiert die Containerschnittstelle zu OLE-Elementen.

## <a name="syntax"></a>Syntax

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Member

### <a name="public-constructors"></a>Öffentliche Konstruktoren

|Name|Beschreibung|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Erstellt ein `COleClientItem`-Objekt.|

### <a name="public-methods"></a>Öffentliche Methoden

|Name|Beschreibung|
|----------|-----------------|
|[COleClientItem::Activate](#activate)|Öffnet das OLE-Element für einen Vorgang und führt dann das angegebene Verb aus.|
|[COleClientItem::ActivateAs](#activateas)|Aktiviert das Element als einen anderen Typ.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Greift auf die Daten im OLE-Objekt zu.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Gibt an, ob eine Containeranwendung ein eingebettetes Objekt erstellen kann.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Gibt an, ob eine Containeranwendung ein verknüpftes Objekt erstellen kann.|
|[COleClientItem::CanPaste](#canpaste)|Gibt an, ob die Zwischenablage ein einbettbares oder statisches OLE-Element enthält.|
|[COleClientItem::CanPasteLink](#canpastelink)|Gibt an, ob die Zwischenablage ein Verknüpf bares-OLE-Element enthält.|
|[COleClientItem::Close](#close)|Schließt einen Link zu einem Server, zerstört das OLE-Element jedoch nicht.|
|[COleClientItem::ConvertTo](#convertto)|Konvertiert das Element in einen anderen Typ.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Kopiert das OLE-Element in die Zwischenablage.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Erstellt ein Duplikat eines vorhandenen Elements.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Erstellt ein eingebettetes Element aus der Zwischenablage.|
|[COleClientItem::CreateFromData](#createfromdata)|Erstellt ein eingebettetes Element aus einem Datenobjekt.|
|[COleClientItem::CreateFromFile](#createfromfile)|Erstellt ein eingebettetes Element aus einer Datei.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Erstellt ein verknüpftes Element aus der Zwischenablage.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Erstellt ein verknüpftes Element aus einem Datenobjekt.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Erstellt ein verknüpftes Element aus einer Datei.|
|[COleClientItem::CreateNewItem](#createnewitem)|Erstellt ein neues eingebettetes Element, indem die Serveranwendung gestartet wird.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Erstellt ein statisches Element aus der Zwischenablage.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Erstellt ein statisches Element aus einem Datenobjekt.|
|[COleClientItem::Deactivate](#deactivate)|Deaktiviert das Element.|
|[COleClientItem::DeactivateUI](#deactivateui)|Stellt die Benutzeroberfläche der Containeranwendung in Ihrem ursprünglichen Zustand wieder her.|
|[COleClientItem::Delete](#delete)|Löscht oder schließt das OLE-Element, wenn es sich um ein verknüpftes Element handelt.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Führt einen Drag & Drop-Vorgang aus.|
|[COleClientItem::DoVerb](#doverb)|Führt das angegebene Verb aus.|
|[COleClientItem::Draw](#draw)|Zeichnet das OLE-Element.|
|[COleClientItem::GetActiveView](#getactiveview)|Ruft die Ansicht ab, für die das Element an Ort und Stelle aktiviert ist.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Gibt die Begrenzungen des Rechtecks des OLE-Elements zurück.|
|[COleClientItem::GetClassID](#getclassid)|Ruft die Klassen-ID des aktuellen Elements ab.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Ruft die Daten ab, die in der Zwischenablage platziert werden, `CopyToClipboard` indem die Member-Funktion aufgerufen wird.|
|[COleClientItem::GetDocument](#getdocument)|Gibt das `COleDocument` -Objekt zurück, das das aktuelle Element enthält.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Ruft die aktuelle Ansicht des Elements zum Rendern ab.|
|[COleClientItem::GetExtent](#getextent)|Gibt die Begrenzungen des Rechtecks des OLE-Elements zurück.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Ruft ein Handle für ein Symbol ab, das dem Server einer bestimmten CLSID zugeordnet ist.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Ruft die Metadatendatei ab, die zum Zeichnen des Element Symbols verwendet wird.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Gibt einen Zeiger auf das direkte Bearbeitungsfenster des Elements zurück.|
|[COleClientItem::GetItemState](#getitemstate)|Ruft den aktuellen Zustand des Elements ab.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Gibt den Status des letzten OLE-Vorgangs zurück.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Gibt den Aktualisierungs Modus für ein verknüpftes Element (erweiterte Funktion) zurück.|
|[COleClientItem::GetType](#gettype)|Gibt den Typ (eingebettet, verknüpft oder statisch) des OLE-Elements zurück.|
|[COleClientItem::GetUserType](#getusertype)|Ruft eine Zeichenfolge ab, die den Typ des Elements beschreibt.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Gibt "true" zurück, wenn das Element direkt aktiv ist.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Gibt true zurück, wenn ein verknüpftes Element mit seinem Quelldokument auf dem neuesten Stand ist.|
|[COleClientItem::IsModified](#ismodified)|Gibt "true" zurück, wenn das Element seit dem letzten Speichern geändert wurde.|
|[COleClientItem::IsOpen](#isopen)|Gibt "true" zurück, wenn das Element derzeit in der Serveranwendung geöffnet ist.|
|[COleClientItem::IsRunning](#isrunning)|Gibt "true" zurück, wenn die Serveranwendung des Elements ausgeführt wird.|
|[COleClientItem::OnActivate](#onactivate)|Wird von Framework aufgerufen, um das Element zu benachrichtigen, dass es aktiviert ist.|
|[COleClientItem::OnActivateUI](#onactivateui)|Wird von Framework aufgerufen, um das Element zu benachrichtigen, dass es aktiviert ist und die zugehörige Benutzeroberfläche angezeigt werden soll.|
|[COleClientItem::OnChange](#onchange)|Wird aufgerufen, wenn der Server das OLE-Element ändert. Implementierung erforderlich.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Wird von Framework aufgerufen, wenn ein Element deaktiviert wird.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Wird von Framework aufgerufen, wenn die direkte Benutzeroberfläche des Servers entfernt wurde.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Wird von Framework aufgerufen, um die Daten zu erhalten, die in die Zwischenablage kopiert werden sollen.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Wird von Framework aufgerufen, um ein zusammengesetztes Menü zu erstellen.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Wird von Framework aufgerufen, um die Menüs des Containers aus einem zusammengesetzten Menü zu entfernen.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Wird von Framework aufgerufen, um ein zusammengesetztes Menü zu installieren und zu entfernen.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Wird von Framework aufgerufen, um Steuer leisten anzuzeigen und auszublenden.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Wird von Framework aufgerufen, um die Titelleiste des Rahmen Fensters zu aktualisieren.|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Aktiviert das Element erneut und macht den letzten Bearbeitungsvorgang zurück.|
|[COleClientItem::Release](#release)|Gibt die Verbindung zu einem mit OLE verknüpften Element frei und schließt es, wenn es geöffnet war. Das Client Element wird nicht zerstört.|
|[COleClientItem::Reload](#reload)|Lädt das Element nach einem-Rückruf `ActivateAs`erneut.|
|[COleClientItem::Run](#run)|Führt die Anwendung aus, die dem Element zugeordnet ist.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Legt die aktuelle Ansicht des Elements für das Rendering fest.|
|[COleClientItem::SetExtent](#setextent)|Legt das umgebende Rechteck des OLE-Elements fest.|
|[COleClientItem::SetHostNames](#sethostnames)|Legt die Namen fest, die der Server anzeigt, wenn das OLE-Element bearbeitet wird.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Speichert die zum Zeichnen des Element Symbols verwendete Metadatendatei zwischen.|
|[COleClientItem::SetItemRects](#setitemrects)|Legt das umgebende Rechteck des Elements fest.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Legt den Update Modus für ein verknüpftes Element (erweiterte Funktion) fest.|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Legt das Druck Ziel Gerät für dieses Client Element fest.|
|[COleClientItem::UpdateLink](#updatelink)|Aktualisiert den Präsentations Cache eines Elements.|

### <a name="protected-methods"></a>Geschützte Methoden

|Name|Beschreibung|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Wird von Framework aufgerufen, um zu bestimmen, ob die direkte Aktivierung zulässig ist.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Wird von Framework aufgerufen, wenn die Position eines Elements geändert wird.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Wird von Framework aufgerufen, um nach der Aktivierung rückgängig zu machen.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Wird von Framework aufgerufen, um die rückgängig-Zustandsinformationen des Elements zu verwerfen.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Wird von Framework aufgerufen, um die Clipping-Rechteck Koordinaten des Elements zu erhalten.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Wird von Framework aufgerufen, um die Position des Elements relativ zur Ansicht zu erhalten.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Wird von Framework aufgerufen, wenn ein Element an Ort und Stelle aktiviert wird.|
|[COleClientItem::OnScrollBy](#onscrollby)|Wird von Framework aufgerufen, um einen Bildlauf zum Element durchführen zu können.|
|[COleClientItem::OnShowItem](#onshowitem)|Wird von Framework aufgerufen, um das OLE-Element anzuzeigen.|

## <a name="remarks"></a>Hinweise

Ein OLE-Element stellt Daten dar, die von einer Serveranwendung erstellt und verwaltet werden, die nahtlos in ein Dokument integriert werden kann, damit Sie dem Benutzer als einzelnes Dokument angezeigt wird. Das Ergebnis ist ein "Verbund Dokument", das aus dem OLE-Element und einem enthaltenden Dokument besteht.

Ein OLE-Element kann entweder eingebettet oder verknüpft sein. Wenn Sie eingebettet ist, werden Ihre Daten als Teil des Verbund Dokuments gespeichert. Wenn Sie verknüpft ist, werden die Daten als Teil einer separaten, von der Serveranwendung erstellten Datei gespeichert, und nur ein Link zu dieser Datei wird im Verbund Dokument gespeichert. Alle OLE-Elemente enthalten Informationen zum Angeben der Serveranwendung, die aufgerufen werden soll, um Sie zu bearbeiten.

`COleClientItem`definiert mehrere über schreibbare Funktionen, die als Antwort auf Anforderungen von der Serveranwendung aufgerufen werden. Diese außer Kraft setzungen fungieren in der Regel als Benachrichtigungen. Dies ermöglicht der Serveranwendung, den Container über Änderungen zu informieren, die der Benutzer beim Bearbeiten des OLE-Elements vornimmt, oder um die während der Bearbeitung erforderlichen Informationen abzurufen.

`COleClientItem`kann entweder mit der [COleDocument](../../mfc/reference/coledocument-class.md)-, [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)-oder [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) -Klasse verwendet werden. Leiten Sie `COleClientItem`zum Verwenden von eine Klasse davon ab, und implementieren Sie die [OnChange](#onchange) -Member-Funktion, mit der definiert wird, wie der Container auf Änderungen am Element reagiert. Überschreiben Sie die [OnGetItemPosition](#ongetitemposition) -Member-Funktion, um die direkte Aktivierung zu unterstützen. Diese Funktion stellt Informationen über die angezeigte Position des OLE-Elements bereit.

Weitere Informationen zum Verwenden der Container Schnittstelle finden Sie in den Artikeln [Container: Implementieren eines Containers](../../mfc/containers-implementing-a-container.md) und einer [Aktivierung](../../mfc/activation-cpp.md).

> [!NOTE]
>  Der Windows SDK verweist auf eingebettete und verknüpfte Elemente als "Objekte" und verweist auf Typen von Elementen als "Klassen". Diese Referenz verwendet den Begriff "Item", um die OLE-Entität vom C++ entsprechenden Objekt und den Begriff "Typ" zu unterscheiden, um die C++ OLE-Kategorie von der Klasse zu unterscheiden.

## <a name="inheritance-hierarchy"></a>Vererbungshierarchie

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Anforderungen

**Header:** Afxole. h

##  <a name="activate"></a>COleClientItem:: Aktivierung

Diese Funktion wird aufgerufen, um das angegebene Verb anstelle von [DoVerb](#doverb) auszuführen, sodass Sie Ihre eigene Verarbeitung durchführen können, wenn eine Ausnahme ausgelöst wird.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parameter

*nVerb*<br/>
Gibt das auszuführende Verb an. Dabei kann es sich um einen der folgenden handeln:

|Wert|Bedeutung|Symbol|
|-----------|-------------|------------|
|- 0|Primäres Verb|OLEIVERB_PRIMARY|
|- 1|Sekundäres Verb|(Keine)|
|- 1|Element zur Bearbeitung anzeigen|OLEIVERB_SHOW|
|- 2|Element im separaten Fenster bearbeiten|OLEIVERB_OPEN|
|- 3|Element ausblenden|OLEIVERB_HIDE|

Der-1-Wert ist in der Regel ein Alias für ein anderes Verb. Wenn offene Bearbeitung nicht unterstützt wird, hat-2 denselben Effekt wie-1. Weitere Werte finden Sie unter [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) in der Windows SDK.

*pView*<br/>
Zeiger auf das Fenster der Container Ansicht, das das OLE-Element enthält. Diese wird von der Serveranwendung für die direkte Aktivierung verwendet. Dieser Parameter sollte NULL sein, wenn der Container keine direkte Aktivierung unterstützt.

*lpMsg*<br/>
Ein Zeiger auf die Meldung, die bewirkt hat, dass das Element aktiviert wurde.

### <a name="remarks"></a>Hinweise

Wenn die Serveranwendung mit dem Microsoft Foundation Class-Bibliothek geschrieben wurde, bewirkt diese Funktion, dass die [ondoverb](../../mfc/reference/coleserveritem-class.md#ondoverb) -Member- `COleServerItem` Funktion des entsprechenden Objekts ausgeführt wird.

Wenn das primäre Verb "Edit" und "Zero" im *nverb* -Parameter angegeben ist, wird die Serveranwendung gestartet, damit das OLE-Element bearbeitet werden kann. Wenn die Containeranwendung die direkte Aktivierung unterstützt, kann die Bearbeitung direkt erfolgen. Wenn der Container die direkte Aktivierung nicht unterstützt (oder wenn das geöffnete Verb angegeben ist), wird der Server in einem separaten Fenster gestartet und kann dort bearbeitet werden. Wenn der Benutzer der Containeranwendung in der Regel auf das OLE-Element doppelklickt, legt der Wert für das primäre Verb im *nverb* -Parameter fest, welche Aktion der Benutzer ausführen kann. Wenn der Server jedoch nur eine Aktion unterstützt, wird diese Aktion ausgeführt, unabhängig davon, welcher Wert im *nverb* -Parameter angegeben wird.

Weitere Informationen finden Sie unter [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) in der Windows SDK.

##  <a name="activateas"></a>COleClientItem:: activateas

Verwendet OLE-Objekt Konvertierungs Funktionen, um das Element so zu aktivieren, als wäre es ein Element des Typs, der von *clsidnew*angegeben wurde.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parameter

*lpszUserType*<br/>
Zeiger auf eine Zeichenfolge, die den Ziel Benutzertyp darstellt, z. b. "Word-Dokument".

*clsidOld*<br/>
Ein Verweis auf die aktuelle Klassen-ID des Elements. Die Klassen-ID muss den Typ des eigentlichen Objekts, wie gespeichert, darstellen, es sei denn, es handelt sich um einen Link. In diesem Fall sollte es sich um die CLSID des Elements handeln, auf das der Link verweist. [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) stellt automatisch die korrekte Klassen-ID für das Element bereit.

*clsidNew*<br/>
Ein Verweis auf die Ziel Klassen-ID.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Dies wird automatisch von [COleConvertDialog::D oconvert](../../mfc/reference/coleconvertdialog-class.md#doconvert)aufgerufen. Sie wird normalerweise nicht direkt aufgerufen.

##  <a name="attachdataobject"></a>COleClientItem:: attachdataobject

Mit dieser Funktion wird ein [COleDataObject](../../mfc/reference/coledataobject-class.md) zum Zugreifen auf die Daten im OLE-Element initialisiert.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parameter

*rDataObject*<br/>
Verweis auf ein `COleDataObject` -Objekt, das initialisiert wird, um den Zugriff auf die Daten im OLE-Element zuzulassen.

##  <a name="canactivate"></a>COleClientItem:: canaktivierungs

Wird von Framework aufgerufen, wenn der Benutzer eine direkte Aktivierung des OLE-Elements anfordert. der Rückgabewert dieser Funktion bestimmt, ob die direkte Aktivierung zulässig ist.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich 0 (null), wenn die direkte Aktivierung zulässig ist. andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung ermöglicht die direkte Aktivierung, wenn der Container über ein gültiges Fenster verfügt. Überschreiben Sie diese Funktion, um eine spezielle Logik zum akzeptieren oder ablehnen der Aktivierungs Anforderung zu implementieren. Beispielsweise kann eine Aktivierungs Anforderung abgelehnt werden, wenn das OLE-Element zu klein ist oder derzeit nicht sichtbar ist.

Weitere Informationen finden Sie unter [IOleInPlaceSite:: caninplaceaktivierungs](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) in der Windows SDK.

##  <a name="cancreatefromdata"></a>COleClientItem:: cankreatefromdata

Überprüft, ob eine Containeranwendung ein eingebettetes Objekt aus dem angegebenen `COleDataObject` Objekt erstellen kann.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parameter

*pDataObject*<br/>
Zeiger auf das [COleDataObject](../../mfc/reference/coledataobject-class.md) -Objekt, aus dem das OLE-Element erstellt werden soll.

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich NULL, wenn der Container ein eingebettetes Objekt `COleDataObject` aus dem-Objekt erstellen kann, andernfalls 0.

### <a name="remarks"></a>Hinweise

Die `COleDataObject` -Klasse wird in Datenübertragungen zum Abrufen von Daten in verschiedenen Formaten aus der Zwischenablage, per Drag & Drop oder von einem eingebetteten OLE-Element verwendet.

Container können diese Funktion verwenden, um Ihre speziellen Befehle zum Einfügen und einfügen einfügen zu aktivieren bzw. zu deaktivieren.

Weitere Informationen finden Sie im Artikel [Datenobjekte und Datenquellen (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="cancreatelinkfromdata"></a>COleClientItem:: cankreatelinkfromdata

Überprüft, ob eine Containeranwendung ein verknüpftes Objekt aus dem angegebenen `COleDataObject` Objekt erstellen kann.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parameter

*pDataObject*<br/>
Zeiger auf das [COleDataObject](../../mfc/reference/coledataobject-class.md) -Objekt, aus dem das OLE-Element erstellt werden soll.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn der Container ein verknüpftes `COleDataObject` Objekt aus dem-Objekt erstellen kann.

### <a name="remarks"></a>Hinweise

Die `COleDataObject` -Klasse wird in Datenübertragungen zum Abrufen von Daten in verschiedenen Formaten aus der Zwischenablage, per Drag & Drop oder von einem eingebetteten OLE-Element verwendet.

Container können diese Funktion verwenden, um zu entscheiden, Ihre Befehle zum Bearbeiten und einfügen einfügen zu aktivieren bzw. zu deaktivieren.

Weitere Informationen finden Sie im Artikel [Datenobjekte und Datenquellen (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="canpaste"></a>COleClientItem:: CanPaste

Mit dieser Funktion können Sie feststellen, ob ein eingebettetes OLE-Element aus der Zwischenablage eingefügt werden kann.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn ein eingebettetes OLE-Element aus der Zwischenablage eingefügt werden kann. andernfalls 0.

### <a name="remarks"></a>Hinweise

Weitere Informationen finden Sie unter [olegetclipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) und [olequerykreatefromdata](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) in der Windows SDK.

##  <a name="canpastelink"></a>COleClientItem:: canpstelink

Mit dieser Funktion können Sie feststellen, ob ein verknüpftes OLE-Element aus der Zwischenablage eingefügt werden kann.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn ein verknüpftes OLE-Element aus der Zwischenablage eingefügt werden kann. andernfalls 0.

### <a name="remarks"></a>Hinweise

Weitere Informationen finden Sie unter [olegetclipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) und [olequerylinkfromdata](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) im Windows SDK.

##  <a name="close"></a>COleClientItem:: Close

Mit dieser Funktion können Sie den Zustand eines OLE-Elements vom Zustand "wird ausgeführt" in den geladenen Zustand ändern, d. h., er wird mit seinem Handler in den Arbeitsspeicher geladen, der Server wird jedoch nicht ausgeführt.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parameter

*dwCloseOption*<br/>
Flag, das angibt, unter welchen Umständen das OLE-Element beim zurückkehren in den geladenen Zustand gespeichert wird. Sie kann einen der folgenden Werte aufweisen:

- OLECLOSE_SAVEIFDIRTY speichern Sie das OLE-Element.

- OLECLOSE_NOSAVE speichern Sie das OLE-Element nicht.

- OLECLOSE_PROMPTSAVE fordert den Benutzer auf, ob das OLE-Element gespeichert werden soll.

### <a name="remarks"></a>Hinweise

Diese Funktion hat keine Auswirkung, wenn das OLE-Element nicht ausgeführt wird.

Weitere Informationen finden Sie unter [IOleObject:: Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) in der Windows SDK.

##  <a name="coleclientitem"></a>COleClientItem:: COleClientItem

Erstellt ein `COleClientItem` -Objekt und fügt es der Auflistung von Dokument Elementen des Container Dokuments hinzu, das nur das C++ -Objekt erstellt und keine OLE-Initialisierung ausführt.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parameter

*pContainerDoc*<br/>
Zeiger auf das Container Dokument, das dieses Element enthält. Dabei kann es sich um eine beliebige [COleDocument](../../mfc/reference/coledocument-class.md) -Ableitung handeln.

### <a name="remarks"></a>Hinweise

Wenn Sie einen NULL-Zeiger übergeben, wird keine Addition zum Container Dokument erstellt. Sie müssen [COleDocument:: AddItem](../../mfc/reference/coledocument-class.md#additem)explizit aufzurufen.

Bevor Sie das OLE-Element verwenden, müssen Sie eine der folgenden Member der Erstellungs Elemente abrufen:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>COleClientItem:: ConvertTo

Diese Member-Funktion wird aufgerufen, um das Element in den von *clsidnew*angegebenen Typ zu konvertieren.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parameter

*clsidNew*<br/>
Die Klassen-ID des Zieltyps.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Dies wird automatisch von [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)aufgerufen. Es ist nicht notwendig, ihn direkt aufzurufen.

##  <a name="copytoclipboard"></a>COleClientItem:: CopyTo Clipboard

Mit dieser Funktion wird das OLE-Element in die Zwischenablage kopiert.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parameter

*bIncludeLink*<br/>
TRUE, wenn Link Informationen in die Zwischenablage kopiert werden sollen, sodass ein verknüpftes Element eingefügt werden kann. andernfalls false.

### <a name="remarks"></a>Hinweise

In der Regel wird diese Funktion aufgerufen, wenn Sie Nachrichten Handler für die Befehle Kopieren oder Ausschneiden aus dem Menü Bearbeiten schreiben. Wenn Sie die Befehle "Kopieren" oder "Ausschneiden" implementieren möchten, müssen Sie die Elementauswahl in der Containeranwendung implementieren.

Weitere Informationen finden Sie unter [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) in der Windows SDK.

##  <a name="createclonefrom"></a>COleClientItem:: kreateclonefrom

Rufen Sie diese Funktion auf, um eine Kopie des angegebenen OLE-Elements zu erstellen.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parameter

*pSrcItem*<br/>
Zeiger auf das OLE-Element, das dupliziert werden soll.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Die Kopie ist mit dem Quell Element identisch. Sie können diese Funktion verwenden, um rückgängig-Vorgänge zu unterstützen.

##  <a name="createfromclipboard"></a>COleClientItem:: kreatefromclipboard

Rufen Sie diese Funktion auf, um ein eingebettetes Element aus dem Inhalt der Zwischenablage zu erstellen.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*bieten*<br/>
Flag zum angeben, wie der Server das OLE-Element Rendering soll. Mögliche Werte finden Sie unter [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender) in der Windows SDK.

*cfFormat*<br/>
Gibt das Zwischenablage Datenformat an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW ist. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatierungsinformationen über das in *cfFormat*angegebene Zwischenablage Format angeben möchten. Wenn Sie diesen Parameter weglassen, werden für die anderen Felder in der `FORMATETC` Struktur Standardwerte verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Diese Funktion wird in der Regel vom Meldungs Handler für den Befehl "Einfügen" im Menü "Bearbeiten" aufgerufen. (Der Befehl Einfügen wird durch das Framework aktiviert, wenn die [CanPaste](#canpaste) -Element Funktion einen Wert ungleich 0 (null) zurückgibt.)

Weitere Informationen finden Sie unter [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender) und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) in der Windows SDK.

##  <a name="createfromdata"></a>COleClientItem:: kreatefromdata

Rufen Sie diese Funktion auf, um ein eingebettetes `COleDataObject` Element aus einem-Objekt zu erstellen.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*pDataObject*<br/>
Zeiger auf das [COleDataObject](../../mfc/reference/coledataobject-class.md) -Objekt, aus dem das OLE-Element erstellt werden soll.

*bieten*<br/>
Flag zum angeben, wie der Server das OLE-Element Rendering soll. Mögliche Werte finden Sie unter [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender) in der Windows SDK.

*cfFormat*<br/>
Gibt das Zwischenablage Datenformat an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW ist. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatierungsinformationen über das in *cfFormat*angegebene Zwischenablage Format angeben möchten. Wenn Sie diesen Parameter weglassen, werden für die anderen Felder in der `FORMATETC` Struktur Standardwerte verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Datenübertragungs Vorgänge, wie z. b. das Einfügen aus der Zwischenablage oder Drag & Drop-Vorgänge `COleDataObject` , stellen Objekte bereit, die die von einer Serveranwendung angebotenen Informationen enthalten. Sie wird in der Regel in der Überschreibung von [CView:: OnDrop](../../mfc/reference/cview-class.md#ondrop)verwendet.

Weitere Informationen finden Sie unter [olecreatefromdata](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender)und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) in der Windows SDK.

##  <a name="createfromfile"></a>COleClientItem:: anatefromfile

Rufen Sie diese Funktion auf, um ein eingebettetes OLE-Element aus einer Datei zu erstellen.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*lpszFileName*<br/>
Zeiger auf den Namen der Datei, aus der das OLE-Element erstellt werden soll.

*clsid*<br/>
Zur künftigen Verwendung reserviert.

*bieten*<br/>
Flag zum angeben, wie der Server das OLE-Element Rendering soll. Mögliche Werte finden Sie unter [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender) in der Windows SDK.

*cfFormat*<br/>
Gibt das Zwischenablage Datenformat an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW ist. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatierungsinformationen über das in *cfFormat*angegebene Zwischenablage Format angeben möchten. Wenn Sie diesen Parameter weglassen, werden für die anderen Felder in der `FORMATETC` Struktur Standardwerte verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Das Framework ruft diese Funktion aus [COleInsertDialog:: deateitem](../../mfc/reference/coleinsertdialog-class.md#createitem) auf, wenn der Benutzer im Dialogfeld Objekt einfügen die Option OK auswählt, wenn die Schaltfläche aus Datei erstellen ausgewählt ist.

Weitere Informationen finden Sie unter [olecreatefromfile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender)und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) in der Windows SDK.

##  <a name="createlinkfromclipboard"></a>COleClientItem:: kreatelinkfromclipboard

Rufen Sie diese Funktion auf, um ein verknüpftes Element aus dem Inhalt der Zwischenablage zu erstellen.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*bieten*<br/>
Flag zum angeben, wie der Server das OLE-Element Rendering soll. Mögliche Werte finden Sie unter [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender) in der Windows SDK.

*cfFormat*<br/>
Gibt das Zwischenablage Datenformat an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW ist. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatierungsinformationen über das in *cfFormat*angegebene Zwischenablage Format angeben möchten. Wenn Sie diesen Parameter weglassen, werden für die anderen Felder in der `FORMATETC` Struktur Standardwerte verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Diese Funktion wird in der Regel vom Meldungs Handler für den Befehl "Link einfügen" im Menü "Bearbeiten" aufgerufen. (Der Befehl Link einfügen ist in der Standard Implementierung von [COleDocument](../../mfc/reference/coledocument-class.md) aktiviert, wenn die Zwischenablage ein OLE-Element enthält, das verknüpft werden kann.)

Weitere Informationen finden Sie unter [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender) und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) in der Windows SDK.

##  <a name="createlinkfromdata"></a>COleClientItem:: anatelinkfromdata

Rufen Sie diese Funktion auf, um ein verknüpftes `COleDataObject` Element aus einem-Objekt zu erstellen.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*pDataObject*<br/>
Zeiger auf das [COleDataObject](../../mfc/reference/coledataobject-class.md) -Objekt, aus dem das OLE-Element erstellt werden soll.

*bieten*<br/>
Flag zum angeben, wie der Server das OLE-Element Rendering soll. Mögliche Werte finden Sie unter [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender) in der Windows SDK.

*cfFormat*<br/>
Gibt das Zwischenablage Datenformat an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW ist. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatierungsinformationen über das in *cfFormat*angegebene Zwischenablage Format angeben möchten. Wenn Sie diesen Parameter weglassen, werden für die anderen Felder in der `FORMATETC` Struktur Standardwerte verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Dies wird während eines Drop-Vorgangs aufgerufen, wenn der Benutzer anzeigt, dass ein Link erstellt werden soll. Sie kann auch verwendet werden, um den Befehl "einfügen bearbeiten" zu verarbeiten. Sie wird von Framework in `COleClientItem::CreateLinkFromClipboard` und in [COlePasteSpecialDialog:: deeitem](../../mfc/reference/colepastespecialdialog-class.md#createitem) aufgerufen, wenn die Link-Option ausgewählt wurde.

Weitere Informationen finden Sie unter [olecreatelinkfromdata](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender)und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) in der Windows SDK.

##  <a name="createlinkfromfile"></a>COleClientItem:: "anatelinkfromfile"

Rufen Sie diese Funktion auf, um ein verknüpftes OLE-Element aus einer Datei zu erstellen.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*lpszFileName*<br/>
Zeiger auf den Namen der Datei, aus der das OLE-Element erstellt werden soll.

*bieten*<br/>
Flag zum angeben, wie der Server das OLE-Element Rendering soll. Mögliche Werte finden Sie unter [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender) in der Windows SDK.

*cfFormat*<br/>
Gibt das Zwischenablage Datenformat an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW ist. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatierungsinformationen über das in *cfFormat*angegebene Zwischenablage Format angeben möchten. Wenn Sie diesen Parameter weglassen, werden für die anderen Felder in der `FORMATETC` Struktur Standardwerte verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Das Framework ruft diese Funktion auf, wenn der Benutzer im Dialogfeld Objekt einfügen die Option OK auswählt, wenn die Schaltfläche aus Datei erstellen aktiviert und das Kontrollkästchen Link aktiviert ist. Sie wird von [colansertdialog:: | ateitem](../../mfc/reference/coleinsertdialog-class.md#createitem)aufgerufen.

Weitere Informationen finden Sie unter [olecreatelinkdefile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender)und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) in der Windows SDK.

##  <a name="createnewitem"></a>COleClientItem:: "kreatenewitem"

Rufen Sie diese Funktion auf, um ein eingebettetes Element zu erstellen. mit dieser Funktion wird die Serveranwendung gestartet, mit der der Benutzer das OLE-Element erstellen kann.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*clsid*<br/>
ID, die den Typ des zu erstellenden OLE-Elements eindeutig identifiziert.

*bieten*<br/>
Flag zum angeben, wie der Server das OLE-Element Rendering soll. Mögliche Werte finden Sie unter [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender) in der Windows SDK.

*cfFormat*<br/>
Gibt das Zwischenablage Datenformat an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW ist. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatierungsinformationen über das in *cfFormat*angegebene Zwischenablage Format angeben möchten. Wenn Sie diesen Parameter weglassen, werden für die anderen Felder in der `FORMATETC` Struktur Standardwerte verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Das Framework ruft diese Funktion auf, wenn der Benutzer im Dialogfeld Objekt einfügen die Option OK auswählt, wenn die Schaltfläche neu erstellen ausgewählt ist.

Weitere Informationen finden Sie unter [olecreate](/windows/win32/api/ole/nf-ole-olecreate), [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender)und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) in der Windows SDK.

##  <a name="createstaticfromclipboard"></a>COleClientItem:: kreatestaticfromclipboard

Rufen Sie diese Funktion auf, um ein statisches Element aus dem Inhalt der Zwischenablage zu erstellen.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*bieten*<br/>
Flag zum angeben, wie der Server das OLE-Element Rendering soll. Mögliche Werte finden Sie unter [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender) in der Windows SDK.

*cfFormat*<br/>
Gibt das Zwischenablage Datenformat an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW ist. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatierungsinformationen über das in *cfFormat*angegebene Zwischenablage Format angeben möchten. Wenn Sie diesen Parameter weglassen, werden für die anderen Felder in der `FORMATETC` Struktur Standardwerte verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Ein statisches Element enthält die Präsentationsdaten, jedoch nicht die systemeigenen Daten. Folglich kann Sie nicht bearbeitet werden. Diese Funktion wird in der Regel aufgerufen, wenn die Member-Funktion von " [kreatefromclipboard](#createfromclipboard) " ausfällt.

Weitere Informationen finden Sie unter [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender) und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) in der Windows SDK.

##  <a name="createstaticfromdata"></a>COleClientItem:: anatestaticfromdata

Rufen Sie diese Funktion auf, um ein statisches `COleDataObject` Element aus einem-Objekt zu erstellen.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parameter

*pDataObject*<br/>
Zeiger auf das [COleDataObject](../../mfc/reference/coledataobject-class.md) -Objekt, aus dem das OLE-Element erstellt werden soll.

*bieten*<br/>
Flag zum angeben, wie der Server das OLE-Element Rendering soll. Mögliche Werte finden Sie unter [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender) in der Windows SDK.

*cfFormat*<br/>
Gibt das Zwischenablage Datenformat an, das beim Erstellen des OLE-Elements zwischengespeichert werden soll.

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die verwendet wird, wenn *Rendering* OLERENDER_FORMAT oder OLERENDER_DRAW ist. Geben Sie einen Wert für diesen Parameter nur an, wenn Sie zusätzliche Formatierungsinformationen über das in *cfFormat*angegebene Zwischenablage Format angeben möchten. Wenn Sie diesen Parameter weglassen, werden für die anderen Felder in der `FORMATETC` Struktur Standardwerte verwendet.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Ein statisches Element enthält die Präsentationsdaten, jedoch nicht die systemeigenen Daten. Folglich kann Sie nicht bearbeitet werden. Dies ist im Wesentlichen identisch mit dem Wert von " [kreatestaticfromclipboard](#createstaticfromclipboard) ", mit dem Unterschied, `COleDataObject`dass ein statisches Element aus einer beliebigen nicht nur aus der Zwischenablage erstellt werden kann

Wird in [COlePasteSpecialDialog:: kreateitem](../../mfc/reference/colepastespecialdialog-class.md#createitem) verwendet, wenn static ausgewählt ist.

Weitere Informationen finden Sie unter [olecreatestaticfromdata](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [olerender](/windows/win32/api/oleidl/ne-oleidl-olerender)und [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) in der Windows SDK.

##  <a name="deactivate"></a>COleClientItem::D eaktivierung

Diese Funktion wird aufgerufen, um das OLE-Element zu deaktivieren und alle zugeordneten Ressourcen freizugeben.

```
void Deactivate();
```

### <a name="remarks"></a>Hinweise

In der Regel deaktivieren Sie ein direktes aktives OLE-Element, wenn der Benutzer auf den Client Bereich außerhalb der Grenzen des Elements klickt. Beachten Sie, dass das Deaktivieren des OLE-Elements den rückgängigzustand verwerfen wird, sodass die [reactivateandundo](#reactivateandundo) -Member-Funktion nicht aufgerufen werden kann.

Wenn Ihre Anwendung Rückgängigmachen unterstützt `Deactivate`, rufen Sie nicht auf. Rufen Sie stattdessen "Debug [ateui](#deactivateui)" auf.

Weitere Informationen finden Sie unter [IOleInPlaceObject:: inplacedeaktivierungs](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) in der Windows SDK.

##  <a name="deactivateui"></a>COleClientItem::D eactivateui

Diese Funktion wird aufgerufen, wenn der Benutzer ein Element deaktiviert, das direkt aktiviert wurde.

```
void DeactivateUI();
```

### <a name="remarks"></a>Hinweise

Diese Funktion stellt die Benutzeroberfläche der Containeranwendung in Ihrem ursprünglichen Zustand wieder her und blendet alle Menüs und anderen Steuerelemente aus, die für die direkte Aktivierung erstellt wurden.

Diese Funktion leert nicht die rückgängig-Zustandsinformationen für das Element. Diese Informationen werden beibehalten, sodass [reactivateandundo](#reactivateandundo) später zum Ausführen eines rückgängigbefehls in der Serveranwendung verwendet werden kann, falls der Rückgängig-Befehl des Containers sofort nach dem Deaktivieren des Elements ausgewählt wird.

Weitere Informationen finden Sie unter [IOleInPlaceObject:: inplacedeaktivierungs](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) in der Windows SDK.

##  <a name="delete"></a>COleClientItem::D Elete

Mit dieser Funktion wird das OLE-Element aus dem Container Dokument gelöscht.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parameter

*bAutoDelete*<br/>
Gibt an, ob das Element aus dem Dokument entfernt werden soll.

### <a name="remarks"></a>Hinweise

Diese Funktion Ruft die [releasemember](#release) -Funktion auf, die wiederum C++ das-Objekt für das Element löscht, wobei das OLE-Element dauerhaft aus dem Dokument entfernt wird. Wenn das OLE-Element eingebettet ist, werden die systemeigenen Daten für das Element gelöscht. Es schließt immer einen laufenden Server. Wenn es sich bei dem Element um einen geöffneten Link handelt, wird es daher von dieser Funktion geschlossen.

##  <a name="dodragdrop"></a>COleClientItem::D odragdrop

Ruft die `DoDragDrop` Member-Funktion auf, um einen Drag & Drop-Vorgang auszuführen.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parameter

*lpItemRect*<br/>
Das Rechteck des Elements auf dem Bildschirm in den Client Koordinaten (Pixel).

*ptOffset*<br/>
Der Offset von *lpitemrect* , an dem sich die Mausposition zum Zeitpunkt des Zieh Vorgangs befand.

*bIncludeLink*<br/>
Legen Sie diese Einstellung auf "true" fest, wenn die Linkdaten in die Zwischenablage kopiert werden sollen. Legen Sie diese Einstellung auf "false" fest, wenn die Serveranwendung keine Links unterstützt.

*dwEffects*<br/>
Bestimmt die Auswirkungen, die die Zieh Quelle im Zieh Vorgang zulässt.

*lpRectStartDrag*<br/>
Zeiger auf das Rechteck, das definiert, wo der Zieh Vorgang tatsächlich gestartet wird. Weitere Informationen finden Sie im folgenden Abschnitt "Hinweise".

### <a name="return-value"></a>Rückgabewert

Ein dropffect-Wert. Wenn es DROPEFFECT_MOVE ist, sollten die ursprünglichen Daten entfernt werden.

### <a name="remarks"></a>Hinweise

Der Drag & Drop-Vorgang wird nicht sofort gestartet. Sie wartet, bis der Mauszeiger das von *lprectstartdrag* angegebene Rechteck verlässt oder bis eine angegebene Anzahl von Millisekunden verstrichen ist. Wenn *lprectstartdrag* den Wert NULL hat, ist die Größe des Rechtecks ein Pixel.

Die Verzögerungszeit wird durch eine Registrierungsschlüssel Einstellung angegeben. Sie können die Verzögerungszeit ändern, indem Sie [CWinApp:: schreiteprofilestring](../../mfc/reference/cwinapp-class.md#writeprofilestring) oder [CWinApp:: Beschreib teprofileint](../../mfc/reference/cwinapp-class.md#writeprofileint)aufrufen. Wenn Sie die Verzögerungszeit nicht angeben, wird ein Standardwert von 200 Millisekunden verwendet. Die Zeit für die Zieh Verzögerung wird wie folgt gespeichert:

- Windows NT-Zieh Verzögerungszeit wird in HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay. gespeichert.

- Windows 3. x-Zieh Verzögerungszeit wird im Gewinn gespeichert. INI-Datei im Abschnitt [Windows} '.

- Windows 95/98-Zieh Verzögerungszeit wird in einer zwischengespeicherten Version von Win gespeichert. Geleitet.

Weitere Informationen zur Art und Weise, in der Informationen zu Drag Delay in der Registrierung oder in gespeichert werden. Die INI-Datei finden Sie unter " [Beschreib teprofilestring](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) " in der Windows SDK.

##  <a name="doverb"></a>COleClientItem::D overb

Ruft `DoVerb` auf, um das angegebene Verb auszuführen.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parameter

*nVerb*<br/>
Gibt das auszuführende Verb an. Dies kann einen der folgenden einschließen:

|Wert|Bedeutung|Symbol|
|-----------|-------------|------------|
|- 0|Primäres Verb|OLEIVERB_PRIMARY|
|- 1|Sekundäres Verb|(Keine)|
|- 1|Element zur Bearbeitung anzeigen|OLEIVERB_SHOW|
|- 2|Element im separaten Fenster bearbeiten|OLEIVERB_OPEN|
|- 3|Element ausblenden|OLEIVERB_HIDE|

Der-1-Wert ist in der Regel ein Alias für ein anderes Verb. Wenn offene Bearbeitung nicht unterstützt wird, hat-2 denselben Effekt wie-1. Weitere Werte finden Sie unter [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) in der Windows SDK.

*pView*<br/>
Zeiger auf das Ansichts Fenster. Diese wird vom Server für die direkte Aktivierung verwendet. Dieser Parameter sollte NULL sein, wenn die Containeranwendung keine direkte Aktivierung zulässt.

*lpMsg*<br/>
Ein Zeiger auf die Meldung, die bewirkt hat, dass das Element aktiviert wurde.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das Verb erfolgreich ausgeführt wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Diese Funktion Ruft die Funktion "Member [aktivieren](#activate) " auf, um das Verb auszuführen. Es fängt auch Ausnahmen ab und zeigt dem Benutzer ein Meldungs Feld an, wenn eine ausgelöst wird.

Wenn das primäre Verb "Edit" und "Zero" im *nverb* -Parameter angegeben ist, wird die Serveranwendung gestartet, damit das OLE-Element bearbeitet werden kann. Wenn die Containeranwendung die direkte Aktivierung unterstützt, kann die Bearbeitung direkt erfolgen. Wenn der Container die direkte Aktivierung nicht unterstützt (oder wenn das geöffnete Verb angegeben ist), wird der Server in einem separaten Fenster gestartet und kann dort bearbeitet werden. Wenn der Benutzer der Containeranwendung in der Regel auf das OLE-Element doppelklickt, legt der Wert für das primäre Verb im *nverb* -Parameter fest, welche Aktion der Benutzer ausführen kann. Wenn der Server jedoch nur eine Aktion unterstützt, wird diese Aktion ausgeführt, unabhängig davon, welcher Wert im *nverb* -Parameter angegeben wird.

##  <a name="draw"></a>COleClientItem::D RAW

Mit dieser Funktion wird das OLE-Element mit dem angegebenen Gerätekontext in das angegebene umgebende Rechteck gezeichnet.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Zeiger auf ein [CDC](../../mfc/reference/cdc-class.md) -Objekt, das zum Zeichnen des OLE-Elements verwendet wird.

*lpBounds*<br/>
Ein Zeiger auf ein [CRect](../../atl-mfc-shared/reference/crect-class.md) - `RECT` Objekt oder eine CRect-Struktur, das das umschließende Rechteck definiert, in dem das OLE-Element gezeichnet werden soll (in logischen Einheiten, die durch den Gerätekontext

*nDrawAspect*<br/>
Gibt den Aspekt des OLE-Elements an, d. h., wie es angezeigt werden soll. Wenn *ndrawaspect* den Wert-1 hat, wird der letzte mit [setdrawaspect](#setdrawaspect) festgelegte Aspekt verwendet. Weitere Informationen zu möglichen Werten für dieses Flag finden Sie unter [setdrawaspect](#setdrawaspect).

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Die-Funktion kann die metadateidarstellung des OLE-Elements verwenden, das von der [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) -Member-Funktion von `COleServerItem`erstellt wurde.

Normalerweise verwenden `Draw` Sie für die Bildschirm Anzeige und übergeben den Bildschirm-Gerätekontext als *PDC*. In diesem Fall müssen Sie nur die ersten beiden Parameter angeben.

Der *lpbounds* -Parameter identifiziert das Rechteck im Zielgeräte Kontext (relativ zum aktuellen Zustellungs Modus). Das Rendering kann das Skalieren des Bilds einschließen und von Container Anwendungen verwendet werden, um eine Ansicht zu erzwingen, die zwischen der angezeigten Ansicht und dem endgültigen gedruckten Bild skaliert.

Weitere Informationen finden Sie unter [IViewObject::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) in der Windows SDK.

##  <a name="getactiveview"></a>COleClientItem:: GetActiveView

Gibt die Ansicht zurück, für die das Element direkt aktiviert ist.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf die Ansicht. andernfalls NULL, wenn das Element nicht direkt aktiviert ist.

##  <a name="getcachedextent"></a>COleClientItem:: getcachedextent

Rufen Sie diese Funktion auf, um die Größe des OLE-Elements abzurufen.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parameter

*lpSize*<br/>
Ein Zeiger auf `SIZE` eine Struktur oder ein [CSize](../../atl-mfc-shared/reference/csize-class.md) -Objekt, das die Größen Informationen empfängt.

*nDrawAspect*<br/>
Gibt den Aspekt des OLE-Elements an, dessen Begrenzungen abgerufen werden sollen. Mögliche Werte finden Sie unter [setdrawaspect](#setdrawaspect).

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn erfolgreich; 0, wenn das OLE-Element leer ist.

### <a name="remarks"></a>Hinweise

Diese Funktion stellt die gleichen Informationen wie [GetExtent](#getextent)bereit. Sie können jedoch auch aufzurufen `GetCachedExtent` , um bei der Verarbeitung von anderen OLE-Handlern, wie z. b. [OnChange](#onchange), Block Informationen zu erhalten. Die Dimensionen sind in MM_HIMETRIC-Einheiten.

Dies ist möglich, `GetCachedExtent` da die [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) -Schnittstelle anstelle der [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject) -Schnittstelle verwendet, um den Umfang dieses Elements zu erhalten. Das `IViewObject2` com-Objekt speichert die im vorherigen IViewObject-Aufrufe verwendeten Bereichs Informationen zwischen [::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Weitere Informationen finden Sie unter [IViewObject2:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) im Windows SDK.

##  <a name="getclassid"></a>COleClientItem:: GetClassID

Gibt die Klassen-ID des Elements im Speicher zurück, auf das von *pClassId*verwiesen wird.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parameter

*pClassID*<br/>
Zeiger auf einen Bezeichner des Typs [CLSID](/windows/win32/com/clsid-key-hklm) , um die Klassen-ID abzurufen. Weitere Informationen zur CLSID finden Sie in der Windows SDK.

### <a name="remarks"></a>Hinweise

Die Klassen-ID ist eine 128-Bit-Zahl, die die Anwendung, die das Element bearbeitet, eindeutig identifiziert.

Weitere Informationen finden Sie unter [ipersistent:: GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) in der Windows SDK.

##  <a name="getclipboarddata"></a>COleClientItem:: GetClipboardData

Mit dieser Funktion können Sie ein `COleDataSource` -Objekt abrufen, das alle Daten enthält, die durch einen Anruf an die [CopyTo Clipboard](#copytoclipboard) -Member-Funktion in der Zwischenablage platziert werden.

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parameter

*pDataSource*<br/>
Zeiger auf ein [COleDataSource](../../mfc/reference/coledatasource-class.md) -Objekt, das die Daten empfängt, die im OLE-Element enthalten sind.

*bIncludeLink*<br/>
TRUE, wenn Verknüpfungs Daten eingeschlossen werden sollen. andernfalls false.

*lpOffset*<br/>
Der Offset des Maus Cursors vom Ursprung des-Objekts in Pixel.

*lpSize*<br/>
Die Größe des-Objekts in Pixel.

### <a name="remarks"></a>Hinweise

`GetClipboardData`wird als Standard Implementierung von [OnGetClipboardData](#ongetclipboarddata)aufgerufen. Über `OnGetClipboardData` schreiben Sie nur, wenn Sie zusätzlich zu den von `CopyToClipboard`angebotenen Datenformaten bereitstellen möchten. Platzieren Sie diese Formate vor `COleDataSource` oder nach dem Aufrufen `CopyToClipboard`von in das-Objekt, `COleDataSource` und übergeben Sie das Objekt dann an die [COleDataSource:: setClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) -Funktion. Wenn Sie z. b. möchten, dass die Position des OLE-Elements in seinem Container Dokument in der Zwischenablage enthalten ist, definieren Sie ein eigenes Format zum Übergeben dieser Informationen, und `COleDataSource` platzieren Sie `CopyToClipboard`es in der, bevor Sie aufrufen.

##  <a name="getdocument"></a>COleClientItem:: GetDocument

Mit dieser Funktion können Sie einen Zeiger auf das Dokument abrufen, das das OLE-Element enthält.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf das Dokument, das das OLE-Element enthält. NULL, wenn das Element nicht Teil eines Dokuments ist.

### <a name="remarks"></a>Hinweise

Dieser Zeiger ermöglicht den Zugriff auf `COleDocument` das-Objekt, das Sie als Argument an `COleClientItem` den-Konstruktor übergeben haben.

##  <a name="getdrawaspect"></a>COleClientItem:: getdrawaspect

Ruft die `GetDrawAspect` Member-Funktion auf, um den aktuellen "Aspekt" oder die aktuelle Ansicht des Elements zu bestimmen.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Rückgabewert

Ein Wert aus der DVASPECT-Enumeration, dessen Werte in der Referenz für [setdrawaspect](#setdrawaspect)aufgeführt sind.

### <a name="remarks"></a>Hinweise

Der Aspekt gibt an, wie das Element gerendert werden soll.

##  <a name="getextent"></a>COleClientItem:: GetExtent

Rufen Sie diese Funktion auf, um die Größe des OLE-Elements abzurufen.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parameter

*lpSize*<br/>
Ein Zeiger auf `SIZE` eine-Struktur `CSize` oder ein-Objekt, das die Größen Informationen empfängt.

*nDrawAspect*<br/>
Gibt den Aspekt des OLE-Elements an, dessen Begrenzungen abgerufen werden sollen. Mögliche Werte finden Sie unter [setdrawaspect](#setdrawaspect).

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn erfolgreich; 0, wenn das OLE-Element leer ist.

### <a name="remarks"></a>Hinweise

Wenn die Serveranwendung mit dem Microsoft Foundation Class-Bibliothek geschrieben wurde, bewirkt diese Funktion, dass die [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) -Member- `COleServerItem` Funktion des entsprechenden Objekts aufgerufen wird. Beachten Sie, dass die abgerufene Größe von der Größe abweichen kann, die zuletzt von der [SetExtent](#setextent) -Element Funktion festgelegt wurde. die von `SetExtent` angegebene Größe wird als Vorschlag behandelt. Die Dimensionen sind in MM_HIMETRIC-Einheiten.

> [!NOTE]
>  Während der Verarbeitung `GetExtent` eines OLE-Handlers (z. b. [OnChange](#onchange)) nicht aufzurufen. Aufrufen Sie stattdessen [getcachedextent](#getcachedextent) .

Weitere Informationen finden Sie unter [IOleObject:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) in der Windows SDK.

##  <a name="geticonfromregistry"></a>COleClientItem:: getikonfromregistry

Rufen Sie diese Member-Funktion auf, um ein Handle für eine Symbol Ressource abzurufen, die dem Server einer bestimmten CLSID zugeordnet ist.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parameter

*clsid*<br/>
Ein Verweis auf die CLSID für den Server, der dem Symbol zugeordnet ist.

### <a name="return-value"></a>Rückgabewert

Ein gültiges Handle für die Symbol Ressource oder NULL, wenn das Server Symbol oder ein Standard Symbol nicht gefunden werden kann.

### <a name="remarks"></a>Hinweise

Diese Member-Funktion startet den Server nicht, oder es wird ein Symbol nicht dynamisch abgerufen, auch wenn der Server bereits ausgeführt wird. Stattdessen öffnet diese Member-Funktion das ausführbare Image des Servers und ruft das statische Symbol ab, das dem Server während der Registrierung zugeordnet ist.

##  <a name="geticonicmetafile"></a>COleClientItem:: getikonicmetafile

Ruft die Metadatendatei ab, die zum Zeichnen des Element Symbols verwendet wird.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Rückgabewert

Ein Handle für die Metadatei, wenn erfolgreich. andernfalls NULL.

### <a name="remarks"></a>Hinweise

Wenn kein Aktuelles Symbol vorhanden ist, wird ein Standard Symbol zurückgegeben. Diese wird automatisch von den MFC/OLE-Dialogfeldern aufgerufen und wird normalerweise nicht direkt aufgerufen.

Diese [Funktion ruft auch](#seticonicmetafile) "" "" "", um die Metadatendatei für die spätere Verwendung zwischenzuspeichern.

##  <a name="getinplacewindow"></a>COleClientItem:: getinplacewindow

Ruft die `GetInPlaceWindow` Member-Funktion auf, um einen Zeiger auf das Fenster zu erhalten, in dem das Element für die direkte Bearbeitung geöffnet wurde.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf das direkte Bearbeitungsfenster des Elements. NULL, wenn das Element nicht aktiv ist oder der Server nicht verfügbar ist.

### <a name="remarks"></a>Hinweise

Diese Funktion sollte nur für Elemente aufgerufen werden, die direkt aktiv sind.

##  <a name="getitemstate"></a>COleClientItem:: GetItemState

Mit dieser Funktion können Sie den aktuellen Zustand des OLE-Elements abrufen.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Rückgabewert

Ein `COleClientItem::ItemState` -Enumerationswert, bei dem es sich um einen der folgenden Werte `activeState`handeln `activeUIState`kann: `emptyState`, `loadedState`, `openState`,,. Weitere Informationen zu diesen Zuständen finden Sie im Artikel [Container: Client-Element-](../../mfc/containers-client-item-states.md)Zustände.

### <a name="remarks"></a>Hinweise

Um benachrichtigt zu werden, wenn sich der Status des OLE-Elements ändert, verwenden Sie die [OnChange](#onchange) -Member-Funktion.

Weitere Informationen finden Sie im Artikel [Container: Client-Element-](../../mfc/containers-client-item-states.md)Zustände.

##  <a name="getlaststatus"></a>COleClientItem:: getlaststatus

Gibt den Statuscode des letzten OLE-Vorgangs zurück.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Rückgabewert

Ein SCODE-Wert.

### <a name="remarks"></a>Hinweise

Gibt für Member-Funktionen, die einen booleschen Wert von false zurückgeben, oder andere Element `GetLastStatus` Funktionen, die NULL zurückgeben, ausführlichere Fehlerinformationen zurück. Beachten Sie, dass die meisten OLE-Member-Funktionen bei schwerwiegenderen Fehlern Ausnahmen auslösen. Die spezifischen Informationen zur Interpretation des scodes hängen vom zugrunde liegenden OLE-Befehl ab, der zuletzt einen SCODE-Wert zurückgegeben hat.

Weitere Informationen zu SCODE finden Sie unter [Struktur von com-Fehler Codes](/windows/win32/com/structure-of-com-error-codes) in der Windows SDK-Dokumentation.

##  <a name="getlinkupdateoptions"></a>COleClientItem:: getlinkupdateoptions

Mit dieser Funktion können Sie den aktuellen Wert der Link-Update-Option für das OLE-Element abrufen.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Rückgabewert

Einer der folgenden Werte:

- OLEUPDATE_ALWAYS aktualisieren Sie das verknüpfte Element, wann immer möglich. Diese Option unterstützt das automatische Link-Update-Optionsfeld im Dialogfeld Verknüpfungen.

- OLEUPDATE_ONCALL aktualisiert das verknüpfte Element nur auf Anforderung von der Containeranwendung (wenn die [UpdateLink](#updatelink) -Member-Funktion aufgerufen wird). Diese Option unterstützt das Optionsfeld Manuelles Link-Update im Dialogfeld Verknüpfungen.

### <a name="remarks"></a>Hinweise

Dies ist ein erweiterter Vorgang.

Diese Funktion wird automatisch von der [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) -Klasse aufgerufen.

Weitere Informationen finden Sie unter [iolelink:: getupdateoptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) in der Windows SDK.

##  <a name="gettype"></a>COleClientItem:: GetType

Mit dieser Funktion können Sie feststellen, ob das OLE-Element eingebettet oder verknüpft oder statisch ist.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Rückgabewert

Eine ganze Zahl ohne Vorzeichen mit einem der folgenden Werte:

- OT_LINK das OLE-Element ist ein Link.

- OT_EMBEDDED das OLE-Element ist eingebettet.

- OT_STATIC das OLE-Element ist statisch, d. h. es enthält nur Präsentationsdaten, keine nativen Daten und kann daher nicht bearbeitet werden.

##  <a name="getusertype"></a>COleClientItem:: GetUserType

Mit dieser Funktion können Sie die Benutzer sichtbare Zeichenfolge abrufen, die den Typ des OLE-Elements beschreibt, z. b. "Word-Dokument".

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parameter

*nUserClassType*<br/>
Ein-Wert, der die gewünschte Variante der Zeichenfolge angibt, die den Typ des OLE-Elements beschreibt. Dies kann einen der folgenden Werte aufweisen:

- USERCLASSTYPE_FULL der vollständige Typname, der dem Benutzer angezeigt wird.

- USERCLASSTYPE_SHORT ein Kurzname (maximal 15 Zeichen) für die Verwendung in Popup Menüs und im Dialogfeld Links bearbeiten.

- USERCLASSTYPE_APPNAME Name der Anwendung, die die-Klasse bedient.

*rString*<br/>
Ein Verweis auf ein [CString](../../atl-mfc-shared/reference/cstringt-class.md) -Objekt, für das die Zeichenfolge, die den Typ des OLE-Elements beschreibt, zurückgegeben werden soll.

### <a name="remarks"></a>Hinweise

Dies ist häufig der Eintrag in der Datenbank der Systemregistrierung.

Wenn der vollständige Typname angefordert, aber nicht verfügbar ist, wird stattdessen der Kurzname verwendet. Wenn in der Registrierungsdatenbank kein Eintrag für den Typ des OLE-Elements gefunden wird oder wenn keine Benutzer Typen für den Typ des OLE-Elements registriert sind, wird der derzeit im OLE-Element gespeicherte Benutzertyp verwendet. Wenn dieser Benutzertypname eine leere Zeichenfolge ist, wird "Unbekanntes Objekt" verwendet.

Weitere Informationen finden Sie unter [IOleObject:: GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) in der Windows SDK.

##  <a name="isinplaceactive"></a>COleClientItem:: isinplaceactive

Mit dieser Funktion können Sie feststellen, ob das OLE-Element direkt aktiv ist.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das OLE-Element direkt aktiv ist. andernfalls 0.

### <a name="remarks"></a>Hinweise

Es ist üblich, abhängig davon, ob das Element an Ort und Stelle bearbeitet wird, unterschiedliche Logik auszuführen. Die-Funktion überprüft, ob der aktuelle Element Zustand entweder der `activeState` oder der `activeUIState`entspricht.

##  <a name="islinkuptodate"></a>COleClientItem:: islinkupdate

Mit dieser Funktion können Sie feststellen, ob das OLE-Element auf dem neuesten Stand ist.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das OLE-Element aktuell ist. andernfalls 0.

### <a name="remarks"></a>Hinweise

Ein verknüpftes Element kann veraltet sein, wenn das Quelldokument aktualisiert wurde. Ein eingebettetes Element, das darin enthaltene Links enthält, kann auf ähnliche Weise veraltet sein. Die-Funktion führt eine rekursive Überprüfung des OLE-Elements aus. Beachten Sie, dass die Bestimmung, ob ein OLE-Element veraltet ist, sehr teuer sein kann, wenn ein Update tatsächlich durchgeführt wird.

Dies wird automatisch von der [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) -Implementierung aufgerufen.

Weitere Informationen finden Sie unter [IOleObject:: isuptopdate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) in der Windows SDK.

##  <a name="ismodified"></a>COleClientItem:: IsModified

Mit dieser Funktion können Sie feststellen, ob das OLE-Element geändert wurde (seit dem letzten Speichern geändert).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das OLE-Element geändert wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Weitere Informationen finden Sie unter [IPersistStorage:: IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) in der Windows SDK.

##  <a name="isopen"></a>COleClientItem:: IsOpen

Mit dieser Funktion können Sie feststellen, ob das OLE-Element geöffnet ist. Das heißt, Sie wird in einer Instanz der Serveranwendung geöffnet, die in einem separaten Fenster ausgeführt wird.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das OLE-Element geöffnet ist. andernfalls 0.

### <a name="remarks"></a>Hinweise

Es wird verwendet, um zu bestimmen, wann das Objekt mit einem Schraffurmuster gezeichnet werden soll. Ein offenes Objekt muss über ein Schraffurmuster verfügen, das oberhalb des Objekts gezeichnet wird. Hierfür können Sie ein [CRectTracker](../../mfc/reference/crecttracker-class.md) -Objekt verwenden.

##  <a name="isrunning"></a>COleClientItem:: IsRunning

Mit dieser Funktion können Sie feststellen, ob das OLE-Element ausgeführt wird. Das heißt, ob das Element in der Serveranwendung geladen und ausgeführt wird.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das OLE-Element ausgeführt wird. andernfalls 0.

### <a name="remarks"></a>Hinweise

Weitere Informationen finden Sie unter [oleisrunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) in der Windows SDK.

##  <a name="onactivate"></a>COleClientItem:: onaktivierungs

Wird von Framework aufgerufen, um das Element zu benachrichtigen, dass es gerade direkt aktiviert wurde.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Hinweise

Beachten Sie, dass diese Funktion aufgerufen wird, um anzugeben, dass der Server ausgeführt wird, und nicht, um anzugeben, dass die zugehörige Benutzeroberfläche in der Containeranwendung installiert wurde. An diesem Punkt hat das Objekt keine aktive Benutzeroberfläche (ist nicht `activeUIState`). Die Menüs oder die Symbolleiste wurden nicht installiert. Die [onactivateui](#onactivateui) -Member-Funktion wird aufgerufen, wenn dies geschieht.

Die Standard Implementierung ruft die [OnChange](#onchange) -Member-Funktion mit OLE_CHANGEDSTATE als Parameter auf. Überschreiben Sie diese Funktion, um eine benutzerdefinierte Verarbeitung auszuführen, wenn ein Element direkt aktiv wird.

##  <a name="onactivateui"></a>COleClientItem:: onactivateui

Das Framework ruft `OnActivateUI` auf, wenn das Objekt den aktiven Benutzeroberflächen Zustand erreicht hat.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Hinweise

Die Symbolleiste und die Menüs des-Objekts wurden nun installiert.

Die Standard Implementierung speichert das HWND des Servers für spätere `GetServerWindow` Aufrufe.

##  <a name="onchange"></a>COleClientItem:: OnChange

Wird von Framework aufgerufen, wenn der Benutzer das OLE-Element ändert, speichert oder schließt.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parameter

*nCode*<br/>
Der Grund, warum der Server dieses Element geändert hat. Sie kann einen der folgenden Werte aufweisen:

- OLE_CHANGED die Darstellung des OLE-Elements hat sich geändert.

- OLE_SAVED das OLE-Element wurde gespeichert.

- OLE_CLOSED das OLE-Element wurde geschlossen.

- OLE_CHANGED_STATE das OLE-Element wurde von einem Zustand in einen anderen geändert.

*dwParam*<br/>
Wenn *nCode* "OLE_SAVED" oder "OLE_CLOSED" ist, wird dieser Parameter nicht verwendet. Wenn *nCode* OLE_CHANGED ist, gibt dieser Parameter den Aspekt des geänderten OLE-Elements an. Mögliche Werte finden Sie unter dem *dwparam* -Parameter von [COleClientItem::D RAW](#draw). Wenn *nCode* OLE_CHANGED_STATE ist, ist dieser Parameter ein `COleClientItem::ItemState` -Enumerationswert und beschreibt den Zustand, der eingegeben wird. Sie kann einen der folgenden Werte aufweisen: `emptyState`, `loadedState`, `openState`, `activeState`oder `activeUIState`.

### <a name="remarks"></a>Hinweise

(Wenn die Serveranwendung mit dem Microsoft Foundation Class-Bibliothek geschrieben wird, wird diese Funktion als Reaktion auf die `Notify` Element Funktionen von `COleServerDoc` oder `COleServerItem`aufgerufen.) Die Standard Implementierung markiert das Container Dokument als geändert, wenn *nCode* OLE_CHANGED oder OLE_SAVED ist.

Für OLE_CHANGED_STATE ist der aktuelle Zustand, der von [GetItemState](#getitemstate) zurückgegeben wurde, immer noch der alte Zustand, d. h. der Zustand, der vor dieser Zustandsänderung aktuell war.

Überschreiben Sie diese Funktion, um auf Änderungen im Zustand des OLE-Elements zu reagieren. In der Regel aktualisieren Sie die Darstellung des Elements, indem Sie den Bereich, in dem das Element angezeigt wird, ungültig machen. Nennen Sie die Basisklassen Implementierung am Anfang der außer Kraft Setzung.

##  <a name="onchangeitemposition"></a>COleClientItem:: OnChangeItemPosition

Wird von Framework aufgerufen, um den Container zu benachrichtigen, dass sich der Block des OLE-Elements während der direkten Aktivierung geändert hat.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parameter

*rectPos*<br/>
Gibt die Position des Elements relativ zum Client Bereich der Containeranwendung an.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn die Position des Elements erfolgreich geändert wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung bestimmt das neue sichtbare Rechteck des OLE-Elements und ruft " [mentitemrects](#setitemrects) " mit den neuen Werten auf. Die Standard Implementierung berechnet das sichtbare Rechteck für das Element und übergibt diese Informationen an den Server.

Überschreiben Sie diese Funktion, um spezielle Regeln auf den Größenänderung/Verschiebungs Vorgang anzuwenden. Wenn die Anwendung in MFC geschrieben ist, wird dieser Aufruf ausgegeben, weil der Server [COleServerDoc:: requestpositionchange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange)heißt.

##  <a name="ondeactivate"></a>COleClientItem:: ondeaktivieren

Wird von Framework aufgerufen, wenn das OLE-Element vom direkten aktiven Zustand ( `activeState`) in den geladenen Zustand übergeht, was bedeutet, dass es nach einer direkten Aktivierung deaktiviert wird.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Hinweise

Beachten Sie, dass diese Funktion aufgerufen wird, um anzugeben, dass das OLE-Element geschlossen ist, und nicht, dass die Benutzeroberfläche aus der Containeranwendung entfernt wurde. Wenn dies der Fall ist, wird die [onde activateui](#ondeactivateui) -Member-Funktion aufgerufen.

Die Standard Implementierung ruft die [OnChange](#onchange) -Member-Funktion mit OLE_CHANGEDSTATE als Parameter auf. Überschreiben Sie diese Funktion, um eine benutzerdefinierte Verarbeitung auszuführen, wenn ein direktes aktives Element deaktiviert wird. Wenn Sie z. b. den Befehl "Rückgängig" in der Containeranwendung unterstützen, können Sie diese Funktion überschreiben, um den Rückgängig-Zustand zu verwerfen. Dies bedeutet, dass der letzte Vorgang, der für das OLE-Element ausgeführt wurde, nicht rückgängig gemacht werden kann

##  <a name="ondeactivateandundo"></a>COleClientItem:: onde activateandundo

Wird von Framework aufgerufen, wenn der Benutzer den Befehl "Rückgängig" aufruft, nachdem das OLE-Element direkt aktiviert wurde.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Hinweise

Die Standard Implementierung ruft [deactivateui](#deactivateui) auf, um die Benutzeroberfläche des Servers zu deaktivieren. Überschreiben Sie diese Funktion, wenn Sie den Befehl "Rückgängig" in der Containeranwendung implementieren. Rufen Sie in der außer Kraft Setzung die Basisklassen Version der Funktion auf, und machen Sie dann den letzten Befehl rückgängig, der in Ihrer Anwendung ausgeführt wurde.

Weitere Informationen finden Sie unter [IOleInPlaceSite::D eactivateandundo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) in der Windows SDK.

##  <a name="ondeactivateui"></a>COleClientItem:: onde activateui

Wird aufgerufen, wenn der Benutzer ein Element deaktiviert, das direkt aktiviert wurde.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parameter

*bundoable*<br/>
Gibt an, ob die Bearbeitungs Änderungen nicht rückgängig gemacht werden können.

### <a name="remarks"></a>Hinweise

Diese Funktion stellt die Benutzeroberfläche der Containeranwendung in Ihrem ursprünglichen Zustand wieder her und blendet alle Menüs und anderen Steuerelemente aus, die für die direkte Aktivierung erstellt wurden.

Wenn " *bundoable* " auf "false" festgelegt ist, sollte der Container den Befehl "Rückgängig" deaktivieren und den rückgängigzustand des Containers verwerfen, da er angibt, dass der letzte vom Server ausgeführte Vorgang nicht rückgängig gemacht werden kann.

##  <a name="ondiscardundostate"></a>COleClientItem:: onverwerfen dundostate

Wird von Framework aufgerufen, wenn der Benutzer eine Aktion ausführt, die den rückgängigzustand bei der Bearbeitung des OLE-Elements verwirft.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Hinweise

Bei der Standardimplementierung wird keine Aktion ausgeführt. Überschreiben Sie diese Funktion, wenn Sie den Befehl "Rückgängig" in der Containeranwendung implementieren. Verwerfen Sie in der außer Kraft Setzung den rückgängigzustand der Containeranwendung.

Wenn der Server mit dem Microsoft Foundation Class-Bibliothek geschrieben wurde, kann der Server bewirken, dass diese Funktion durch Aufrufen von [COleServerDoc::D iscardundostate](../../mfc/reference/coleserverdoc-class.md#discardundostate)aufgerufen wird.

Weitere Informationen finden Sie unter [IOleInPlaceSite::D iscardundostate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) in der Windows SDK.

##  <a name="ongetclipboarddata"></a>COleClientItem:: OnGetClipboardData

Wird von Framework aufgerufen, um ein `COleDataSource` -Objekt zu erhalten, das alle Daten enthält, die durch einen Aufruf der [copyteclipboard](#copytoclipboard) -oder der [DoDragDrop](#dodragdrop) -Member-Funktion in der Zwischenablage platziert würden.

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parameter

*bIncludeLink*<br/>
Legen Sie diese Einstellung auf true fest, wenn Verknüpfungs Daten in die Zwischenablage kopiert werden sollen. Legen Sie diese Einstellung auf "false" fest, wenn die Serveranwendung keine Links unterstützt.

*lpOffset*<br/>
Zeiger auf den Offset des Maus Cursors vom Ursprung des Objekts in Pixel.

*lpSize*<br/>
Ein Zeiger auf die Größe des Objekts in Pixel.

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf ein [COleDataSource](../../mfc/reference/coledatasource-class.md) -Objekt, das die Zwischenablage Daten enthält.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung dieser Funktion ruft [GetClipboardData](#getclipboarddata)auf.

##  <a name="ongetcliprect"></a>COleClientItem:: ongetcliprect

Das Framework ruft die `OnGetClipRect` Member-Funktion auf, um die clippingrechtekoordinaten des Elements zu erhalten, das direkt bearbeitet wird.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parameter

*rClipRect*<br/>
Zeiger auf ein Objekt der Klasse [CRect](../../atl-mfc-shared/reference/crect-class.md) , das die clippingrechtekoordinaten des Elements enthält.

### <a name="remarks"></a>Hinweise

Die Koordinaten befinden sich in Pixel relativ zum Client Bereich des Container Anwendungsfensters.

Die Standard Implementierung gibt einfach das Client Rechteck der Ansicht zurück, für die das Element direkt aktiv ist.

##  <a name="ongetitemposition"></a>COleClientItem:: OnGetItemPosition

Das Framework ruft die `OnGetItemPosition` Member-Funktion auf, um die Koordinaten des Elements zu erhalten, das direkt bearbeitet wird.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parameter

*rPosition*<br/>
Verweis auf das [CRect](../../atl-mfc-shared/reference/crect-class.md) -Objekt, das die Positionskoordinaten des Elements enthält.

### <a name="remarks"></a>Hinweise

Die Koordinaten befinden sich in Pixel relativ zum Client Bereich des Container Anwendungsfensters.

Bei der Standardimplementierung dieser Funktion wird keine Aktion ausgeführt. Anwendungen, die eine direkte Bearbeitung unterstützen, erfordern Ihre Implementierung.

##  <a name="ongetwindowcontext"></a>COleClientItem:: ongetwindowcontext

Wird von Framework aufgerufen, wenn ein Element an Ort und Stelle aktiviert wird.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parameter

*ppMainFrame*<br/>
Zeiger auf einen Zeiger auf das Hauptrahmen Fenster.

*ppDocFrame*<br/>
Zeiger auf einen Zeiger auf das Dokument Rahmen Fenster.

*lpFrameInfo*<br/>
Zeiger auf eine [oleinplaceframeinfo](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) -Struktur, die Rahmen Fenster Informationen empfängt.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Diese Funktion wird verwendet, um Informationen über das übergeordnete Fenster des OLE-Elements abzurufen.

Wenn es sich bei dem Container um eine MDI-Anwendung handelt, gibt die Standard Implementierung einen Zeiger auf das [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) -Objekt in *ppmainframe* und einen Zeiger auf das aktive [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) -Objekt in *ppdocframe*zurück. Wenn der Container eine SDI-Anwendung ist, gibt die Standard Implementierung einen Zeiger auf das [CFrameWnd](../../mfc/reference/cframewnd-class.md) -Objekt in *ppmainframe* zurück und gibt in *ppdocframe*den Wert NULL zurück. Die Standard Implementierung füllt auch die Member von *lpframeinfo*aus.

Überschreiben Sie diese Funktion nur, wenn die Standard Implementierung nicht der Anwendung entspricht. Beispiel: Wenn Ihre Anwendung ein Benutzeroberflächen Paradigma hat, das von SDI oder MDI abweicht. Hierbei handelt es sich um eine erweiterte über schreibbare.

Weitere Informationen finden Sie unter [IOleInPlaceSite:: GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) und die [oleinplaceframeinfo](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) -Struktur in der Windows SDK.

##  <a name="oninsertmenus"></a>COleClientItem:: oninsertmenüs

Wird von Framework während der direkten Aktivierung aufgerufen, um die Menüs der Containeranwendung in ein leeres Menü einzufügen.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parameter

*pMenuShared*<br/>
Verweist auf ein leeres Menü.

*lpMenuWidths*<br/>
Verweist auf ein Array von sechs langen Werten, die angeben, wie viele Menüs in den folgenden Menü Gruppen aufgeführt werden: Datei, bearbeiten, Container, Objekt, Fenster, Hilfe. Die Containeranwendung ist für die Menü Gruppen "Datei", "Container" und "Fenster" zuständig, die den Elementen 0, 2 und 4 dieses Arrays entsprechen.

### <a name="remarks"></a>Hinweise

Dieses Menü wird dann an den Server weitergegeben, der eigene Menüs einfügt und ein zusammengesetztes Menü erstellt. Diese Funktion kann wiederholt aufgerufen werden, um mehrere zusammengesetzte Menüs zu erstellen.

Die Standard Implementierung fügt in *pmenushared* die Menüs für den direkten Container ein. Das heißt, die Menü Gruppen "Datei", "Container" und "Fenster". [CDocTemplate:: setcontainerinfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) wird zum Festlegen dieser Menü Ressource verwendet. In der Standard Implementierung werden den Elementen 0, 2 und 4 in *lpmenubreiten*abhängig von der Menü Ressource auch die entsprechenden Werte zugewiesen. Überschreiben Sie diese Funktion, wenn die Standard Implementierung für Ihre Anwendung nicht geeignet ist. Wenn Ihre Anwendung z. b. keine Dokumentvorlagen zum Zuordnen von Ressourcen zu Dokumenttypen verwendet. Wenn Sie diese Funktion überschreiben, sollten Sie auch [onsetmenu](#onsetmenu) und [onremovemenus](#onremovemenus)überschreiben. Hierbei handelt es sich um eine erweiterte über schreibbare.

Weitere Informationen finden Sie unter [IOleInPlaceFrame:: insertmenüs](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) in der Windows SDK.

##  <a name="onremovemenus"></a>COleClientItem:: onremovemenus

Wird von Framework aufgerufen, um die Menüs des Containers aus dem angegebenen zusammengesetzten Menü zu entfernen, wenn die direkte Aktivierung beendet wird.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parameter

*pMenuShared*<br/>
Verweist auf das zusammengesetzte Menü, das durch Aufrufe der [oninsertmenus](#oninsertmenus) -Member-Funktion erstellt wird.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung entfernt aus *pmenushared* die direkten Container Menüs, d. h. die Menü Gruppen "Datei", "Container" und "Fenster". Überschreiben Sie diese Funktion, wenn die Standard Implementierung für Ihre Anwendung nicht geeignet ist. Wenn Ihre Anwendung z. b. keine Dokumentvorlagen zum Zuordnen von Ressourcen zu Dokumenttypen verwendet. Wenn Sie diese Funktion überschreiben, sollten Sie möglicherweise auch [oninsertmenüs](#oninsertmenus) und [onsetmenu](#onsetmenu) überschreiben. Hierbei handelt es sich um eine erweiterte über schreibbare.

Die Untermenüs von *pmenushared* können von mehr als einem zusammengesetzten Menü gemeinsam genutzt werden, wenn der Server `OnInsertMenus`wiederholt aufgerufen hat. Daher sollten Sie keine Untermenüs in der außer Kraft Setzung von `OnRemoveMenus`löschen. Sie sollten Sie nur trennen.

Weitere Informationen finden Sie unter [IOleInPlaceFrame:: removemenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) in der Windows SDK.

##  <a name="onscrollby"></a>COleClientItem:: onscrollby

Wird von Framework aufgerufen, um durch das OLE-Element in Reaktion auf Anforderungen vom Server einen Bildlauf durchführen zu können

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parameter

*sizeExtent*<br/>
Gibt die Abstände (in Pixel) für den Bildlauf in x-und y-Richtung an.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn für das Element ein Rollup durchgeführt wurde. 0, wenn kein Rollup für das Element ausgeführt werden konnte.

### <a name="remarks"></a>Hinweise

Wenn das OLE-Element z. b. teilweise sichtbar ist und der Benutzer beim Ausführen der direkten Bearbeitung außerhalb des sichtbaren Bereichs wechselt, wird diese Funktion aufgerufen, um den Cursor sichtbar zu machen. Bei der Standardimplementierung wird keine Aktion ausgeführt. Überschreiben Sie diese Funktion, um einen Bildlauf zum angegebenen Betrag durchführen zu können. Beachten Sie, dass sich der sichtbare Teil des OLE-Elements als Ergebnis des Bildlaufs ändern kann. Aufrufen [von](#setitemrects) "", um das sichtbare Rechteck des Elements zu aktualisieren.

Weitere Informationen finden Sie unter [IOleInPlaceSite:: Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) in der Windows SDK.

##  <a name="onsetmenu"></a>COleClientItem:: onsetmenu

Wird von Framework zwei Mal aufgerufen, wenn die direkte Aktivierung beginnt und endet. Wenn Sie das zusammengesetzte Menü zum ersten Mal installieren (bei *holemenu* gleich null), um es zu entfernen.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parameter

*pMenuShared*<br/>
Ein Zeiger auf das zusammengesetzte Menü, das durch Aufrufe der [oninsertmenus](#oninsertmenus) -Member `InsertMenu` -Funktion und der-Funktion erstellt wird.

*holemenu*<br/>
Handle für den von der `OleCreateMenuDescriptor` Funktion zurückgegebenen Menü Deskriptor oder NULL, wenn der Verteiler Code entfernt werden soll.

*hwndActiveObject*<br/>
Handle für das Bearbeitungsfenster des OLE-Elements. Dies ist das Fenster, in dem Bearbeitungsbefehle von OLE empfangen werden.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung installiert oder entfernt das zusammengesetzte Menü und ruft dann die [olesetmenudescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) -Funktion auf, um den Verteiler Code zu installieren oder zu entfernen. Überschreiben Sie diese Funktion, wenn die Standard Implementierung für Ihre Anwendung nicht geeignet ist. Wenn Sie diese Funktion überschreiben, sollten Sie möglicherweise auch [oninsertmenus](#oninsertmenus) und [onremovemenus](#onremovemenus) überschreiben. Hierbei handelt es sich um eine erweiterte über schreibbare.

Weitere Informationen finden Sie unter [olecreatemenudescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [olesetmenudescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)und [IOleInPlaceFrame:: setMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) in der Windows SDK.

##  <a name="onshowcontrolbars"></a>COleClientItem:: onshowcontrolbars

Wird von Framework aufgerufen, um die Steuer leisten der Containeranwendung anzuzeigen und auszublenden.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parameter

*pFrameWnd*<br/>
Zeiger auf das Rahmen Fenster der Containeranwendung. Dabei kann es sich entweder um ein Hauptrahmen Fenster oder um ein untergeordnetes MDI-Fenster handeln.

*bShow*<br/>
Gibt an, ob Steuer leisten angezeigt oder ausgeblendet werden sollen.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn der Funktions Aufrufwert eine Änderung am Zustand der Steuer leisten bewirkt. 0, wenn der-Befehl keine Änderung auslöst, oder, wenn *pframewnd* nicht auf das Rahmen Fenster des Containers zeigt.

### <a name="remarks"></a>Hinweise

Diese Funktion gibt 0 (null) zurück, wenn sich die Steuer leisten bereits in dem von *bShow* angegebenen Zustand befinden. Dies wäre z. b. der Fall, wenn die Steuer leisten ausgeblendet sind und *bShow* den Wert false hat.

Die Standard Implementierung entfernt die Symbolleiste aus dem Rahmen Fenster der obersten Ebene.

##  <a name="onshowitem"></a>COleClientItem:: onshowitem

Wird von Framework aufgerufen, um das OLE-Element anzuzeigen, sodass es während der Bearbeitung vollständig sichtbar wird.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Hinweise

Sie wird verwendet, wenn Ihre Containeranwendung Links zu eingebetteten Elementen unterstützt (d. h., wenn Sie die Dokument Klasse von [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)abgeleitet haben). Diese Funktion wird während der direkten Aktivierung aufgerufen, oder wenn das OLE-Element eine Verknüpfungs Quelle ist und der Benutzer Sie bearbeiten möchte. Die Standard Implementierung aktiviert die erste Ansicht für das Container Dokument. Überschreiben Sie diese Funktion, um das Dokument so zu scrollen, dass das OLE-Element sichtbar ist.

##  <a name="onupdateframetitle"></a>COleClientItem:: onupdateframetitle

Wird von Framework während der direkten Aktivierung aufgerufen, um die Titelleiste des Rahmen Fensters zu aktualisieren.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn diese Funktion den Frame Titel erfolgreich aktualisiert hat, andernfalls NULL.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung ändert den Titel des Rahmen Fensters nicht. Überschreiben Sie diese Funktion, wenn Sie für Ihre Anwendung einen anderen Frame Titel benötigen, z. b. " *Server-App* - -*Element* in *docname*" (wie in "Microsoft Excel-Kalkulations Tabelle" im Bericht. DOC "). Hierbei handelt es sich um eine erweiterte über schreibbare.

##  <a name="reactivateandundo"></a>COleClientItem:: reactivateandundo

Mit dieser Funktion können Sie das OLE-Element reaktivieren und den letzten Vorgang, der vom Benutzer während der direkten Bearbeitung ausgeführt wurde, rückgängig machen.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Wenn die Containeranwendung den Befehl rückgängig unterstützt, rufen Sie diese Funktion auf, wenn der Benutzer sofort nach dem Deaktivieren des OLE-Elements den Befehl rückgängig auswählt.

Wenn die Serveranwendung mit den Microsoft Foundation Class-Bibliotheken geschrieben wird, bewirkt diese Funktion, dass der Server [COleServerDoc:: onreactivateandundo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo)aufruft.

Weitere Informationen finden Sie unter [IOleInPlaceObject:: reactivateandundo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) in der Windows SDK.

##  <a name="release"></a>COleClientItem:: Release

Mit dieser Funktion können Sie Ressourcen bereinigen, die vom OLE-Element verwendet werden.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parameter

*dwCloseOption*<br/>
Flag, das angibt, unter welchen Umständen das OLE-Element beim zurückkehren in den geladenen Zustand gespeichert wird. Eine Liste möglicher Werte finden Sie unter [COleClientItem:: Close](#close).

### <a name="remarks"></a>Hinweise

`Release`wird vom `COleClientItem` Dekonstruktor aufgerufen.

Weitere Informationen finden Sie unter [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) in der Windows SDK.

##  <a name="reload"></a>COleClientItem:: Upload

Schließt und lädt das Element erneut.

```
BOOL Reload();
```

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Aufrufen der `Reload` Funktion nach dem Aktivieren des Elements als Element eines anderen Typs durch einen Aufrufen von [activateas](#activateas).

##  <a name="run"></a>COleClientItem:: Run

Führt die Anwendung aus, die diesem Element zugeordnet ist.

```
void Run();
```

### <a name="remarks"></a>Hinweise

Rufen Sie `Run` die Member-Funktion auf, um die Serveranwendung vor dem Aktivieren des Elements zu starten. Dies erfolgt automatisch durch [aktivieren](#activate) und [DoVerb](#doverb), daher ist es in der Regel nicht erforderlich, diese Funktion aufzurufen. Diese Funktion wird aufgerufen, wenn es erforderlich ist, den Server auszuführen, um vor der Ausführung von [DoVerb](#doverb)ein Element Attribut wie [SetExtent](#setextent)festzulegen.

##  <a name="setdrawaspect"></a>COleClientItem:: setdrawaspect

Ruft die `SetDrawAspect` Member-Funktion auf, um den "Aspekt" oder die Ansicht des Elements festzulegen.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parameter

*nDrawAspect*<br/>
Ein Wert aus der DVASPECT-Enumeration. Dieser Parameter kann einen der folgenden Werte aufweisen:

- DVASPECT_CONTENT Item wird so dargestellt, dass es als eingebettetes Objekt in seinem Container angezeigt werden kann.

- DVASPECT_THUMBNAIL Item wird in einer "Miniaturansicht"-Darstellung gerendert, sodass es in einem Browsertool angezeigt werden kann.

- DVASPECT_ICON Item wird durch ein Symbol dargestellt.

- DVASPECT_DOCPRINT Item wird so dargestellt, als ob es mithilfe des Befehls Drucken aus dem Menü Datei gedruckt wurde.

### <a name="remarks"></a>Hinweise

Der Aspekt gibt an, wie das Element durch [Zeichnen](#draw) gerendert werden soll, wenn der Standardwert für das *ndrawaspect* -Argument der Funktion verwendet wird.

Diese Funktion wird automatisch durch das Symbol "ändern" aufgerufen (und in anderen Dialogfeldern, in denen das Dialogfeld "Symbol ändern" direkt aufgerufen wird), um den Bildschirm Aspekt der Darstellung zu aktivieren, wenn der Benutzer

##  <a name="setextent"></a>COleClientItem:: abtextent

Mit dieser Funktion können Sie angeben, wie viel Speicherplatz für das OLE-Element verfügbar ist.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parameter

*size*<br/>
Ein [CSize](../../atl-mfc-shared/reference/csize-class.md) -Objekt, das die Größen Informationen enthält.

*nDrawAspect*<br/>
Gibt den Aspekt des OLE-Elements an, dessen Begrenzungen festgelegt werden sollen. Mögliche Werte finden Sie unter [setdrawaspect](#setdrawaspect).

### <a name="remarks"></a>Hinweise

Wenn die Serveranwendung mit dem Microsoft Foundation Class-Bibliothek geschrieben wurde, bewirkt dies, dass die [onsetextent](../../mfc/reference/coleserveritem-class.md#onsetextent) -Member- `COleServerItem` Funktion des entsprechenden Objekts aufgerufen wird. Das OLE-Element kann dann seine Anzeige entsprechend anpassen. Die Dimensionen müssen sich in MM_HIMETRIC-Einheiten befinden. Diese Funktion wird aufgerufen, wenn der Benutzer die Größe des OLE-Elements ändert, oder wenn Sie eine Form der layoutaushandlung unterstützen.

Weitere Informationen finden Sie unter [IOleObject:: SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) in der Windows SDK.

##  <a name="sethostnames"></a>COleClientItem:: "abkthostnames"

Mit dieser Funktion können Sie den Namen der Containeranwendung und den Namen des Containers für ein eingebettetes OLE-Element angeben.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parameter

*lpszHost*<br/>
Ein Zeiger auf den Benutzer sichtbaren Namen der Containeranwendung.

*lpszHostObj*<br/>
Zeiger auf eine identifizierende Zeichenfolge des Containers, der das OLE-Element enthält.

### <a name="remarks"></a>Hinweise

Wenn die Serveranwendung mit dem Microsoft Foundation Class-Bibliothek geschrieben wurde, ruft diese Funktion die [onsethostnames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) -Member-Funktion `COleServerDoc` des Dokuments auf, das das OLE-Element enthält. Diese Informationen werden in Fenstertiteln verwendet, wenn das OLE-Element bearbeitet wird. Jedes Mal, wenn ein Container Dokument geladen wird, ruft das Framework diese Funktion für alle OLE-Elemente im Dokument auf. `SetHostNames`ist nur auf eingebettete Elemente anwendbar. Es ist nicht erforderlich, diese Funktion zu jedem Zeitpunkt aufzurufen, wenn ein eingebettetes OLE-Element für die Bearbeitung aktiviert wird.

Dies wird auch automatisch mit dem Anwendungsnamen und dem Dokumentnamen aufgerufen, wenn ein Objekt geladen wird oder wenn eine Datei unter einem anderen Namen gespeichert wird. Dementsprechend ist es normalerweise nicht erforderlich, diese Funktion direkt aufzurufen.

Weitere Informationen finden Sie unter [IOleObject:: sethostnames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) im Windows SDK.

##  <a name="seticonicmetafile"></a>COleClientItem:: "".

Speichert die zum Zeichnen des Element Symbols verwendete Metadatendatei zwischen.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parameter

*hMetaPict*<br/>
Ein Handle für die Metadatendatei, die zum Zeichnen des Element Symbols verwendet wird.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Verwenden Sie [getideicmetafile](#geticonicmetafile) , um die Metadatendatei abzurufen.

Der *hmetapict* -Parameter wird in das-Element kopiert. Daher muss *hmetapict* vom Aufrufer freigegeben werden.

##  <a name="setitemrects"></a>COleClientItem:: "abtitemrects"

Mit dieser Funktion können Sie das umgebende Rechteck oder das sichtbare Rechteck des OLE-Elements festlegen.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parameter

*lprcPosRect*<br/>
Ein Zeiger auf das Rechteck, das die Begrenzungen des OLE-Elements relativ zu seinem übergeordneten Fenster in Client Koordinaten enthält.

*lprcClipRect*<br/>
Ein Zeiger auf das Rechteck, das die Begrenzungen des sichtbaren Teils des OLE-Elements relativ zu seinem übergeordneten Fenster in Client Koordinaten enthält.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn erfolgreich, andernfalls 0 (null).

### <a name="remarks"></a>Hinweise

Diese Funktion wird von der Standard Implementierung der [OnChangeItemPosition](#onchangeitemposition) -Member-Funktion aufgerufen. Diese Funktion sollte immer dann aufgerufen werden, wenn die Position oder der sichtbare Teil des OLE-Elements geändert wird. In der Regel bedeutet dies, dass Sie Sie aus den [OnSize](../../mfc/reference/cwnd-class.md#onsize) -und [onscrollby](../../mfc/reference/cview-class.md#onscrollby) -Element Funktionen Ihrer Ansicht abrufen.

Weitere Informationen finden Sie unter [IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) in der Windows SDK.

##  <a name="setlinkupdateoptions"></a>COleClientItem:: setlinkupdateoptions

Diese Funktion wird aufgerufen, um die Link-Update-Option für die Darstellung des angegebenen verknüpften Elements festzulegen.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parameter

*dwUpdateOpt*<br/>
Der Wert der Link-Update-Option für dieses Element. Dieser Wert muss einer der folgenden Werte sein:

- OLEUPDATE_ALWAYS aktualisieren Sie das verknüpfte Element, wann immer möglich. Diese Option unterstützt das automatische Link-Update-Optionsfeld im Dialogfeld Verknüpfungen.

- OLEUPDATE_ONCALL aktualisiert das verknüpfte Element nur auf Anforderung von der Containeranwendung (wenn die [UpdateLink](#updatelink) -Member-Funktion aufgerufen wird). Diese Option unterstützt das Optionsfeld Manuelles Link-Update im Dialogfeld Verknüpfungen.

### <a name="remarks"></a>Hinweise

In der Regel sollten Sie die vom Benutzer ausgewählten Update Optionen im Dialogfeld Verknüpfungen nicht ändern.

Weitere Informationen finden Sie unter [iolelink:: setupdateoptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) in der Windows SDK.

##  <a name="setprintdevice"></a>COleClientItem:: setprintdevice

Mit dieser Funktion können Sie das druckzielgerät für dieses Element ändern.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parameter

*ptd*<br/>
Zeiger auf eine [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) -Datenstruktur, die Informationen über das neue Druck Zielgerät enthält. Kann NULL sein.

*ppd*<br/>
Zeiger auf eine [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) -Datenstruktur, die Informationen über das neue Druck Zielgerät enthält. Kann NULL sein.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn die Funktion erfolgreich war. andernfalls 0.

### <a name="remarks"></a>Hinweise

Mit dieser Funktion wird das druckzielgerät für das Element aktualisiert, aber der Präsentations Cache wird nicht aktualisiert. Um den Präsentations Cache für ein Element zu aktualisieren, nennen Sie [UpdateLink](#updatelink).

Die Argumente für diese Funktion enthalten Informationen, die das OLE-System verwendet, um das Zielgerät zu identifizieren. Die `PRINTDLG` Struktur enthält Informationen, die Windows verwendet, um das Dialogfeld für den allgemeinen Druck zu initialisieren. Nachdem der Benutzer das Dialogfeld geschlossen hat, gibt Windows Informationen zur Auswahl des Benutzers in dieser Struktur zurück. Der `m_pd` Member eines [CPrintDialog](../../mfc/reference/cprintdialog-class.md) -Objekts ist eine `PRINTDLG` -Struktur.

Weitere Informationen zu dieser Struktur finden Sie unter [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) in der Windows SDK.

Weitere Informationen finden Sie im Windows SDK unter [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) .

##  <a name="updatelink"></a>COleClientItem:: UpdateLink

Mit dieser Funktion können Sie die Präsentationsdaten des OLE-Elements sofort aktualisieren.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Rückgabewert

Bei Erfolg ein Wert ungleich 0 (null), andernfalls 0 (null).

### <a name="remarks"></a>Hinweise

Für verknüpfte Elemente sucht die Funktion die Link Quelle, um eine neue Präsentation für das OLE-Element zu erhalten. Dieser Prozess umfasst möglicherweise die Ausführung einer oder mehrerer Server Anwendungen, die zeitaufwändig sein könnten. Für eingebettete Elemente arbeitet die Funktion rekursiv und überprüft, ob das eingebettete Element links enthält, die möglicherweise veraltet sind, und aktualisiert diese. Der Benutzer kann einzelne Links auch manuell mithilfe des Dialog Felds Links aktualisieren.

Weitere Informationen finden Sie unter [iolelink:: Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) in der Windows SDK.

## <a name="see-also"></a>Siehe auch

[MFC-Beispiel MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[MFC-Beispiel OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[CDocItem-Klasse](../../mfc/reference/cdocitem-class.md)<br/>
[Hierarchiediagramm](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem-Klasse](../../mfc/reference/coleserveritem-class.md)
