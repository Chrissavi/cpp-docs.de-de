---
title: CFileDialog-Klasse | Microsoft-Dokumentation
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
dev_langs:
- C++
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: c681cc5f79d0c9d876da522666565e5a43c8e145
ms.sourcegitcommit: 76fd30ff3e0352e2206460503b61f45897e60e4f
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 07/13/2018
ms.locfileid: "39028004"
---
# <a name="cfiledialog-class"></a>CFileDialog-Klasse
Kapselt das Standarddialogfeld für öffnen oder speichern Operations-Datei verwendet wird.  
  
## <a name="syntax"></a>Syntax  
  
```  
class CFileDialog : public CCommonDialog  
```  
  
## <a name="members"></a>Member  
  
### <a name="public-constructors"></a>Öffentliche Konstruktoren  
  
|Name|Beschreibung|  
|----------|-----------------|  
|[CFileDialog::CFileDialog](#cfiledialog)|Erstellt ein `CFileDialog`-Objekt.|  
  
### <a name="public-methods"></a>Öffentliche Methoden  
  
|Name|Beschreibung|  
|----------|-----------------|  
|[CFileDialog::AddCheckButton](#addcheckbutton)|Das Dialogfeld hinzugefügt eine Kontrollkästchen-Schaltfläche.|  
|[CFileDialog::AddComboBox](#addcombobox)|Das Dialogfeld wird ein Kombinationsfeld hinzugefügt.|  
|[CFileDialog::AddControlItem](#addcontrolitem)|Fügt ein Element zu einem Containersteuerelement im Dialogfeld an.|  
|[CFileDialog::AddEditBox](#addeditbox)|Das Dialogfeld wird ein Bearbeitungsfeld hinzugefügt.|  
|[CFileDialog::AddMenu](#addmenu)|Das Dialogfeld wird ein Menü hinzugefügt.|  
|[CFileDialog::AddPlace](#addplace)|Überladen. Fügt ein Ordner, in der Liste der für den Benutzer zum Öffnen oder speichern die Elemente verfügbar wird.|  
|[CFileDialog::AddPushButton](#addpushbutton)|Das Dialogfeld hinzugefügt eine Schaltfläche.|  
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Das Dialogfeld hinzugefügt eine Option (auch bekannt als Radio Schaltfläche)-Gruppe.|  
|[CFileDialog::AddSeparator](#addseparator)|Fügt ein Trennzeichen zum Dialogfeld "".|  
|[CFileDialog::AddText](#addtext)|Das Dialogfeld wird Text-Inhalt hinzugefügt.|  
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Aktualisiert den Zustand der der `CFileDialog` entsprechend den Parameter und die Flags, die in gespeicherten der `m_ofn` Membervariablen gespeichert.|  
|[CFileDialog::DoModal](#domodal)|Zeigt das Dialogfeld an und ermöglicht dem Benutzer eine Auswahl treffen.|  
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Aktiviert eine Dropdown-Liste auf die **öffnen** oder **speichern** Schaltfläche im Dialogfeld.|  
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Beendet das Hinzufügen von Elementen, die einer Gruppe im Dialogfeld an.|  
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Ruft den aktuellen Zustand einer Schaltfläche mit dem Kontrollkästchen (Kontrollkästchen), in das Dialogfeld ab.|  
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Ruft den aktuellen Status eines Elements in einem Containersteuerelement finden Sie im Dialogfeld ab.|  
|[CFileDialog::GetControlState](#getcontrolstate)|Ruft die aktuelle Sichtbarkeit und aktivierte Status eines bestimmten Steuerelements.|  
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Ruft den aktuellen Text in ein Steuerelement mit Eingabefeld ab.|  
|[CFileDialog::GetFileExt](#getfileext)|Gibt die Erweiterung der ausgewählten Datei zurück.|  
|[CFileDialog::GetFileName](#getfilename)|Gibt den Dateinamen der ausgewählten Datei zurück.|  
|[CFileDialog::GetFileTitle](#getfiletitle)|Gibt den Titel der ausgewählten Datei zurück.|  
|[CFileDialog::GetFolderPath](#getfolderpath)|Ruft den Pfad der aktuell geöffneten Ordner oder das Verzeichnis ab, für eine Explorer-ähnliche **öffnen** oder **speichern** Standarddialogfeld.|  
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Ruft das interne COM-Objekt für eine benutzerdefinierte `CFileDialog` Objekt.|  
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Ruft das interne COM-Objekt für eine `CFileDialog` , dient als ein **öffnen** Dateidialogfeld.|  
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Ruft das interne COM-Objekt für eine `CFileDialog` , dient als ein **speichern** Dateidialogfeld.|  
|[CFileDialog::GetNextPathName](#getnextpathname)|Gibt den vollständigen Pfad der nächsten ausgewählten Datei zurück.|  
|[CFileDialog::GetOFN](#getofn)|Ruft die `OPENFILENAME` Struktur der `CFileDialog` Objekt.|  
|[CFileDialog::GetPathName](#getpathname)|Gibt den vollständigen Pfad der ausgewählten Datei zurück.|  
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Gibt den Status "schreibgeschützt" der ausgewählten Datei zurück.|  
|[CFileDialog::GetResult](#getresult)|Ruft ab, die Auswahl, die der Benutzer im Dialogfeld vorgenommen.|  
|[CFileDialog::GetResults](#getresults)|Ruft die Benutzer ausgewählten in einem Dialogfeld an, die Mehrfachauswahl zulässt.|  
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Ruft ein bestimmtes Element aus dem angegebenen Container der Steuerelemente im Dialogfeld ab.|  
|[CFileDialog::GetStartPosition](#getstartposition)|Gibt die Position des ersten Elements der Liste der Dateinamen zurück.|  
|[CFileDialog::HideControl](#hidecontrol)|Blendet das angegebene Steuerelement in einem Explorer-ähnliche **öffnen** oder **speichern** Standarddialogfeld.|  
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Bestimmt, ob das aktuelle Dialogfeld im ordnerauswahlmodus.|  
|[CFileDialog::MakeProminent](#makeprominent)|Stellen, damit es sich abhebt verglichen, ein Steuerelement im Dialogfeld für andere Steuerelemente hinzugefügt.|  
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Entfernt ein Element aus einem Containersteuerelement im Dialogfeld an.|  
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Legt den aktuellen Status einer Kontrollkästchen-Schaltfläche (Kontrollkästchen) in das Dialogfeld "fest.|  
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Legt den aktuellen Status eines Elements in einem Containersteuerelement finden Sie im Dialogfeld "" fest.|  
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Legt den Text von einem Steuerelement ein Element fest. Beispielsweise der Text, der ein Optionsfeld oder ein Element in einem Menü begleitet.|  
|[CFileDialog::SetControlLabel](#setcontrollabel)|Legt den Text eines Steuerelements, z.B. Text der Schaltfläche oder eine Bezeichnung bearbeiten zugeordnet.|  
|[CFileDialog::SetControlState](#setcontrolstate)|Legt die aktuelle Sichtbarkeit und aktivierte Status eines bestimmten Steuerelements.|  
|[CFileDialog::SetControlText](#setcontroltext)|Legt den Text für das angegebene Steuerelement in einem Explorer-ähnliche **öffnen** oder **speichern** Standarddialogfeld.|  
|[CFileDialog::SetDefExt](#setdefext)|Legt die standardmäßige Dateinamenerweiterung für eine Explorer-ähnliche **öffnen** oder **speichern** Standarddialogfeld.|  
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Legt den aktuellen Text in ein Steuerelement mit Eingabefeld fest.|  
|[CFileDialog::SetProperties](#setproperties)|Bietet einen Eigenschaftenspeicher, der die Standardwerte definiert, die für das zu speichernde Element verwendet werden sollen.|  
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Legt den Auswahlzustand eines bestimmten Elements in einer Optionsfeldgruppe oder ein Kombinationsfeld, finden Sie im Dialogfeld "" fest.|  
|[CFileDialog::SetTemplate](#settemplate)|Legt die Dialogfeldvorlage für die `CFileDialog` Objekt.|  
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Deklariert eine visual Gruppe im Dialogfeld an. Nachfolgende Aufrufe an jede Methode "hinzufügen" hinzufügen die Elemente dieser Gruppe.|  
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Aktualisiert die Daten in die `m_ofn` Membervariable entsprechend den aktuellen Status im Dialogfeld "Datei".|  
  
### <a name="protected-methods"></a>Geschützte Methoden  
  
|Name|Beschreibung|  
|----------|-----------------|  
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Wird aufgerufen, wenn die Schaltfläche geklickt wird.|  
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Wird aufgerufen, wenn Sie dieses Kontrollkästchen aktiviert/deaktiviert ist.|  
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Wird aufgerufen, wenn das Steuerelement aktiv wird.|  
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Verarbeitet die WM_NOTIFY CDN_SELCHANGE-Meldung.|  
|[CFileDialog::OnFileNameOK](#onfilenameok)|Der im Dialogfeld eingegebene Dateiname wird überprüft.|  
|[CFileDialog::OnFolderChange](#onfolderchange)|Verarbeitet die WM_NOTIFY CDN_FOLDERCHANGE-Meldung.|  
|[CFileDialog::OnInitDone](#oninitdone)|Verarbeitet die WM_NOTIFY CDN_INITDONE-Meldung.|  
|[CFileDialog::OnItemSelected](#onitemselected)|Wird aufgerufen, wenn der Container-Element ausgewählt wird.|  
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Können Sie benutzerdefinierte Aktionen durchzuführen, wenn die Dateiauswahl geändert.|  
|[CFileDialog::OnShareViolation](#onshareviolation)|Handles geben Verstöße frei.|  
|[CFileDialog::OnTypeChange](#ontypechange)|Verarbeitet die WM_NOTIFY CDN_TYPECHANGE-Meldung.|  
  
### <a name="public-data-members"></a>Öffentliche Datenmember  
  
|Name|Beschreibung|  
|----------|-----------------|  
|[CFileDialog::m_ofn](#m_ofn)|Die Windows `OPENFILENAME` Struktur. Bietet Zugriff auf Dialogfeld-Basisdatei Parameter.|  
  
## <a name="remarks"></a>Hinweise  
 Datei-Standarddialogfelder können Sie die Dateiauswahl (Dialogfelder), z. B. implementieren **geöffnete Datei** und **speichern**, in einer Weise, die konsistent mit den Windows-Standards ist.  
  
 Sie können `CFileDialog` wie mit dem Konstruktor bereitgestellt wird, oder Sie können Ihre eigenen Dialogfeldklasse von ableiten `CFileDialog` und schreiben ein Konstruktors entsprechend Ihren Anforderungen. In beiden Fällen Aufrufen dieser Dialogfelder verhält sich wie standard-MFC-Dialogfelder, weil sie abgeleitet sind die [CCommonDialog-Klasse](../../mfc/reference/ccommondialog-class.md). `CFileDialog` basiert auf der COMMDLG. DLL-Datei, die in Windows enthalten ist.  
  
 Sowohl die Darstellung und die Funktionalität der `CFileDialog` mit Windows Vista oder höher unterscheiden sich von früheren Versionen von Windows. Der Standardwert `CFileDialog` automatisch die neue Windows Vista oder höher Stil ohne Änderungen am Code verwendet, wenn ein Programm kompilierte und Ausführung unter Windows Vista oder höher ist. Verwenden der *bVistaStyle* Parameter im Konstruktor auf dieses automatische Update manuell zu überschreiben. Die Ausnahme, die automatische Aktualisierung ist die benutzerdefinierte Dialogfelder. Sie werden nicht in das neue Format konvertiert werden. Weitere Informationen zu den Konstruktor, finden Sie unter [CFileDialog::CFileDialog](#cfiledialog).  
  
> [!NOTE]
>  Das Steuerungssystem-ID unterscheidet sich in Windows Vista oder höher aus früheren Versionen von Windows, bei der Verwendung einer `CFileDialog`. Sie müssen alle Verweise auf Aktualisieren `CFileDialog` Steuerelemente im Code, bevor Sie Ihr Projekt aus einer früheren Version von Windows Portieren können.  
  
 Einige `CFileDialog` Methoden werden nicht unterstützt, unter Windows Vista oder höher. Überprüfen Sie die einzelne Methode enthält Informationen zum gibt an, ob die Methode unterstützt wird. Darüber hinaus werden die folgenden geerbten Funktionen unter Windows Vista oder höher nicht unterstützt:  
  
- [CDialog::](../../mfc/reference/cdialog-class.md#oninitdialog)  
  
- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)  
  
 Die Windows-Meldungen für die `CFileDialog` Klasse variieren, je nachdem auf welches Betriebssystem Sie verwenden. Windows XP unterstützt beispielsweise keine [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel) und [CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok) für die `CFileDialog` Klasse. Allerdings Windows Vista und späteren Betriebssystemen werden unterstützt. Weitere Informationen über die unterschiedlichen Nachrichten, die generiert werden und die Reihenfolge, in dem sie empfangen werden, finden Sie unter [CFileDialog-Beispiel: Protokollierung Ereignisreihenfolge](../../visual-cpp-samples.md).  
  
 Verwenden einer `CFileDialog` Objekt, erstellen Sie zuerst mithilfe der `CFileDialog` Konstruktor. Nachdem Sie das Dialogfeld erstellt wurde, können Sie festlegen oder ändern Sie alle Werte in der [CFileDialog::m_ofn](#m_ofn) Struktur, die Werte oder Zustände der Dialogfeld-Steuerelemente initialisieren. Die `m_ofn` Struktur ist vom Typ `OPENFILENAME`. Weitere Informationen finden Sie unter den [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur im Windows SDK.  
  
 Nachdem Sie die Dialogfeld-Steuerelemente initialisieren, rufen die [CFileDialog::DoModal](#domodal) Methode, um die Anzeige des Dialogfelds Feld, damit der Benutzer den Pfad und den Namen eingeben kann. `DoModal` Gibt zurück, ob der Benutzer das OK (IDOK) oder auf die Schaltfläche Abbrechen (IDCANCEL) geklickt hat. Wenn `DoModal` gibt IDOK, können Sie eine der der `CFileDialog` öffentliche Memberfunktionen zum Abrufen der Informationen in versetzt, durch das der Benutzer.  
  
> [!NOTE]
> Unter Windows Vista oder höher, mehrere Aufrufe [IFileDialog::SetFileTypes](http://msdn.microsoft.com/library/windows/desktop/bb775980) verursacht einen Fehler. Der zweite Aufruf von `SetFileTypes` für jede Instanz einer `CFileDialog` E_UNEXPECTED in Windows Vista oder höher zurück. Einige `CFileDialog` Methode-Funktionen rufen `SetFileTypes`. Zum Beispiel zwei Aufrufe von `CFileDialog::DoModal` für dieselbe Instanz von einem `CFileDialog` generiert [ASSERT](diagnostic-services.md#assert).  
  
 `CFileDialog` enthält mehrere geschützte Member, mit denen Sie die benutzerdefinierte Behandlung von Verletzungen der Freigabe, Datei Überprüfung und Listenfeld änderungsbenachrichtigung führen. Diese geschützte Member sind Rückruffunktionen, die meisten Anwendungen nicht verwendet werden, da die Standardbehandlung automatisch ausgeführt wird. Meldungszuordnungseinträge für diese Funktionen sind nicht erforderlich, da sie die standardmäßigen virtuellen Funktionen sind.  
  
 Sie können die Windows [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916) -Funktion zu bestimmen, ob ein während der Initialisierung des Dialogfelds Fehler und Weitere Informationen zum Fehler.  
  
 Die Zerstörung des `CFileDialog` Objekte erfolgt automatisch. Sie müssen keine Aufrufen [CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog).  
  
 Damit der Benutzer, die mehrere Dateien auswählen, legen das Flag OFN_ALLOWMULTISELECT vor dem Aufruf `DoModal`. Sie müssen einen eigene Datei Namen Puffer zur Aufnahme die zurückgegebene Liste der verschiedenen angegebenen Dateinamen angeben. Ersetzen Sie hierzu `m_ofn.lpstrFile` mit einem Zeiger auf einen Puffer Sie zugeordnet haben, wenn Sie erstellt haben, die `CFileDialog`, aber vor dem Aufruf `DoModal`.  
  
 Darüber hinaus müssen Sie festlegen `m_ofn.nMaxFile` mit die Anzahl der Zeichen in den Puffer, der auf `m_ofn.lpstrFile`. Wenn Sie festlegen, dass die maximale Anzahl von Dateien, ausgewählt werden `n`, ist die erforderliche Puffergröße `n * (_MAX_PATH + 1) + 1`. Das erste Element im Puffer zurückgegeben wird, den Pfad zu dem Ordner, in dem die Dateien ausgewählt wurden. Für Windows Vista oder höher-Stil Dialogfelder sind die Zeichenfolgen für die Verzeichnis- und Dateinamen an, Null-terminiert ist, mit einer zusätzlichen Null-Zeichen nach dem Nachnamen-Datei. Dieses Format kann die Explorer-Style-Dialogfelder zur lange Dateinamen zurück, die Leerzeichen enthalten. Für herkömmliche Dialogfelder die Zeichenfolgen für die Verzeichnis- und Dateidienste werden durch Leerzeichen getrennt, und die Funktion verwendet die kurze Dateinamen für den Dateinamen mit Leerzeichen.  
  
 Im folgende Beispiel wird veranschaulicht, so verwenden Sie einen Puffer zum Abrufen und Auflisten von verschiedenen angegebenen Dateinamen.  
  
 [!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]  
  
 Um die Größe des Puffers als Reaktion auf die Auswahl mehrere Dateinamen zu ändern, müssen Sie eine neue Klasse von ableiten `CFileDialog` und überschreiben die [CFileDialog::OnFileNameChange](#onfilenamechange) Methode.  
  
 Wenn Sie eine neue Klasse von ableiten `CFileDialog`, Sie können eine meldungszuordnung verwenden, um alle Meldungen zu verarbeiten. Um die Standardbehandlung für die Nachricht zu erweitern, leiten Sie eine Klasse von `CFileDialog`, eine meldungszuordnung an die neue Klasse hinzufügen, und geben Sie die Member-Funktionen für die neuen Nachrichten. Sie müssen keinen Geben Sie Hook-Funktion, um das Dialogfeld Anpassen zu können.  
  
 Um das Dialogfeld anzupassen, leiten Sie eine Klasse von `CFileDialog`, geben Sie eine benutzerdefinierte Dialogfeldvorlage und hinzufügen eine meldungszuordnung, um die benachrichtigungsmeldungen aus den erweiterten Steuerelementen zu verarbeiten. Übergeben Sie alle nicht verarbeiteten Nachrichten an die Basisklasse der Klasse. Sie müssen nicht die Hookfunktion anpassen.  
  
 Bei Verwendung der Windows Vista oder spätere Darstellung der `CFileDialog`, können keine nachrichtenzuordnungen und Dialogfeldvorlagen. Stattdessen müssen Sie die COM-Schnittstellen für ähnliche Funktionen verwenden.  
  
 Weitere Informationen zur Verwendung von `CFileDialog`, finden Sie unter [allgemeine Dialogfeldklassen](../../mfc/common-dialog-classes.md).  
  
## <a name="inheritance-hierarchy"></a>Vererbungshierarchie  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CDialog](../../mfc/reference/cdialog-class.md)  
  
 [CCommonDialog](../../mfc/reference/ccommondialog-class.md)  
  
 `CFileDialog`  
  
## <a name="requirements"></a>Anforderungen  
 **Header:** afxdlgs.h  
  
##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton  
 Das Dialogfeld hinzugefügt eine Kontrollkästchen-Schaltfläche.  
  
```  
HRESULT AddCheckButton(
    DWORD dwIDCtl,  
    const CString& strLabel,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID der Schaltfläche mit dem Häkchen, hinzugefügt werden soll.  
  
 *strLabel*  
 Der Name des Kontrollkästchen-Schaltfläche.  
  
 *bChecked*  
 Ein boolescher Wert, der angibt, der des aktuellen Zustands der Schaltfläche mit dem Häkchen. TRUE, wenn überprüft wird; "False" andernfalls  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addcombobox"></a>  CFileDialog::AddComboBox  
 Das Dialogfeld wird ein Kombinationsfeld hinzugefügt.  
  
```  
HRESULT AddComboBox(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Kombinationsfelds, hinzugefügt werden soll.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem  
 Fügt ein Element zu einem Containersteuerelement im Dialogfeld an.  
  
```  
HRESULT AddControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Containersteuerelements, das Element hinzugefügt werden soll.  
  
 *dwIDItem*  
 Die ID des Elements.  
  
 *strLabel*  
 Text des Elements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addeditbox"></a>  CFileDialog::AddEditBox  
 Das Dialogfeld wird ein Bearbeitungsfeld hinzugefügt.  
  
```  
HRESULT AddEditBox(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Bearbeitungsfelds, hinzugefügt werden soll.  
  
 *strText*  
 Der Name des bearbeiten-Feld.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addmenu"></a>  CFileDialog::AddMenu  
 Das Dialogfeld wird ein Menü hinzugefügt.  
  
```  
HRESULT AddMenu(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Menüs, hinzugefügt werden soll.  
  
 *strLabel*  
 Der Menüname.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addplace"></a>  CFileDialog::AddPlace  
 Fügt ein Ordner, in der Liste der für den Benutzer zum Öffnen oder speichern die Elemente verfügbar wird.  
  
```  
void AddPlace(
    LPCWSTR lpszFolder,  
    FDAP fdap = FDAP_TOP) throw();

 
void AddPlace(
    IShellItem* psi,  
    FDAP fdap = FDAP_TOP) throw();
```  
  
### <a name="parameters"></a>Parameter  
 *lpszFolder*  
 Ein Pfad zu dem Ordner für dem Benutzer verfügbar gemacht werden. Dies kann nur einem Ordner sein.  
  
 *fdap*  
 Gibt an, in dem Ordner, in der Liste platziert wird.  
  
 *PSI*  
 Ein Zeiger auf ein IShellItem, die den Ordner darstellt, der dem Benutzer zur Verfügung gestellt werden. Dies kann nur einem Ordner sein.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton  
 Das Dialogfeld hinzugefügt eine Schaltfläche.  
  
```  
HRESULT AddPushButton(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID der Schaltfläche hinzufügen.  
  
 *strLabel*  
 Der Name der Schaltfläche.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList  
 Das Dialogfeld hinzugefügt eine Option (auch bekannt als Radio Schaltfläche)-Gruppe.  
  
```  
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID von der Gruppe von Optionsschaltflächen, hinzugefügt werden soll.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addseparator"></a>  CFileDialog::AddSeparator  
 Fügt ein Trennzeichen zum Dialogfeld "".  
  
```  
HRESULT AddSeparator(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Fügen Sie die ID des Trennzeichens hinzu.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addtext"></a>  CFileDialog::AddText  
 Das Dialogfeld hinzugefügt Text.  
  
```  
HRESULT AddText(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Texts, hinzugefügt werden soll.  
  
 *strText*  
 Der Name des Texts.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog  
 Aktualisiert den aktuellen Zustand der der [CFileDialog](../../mfc/reference/cfiledialog-class.md) basierend auf den Werten, die in gespeicherten der `m_ofn` Datenstruktur.  
  
```  
void ApplyOFNToShellDialog();
```  
  
### <a name="remarks"></a>Hinweise  
 In Versionen von Windows vor Windows Vista, das Element [OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx) -Datenstruktur wurde mit dem Status der fortlaufend synchronisiert die `CFileDialog`. Alle Änderungen an der [M_ofn](#m_ofn) Membervariable wurden in den Zustand des Dialogfelds sofort sichtbar. Alle Änderungen in den Zustand des Dialogfelds sofort aktualisieren Sie außerdem die `m_ofn` Membervariablen gespeichert.  
  
 In Windows Vista oder höher, die Werte in der `m_ofn` Membervariable und Status der `CFileDialog` werden nicht unbedingt synchronisiert werden. Diese Funktion erzwingt den Status der `CFileDialog` entsprechend aktualisiert werden die `m_ofn` Struktur. Windows ruft diese Funktion automatisch während der [CFileDialog::DoModal](#domodal).  
  
 Weitere Informationen zur Verwendung der `CFileDialog` Klasse, die unter Windows Vista oder höher finden Sie in [CFileDialog-Klasse](../../mfc/reference/cfiledialog-class.md).  
  
### <a name="example"></a>Beispiel  
  Siehe das Beispiel für [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog).  
  
##  <a name="cfiledialog"></a>  CFileDialog::CFileDialog  
 Rufen Sie diese Funktion zum Erstellen einer standard-Windows-Dateidialogfeld.  
  
```  
explicit CFileDialog(
    BOOL bOpenFileDialog,  
    LPCTSTR lpszDefExt = NULL,  
    LPCTSTR lpszFileName = NULL,  
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,  
    LPCTSTR lpszFilter = NULL,  
    CWnd* pParentWnd = NULL,  
    DWORD dwSize = 0,  
    BOOL bVistaStyle = TRUE);
```  
  
### <a name="parameters"></a>Parameter  
 [in] *bOpenFileDialog*  
 Der Parameter, der angibt, welche Art von Dialogfeld zu erstellen. Legen Sie sie auf "true", erstellen Sie eine **Datei öffnen** Dialogfeld. Legen Sie sie auf "false" zum Erstellen einer **Datei speichern als** Dialogfeld.  
  
 [in] *LpszDefExt*  
 Die Standarddateierweiterung. Wenn der Benutzer nicht (eine, die eine Zuordnung auf dem Computer des Benutzers) bekannte Erweiterung in das Feld Dateiname enthalten ist, die Erweiterung angegeben *LpszDefExt* wird automatisch an den Dateinamen angefügt. Wenn dieser Parameter NULL ist, wird keine Erweiterung angefügt.  
  
 [in] *LpszFileName*  
 Der ursprüngliche Dateiname, der in das Feld Dateiname angezeigt wird. Wenn der Wert NULL ist, wird kein Name für die erste Datei angezeigt.  
  
 [in] *DwFlags*  
 Eine Kombination von ein oder mehrere Flags, die Sie verwenden können, um das Dialogfeld anzupassen. Eine Beschreibung dieser Flags finden Sie in der [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur im Windows SDK. Wenn Sie ändern die `m_ofn.Flags` Member zu strukturieren, verwenden Sie einen bitweisen OR-Operator die Änderungen, um das Standardverhalten unverändert zu lassen.  
  
 [in] *LpszFilter*  
 Eine Reihe von Zeichenfolgenpaare, die Filter angeben, können Sie auf die Datei anwenden. Wenn Sie Filter angeben, werden nur die Dateien, die Filterkriterien in der Liste der Dateien angezeigt. Finden Sie im Abschnitt "Hinweise" Weitere Informationen zum Arbeiten mit Filter.  
  
 [in] *pParentWnd*  
 Ein Zeiger auf das Fenster "übergeordneten" oder "Besitzer" im Dialogfeld "Datei".  
  
 [in] *DwSize*  
 Die Größe der `OPENFILENAME` Struktur. Dieser Wert hängt von der Version des Betriebssystems ab. MFC verwendet diesen Parameter, um zu bestimmen, die geeignete Arten von Dialogfeld zum Erstellen. Die Standardgröße von 0 bedeutet, die die Größe des richtigen Dialogfeld mit der MFC-Code bestimmt basierend auf die Version des Betriebssystems, auf der das Programm ausgeführt wird.  
  
 [in] *bVistaStyle*  
 **Beachten Sie** dieser Parameter ist in Visual Studio 2008 und höher verfügbar und wird dazu führen, dass das Dialogfeld "neue Formatvorlage" verwendet werden, nur dann, wenn Sie in Windows Vista oder höher ausgeführt werden.  
  
 Der Parameter, der den Stil der mit dem Dialogfeld "Datei" angibt. Legen Sie sie auf "true" verwenden die neue Vista-Formatvorlage Dateidialogfelder. Andernfalls wird das alte Format von Dialogfeldern verwendet werden. Finden Sie im Abschnitt "Hinweise" Weitere Informationen zu unter Vista ausgeführt wird.  
  
### <a name="remarks"></a>Hinweise  
 Entweder ein **Datei öffnen** oder **Datei speichern als** Dialogfeld erstellt wird, abhängig vom Wert *bOpenFileDialog*.  
  
 Angeben eines standardmäßigen Erweiterung mit *LpszDefExt* das Verhalten, die Sie erwarten, können nicht erzeugt werden, da es nur selten vorhersagbar ist, welche Erweiterungen dateizuordnungen auf dem Computer des Benutzers verfügen. Wenn Sie mehr Kontrolle über das Anfügen einer Standard-Erweiterung benötigen, können Sie eine eigene Klasse von ableiten `CFileDialog`, und überschreiben die `CFileDialog::OnFileNameOK` Methode, um Ihre eigene Behandlung für die Erweiterung durchzuführen.  
  
 Um den Benutzer zum Auswählen mehrerer Dateien zu aktivieren, legen Sie das Flag OFN_ALLOWMULTISELECT, vor dem Aufruf [DoModal](#domodal). Sie müssen Ihre eigenen Namen Dateipuffer zum Speichern der zurückgegebenen Liste der verschiedenen angegebenen Dateinamen angeben. Ersetzen Sie hierzu `m_ofn.lpstrFile` mit einem Zeiger auf einen Puffer Sie zugeordnet haben, wenn Sie erstellt haben, die [CFileDialog](../../mfc/reference/cfiledialog-class.md), aber vor dem Aufruf `DoModal`. Darüber hinaus müssen Sie festlegen `m_ofn.nMaxFile` mit der Anzahl der Zeichen im Puffer, die auf `m_ofn.lpstrFile`. Wenn Sie festlegen, dass die maximale Anzahl von Dateien, ausgewählt werden *n*, ist die erforderliche Puffergröße `n`*(_MAX_PATH + 1) + 1. Zum Beispiel:  
  
 [!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]  
  
 Um dem Benutzer ein Dialogfeld für die Explorer-ähnliche Größe ändern, indem Sie mithilfe der Maus oder Tastatur zu ermöglichen, müssen festlegen Sie das OFN_ENABLESIZING-Flag. Wenn Sie dieses Flag ist nur erforderlich, wenn Sie einen Hook-Prozedur oder eine benutzerdefinierte Vorlage bereitstellen. Das Flag funktioniert nur mit einem Dialogfeld für die Explorer-ähnliche; Dialogfelder "alten Stil" können nicht geändert werden.  
  
 Die *LpszFilter* Parameter wird verwendet, um zu bestimmen, den Typ des Dateinamens eine Datei, die in der Liste angezeigt werden müssen. Die erste Zeichenfolge im String-Paar wird den Filter beschrieben; die zweite Zeichenfolge gibt an, der Erweiterung verwendet wird. Mehrere Erweiterungen können durch ein Semikolon (';'-Zeichen) als Trennzeichen angegeben werden. Die Zeichenfolge endet mit zwei "&#124;'-Zeichen gefolgt von einem NULL-Zeichen. Sie können auch eine [CString](../../atl-mfc-shared/using-cstring.md) Objekt für diesen Parameter.  
  
 Z. B. [!INCLUDE[ofprexcel](../../mfc/reference/includes/ofprexcel_md.md)] ermöglicht das Öffnen von Dateien, die Erweiterungen .xlc (Diagramm) oder einer XLS (Tabelle), unter anderem. Der Filter für Excel kann folgendermaßen geschrieben werden:  
  
 [!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]  
  
 Allerdings aktualisiert werden, wenn Sie planen, verwenden Sie diese Zeichenfolge direkt die `OPENFILENAME` Struktur, trennen Sie die Zeichenfolgen mit Null-Zeichen "\0", statt die senkrechten Striche ("&#124;").  
  
 Die *bVistaStyle* Parameter gilt nur unter Windows Vista oder höher ausgeführt. Bei früheren Versionen von Windows wird dieser Parameter ignoriert. Wenn *bVistaStyle* auf TRUE festgelegt ist, beim Kompilieren eines Programms mit Visual Studio 2008 oder höher, die neue Vista-Formatvorlage **Dialogfeld "Datei"** verwendet werden. Andernfalls den vorherigen Stil für die MFC- **Dialogfeld "Datei"** verwendet werden.  
  
 Dialogfeldvorlagen werden nicht unterstützt, auf Dialogfeldern basierend auf *bVistaStyle*  
  
### <a name="example"></a>Beispiel  
  Siehe das Beispiel für [CFileDialog::DoModal](#domodal).  
  
##  <a name="domodal"></a>  CFileDialog::DoModal  
 Rufen Sie diese Funktion zum Anzeigen der Windows-Standarddateidialogfelds und ermöglicht dem Benutzer zum Durchsuchen von Dateien und Verzeichnisse, und geben einen Dateinamen ein.  
  
```  
virtual INT_PTR DoModal();
```  
  
### <a name="return-value"></a>Rückgabewert  
 IDOK oder IDCANCEL. Wenn IDCANCEL zurückgegeben wird, rufen Sie die Windows [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916) Funktion, um zu bestimmen, ob ein Fehler aufgetreten ist.  
  
 IDOK und IDCANCEL sind Konstanten, die angeben, ob der Benutzer die Schaltfläche "OK" oder "Abbrechen" aktiviert.  
  
### <a name="remarks"></a>Hinweise  
 Wenn Sie verschiedene Optionen für die im Dialogfeld zu initialisieren, indem Sie Mitglieder festlegen möchten die `m_ofn` Struktur, sollten Sie dies tun, vor dem Aufruf `DoModal`, allerdings nachdem das Dialogfeldobjekt erstellt wird.  
  
 Z. B. Wenn Sie den Benutzer zum Auswählen mehrerer Dateien zulassen möchten, legen Sie das Flag OFN_ALLOWMULTISELECT vor dem Aufruf `DoModal`, wie im Codebeispiel in diesem Thema gezeigt.  
  
 Wenn der Benutzer klickt auf das Dialogfeld OK "oder" Abbrechen ", oder SELECT-Anweisungen schließen über des Dialogfelds option Menü steuern möchten, wird die Steuerung für Ihre Anwendung zurückgegeben. Sie können dann andere Memberfunktionen zum Abrufen der Einstellungen oder die Informationen der Benutzereingaben in das Dialogfeld aufrufen.  
  
 `DoModal` ist eine virtuelle Funktion, die aus der Klasse überschreiben `CDialog`.  
  
### <a name="example"></a>Beispiel  
 [!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]  
  
##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown  
 Können eine Dropdownliste öffnen oder die Schaltfläche im Dialogfeld "Speichern".  
  
```  
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID der Dropdown-Liste.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup  
 Beendet das Hinzufügen von Elementen, die einer Gruppe im Dialogfeld an.  
  
```  
HRESULT EndVisualGroup();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Gibt S_OK zurück, wenn erfolgreich; einen Fehlerwert, die andernfalls.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState  
 Ruft den aktuellen Zustand einer Schaltfläche mit dem Kontrollkästchen (Kontrollkästchen), in das Dialogfeld ab.  
  
```  
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,  
    BOOL& bChecked);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Kontrollkästchens.  
  
 *bChecked*  
 Der Status des Kontrollkästchens. Aktiviert, gibt "true" an. Deaktiviert, gibt "false" an.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState  
 Ruft den aktuellen Status eines Elements in einem Containersteuerelement finden Sie im Dialogfeld ab.  
  
```  
HRESULT GetControlItemState(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    CDCONTROLSTATEF& dwState);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Containersteuerelements.  
  
 *dwIDItem*  
 Die ID des Elements.  
  
 *dwState-Datenmember*  
 Ein Verweis auf eine Variable, die mehrere Werte aus der Enumeration CDCONTROLSTATE empfängt, der den aktuellen Zustand des Steuerelements angibt.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState  
 Ruft die aktuelle Sichtbarkeit und aktivierte Status eines bestimmten Steuerelements.  
  
```  
HRESULT GetControlState(
    DWORD dwIDCtl,  
    CDCONTROLSTATEF& dwState);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Steuerelements.  
  
 *dwState-Datenmember*  
 Ein Verweis auf eine Variable, die einen oder mehrere Werte aus der Enumeration CDCONTROLSTATE empfängt, der den aktuellen Zustand des Steuerelements angibt.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText  
 Ruft den aktuellen Text in ein Steuerelement mit Eingabefeld ab.  
  
```  
HRESULT GetEditBoxText(
    DWORD dwIDCtl,  
    CString& strText);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Bearbeitungsfelds.  
  
 *strText*  
 Der Textwert.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getfileext"></a>  CFileDialog::GetFileExt  
 Rufen Sie diese Funktion zum Abrufen der Erweiterungs des Dateinamens in das Dialogfeld eingegeben haben.  
  
```  
CString GetFileExt() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Die Erweiterung des Dateinamens.  
  
### <a name="remarks"></a>Hinweise  
 Wenn der Name der Datei eingetragen sind z. B. Daten auf. TXT, `GetFileExt` "TXT" zurückgegeben.  
  
 Wenn `m_ofn.Flags` ist das OFN_ALLOWMULTISELECT-Flag festgelegt ist, diese Zeichenfolge enthält eine Sequenz von Null-terminierte Zeichenfolgen, wobei die erste Zeichenfolge, die den Verzeichnispfad der Dateigruppe ausgewählt haben, wird gefolgt von den Namen aller Dateien, die vom Benutzer ausgewählt wurde. Verwenden Sie zum Abrufen der Dateipfadnamen der [GetStartPosition](#getstartposition) und [GetNextPathName](#getnextpathname) Memberfunktionen.  
  
##  <a name="getfilename"></a>  CFileDialog::GetFileName  
 Rufen Sie diese Funktion, um den Namen der im Dialogfeld eingegebene Dateiname abzurufen.  
  
```  
CString GetFileName() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Name der Datei.  
  
### <a name="remarks"></a>Hinweise  
 Der Name der Datei enthält sowohl das Präfix als auch die Erweiterung. Z. B. `GetFileName` gibt "TEXT. Datenzugriffstool"für die Datei C:\FILES\TEXT.DAT.  
  
 Wenn `m_ofn.Flags` hat die `OFN_ALLOWMULTISELECT` flag festgelegt ist, rufen Sie [GetStartPosition](#getstartposition) und [GetNextPathName](#getnextpathname) um einen Dateipfadnamen abzurufen.  
  
##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle  
 Rufen Sie diese Funktion zum Abrufen des Titels der Datei in das Dialogfeld eingegeben haben.  
  
```  
CString GetFileTitle() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Titel der Datei.  
  
### <a name="remarks"></a>Hinweise  
 Der Titel der Datei enthält nur des Präfixes, ohne den Pfad oder die Erweiterung. Z. B. `GetFileTitle` "TEXT" für die Datei C:\FILES\TEXT.DAT zurück.  
  
 Wenn `m_ofn.Flags` ist das OFN_ALLOWMULTISELECT-Flag festgelegt ist, diese Zeichenfolge enthält eine Sequenz von Null-terminierte Zeichenfolgen, wobei die erste Zeichenfolge, die den Verzeichnispfad der Dateigruppe ausgewählt haben, wird gefolgt von den Namen aller Dateien, die vom Benutzer ausgewählt wurde. Aus diesem Grund verwenden die [GetStartPosition](#getstartposition) und [GetNextPathName](#getnextpathname) Memberfunktionen zum nächsten Dateinamen in der Liste abrufen.  
  
### <a name="example"></a>Beispiel  
  Siehe das Beispiel für [CFileDialog::DoModal](#domodal).  
  
##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath  
 Rufen Sie diese Memberfunktion um den Pfad der aktuell geöffneten Ordner oder des Verzeichnisses für eine Explorer-Format öffnen oder Speichern unter Standarddialogfeld abzurufen.  
  
```  
CString GetFolderPath() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein [CString](../../atl-mfc-shared/reference/cstringt-class.md) Objekt, das die aktuell geöffneten Ordner oder das Verzeichnis enthält.  
  
### <a name="remarks"></a>Hinweise  
 Das Dialogfeld muss im Format OFN_EXPLORER erstellt worden sein; Andernfalls schlägt die Methode mit einer Assertion fehl.  
  
 Sie können diese Methode aufrufen, nur, solange Sie das Dialogfeld angezeigt wird. Nachdem Sie das Dialogfeld geschlossen wurde, diese Funktion wird nicht mehr funktionieren, und die Methode schlägt fehl, mit der eine Assertion.  
  
##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize  
 Ruft einen Zeiger auf das interne COM-Objekt für einen bestimmten [CFileDialog](../../mfc/reference/cfiledialog-class.md).  
  
```  
IFileDialogCustomize* GetIFileDialogCustomize();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Zeiger auf das interne COM-Objekt, für die `CFileDialog`. Es ist Ihre Aufgabe, die diesen Zeiger freizugeben, entsprechend.  
  
### <a name="remarks"></a>Hinweise  
 Verwenden Sie diese Funktion nur unter Windows Vista oder höher mit der ein Objekt mit *bVistaStyle* auf "true" festgelegt. Wenn Sie diese Funktion verwenden beim *bVistaStyle* false festgelegt ist, wird NULL im Releasemodus zurück und löst eine Assertion im Debugmodus befindet.  
  
 Weitere Informationen zu den `IFileDialogCustomize` Benutzeroberfläche, siehe [IFileDialogCustomize](http://msdn.microsoft.com/library/windows/desktop/bb775912).  
  
### <a name="example"></a>Beispiel  
 In diesem Beispiel ruft das interne COM-Objekt ab. Um dieses Codebeispiel ausführen zu können, müssen Sie es unter Windows Vista oder höher kompilieren.  
  
 [!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]  
  
##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog  
 Ruft einen Zeiger auf das interne COM-Objekt für einen bestimmten `CFileDialog`.  
  
```  
IFileOpenDialog* GetIFileOpenDialog();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Zeiger auf das interne COM-Objekt, für die `CFileDialog`. Es ist Ihre Aufgabe, die diesen Zeiger freizugeben, entsprechend.  
  
### <a name="remarks"></a>Hinweise  
 Verwenden Sie diese Funktion nur unter Windows Vista oder höher mit der ein Objekt mit *bVistaStyle* auf "true" festgelegt. Diese Funktion gibt NULL zurück, wenn die `CFileDialog` kein **öffnen** Dialogfeld oder, wenn *bVistaStyle* auf "false" festgelegt ist. In diesem letzten Fall die Funktion nur gibt NULL zurück, im Releasemodus - im Debugmodus befinden, löst es eine Assertion.  
  
 Weitere Informationen zu den `IFileOpenDialog` Benutzeroberfläche, siehe [IFileOpenDialog](http://msdn.microsoft.com/library/windows/desktop/bb775834).  
  
### <a name="example"></a>Beispiel  
 In diesem Beispiel ruft das interne COM-Objekt ab. Um diesen Code auszuführen, müssen Sie es unter Windows Vista oder höher kompilieren.  
  
 [!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]  
  
##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog  
 Ruft einen Zeiger auf das interne COM-Objekt für einen bestimmten `CFileDialog`.  
  
```  
IFileSaveDialog* GetIFileSaveDialog();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Zeiger auf das interne COM-Objekt, für die `CFileDialog`. Es ist Ihre Aufgabe, die diesen Zeiger freizugeben, entsprechend.  
  
### <a name="remarks"></a>Hinweise  
 Verwenden Sie diese Funktion nur unter Windows Vista oder höher mit der ein Objekt mit *bVistaStyle* auf "true" festgelegt. Diese Funktion gibt NULL zurück, wenn die `CFileDialog` keine **speichern** Dialogfeld oder, wenn *bVistaStyle* auf "false" festgelegt ist. In diesem letzten Fall die Funktion nur gibt NULL zurück, im Releasemodus - im Debugmodus befinden, löst es eine Assertion.  
  
 Weitere Informationen zu den `IFileSaveDialog` Benutzeroberfläche, siehe [IFileSaveDialog](http://msdn.microsoft.com/library/windows/desktop/bb775688).  
  
### <a name="example"></a>Beispiel  
 In diesem Beispiel ruft das interne COM-Objekt ab. Um dieses Codebeispiel ausführen zu können, müssen Sie es unter Windows Vista oder höher kompilieren.  
  
 [!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]  
  
##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName  
 Rufen Sie diese Funktion zum Abrufen des nächsten Dateinamens aus der Gruppe, die Sie im Dialogfeld ausgewählt.  
  
```  
CString GetNextPathName(POSITION& pos) const;  
```  
  
### <a name="parameters"></a>Parameter  
 *POS*  
 Ein Verweis auf eine Positionswert, der von einem vorherigen zurückgegebene `GetNextPathName` oder `GetStartPosition` Funktionsaufruf. NULL, wenn das Ende der Liste erreicht wird.  
  
### <a name="return-value"></a>Rückgabewert  
 Der vollständige Pfad der Datei.  
  
### <a name="remarks"></a>Hinweise  
 Der Pfad der der Dateiname enthält den Titel der Datei sowie den gesamten Pfad. Z. B. `GetNextPathName` gibt "C:\FILES\TEXT. Datenzugriffstool"für die Datei C:\FILES\TEXT.DAT. Sie können `GetNextPathName` in einer Schleife Vorwärtsiteration, wenn Sie die ursprüngliche Position mit einem Aufruf von einrichten `GetStartPosition`.  
  
 Wenn die Auswahl aus nur einer Datei besteht, wird dieser Dateiname zurückgegeben werden.  
  
##  <a name="getofn"></a>  CFileDialog::GetOFN  
 Ruft das zugeordnete `OPENFILENAME` Struktur.  
  
```  
const OPENFILENAME& GetOFN() const;  
  
OPENFILENAME& GetOFN();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur.  
  
### <a name="remarks"></a>Hinweise  
 Verwenden Sie die zweite Version dieser Funktion, um die Darstellung der initialisieren eine **Datei öffnen** oder **Datei speichern unter** Dialogfeld angezeigt, nachdem es erstellt wurde, aber vor der Anzeige mit der `DoModal` Member-Funktion. Sie können z. B. Festlegen der `lpstrTitle` Mitglied `m_ofn` auf die Beschriftung im Dialogfeld haben sollen.  
  
##  <a name="getpathname"></a>  CFileDialog::GetPathName  
 Rufen Sie diese Funktion zum Abrufen des vollständigen Pfads der Datei in das Dialogfeld eingegeben haben.  
  
```  
CString GetPathName() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der vollständige Pfad der Datei.  
  
### <a name="remarks"></a>Hinweise  
 Der Pfad der der Dateiname enthält den Titel der Datei sowie den gesamten Pfad. Z. B. `GetPathName` gibt "C:\FILES\TEXT. Datenzugriffstool"für die Datei C:\FILES\TEXT.DAT.  
  
 Wenn `m_ofn.Flags` ist das OFN_ALLOWMULTISELECT-Flag festgelegt ist, diese Zeichenfolge enthält eine Sequenz von Null-Teminated gefolgt Zeichenfolgen, wobei die erste Zeichenfolge, die den Verzeichnispfad der Dateigruppe ausgewählt haben, werden die Namen aller Dateien, die vom Benutzer ausgewählt wurde. Aus diesem Grund verwenden die [GetStartPosition](#getstartposition) und [GetNextPathName](#getnextpathname) Memberfunktionen zum nächsten Dateinamen in der Liste abrufen.  
  
### <a name="example"></a>Beispiel  
  Siehe das Beispiel für [CFileDialog::DoModal](#domodal).  
  
##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref  
 Rufen Sie diese Funktion, um zu bestimmen, ob nur lesen Sie das Kontrollkästchen in den Windows-standard-Datei öffnen und Datei speichern unter Dialogfeldern ausgewählt wurde.  
  
```  
BOOL GetReadOnlyPref() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich NULL, wenn Sie im Dialogfeld das Kontrollkästchen Schreibgeschützt aktiviert ist; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Sie können nur lesen Sie das Kontrollkästchen ausblenden, indem Sie den OFN_HIDEREADONLY Stil festlegen, in der `CFileDialog` Konstruktor.  
  
> [!NOTE]
> Windows Vista oder höher Stil `CFileDialog` Objekte unterstützen diese Funktion nicht. Es wird versucht, diese Funktion auf einem Windows Vista oder höher Stil verwenden `CFileDialog` löst [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).   
  
##  <a name="getresult"></a>  CFileDialog::GetResult  
 Ruft ab, die Auswahl, die der Benutzer im Dialogfeld vorgenommen.  
  
```  
IShellItem* GetResult() throw();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Zeiger auf ein IShellItem, die die Auswahl des Benutzers darstellt.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getresults"></a>  CFileDialog::GetResults  
 Ruft ab, der Benutzerauswahl in einem Dialogfeld an, die Mehrfachauswahl zulässt.  
  
```  
IShellItemArray* GetResults() throw();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Zeiger auf ein IShellItemArray über die im Dialogfeld für die ausgewählten Elemente zugegriffen werden können.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem  
 Ruft ein bestimmtes Element aus dem angegebenen Container-Steuerelement im Dialogfeld ab.  
  
```  
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,  
    DWORD& dwIDItem);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Containersteuerelements.  
  
 *dwIDItem*  
 Die ID des Elements, das der Benutzer im Steuerelement ausgewählt werden soll.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition  
 Rufen Sie diese Memberfunktion, um die Position des ersten Dateipfadnamens in der Liste abzurufen, wenn `m_ofn.Flags` das OFN_ALLOWMULTISELECT-Flag festgelegt wurde.  
  
```  
POSITION GetStartPosition() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Positionswert, der zur Iteration verwendet werden kann. NULL, wenn die Liste leer ist.  
  
##  <a name="hidecontrol"></a>  CFileDialog::HideControl  
 Rufen Sie diese Memberfunktion, um das angegebene Steuerelement in einem Explorer-Format öffnen oder Speichern unter Allgemeine Dialogfeld auszublenden.  
  
```  
void HideControl(int nID);
```  
  
### <a name="parameters"></a>Parameter  
 *nID*  
 Die ID des Steuerelements ausgeblendet werden soll.  
  
### <a name="remarks"></a>Hinweise  
 Das Dialogfeld muss im Format OFN_EXPLORER erstellt worden sein; Andernfalls schlägt die Funktion mit einer Assertion fehl.  
  
##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode  
 Bestimmt, ob das aktuelle Dialogfeld im ordnerauswahlmodus ist.  
  
```  
BOOL IsPickFoldersMode() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 True, wenn das Dialogfeld im ordnerauswahlmodus. andernfalls "false".  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="m_ofn"></a>  CFileDialog::m_ofn  
 `m_ofn` ist eine Struktur vom Typ `OPENFILENAME`. Die Daten in dieser Struktur entspricht dem aktuellen Zustand von der `CFileDialog`.  
  
### <a name="remarks"></a>Hinweise  
 Verwenden Sie diese Struktur, um die Darstellung der Initialisieren einer **Datei öffnen** oder **Datei speichern als** Dialogfeld nach der Erstellung, aber bevor Sie ihn mit Anzeigen der [DoModal](#domodal) Methode. Sie können z. B. Festlegen der *LpstrTitle* Mitglied `m_ofn` auf die Beschriftung im Dialogfeld haben sollen.  
  
 Mit dem Windows Vista oder höher Stil der [CFileDialog](../../mfc/reference/cfiledialog-class.md), `m_ofn` entspricht nicht unbedingt immer den Zustand des Dialogfelds. Es wird mit dem Dialogfeld in früheren Versionen von Windows synchronisiert werden. Finden Sie unter [CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog) und [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog) für Weitere Informationen zum Synchronisieren der `m_ofn` Struktur und die `CFileDialog` Zustand unter Windows Vista oder höher.  
  
 Windows Vista oder höher Stil Dateidialogfelder unterstützen keine bestimmte Elemente und die Flags der `CFileDialog`. Daher müssen diese keine Auswirkungen.  
  
 Im folgenden finden eine Liste der Member, die von Windows Vista oder höher nicht unterstützt werden:  
  
- `lpstrCustomFilter`  
  
- `lpstrInitialDir`  
  
- `lCustData`  
  
- `lpfnHook`  
  
- `lpTemplateName`  
  
 Die folgenden Flags werden nicht unterstützt und daher wirken sich nicht bei der Verwendung der Windows Vista oder höher Stil der `CFileDialog`:  
  
-   OFN_ENABLEHOOK  
  
-   OFN_ENABLEINCLUDENOTIFY  
  
-   OFN_ENABLETEMPLATE  
  
-   OFN_ENABLETEMPLATEHANDLE  
  
-   OFN_EXPLORER  
  
-   OFN_EXTENSIONDIFFERENT  
  
-   OFN_HIDEREADONLY  
  
-   OFN_LONGNAMES - effektiv immer auf in Windows Vista oder höher  
  
-   OFN_NOLONGNAMES - deaktiviert effektiv immer, in Windows Vista oder höher  
  
-   OFN_NONETWORKBUTTON - effektiv immer auf in Windows Vista oder höher  
  
-   OFN_READONLY  
  
-   OFN_SHOWHELP  
  
 Weitere Informationen zu dieser Struktur finden Sie unter den [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur im Windows SDK.  
  
##  <a name="makeprominent"></a>  CFileDialog::MakeProminent  
 Stellen, damit es sich abhebt ein Steuerelements im Dialogfeld für die zu anderen Steuerelementen verglichen.  
  
```  
HRESULT MakeProminent(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Steuerelements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked  
 Wird aufgerufen, wenn die Schaltfläche geklickt wird.  
  
```  
virtual void OnButtonClicked(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID der Schaltfläche.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled  
 Wird aufgerufen, wenn Sie dieses Kontrollkästchen aktiviert oder deaktiviert ist.  
  
```  
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Kontrollkästchens.  
  
 *bChecked*  
 Aktiviert oder deaktiviert.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating  
 Wird aufgerufen, wenn das Steuerelement aktiviert ist.  
  
```  
virtual void OnControlActivating(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Steuerelements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange  
Überschreiben Sie diese Methode, wenn Sie die WM_NOTIFY CDN_SELCHANGE-Meldung zu behandeln möchten.  
  
```  
virtual void OnFileNameChange();
```  
  
### <a name="remarks"></a>Hinweise  
 Das System sendet die CDN_SELCHANGE-Meldung, wenn der Benutzer eine neue Datei oder einen Ordner in der Dateiliste des auswählt der **öffnen** oder **speichern** Dialogfeld. Überschreiben Sie diese Methode, wenn Sie Aktionen als Reaktion auf diese Nachricht ausführen möchten.  
  
 Das System sendet diese Nachricht nur, wenn das Dialogfeld mit dem OFN_EXPLORER-Flag aktiviert wurde. Weitere Informationen zu die Benachrichtigung, finden Sie unter [CDN_SELCHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646865). Informationen über das Flag OFN_EXPLORER, finden Sie unter den [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur und [öffnen und speichern Sie als Dialogfelder](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK  
 Überschreiben Sie diese Funktion nur, wenn Sie möchten benutzerdefinierte Validierung des Dateinamen angeben, die in einem Standarddialogfeld Datei eingegeben werden.  
  
```  
virtual BOOL OnFileNameOK();
```  
  
### <a name="return-value"></a>Rückgabewert  
 1, wenn der Dateiname nicht um einen gültigen Dateinamen ist; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Diese Funktion können Sie einen Dateinamen anwendungsspezifischen Gründen abzulehnen. In der Regel müssen Sie nicht diese Funktion zu verwenden, da das Framework bietet die standardüberprüfung von Dateinamen und zeigt ein Meldungsfeld an, wenn ein ungültiger Dateiname eingegeben wird.  
  
 Wenn 1 zurückgegeben wird, bleibt das Dialogfeld für den Benutzer zur Eingabe von einem anderen Dateinamen angezeigt. Die Dialogfeldprozedur schließt das Dialogfeld, wenn der Rückgabewert 0 ist. Andere ungleich NULL-Rückgabewerte sind derzeit reserviert und sollte nicht verwendet werden.  
  
##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange  
 Überschreiben Sie diese Funktion, um die WM_NOTIFYCDN_FOLDERCHANGE-Meldung zu behandeln.  
  
```  
virtual void OnFolderChange();
```  
  
### <a name="remarks"></a>Hinweise  
 Die Benachrichtigung wird gesendet, wenn im Dialogfeld Öffnen oder Speichern unter ein neuer Ordner geöffnet wird.  
  
 Die Benachrichtigung wird nur dann, wenn das Dialogfeld mit den OFN_EXPLORER Stil erstellt wurde. Weitere Informationen zu die Benachrichtigung, finden Sie unter [CDN_FOLDERCHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646859). Informationen zu den OFN_EXPLORER-Stil, finden Sie unter den [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur und [öffnen und speichern Sie als Dialogfelder](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
##  <a name="oninitdone"></a>  CFileDialog::OnInitDone  
 Überschreiben Sie diese Funktion, um die WM_NOTIFY CDN_INITDONE-Meldung zu behandeln.  
  
```  
virtual void OnInitDone();
```  
  
### <a name="remarks"></a>Hinweise  
 Das System sendet diese Benachrichtigung, wenn das System abgeschlossen ist, Anordnen von Steuerelementen in der **öffnen** oder **speichern** im Dialogfeld, um Platz für die Steuerelemente im Dialogfeld "untergeordneten" zu machen.  
  
 Das System sendet dieses nur dann, wenn das Dialogfeld mit den OFN_EXPLORER Stil erstellt wurde. Weitere Informationen zu die Benachrichtigung, finden Sie unter [CDN_INITDONE](http://msdn.microsoft.com/library/windows/desktop/ms646863). Informationen zu den OFN_EXPLORER-Stil, finden Sie unter den [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur und [öffnen und speichern Sie als Dialogfelder](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
> [!NOTE]
> Windows Vista oder höher Stil Dateidialogfelder unterstützen diese Funktion nicht. Es wird versucht, diese Funktion auf einem Windows Vista oder höher Stil Dialogfeld "Datei" verwenden, löst [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). 
  
##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected  
 Wird aufgerufen, wenn der Containerelement ausgewählt ist.  
  
```  
virtual void OnItemSelected(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Containersteuerelements.  
  
 *dwIDItem*  
 Die ID des Elements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify  
 Diese Funktion wird aufgerufen, wenn die aktuelle Auswahl in einem Listenfeld geändert wird.  
  
```  
virtual void OnLBSelChangedNotify(
    UINT nIDBox,  
    UINT iCurSel,  
    UINT nCode);
```  
  
### <a name="parameters"></a>Parameter  
 *nIDBox*  
 Die ID des das Listenfeld oder Kombinationsfeld, in dem die Markierung auftrat.  
  
 *iCurSel*  
 Der Index der aktuellen Auswahl.  
  
 *nCode*  
 Der Code für den Steuerelement-Benachrichtigung. Dieser Parameter muss einen der folgenden Werte aufweisen:  
  
- Gibt an, CD_LBSELCHANGE *iCurSel* das ausgewählte Element in einem Mehrfachauswahl-Listenfeld.  
  
- CD_LBSELSUB gibt an, dass *iCurSel* nicht mehr in einem Mehrfachauswahl-Listenfeld ausgewählt ist.  
  
- CD_LBSELADD gibt an, dass *iCurSel* in einem Mehrfachauswahl-Listenfeld ausgewählt ist.  
  
- CD_LBSELNOITEMS gibt an, die in einem Mehrfachauswahl-Listenfeld keine Auswahl vorhanden ist.  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion, um die benutzerdefinierte Behandlung von Änderungen der Auswahl im Listenfeld bereitzustellen. Beispielsweise können Sie diese Funktion die Zugriffsrechten anzuzeigen, oder Datum-letzten Änderung der einzelnen Dateien der Benutzer auswählt.  
  
##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation  
 Überschreiben Sie diese Funktion, um die benutzerdefinierte Behandlung von Verletzungen der Freigabe bereitzustellen.  
  
```  
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```  
  
### <a name="parameters"></a>Parameter  
 *lpszPathName*  
 Der Pfad der Datei auf der der freigabeverletzung aufgetreten ist.  
  
### <a name="return-value"></a>Rückgabewert  
 Einer der folgenden Werte:  
  
- OFN_SHAREFALLTHROUGH der Dateiname wird im Dialogfeld zurückgegeben.  
  
- OFN_SHARENOWARN keine weitere Aktion muss ausgeführt werden.  
  
- OFN_SHAREWARN der Benutzer erhält die standardwarnmeldung angezeigt für diesen Fehler.  
  
### <a name="remarks"></a>Hinweise  
 In der Regel müssen Sie nicht diese Funktion zu verwenden, da das Framework stellt Überprüfung Verstöße gegen die Freigabe und zeigt ein Meldungsfeld an, wenn eine freigabeverletzung auftritt.  
  
 Wenn Sie die Freigabe Verstoß Überprüfung deaktivieren möchten, verwenden Sie die bitweisen OR-Operator, um das Flag OFN_SHAREAWARE kombinieren mit `m_ofn.Flags`.  
  
##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange  
 Überschreiben Sie diese Funktion, um die WM_NOTIFYCDN_TYPECHANGE-Meldung zu behandeln.  
  
```  
virtual void OnTypeChange();
```  
  
### <a name="remarks"></a>Hinweise  
 Die Benachrichtigung wird gesendet, wenn der Benutzer einen neuen Dateityp aus der Liste der Dateitypen öffnen oder im Dialogfeld Speichern unter auswählt.  
  
 Die Benachrichtigung wird nur dann, wenn das Dialogfeld mit den OFN_EXPLORER Stil erstellt wurde. Weitere Informationen zu die Benachrichtigung, finden Sie unter [CDN_TYPECHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646868). Informationen zu den OFN_EXPLORER-Stil, finden Sie unter den [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur und [öffnen und speichern Sie als Dialogfelder](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem  
 Entfernt ein Element aus einem Containersteuerelement im Dialogfeld an.  
  
```  
HRESULT RemoveControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Containersteuerelements auf das Element entfernt werden soll.  
  
 *dwIDItem*  
 Die ID des Elements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState  
 Legt den aktuellen Status einer Kontrollkästchen-Schaltfläche (Kontrollkästchen) in das Dialogfeld "fest.  
  
```  
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Kontrollkästchens.  
  
 *bChecked*  
 Der Status des Kontrollkästchens. Aktiviert, gibt "true" an. FALSE gibt an, deaktiviert.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState  
 Legt den aktuellen Status eines Elements in einem Containersteuerelement finden Sie im Dialogfeld "" fest.  
  
```  
HRESULT SetControlItemState(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    CDCONTROLSTATEF dwState);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Containersteuerelements.  
  
 *dwIDItem*  
 Die ID des Elements.  
  
 *dwState-Datenmember*  
 Eine oder mehrere Werte aus der CDCONTROLSTATE-Enumeration, die den neuen Zustand des Steuerelements angeben.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText  
 Legt den Text von einem Steuerelement ein Element fest. Beispielsweise der Text, der ein Optionsfeld oder ein Element in einem Menü begleitet.  
  
```  
HRESULT SetControlItemText(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Containersteuerelements.  
  
 *dwIDItem*  
 Die ID des Elements.  
  
 *strLabel*  
 Text des Elements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel  
 Legt den Text eines Steuerelements, z.B. Text der Schaltfläche oder eine Bezeichnung bearbeiten zugeordnet.  
  
```  
HRESULT SetControlLabel(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Steuerelements.  
  
 *strLabel*  
 Der Name des Steuerelements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState  
 Legt die aktuelle Sichtbarkeit und aktivierte Status eines bestimmten Steuerelements.  
  
```  
HRESULT SetControlState(
    DWORD dwIDCtl,  
    CDCONTROLSTATEF dwState);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Steuerelements.  
  
 *dwState-Datenmember*  
 Eine oder mehrere Werte aus der CDCONTROLSTATE-Enumeration, die den aktuellen Zustand des Steuerelements angeben.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setcontroltext"></a>  CFileDialog::SetControlText  
 Rufen Sie diese Methode zum Festlegen von des Texts für das angegebene Steuerelement in einem Explorer-ähnliche **öffnen** oder **speichern** Dialogfeld.  
  
```  
void SetControlText(
    int nID,  
    LPCSTR lpsz);

 
void SetControlText(
    int nID,  
    const wchar_t *lpsz);
```  
  
### <a name="parameters"></a>Parameter  
 [in] *nID*  
 Die ID des Steuerelements für die den Text festgelegt.  
  
 [in] *Lpsz*  
 Ein Zeiger auf die Zeichenfolge, die Text enthält, der für das Steuerelement festgelegt.  
  
### <a name="remarks"></a>Hinweise  
 Beide Versionen dieser Funktion gelten für Anwendungen, die Unicode verwenden. Nur die Version mit dem Typ LPCSTR ist jedoch gültig für Anwendungen mit [!INCLUDE[vcpransi](../../atl-mfc-shared/reference/includes/vcpransi_md.md)].  
  
 Um diese Methode verwenden zu können, müssen Sie das Dialogfeld mit dem OFN_EXPLORER-Stil erstellen. Andernfalls schlägt die Funktion mit einer Assertion fehl.  
  
##  <a name="setdefext"></a>  CFileDialog::SetDefExt  
 Rufen Sie diese Funktion, um die standardmäßige Dateinamenerweiterung für eine Explorer-Format öffnen oder Speichern unter Standarddialogfeld festgelegt.  
  
```  
void SetDefExt(LPCSTR lpsz);
```  
  
### <a name="parameters"></a>Parameter  
 *lpsz*  
 Ein Zeiger auf eine Zeichenfolge, enthält die standarderweiterung für die Dialogfeldobjekt verwenden. Diese Zeichenfolge darf keinen Punkt (.) enthalten.  
  
### <a name="remarks"></a>Hinweise  
 Das Dialogfeld muss im Format OFN_EXPLORER erstellt worden sein; Andernfalls schlägt die Funktion mit einer Assertion fehl.  
  
##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText  
 Legt den aktuellen Text in ein Steuerelement mit Eingabefeld fest.  
  
```  
HRESULT SetEditBoxText(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Bearbeitungsfelds.  
  
 *strText*  
 Der Textwert.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setproperties"></a>  CFileDialog::SetProperties  
 Bietet einen Eigenschaftenspeicher, der die Standardwerte definiert, die für das zu speichernde Element verwendet werden sollen.  
  
```  
BOOL SetProperties(LPCWSTR lpszPropList);
```  
  
### <a name="parameters"></a>Parameter  
 *lpszPropList*  
 Eine Liste der vordefinierten Eigenschaften, die durch ein ";" voneinander getrennt sind. Eine Liste der Flags, finden Sie unter den **Flags** Abschnitt [OPENFILENAME](http://msdn.microsoft.com/8cecfd45-f7c1-4f8d-81a0-4e7fecc3b104).  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem  
 Legt den Auswahlzustand eines bestimmten Elements in einer Optionsfeldgruppe oder ein Kombinationsfeld, finden Sie im Dialogfeld "" fest.  
  
```  
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID des Containersteuerelements.  
  
 *dwIDItem*  
 Die ID des Elements, das der Benutzer im Steuerelement ausgewählt werden soll.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="settemplate"></a>  CFileDialog::SetTemplate  
 Legt die Dialogfeldvorlage für die [CFileDialog](../../mfc/reference/cfiledialog-class.md) Objekt.  
  
```  
void SetTemplate(
    UINT nWin3ID,  
    UINT nWin4ID);

 
void SetTemplate(
    LPCTSTR lpWin3ID,  
    LPCTSTR lpWin4ID);
```  
  
### <a name="parameters"></a>Parameter  
 [in] *nWin3ID*  
 Enthält die ID der Dialogfeldvorlagen-Ressource für den Explorer `CFileDialog` Objekt. Mit dieser Vorlage wird nur verwendet, auf Windows NT 3.51 oder wenn der Stil OFN_EXPLORER nicht vorhanden ist.  
  
 [in] *nWin4ID*  
 Enthält die ID der Dialogfeldvorlagen-Ressource für den Explorer `CFileDialog` Objekt. Diese Vorlage dient nur für [!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)] und höher, Windows 95 und höher, oder wenn der Stil OFN_EXPLORER vorhanden ist.  
  
 [in] *lpWin3ID*  
 Enthält den Namen der Dialogfeldvorlagen-Ressource für den Explorer `CFileDialog` Objekt. Mit dieser Vorlage wird nur verwendet, auf Windows NT 3.51 oder wenn der Stil OFN_EXPLORER nicht vorhanden ist.  
  
 [in] *lpWin4ID*  
 Enthält den Namen der Dialogfeldvorlagen-Ressource des Explorers `CFileDialog` Objekt. Diese Vorlage dient nur für [!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)] und höher, Windows 95 und höher, oder wenn der Stil OFN_EXPLORER vorhanden ist.  
  
### <a name="remarks"></a>Hinweise  
 Vom System wird nur eine der angegebenen Vorlagen verwendet. Das System bestimmt die zu verwendende Vorlage basierend auf dem Vorhandensein der OFN_EXPLORER-Stil und das Betriebssystem, das die Anwendung ausgeführt wird. Durch Angabe einer nicht-Explorer und die Explorer-Formatvorlage, es ist einfach, Unterstützung für Windows NT 3.51, [!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)] und höher, Windows 95 und höher.  
  
> [!NOTE]
> Windows Vista oder höher Stil Dateidialogfelder unterstützen diese Funktion nicht. Es wird versucht, diese Funktion verwenden, auf einem Windows Vista oder höher Stil Dateidialogfeld löst [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Alternativ kann ein angepasstes Dialogfeld zu verwenden. Weitere Informationen zur Verwendung eines benutzerdefiniertes `CFileDialog`, finden Sie unter [IFileDialogCustomize](http://msdn.microsoft.com/library/windows/desktop/bb775912).  
  
##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup  
 Deklariert eine visual Gruppe im Dialogfeld an. Nachfolgende Aufrufe an jede Methode "hinzufügen" hinzufügen die Elemente dieser Gruppe.  
  
```  
HRESULT StartVisualGroup(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parameter  
 *dwIDCtl*  
 Die ID der Gruppe "visual".  
  
 *strLabel*  
 Der Gruppenname.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog  
 Updates der `m_ofn` Datenstruktur von der [CFileDialog](../../mfc/reference/cfiledialog-class.md) basierend auf den aktuellen Zustand des internen Objekts.  
  
```  
void UpdateOFNFromShellDialog();
```  
  
### <a name="remarks"></a>Hinweise  
 In Versionen von Windows vor Windows Vista, das Element [OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx) -Datenstruktur wurde mit dem Status der fortlaufend synchronisiert die `CFileDialog`. Alle Änderungen an der [M_ofn](#m_ofn) Membervariable direkt betroffen, den Zustand des Dialogfelds. Außerdem aktualisiert alle Änderungen in den Zustand des Dialogfelds sofort die Membervariable M_ofn.  
  
 In Windows Vista oder höher, die `m_ofn` Datenstruktur wird nicht automatisch aktualisiert. Gewährleisten Sie die Genauigkeit der Daten in die `m_ofn` Membervariable, rufen Sie die `UpdateOFNFromShellDialog` Funktion vor dem Zugriff auf die Daten. Windows ruft diese Funktion automatisch während der Verarbeitung der [IFileDialog::OnFileOK](http://msdn.microsoft.com/library/windows/desktop/bb775879).  
  
 Weitere Informationen zur Verwendung der `CFileDialog` Klasse, die unter Windows Vista oder höher finden Sie in [CFileDialog-Klasse](../../mfc/reference/cfiledialog-class.md).  
  
### <a name="example"></a>Beispiel  
 In diesem Beispiel aktualisiert die `CFileDialog` vor der Anzeige. Vor dem Aktualisieren der `m_ofn` Membervariable, wir müssen es im aktuellen Zustand des Dialogfelds zu synchronisieren.  
  
 [!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]  
  
## <a name="see-also"></a>Siehe auch  
 [CCommonDialog-Klasse](../../mfc/reference/ccommondialog-class.md)   
 [Hierarchiediagramm](../../mfc/hierarchy-chart.md)

