---
title: CFileDialog-Klasse | Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
dev_langs:
- C++
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: c52d2912edc1632dc2fbe4fe330def6d357f16d2
ms.sourcegitcommit: 19a108b4b30e93a9ad5394844c798490cb3e2945
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/17/2018
---
# <a name="cfiledialog-class"></a>CFileDialog-Klasse
Kapselt das allgemeine Dialogfeld, das für öffnen oder Datei speichern Vorgänge verwendet wird.  
  
## <a name="syntax"></a>Syntax  
  
```  
class CFileDialog : public CCommonDialog  
```  
  
## <a name="members"></a>Member  
  
### <a name="public-constructors"></a>Öffentliche Konstruktoren  
  
|Name|Beschreibung|  
|----------|-----------------|  
|[CFileDialog::CFileDialog](#cfiledialog)|Erstellt ein `CFileDialog`-Objekt.|  
  
### <a name="public-methods"></a>Öffentliche Methoden  
  
|Name|Beschreibung|  
|----------|-----------------|  
|[CFileDialog::AddCheckButton](#addcheckbutton)|Fügt eine Schaltfläche "Überprüfen" im Dialog "".|  
|[CFileDialog::AddComboBox](#addcombobox)|Das Dialogfeld "hinzugefügt ein Kombinationsfeld.|  
|[CFileDialog::AddControlItem](#addcontrolitem)|Fügt ein Element an ein Containersteuerelement im Dialogfeld "".|  
|[CFileDialog::AddEditBox](#addeditbox)|Das Dialogfeld wird ein Bearbeitungsfeld hinzugefügt.|  
|[CFileDialog::AddMenu](#addmenu)|Das Dialogfeld wird ein Menü hinzugefügt.|  
|[CFileDialog::AddPlace](#addplace)|Überladen. Fügt ein Ordner, in der Liste der für den Benutzer zum Öffnen oder speichern die Elemente verfügbaren platziert.|  
|[CFileDialog::AddPushButton](#addpushbutton)|Fügt eine Schaltfläche zum Dialogfeld "".|  
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Fügt eine Optionsgruppe für Optionsfeld (auch bekannt als) zum Dialog "".|  
|[CFileDialog::AddSeparator](#addseparator)|Fügt ein Trennzeichen im Dialog "".|  
|[CFileDialog::AddText](#addtext)|Im Dialogfeld hinzugefügt Text-Inhalt.|  
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Der Status aktualisiert die `CFileDialog` entsprechend die Parameter und den Flags, die in gespeicherten der `m_ofn` Membervariablen gespeichert.|  
|[CFileDialog::DoModal](#domodal)|Zeigt das Dialogfeld an und ermöglicht dem Benutzer eine Auswahl treffen.|  
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Aktiviert eine Dropdown-Liste auf die **öffnen** oder **speichern** Schaltfläche im Dialogfeld.|  
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Beendet das Hinzufügen von Elementen zu einer Gruppe im Dialogfeld "".|  
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Ruft den aktuellen Status der eine Schaltfläche "Überprüfen" (Kontrollkästchen) im Dialogfeld ab.|  
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Ruft den aktuellen Status eines Elements in einem Containersteuerelement im Dialogfeld "" gefunden.|  
|[CFileDialog::GetControlState](#getcontrolstate)|Ruft die aktuelle Sichtbarkeit und aktivierte Status eines angegebenen Steuerelements.|  
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Ruft den aktuellen Text in einem Bearbeitungssteuerelement.|  
|[CFileDialog::GetFileExt](#getfileext)|Gibt die Erweiterung der ausgewählten Datei an.|  
|[CFileDialog::GetFileName](#getfilename)|Gibt den Dateinamen der ausgewählten Datei zurück.|  
|[CFileDialog::GetFileTitle](#getfiletitle)|Gibt den Titel der ausgewählten Datei an.|  
|[CFileDialog::GetFolderPath](#getfolderpath)|Ruft den Pfad der aktuell geöffneten Ordner oder Verzeichnis ab, für eine Explorer-ähnliche **öffnen** oder **speichern unter** Standarddialogfeld.|  
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Ruft das interne COM-Objekt für eine benutzerdefinierte `CFileDialog` Objekt.|  
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Ruft das interne COM-Objekt für eine `CFileDialog` wird, als ein **öffnen** Dateidialogfeld.|  
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Ruft das interne COM-Objekt für eine `CFileDialog` wird, als ein **speichern** Dateidialogfeld.|  
|[CFileDialog::GetNextPathName](#getnextpathname)|Gibt den vollständigen Pfad der ausgewählten Datei weiter.|  
|[CFileDialog::GetOFN](#getofn)|Ruft die `OPENFILENAME` Struktur der `CFileDialog` Objekt.|  
|[CFileDialog::GetPathName](#getpathname)|Gibt den vollständigen Pfad der ausgewählten Datei an.|  
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Gibt den schreibgeschützten Status der ausgewählten Datei an.|  
|[CFileDialog::GetResult](#getresult)|Ruft die Auswahl, die der Benutzer im Dialogfeld vorgenommen.|  
|[CFileDialog::GetResults](#getresults)|Ruft die Auswahl des Benutzers in ein Dialogfeld, Mehrfachauswahl ab.|  
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Ruft ein bestimmtes Element aus dem angegebenen Containersteuerelemente im Dialogfeld ab.|  
|[CFileDialog::GetStartPosition](#getstartposition)|Gibt die Position des ersten Elements in der Liste der Dateinamen zurück.|  
|[CFileDialog::HideControl](#hidecontrol)|Blendet das angegebene Steuerelement in einem Explorer-ähnliche **öffnen** oder **speichern unter** Standarddialogfeld.|  
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Bestimmt, ob das aktuelle Dialogfeld im ordnerauswahlmodus.|  
|[CFileDialog::MakeProminent](#makeprominent)|Stellen, damit er abhebt ein Steuerelements im Dialogfeld auf andere hinzugefügten Steuerelemente verglichen.|  
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Entfernt ein Element aus einem Containersteuerelement im Dialogfeld "".|  
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Legt den aktuellen Status der eine Schaltfläche "Überprüfen" (Kontrollkästchen) in das Dialogfeld "fest.|  
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Legt den aktuellen Status eines Elements in einem Containersteuerelement im Dialogfeld "" gefunden.|  
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Legt den Text eines Steuerelements Elements fest. Beispielsweise der Text, der ein Optionsfeld oder ein Element in einem Menü begleitet.|  
|[CFileDialog::SetControlLabel](#setcontrollabel)|Legt den Text eines Steuerelements, wie z. B. Text oder eine Bezeichnung bearbeiten zugeordnet.|  
|[CFileDialog::SetControlState](#setcontrolstate)|Legt die aktuelle Sichtbarkeit und aktivierte Status eines angegebenen Steuerelements.|  
|[CFileDialog::SetControlText](#setcontroltext)|Legt den Text für das angegebene Steuerelement in einem Explorer-ähnliche **öffnen** oder **speichern unter** Standarddialogfeld.|  
|[CFileDialog::SetDefExt](#setdefext)|Legt die standardmäßige Dateinamenerweiterung für eine Explorer-ähnliche **öffnen** oder **speichern unter** Standarddialogfeld.|  
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Legt den aktuellen Text in einem Bearbeitungssteuerelement.|  
|[CFileDialog::SetProperties](#setproperties)|Bietet einen Eigenschaftenspeicher, der die Standardwerte definiert, die für das zu speichernde Element verwendet werden sollen.|  
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Legt den ausgewählten Zustand eines bestimmten Elements in eine Optionsgruppe-Schaltfläche oder ein Kombinationsfeld, die im Dialogfeld "" gefunden.|  
|[CFileDialog::SetTemplate](#settemplate)|Legt die Dialogfeldvorlage für die `CFileDialog` Objekt.|  
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Deklariert eine visual Gruppe im Dialogfeld "". Nachfolgende Aufrufe an jede Methode "hinzufügen" Fügen Sie dieser Elemente zu dieser Gruppe hinzu.|  
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Aktualisiert die Daten aus der `m_ofn` Membervariable mit dem aktuellen Pufferzustand Dateidialogfeld übereinstimmen.|  
  
### <a name="protected-methods"></a>Geschützte Methoden  
  
|Name|Beschreibung|  
|----------|-----------------|  
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Wird aufgerufen, wenn die Schaltfläche geklickt wird.|  
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Wird aufgerufen, wenn Sie dieses Kontrollkästchen aktiviert/deaktiviert ist.|  
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Wird aufgerufen, wenn das Steuerelement aktiv wird.|  
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Behandelt die `WM_NOTIFY CDN_SELCHANGE` Nachricht.|  
|[CFileDialog::OnFileNameOK](#onfilenameok)|Der im Dialogfeld eingegebene Dateiname wird überprüft.|  
|[CFileDialog::OnFolderChange](#onfolderchange)|Behandelt die `WM_NOTIFY CDN_FOLDERCHANGE` Nachricht.|  
|[CFileDialog::OnInitDone](#oninitdone)|Behandelt die `WM_NOTIFY CDN_INITDONE` Nachricht.|  
|[CFileDialog::OnItemSelected](#onitemselected)|Wird aufgerufen, wenn das Containerelement ausgewählt ist.|  
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Bietet die Möglichkeit, benutzerdefinierte Aktionen durchzuführen, wenn die Dateiauswahl geändert.|  
|[CFileDialog::OnShareViolation](#onshareviolation)|Handles freigeben Verstöße.|  
|[CFileDialog::OnTypeChange](#ontypechange)|Behandelt die `WM_NOTIFY CDN_TYPECHANGE` Nachricht.|  
  
### <a name="public-data-members"></a>Öffentliche Datenmember  
  
|Name|Beschreibung|  
|----------|-----------------|  
|[CFileDialog::m_ofn](#m_ofn)|Die Windows `OPENFILENAME` Struktur. Bietet Zugriff auf grundlegende Dialogfeld Feld Dateiparameter.|  
  
## <a name="remarks"></a>Hinweise  
 Häufig verwendete Dialogfelder für die Datei können Sie die Dateiauswahl Dialogfeldern, z. B. implementieren **Dateiöffnungsmodus** und **speichern unter**, in einer Weise, die mit Windows-Standards konsistent ist.  
  
 Sie können `CFileDialog` wie mit dem Konstruktor bereitgestellt wird oder Sie können eigene Dialogfeldklasse von ableiten `CFileDialog` und einen Konstruktor für Ihre speziellen Anforderungen zu schreiben. In beiden Fällen wird diese Dialogfelder verhält sich wie standard-MFC-Dialogfelder, weil sie abgeleitet sind die [CCommonDialog Klasse](../../mfc/reference/ccommondialog-class.md). `CFileDialog` basiert auf der COMMDLG. DLL-Datei, die in Windows enthalten ist.  
  
 Die Darstellung und die Funktionalität von der `CFileDialog` mit Windows Vista oder höher unterscheiden sich von früheren Versionen von Windows. Die Standardeinstellung `CFileDialog` automatisch die neue Windows Vista oder höher Stil ohne codeänderungen verwendet, wenn ein Programm kompiliert und Ausführung unter Windows Vista oder höher ist. Verwenden der `bVistaStyle` Parameter im Konstruktor auf dieses automatische Update manuell überschreiben. Die Ausnahme, die automatische Aktualisierung ist angepasste Dialogfelder. Sie werden nicht in das neue Format konvertiert werden. Weitere Informationen zu den Konstruktor, finden Sie unter [CFileDialog::CFileDialog](#cfiledialog).  
  
> [!NOTE]
>  Das System der Steuerelement-ID unterscheidet sich in Windows Vista oder höher aus früheren Versionen von Windows, bei der Verwendung einer `CFileDialog`. Sie müssen alle Verweise auf Aktualisieren `CFileDialog` Steuerelemente im Code, bevor Sie das Projekt von einer früheren Version von Windows Portieren können.  
  
 Einige `CFileDialog` Methoden werden nicht unterstützt, unter Windows Vista oder höher ausgeführt. Überprüfen Sie die einzelne Methode Thema Informationen, ob die Methode unterstützt wird. Darüber hinaus werden die folgenden geerbten Funktionen unter Windows Vista oder höher nicht unterstützt:  
  
- [CDialog::](../../mfc/reference/cdialog-class.md#oninitdialog)  
  
- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)  
  
 Die Windows-Nachrichten für die `CFileDialog` Klasse variieren, je nachdem, auf welches Betriebssystem Sie verwenden. Windows XP unterstützt beispielsweise keine [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel) und [CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok) für die `CFileDialog` Klasse. Windows Vista und höheren Betriebssystemen unterstützen sie jedoch. Weitere Informationen zu den anderen Nachrichten, die generiert werden und die Reihenfolge, in der sie empfangen werden, finden Sie unter [CFileDialog-Beispiel: Protokollierung Ereignisreihenfolge](../../visual-cpp-samples.md).  
  
 Verwenden einer `CFileDialog` Objekt, das Objekt erstellen, indem die `CFileDialog` Konstruktor. Nachdem Sie das Dialogfeld erstellt wurde, können Sie festlegen oder ändern Sie alle Werte in der [CFileDialog::m_ofn](#m_ofn) Struktur initialisiert werden, die Werte oder Zustände der Dialogfeld-Steuerelemente. Die `m_ofn` Struktur ist vom Typ `OPENFILENAME`. Weitere Informationen finden Sie unter der [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur im Windows SDK.  
  
 Nachdem Sie das Dialogfeld-Steuerelemente initialisieren, rufen Sie die [CFileDialog::DoModal](#domodal) Methode, um das Dialogfeld anzuzeigen Feld, damit der Pfad und Dateiname eingegeben werden können. `DoModal` Gibt zurück, ob der Benutzer die OK (IDOK) oder auf die Schaltfläche "Abbrechen" (IDCANCEL) geklickt hat. Wenn `DoModal` gibt IDOK, können Sie eines der `CFileDialog` öffentliche Memberfunktionen zum Abrufen von Informationen vom Benutzer gelagerte.  
  
> [!NOTE]
> Unter Windows Vista oder höher, mehrere Aufrufe [IFileDialog::SetFileTypes](http://msdn.microsoft.com/library/windows/desktop/bb775980) verursacht einen Fehler. Der zweite Aufruf von `SetFileTypes` für jede Instanz von einem `CFileDialog` zurück `E_UNEXPECTED` in Windows Vista oder höher. Einige `CFileDialog` Methode-Funktionen rufen `SetFileTypes`. Beispielsweise die beiden Aufrufe von `CFileDialog::DoModal` für dieselbe Instanz von einem `CFileDialog` generiert [ASSERT](diagnostic-services.md#assert).  
  
 `CFileDialog` enthält mehrere geschützte Member, mit denen Sie die benutzerdefinierte Behandlung von Verletzungen der Freigabe, Datei namensüberprüfung und änderungsbenachrichtigung im Listenfeld werden können. Diese geschützte Member sind Fehlerrückruf-Funktionen, die meisten Anwendungen nicht verwendet werden, da die Standardbehandlung automatisch ausgeführt wird. Meldungszuordnungseinträge für diese Funktionen sind nicht erforderlich, da sie die standardmäßige virtuelle Funktionen sind.  
  
 Sie können die Windows [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916) -Funktion zu bestimmen, ob der Fehler während der Initialisierung des Dialogfelds und erfahren Sie mehr über den Fehler.  
  
 Die Zerstörung des `CFileDialog` Objekte automatisch erfolgt. Sie müssen keine Aufrufen [CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog).  
  
 Damit den Benutzer, die mehrere Dateien auswählen können, legen Sie die `OFN_ALLOWMULTISELECT` flag vor dem Aufruf `DoModal`. Sie müssen eine eigene Datei Formatnamenpuffer zum Aufnehmen der zurückgegebenen Liste der mehrere Dateinamen angeben. Ersetzen Sie hierzu `m_ofn.lpstrFile` mit einem Zeiger auf einen Puffer Sie zugeordnet haben, wenn Sie erstellt haben, die `CFileDialog`, aber vor dem Aufruf `DoModal`.  
  
 Darüber hinaus müssen Sie festlegen `m_ofn.nMaxFile` mit die Anzahl der Zeichen im Puffer verweist `m_ofn.lpstrFile`. Wenn Sie festlegen, dass die maximale Anzahl von Dateien zum auszuwählenden `n`, ist die erforderliche Puffergröße `n * (_MAX_PATH + 1) + 1`. Das erste Element im Puffer zurückgegeben wird, den Pfad zu dem Ordner, in dem die Dateien ausgewählt wurden. Für Windows Vista oder höher-Stil Dialogfelder sind die Namenszeichenfolgen Verzeichnis- und Dateinamen Null-terminiert ist, mit einem zusätzlichen Null-Zeichen nach der letzten Dateiname. Dieses Format ermöglicht die Explorer-ähnliche Dialogfelder zurückzugebenden langen Dateinamen, die Leerzeichen enthalten. Für Dialogfelder "im alten Stil" die Namenszeichenfolgen Verzeichnis- und Dateidienste werden durch Leerzeichen getrennt, und verwendet die Funktion für Dateinamen bei kurzen Dateinamen mit Leerzeichen.  
  
 Im folgenden Beispiel wird veranschaulicht, wie auf einen Puffer zum Abrufen und die Liste mehrere Dateinamen verwenden.  
  
 [!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]  
  
 Um die Größe des Puffers als Antwort auf die Benutzer auswählen mehrere Dateinamen zu ändern, leiten Sie eine neue Klasse von `CFileDialog` und überschreiben die [CFileDialog::OnFileNameChange](#onfilenamechange) Methode.  
  
 Wenn Sie eine neue Klasse von ableiten `CFileDialog`, Sie können eine meldungszuordnung verwenden, um alle Meldungen zu verarbeiten. Um die Standard-Meldungsbehandlung zu erweitern, leiten Sie eine Klasse von `CFileDialog`eine meldungszuordnung an die neue Klasse hinzufügen und geben Sie die Memberfunktionen für die neuen Nachrichten. Sie müssen keinen bieten eine Hookfunktion zum Anpassen des Dialogfelds "".  
  
 Um das Dialogfeld anzupassen, leiten Sie eine Klasse von `CFileDialog`, geben Sie eine benutzerdefinierte Dialogfeldvorlage und hinzufügen eine meldungszuordnung, um die benachrichtigungsmeldungen aus den erweiterten Steuerelemente zu verarbeiten. Übergeben Sie alle nicht verarbeiteten Nachrichten an die Basisklasse der Klasse. Sie müssen nicht die Hookfunktion anpassen.  
  
 Beim Verwenden der Windows Vista oder höher Stil der `CFileDialog`, können keine nachrichtenzuordnungen und Dialogfeldvorlagen. Stattdessen müssen Sie die COM-Schnittstellen für ähnliche Funktionalität verwenden.  
  
 Weitere Informationen zur Verwendung von `CFileDialog`, finden Sie unter [allgemeine Dialogfeldklassen](../../mfc/common-dialog-classes.md).  
  
## <a name="inheritance-hierarchy"></a>Vererbungshierarchie  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CDialog](../../mfc/reference/cdialog-class.md)  
  
 [CCommonDialog](../../mfc/reference/ccommondialog-class.md)  
  
 `CFileDialog`  
  
## <a name="requirements"></a>Anforderungen  
 **Header:** afxdlgs.h  
  
##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton  
 Fügt eine Schaltfläche "Überprüfen" im Dialog "".  
  
```  
HRESULT AddCheckButton(
    DWORD dwIDCtl,  
    const CString& strLabel,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID der Schaltfläche "Überprüfen", hinzugefügt werden soll.  
  
 `strLabel`  
 Der Name des Kontrollkästchen-Schaltfläche.  
  
 `bChecked`  
 Ein boolescher Wert, der angibt, des aktuellen Zustands der Schaltfläche "Überprüfen". `TRUE` Wenn diese Option aktiviert ist; `FALSE` andernfalls  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addcombobox"></a>  CFileDialog::AddComboBox  
 Das Dialogfeld "hinzugefügt ein Kombinationsfeld.  
  
```  
HRESULT AddComboBox(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Kombinationsfelds, hinzugefügt werden soll.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem  
 Fügt ein Element an ein Containersteuerelement im Dialogfeld "".  
  
```  
HRESULT AddControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Containersteuerelements auf das Element hinzuzufügen.  
  
 `dwIDItem`  
 Die ID des Elements.  
  
 `strLabel`  
 Text des Elements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addeditbox"></a>  CFileDialog::AddEditBox  
 Das Dialogfeld wird ein Bearbeitungsfeld hinzugefügt.  
  
```  
HRESULT AddEditBox(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des im Bearbeitungsfeld, hinzugefügt werden soll.  
  
 `strText`  
 Der Name des bearbeiten.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addmenu"></a>  CFileDialog::AddMenu  
 Das Dialogfeld wird ein Menü hinzugefügt.  
  
```  
HRESULT AddMenu(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Menüs hinzufügen.  
  
 `strLabel`  
 Der Name des Menüs.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addplace"></a>  CFileDialog::AddPlace  
 Fügt ein Ordner, in der Liste der für den Benutzer zum Öffnen oder speichern die Elemente verfügbaren platziert.  
  
```  
void AddPlace(
    LPCWSTR lpszFolder,  
    FDAP fdap = FDAP_TOP) throw();

 
void AddPlace(
    IShellItem* psi,  
    FDAP fdap = FDAP_TOP) throw();
```  
  
### <a name="parameters"></a>Parameter  
 `lpszFolder`  
 Ein Pfad zu dem Ordner, dem Benutzer zur Verfügung gestellt werden. Dies kann nur ein Ordner sein.  
  
 `fdap`  
 Gibt an, in dem der Ordner in der Liste platziert wird.  
  
 `psi`  
 Ein Zeiger auf ein IShellItem, die für den Ordner für dem Benutzer verfügbar gemacht werden. Dies kann nur ein Ordner sein.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton  
 Fügt eine Schaltfläche zum Dialogfeld "".  
  
```  
HRESULT AddPushButton(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID der Schaltfläche hinzufügen.  
  
 `strLabel`  
 Der Name der Schaltfläche.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList  
 Fügt eine Optionsgruppe für Optionsfeld (auch bekannt als) zum Dialog "".  
  
```  
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID der Gruppe "die Option Schaltfläche" hinzufügen.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addseparator"></a>  CFileDialog::AddSeparator  
 Fügt ein Trennzeichen im Dialog "".  
  
```  
HRESULT AddSeparator(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID für das Trennzeichen hinzufügen.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="addtext"></a>  CFileDialog::AddText  
 Im Dialogfeld hinzugefügt Text.  
  
```  
HRESULT AddText(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Texts, hinzugefügt werden soll.  
  
 `strText`  
 Der Name des Texts.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog  
 Aktualisiert den aktuellen Zustand der der [CFileDialog](../../mfc/reference/cfiledialog-class.md) basierend auf den Werten, die in gespeicherten der `m_ofn` Datenstruktur.  
  
```  
void ApplyOFNToShellDialog();
```  
  
### <a name="remarks"></a>Hinweise  
 In Versionen von Windows vor Windows Vista, das Mitglied [OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx) -Datenstruktur wurde mit dem Status der fortlaufend synchronisiert die `CFileDialog`. Alle Änderungen an der [M_ofn](#m_ofn) Membervariable sofort in den Zustand des Dialogfelds dargestellt wurden. Alle Änderungen in den Zustand des Dialogfelds sofort aktualisieren Sie außerdem die `m_ofn` Membervariablen gespeichert.  
  
 In Windows Vista oder höher, die Werte in der `m_ofn` Membervariablen gespeichert und Status der der `CFileDialog` sind nicht unbedingt synchronisiert werden. Diese Funktion erzwingt den Status des der `CFileDialog` aktualisiert werden, entsprechend der `m_ofn` Struktur. Windows ruft diese Funktion automatisch während des [CFileDialog::DoModal](#domodal).  
  
 Weitere Informationen zur Verwendung der `CFileDialog` Klasse, die unter Windows Vista oder höher finden Sie in [CFileDialog-Klasse](../../mfc/reference/cfiledialog-class.md).  
  
### <a name="example"></a>Beispiel  
  Siehe das Beispiel für [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog).  
  
##  <a name="cfiledialog"></a>  CFileDialog::CFileDialog  
 Mit dieser Funktion wird zum Erstellen einer standardmäßigen Windows-Dateidialogfeld.  
  
```  
explicit CFileDialog(
    BOOL bOpenFileDialog,  
    LPCTSTR lpszDefExt = NULL,  
    LPCTSTR lpszFileName = NULL,  
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,  
    LPCTSTR lpszFilter = NULL,  
    CWnd* pParentWnd = NULL,  
    DWORD dwSize = 0,  
    BOOL bVistaStyle = TRUE);
```  
  
### <a name="parameters"></a>Parameter  
 [in] `bOpenFileDialog`  
 Der Parameter, der angibt, welche Art von Dialogfeld erstellen. Legen Sie es auf `TRUE` zum Erstellen einer **Datei öffnen** (Dialogfeld). Legen Sie es auf `FALSE` zum Erstellen einer **Datei speichern unter** (Dialogfeld).  
  
 [in] `lpszDefExt`  
 Die Standarddateierweiterung. Wenn der Benutzer keine bekannte Erweiterung (eine, die eine Zuordnung auf dem Computer des Benutzers hat) in das Feld Dateiname enthalten, die Erweiterung gemäß `lpszDefExt` automatisch an den Dateinamen angefügt wird. Wenn dieser Parameter ist `NULL`, keine Erweiterung angefügt wird.  
  
 [in] `lpszFileName`  
 Der ursprüngliche Dateiname, der in der Filename-Feld angezeigt wird. Wenn `NULL`, keine anfangsdateiname angezeigt wird.  
  
 [in] `dwFlags`  
 Eine Kombination von ein oder mehrere Flags, die Sie verwenden können, um das Dialogfeld anzupassen. Eine Beschreibung dieser Flags finden Sie in der [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur im Windows SDK. Wenn Sie ändern die `m_ofn.Flags` Member-Struktur, einen bitweisen OR-Operator bei Ihren Änderungen verwenden, um das Standardverhalten unverändert zu lassen.  
  
 [in] `lpszFilter`  
 Eine Reihe von Zeichenfolge-Paaren, die Filter angeben, können Sie auf die Datei anwenden. Wenn Sie Filter angeben, werden nur die Dateien, die Filterkriterien entsprechen in der Liste angezeigt. Finden Sie im Abschnitt "Hinweise" Weitere Informationen zum Arbeiten mit Filter.  
  
 [in] `pParentWnd`  
 Ein Zeiger auf Fenster übergeordnete oder Besitzer von Dateidialogfeld.  
  
 [in] `dwSize`  
 Die Größe der `OPENFILENAME` Struktur. Dieser Wert hängt von der Version des Betriebssystems ab. Dieser Parameter wird von MFC verwendet, um bestimmen die geeignete Arten von Dialogfeld zum Erstellen. Die Standardgröße von 0 bedeutet, die der MFC-Code die richtigen Dialogfeld Feldgröße verwenden bestimmt, auf der Grundlage der Version des Betriebssystems auf der das Programm ausgeführt wird.  
  
 [in] `bVistaStyle`  
 **Hinweis** dieser Parameter wird in Visual Studio 2008 und höher verfügbar und wird dazu führen, dass das Dialogfeld "neue Formatvorlage" verwendet werden, nur dann, wenn Sie in Windows Vista oder höher ausgeführt werden.  
  
 Der Parameter, der den Stil der mit dem Dialogfeld "Datei" angibt. Legen Sie es auf `TRUE` verwenden die neue Vista Stil Dateidialogfelder. Andernfalls wird das alte Format von Dialogfeldern verwendet werden. Finden Sie im Abschnitt "Hinweise" Weitere Informationen zu unter Vista ausgeführt wird.  
  
### <a name="remarks"></a>Hinweise  
 Entweder eine **Datei öffnen** oder **Datei speichern unter** Dialogfeld erstellt werden, abhängig vom Wert des `bOpenFileDialog`.  
  
 Angeben eines Standard-Erweiterung mit `lpszDefExt` das Verhalten, das Sie davon ausgehen dass, möglicherweise nicht erstellt werden, da es nur selten vorhersagbar ist, welche Erweiterungen dateizuordnungen auf dem Computer des Benutzers haben. Wenn Sie mehr Kontrolle über das Anfügen einer Standard-Erweiterung benötigen, leiten Sie eine eigene Klasse von `CFileDialog`, und überschreiben die `CFileDialog::OnFileNameOK` Methode, um eine eigene Behandlung für die Erweiterung ausführen.  
  
 Um den Benutzer zum Auswählen mehrerer Dateien zu aktivieren, legen die `OFN_ALLOWMULTISELECT` flag vor dem Aufruf [DoModal](#domodal). Sie müssen einen eigene Dateinamenpuffer zum Speichern der zurückgegebenen Liste der mehrere Dateinamen angeben. Ersetzen Sie hierzu `m_ofn.lpstrFile` mit einem Zeiger auf einen Puffer Sie zugeordnet haben, wenn Sie erstellt haben, die [CFileDialog](../../mfc/reference/cfiledialog-class.md), aber vor dem Aufruf `DoModal`. Darüber hinaus müssen Sie festlegen `m_ofn.nMaxFile` mit der Anzahl von Zeichen im Puffer verweist `m_ofn.lpstrFile`. Wenn Sie festlegen, dass die maximale Anzahl von Dateien zum auszuwählenden `n`, ist die erforderliche Puffergröße `n`*(_MAX_PATH + 1) + 1. Zum Beispiel:  
  
 [!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]  
  
 Um dem Benutzer ein Dialogfeld Explorer-ähnliche Größe ändern, indem Sie mit der Maus oder Tastatur zu aktivieren, legen die `OFN_ENABLESIZING` Flag. Dieses Flag ist nur erforderlich, wenn Sie einen Hookprozedur oder eine benutzerdefinierte Vorlage bereitzustellen. Das Flag kann nur mit einer Explorer-ähnliche Dialogfeld; Dialogfelder im alten Stil können nicht geändert werden.  
  
 Die `lpszFilter` Parameter wird verwendet, um zu bestimmen, den Typ des Dateinamens eine Datei benötigen, die in der Liste angezeigt werden. Die erste Zeichenfolge im String-Paar beschreibt den Filter. die zweite Zeichenfolge gibt an, die Name-Dateierweiterung verwendet wird. Mehrere Erweiterungen können durch ein Semikolon (';'-Zeichen) als Trennzeichen angegeben werden. Mit zwei endet die Zeichenfolge "&#124;" Zeichen, gefolgt von einem `NULL` Zeichen. Sie können auch eine [CString](../../atl-mfc-shared/using-cstring.md) Objekt für diesen Parameter.  
  
 Beispielsweise [!INCLUDE[ofprexcel](../../mfc/reference/includes/ofprexcel_md.md)] ermöglicht Benutzern das Öffnen von Dateien, die Erweiterungen .xlc (Diagramm) oder einer XLS (Tabelle), haben o. ä. Der Filter für Excel kann als formuliert werden:  
  
 [!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]  
  
 Jedoch, wenn Sie planen, verwenden Sie diese Zeichenfolge für den direkten Aktualisieren der `OPENFILENAME` -Struktur, sollten Sie die Zeichenfolgen mit Null-Zeichen, '\0', statt die senkrechten Striche begrenzen ("&#124;").  
  
 Die `bVistaStyle` Parameter gilt nur, wenn unter Windows Vista oder höher ausgeführt wird. Unter früheren Versionen von Windows wird dieser Parameter ignoriert. Wenn `bVistaStyle` festgelegt ist, um `TRUE`können beim Kompilieren eines Programms mit Visual Studio 2008 oder höher, die neue Vista-Formatvorlage **Dialogfeld "Datei"** verwendet werden. Andernfalls den vorherigen MFC-Stil **Dialogfeld "Datei"** verwendet werden.  
  
 Dialogfeldvorlagen werden auf Dialogfeldern basierend auf nicht unterstützt. `bVistaStyle`  
  
### <a name="example"></a>Beispiel  
  Siehe das Beispiel für [CFileDialog::DoModal](#domodal).  
  
##  <a name="domodal"></a>  CFileDialog::DoModal  
 Mit dieser Funktion wird zum Anzeigen der Windows-Datei Standarddialogfeld und ermöglicht dem Benutzer das Durchsuchen von Dateien und Verzeichnisse, und geben einen Dateinamen an.  
  
```  
virtual INT_PTR DoModal();
```  
  
### <a name="return-value"></a>Rückgabewert  
 **IDOK** oder **IDCANCEL**. Wenn **IDCANCEL** wird zurückgegeben, rufen Sie die Windows [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916) Funktion, um festzustellen, ob ein Fehler aufgetreten.  
  
 **IDOK** und **IDCANCEL** sind Konstanten, die angeben, ob der Benutzer die Schaltfläche OK oder "Abbrechen" ausgewählt.  
  
### <a name="remarks"></a>Hinweise  
 Wenn Sie verschiedene Optionen für die im Dialogfeld zu initialisieren, indem Sie Mitglieder festlegen möchten die **M_ofn** -Struktur, ergreifen Sie dies vor dem Aufruf `DoModal`, aber erst, nachdem das Dialogfeldobjekt erstellt wird.  
  
 Angenommen, wenn Sie den Benutzer zum Auswählen mehrerer Dateien zulassen möchten, legen die `OFN_ALLOWMULTISELECT` vor dem Aufruf flag `DoModal`, wie im Codebeispiel in diesem Thema gezeigt.  
  
 Wenn der Benutzer klickt auf das Dialogfeld Schaltflächen OK oder "Abbrechen", oder SELECT-Anweisungen schließen über des Dialogfelds option Menü steuern möchten, wird die Steuerung an Ihre Anwendung zurückgegeben. Sie können dann anderen Memberfunktionen rufen Sie die Einstellungen oder der Informationen der Benutzereingaben in das Dialogfeld aufrufen.  
  
 `DoModal` eine virtuelle Funktion, die von Klasse überschrieben wird `CDialog`.  
  
### <a name="example"></a>Beispiel  
 [!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]  
  
##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown  
 Ermöglicht eine Dropdownliste öffnen oder speichern Sie die Schaltfläche im Dialogfeld "".  
  
```  
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID der Dropdown-Liste.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup  
 Beendet das Hinzufügen von Elementen zu einer Gruppe im Dialogfeld "".  
  
```  
HRESULT EndVisualGroup();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Gibt S_OK, wenn erfolgreich; ein Fehlerwert andernfalls.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState  
 Ruft den aktuellen Status der eine Schaltfläche "Überprüfen" (Kontrollkästchen) im Dialogfeld ab.  
  
```  
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,  
    BOOL& bChecked);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Kontrollkästchens.  
  
 `bChecked`  
 Der Status des Kontrollkästchens. `TRUE` weist darauf hin überprüft. `FALSE` deaktiviert angibt.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState  
 Ruft ab den aktuellen Status eines Elements in einem Containersteuerelement im Dialogfeld "" gefunden.  
  
```  
HRESULT GetControlItemState(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    CDCONTROLSTATEF& dwState);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Containersteuerelements.  
  
 `dwIDItem`  
 Die ID des Elements.  
  
 `dwState`  
 Ein Verweis auf eine Variable, die mehrere Werte aus der Enumeration CDCONTROLSTATE empfängt, der den aktuellen Status des Steuerelements angibt.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState  
 Ruft die aktuelle Sichtbarkeit und aktivierte Status eines angegebenen Steuerelements.  
  
```  
HRESULT GetControlState(
    DWORD dwIDCtl,  
    CDCONTROLSTATEF& dwState);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Steuerelements.  
  
 `dwState`  
 Ein Verweis auf eine Variable, die einen oder mehrere Werte aus der Enumeration CDCONTROLSTATE empfängt, der den aktuellen Status des Steuerelements angibt.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText  
 Ruft den aktuellen Text in einem Bearbeitungssteuerelement.  
  
```  
HRESULT GetEditBoxText(
    DWORD dwIDCtl,  
    CString& strText);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des im Bearbeitungsfeld.  
  
 `strText`  
 Der Textwert.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getfileext"></a>  CFileDialog::GetFileExt  
 Mit dieser Funktion wird zum Abrufen der Erweiterungs des Dateinamens in das Dialogfeld eingegeben haben.  
  
```  
CString GetFileExt() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Die Erweiterung des Dateinamens.  
  
### <a name="remarks"></a>Hinweise  
 Wenn der Name der Datei eingetragen sind z. B. Daten auf. TXT, `GetFileExt` "TXT" zurückgegeben.  
  
 Wenn `m_ofn.Flags` hat die `OFN_ALLOWMULTISELECT` -Flag festgelegt, diese Zeichenfolge enthält eine Sequenz von Null endende Zeichenfolgen, mit der ersten Zeichenfolge, die den Verzeichnispfad der Dateigruppe ausgewählt, wird gefolgt von den Namen aller Dateien, die vom Benutzer ausgewählt wurden. Verwenden Sie zum Abrufen der Dateipfadnamen der [GetStartPosition](#getstartposition) und [GetNextPathName](#getnextpathname) Memberfunktionen.  
  
##  <a name="getfilename"></a>  CFileDialog::GetFileName  
 Mit dieser Funktion wird zum Abrufen des Namens eines der im Dialogfeld eingegebene Dateiname.  
  
```  
CString GetFileName() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Name der Datei.  
  
### <a name="remarks"></a>Hinweise  
 Der Name der Datei enthält das Präfix und der Erweiterung. Z. B. `GetFileName` zurück "TEXT. DAT"für die Datei C:\FILES\TEXT.DAT.  
  
 Wenn `m_ofn.Flags` hat die `OFN_ALLOWMULTISELECT` flag festgelegt ist, rufen Sie [GetStartPosition](#getstartposition) und [GetNextPathName](#getnextpathname) um einen Dateipfadnamen abzurufen.  
  
##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle  
 Mit dieser Funktion wird zum Abrufen des Titels der Datei in das Dialogfeld eingegeben haben.  
  
```  
CString GetFileTitle() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Titel der Datei.  
  
### <a name="remarks"></a>Hinweise  
 Der Titel der Datei enthält nur ein Präfix, ohne den Pfad oder die Erweiterung. Beispielsweise `GetFileTitle` "TEXT" für die Datei C:\FILES\TEXT.DAT zurück.  
  
 Wenn `m_ofn.Flags` hat die `OFN_ALLOWMULTISELECT` -Flag festgelegt, diese Zeichenfolge enthält eine Sequenz von Null endende Zeichenfolgen, mit der ersten Zeichenfolge, die den Verzeichnispfad der Dateigruppe ausgewählt, wird gefolgt von den Namen aller Dateien, die vom Benutzer ausgewählt wurden. Aus diesem Grund verwenden Sie die [GetStartPosition](#getstartposition) und [GetNextPathName](#getnextpathname) Memberfunktionen zum nächsten Dateinamen in der Liste abzurufen.  
  
### <a name="example"></a>Beispiel  
  Siehe das Beispiel für [CFileDialog::DoModal](#domodal).  
  
##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath  
 Rufen Sie diese Memberfunktion um den Pfad der aktuell geöffneten Ordner oder des Verzeichnisses für eine Explorer-ähnliche öffnen oder Speichern unter Standarddialogfeld abzurufen.  
  
```  
CString GetFolderPath() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein [CString](../../atl-mfc-shared/reference/cstringt-class.md) Objekt, das den aktuell geöffneten Ordner oder Verzeichnis enthält.  
  
### <a name="remarks"></a>Hinweise  
 Das Dialogfeld muss mit erstellt wurden die **OFN_EXPLORER** formatieren; andernfalls schlägt die Methode mit einer Assertion fehl.  
  
 Sie können diese Methode aufrufen, allerdings nur, wenn das Dialogfeld angezeigt wird. Nach dem Schließen des Dialogfelds diese Funktion wird nicht mehr funktionieren, und die Methode mit einer Assertion fehl.  
  
##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize  
 Ruft einen Zeiger auf das interne COM-Objekt für einen bestimmten [CFileDialog](../../mfc/reference/cfiledialog-class.md).  
  
```  
IFileDialogCustomize* GetIFileDialogCustomize();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Zeiger auf das interne COM-Objekt für die `CFileDialog`. Es liegt in Ihrer Verantwortung this-Zeiger ordnungsgemäß freigegeben.  
  
### <a name="remarks"></a>Hinweise  
 Verwenden Sie diese Funktion nur unter Windows Vista oder höher mit der ein Objekt mit `bVistaStyle` festgelegt `true`. Wenn Sie diese Funktion verwenden, wenn `bVistaStyle` ist `false`, zurückgegeben `NULL` im Releasemodus und löst eine Assertion im Debugmodus.  
  
 Weitere Informationen zu den `IFileDialogCustomize` Benutzeroberfläche, siehe [IFileDialogCustomize](http://msdn.microsoft.com/library/windows/desktop/bb775912).  
  
### <a name="example"></a>Beispiel  
 In diesem Beispiel ruft das interne COM-Objekt ab. Um dieses Codebeispiel ausführen zu können, müssen Sie es unter Windows Vista oder höher kompilieren.  
  
 [!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]  
  
##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog  
 Ruft einen Zeiger auf das interne COM-Objekt für einen bestimmten `CFileDialog`.  
  
```  
IFileOpenDialog* GetIFileOpenDialog();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Zeiger auf das interne COM-Objekt für die `CFileDialog`. Es liegt in Ihrer Verantwortung this-Zeiger ordnungsgemäß freigegeben.  
  
### <a name="remarks"></a>Hinweise  
 Verwenden Sie diese Funktion nur unter Windows Vista oder höher mit der ein Objekt mit `bVistaStyle` festgelegt `true`. Diese Funktion gibt `NULL` Wenn die `CFileDialog` kein **öffnen** (Dialogfeld) oder wenn `bVistaStyle` auf festgelegt ist `false`. In diesem letzten Fall gibt die Funktion nur `NULL` im Releasemodus - im Debugmodus befinden, löst sie eine Assertion.  
  
 Weitere Informationen zu den `IFileOpenDialog` Benutzeroberfläche, siehe [IFileOpenDialog](http://msdn.microsoft.com/library/windows/desktop/bb775834).  
  
### <a name="example"></a>Beispiel  
 In diesem Beispiel ruft das interne COM-Objekt ab. Um diesen Code auszuführen, müssen Sie es unter Windows Vista oder höher kompilieren.  
  
 [!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]  
  
##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog  
 Ruft einen Zeiger auf das interne COM-Objekt für einen bestimmten `CFileDialog`.  
  
```  
IFileSaveDialog* GetIFileSaveDialog();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Zeiger auf das interne COM-Objekt für die `CFileDialog`. Es liegt in Ihrer Verantwortung this-Zeiger ordnungsgemäß freigegeben.  
  
### <a name="remarks"></a>Hinweise  
 Verwenden Sie diese Funktion nur unter Windows Vista oder höher mit der ein Objekt mit `bVistaStyle` festgelegt `true`. Diese Funktion zurück `NULL` Wenn die `CFileDialog` ist keine **speichern** Dialogfeld oder, wenn `bVistaStyle` auf festgelegt ist `false`. In diesem letzten Fall gibt die Funktion nur `NULL` im Releasemodus - im Debugmodus befinden, löst sie eine Assertion.  
  
 Weitere Informationen zu den `IFileSaveDialog` Benutzeroberfläche, siehe [IFileSaveDialog](http://msdn.microsoft.com/library/windows/desktop/bb775688).  
  
### <a name="example"></a>Beispiel  
 In diesem Beispiel ruft das interne COM-Objekt ab. Um dieses Codebeispiel ausführen zu können, müssen Sie es unter Windows Vista oder höher kompilieren.  
  
 [!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]  
  
##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName  
 Mit dieser Funktion wird zum Abrufen der nächsten Dateinamen aus der Gruppe, die Sie im Dialogfeld ausgewählt.  
  
```  
CString GetNextPathName(POSITION& pos) const;  
```  
  
### <a name="parameters"></a>Parameter  
 `pos`  
 Ein Verweis auf eine **POSITION** von einem vorherigen zurückgegebene Wert `GetNextPathName` oder `GetStartPosition` Funktionsaufruf. **NULL** , wenn das Ende der Liste erreicht wurde.  
  
### <a name="return-value"></a>Rückgabewert  
 Der vollständige Pfad der Datei.  
  
### <a name="remarks"></a>Hinweise  
 Der Pfad den Dateinamen enthält den Titel der Datei sowie die gesamte Verzeichnispfad. Z. B. `GetNextPathName` zurück "C:\FILES\TEXT. DAT"für die Datei C:\FILES\TEXT.DAT. Sie können `GetNextPathName` in einer Schleife vorwärts, wenn Sie die erste Position mit einem Aufruf von einrichten `GetStartPosition`.  
  
 Wenn die Auswahl nur eine Datei besteht, wird dieser Dateiname zurückgegeben werden.  
  
##  <a name="getofn"></a>  CFileDialog::GetOFN  
 Ruft das zugeordnete **OPENFILENAME** Struktur.  
  
```  
const OPENFILENAME& GetOFN() const;  
  
OPENFILENAME& GetOFN();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur.  
  
### <a name="remarks"></a>Hinweise  
 Verwenden Sie die zweite Version dieser Funktion initialisiert werden, die Darstellung von einer **Datei öffnen** oder **Datei speichern unter** Dialogfeld, nachdem es erstellt wurde, aber bevor er mit angezeigt wird die `DoModal` Memberfunktion. Sie können z. B. Festlegen der **LpstrTitle** Mitglied **M_ofn** auf die Beschriftung im Dialogfeld verfügen sollen.  
  
##  <a name="getpathname"></a>  CFileDialog::GetPathName  
 Mit dieser Funktion wird zum Abrufen des vollständigen Pfads der Datei in das Dialogfeld eingegeben haben.  
  
```  
CString GetPathName() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der vollständige Pfad der Datei.  
  
### <a name="remarks"></a>Hinweise  
 Der Pfad den Dateinamen enthält den Titel der Datei sowie die gesamte Verzeichnispfad. Z. B. `GetPathName` zurück "C:\FILES\TEXT. DAT"für die Datei C:\FILES\TEXT.DAT.  
  
 Wenn `m_ofn.Flags` hat die `OFN_ALLOWMULTISELECT` -Flag festgelegt, diese Zeichenfolge enthält eine Sequenz von Null-Teminated gefolgt Zeichenfolgen, wobei die erste Zeichenfolge, die den Verzeichnispfad der Dateigruppe ausgewählt haben, werden die Namen aller Dateien, die vom Benutzer ausgewählt. Aus diesem Grund verwenden Sie die [GetStartPosition](#getstartposition) und [GetNextPathName](#getnextpathname) Memberfunktionen zum nächsten Dateinamen in der Liste abzurufen.  
  
### <a name="example"></a>Beispiel  
  Siehe das Beispiel für [CFileDialog::DoModal](#domodal).  
  
##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref  
 Rufen Sie diese Funktion, um zu bestimmen, ob das Kontrollkästchen Read Only in den Windows-standard-Datei öffnen und Datei speichern unter Dialogfeldern ausgewählt wurde.  
  
```  
BOOL GetReadOnlyPref() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich 0, wenn Sie im Dialogfeld das Kontrollkästchen Schreibgeschützt aktiviert ist; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Sie können das Kontrollkästchen Read Only ausblenden, indem Sie festlegen der `OFN_HIDEREADONLY` formatieren die `CFileDialog` Konstruktor.  
  
> [!NOTE]
> Windows Vista oder höher Stil `CFileDialog` Objekte unterstützen diese Funktion nicht. Bei dem Versuch, diese Funktion auf einem Windows Vista oder höher Stil verwenden `CFileDialog` löst [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).   
  
##  <a name="getresult"></a>  CFileDialog::GetResult  
 Ruft ab, die Auswahl, die der Benutzer im Dialogfeld vorgenommen.  
  
```  
IShellItem* GetResult() throw();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Zeiger auf ein IShellItem, die die Auswahl des Benutzers darstellt.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getresults"></a>  CFileDialog::GetResults  
 Ruft die Benutzerauswahl in ein Dialogfeld, Mehrfachauswahl ab.  
  
```  
IShellItemArray* GetResults() throw();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Zeiger auf eine IShellItemArray über die ausgewählten Elemente in das Dialogfeld zugegriffen werden können.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem  
 Ruft ein bestimmtes Element aus dem angegebenen Container-Steuerelement im Dialogfeld ab.  
  
```  
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,  
    DWORD& dwIDItem);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Containersteuerelements.  
  
 `dwIDItem`  
 Die ID des Elements, das der Benutzer im Steuerelement ausgewählt.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition  
 Rufen Sie diese Memberfunktion rufen Sie die Position des ersten Dateipfadnamen in der Liste aus, wenn `m_ofn.Flags` hat die `OFN_ALLOWMULTISELECT` flag festgelegt.  
  
```  
POSITION GetStartPosition() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein **POSITION** Wert, der für die Iteration; verwendet werden kann **NULL** , wenn die Liste leer ist.  
  
##  <a name="hidecontrol"></a>  CFileDialog::HideControl  
 Rufen Sie diese Memberfunktion, um das angegebene Steuerelement in einem Explorer-ähnliche öffnen oder speichern Sie als allgemeine Dialogfeld auszublenden.  
  
```  
void HideControl(int nID);
```  
  
### <a name="parameters"></a>Parameter  
 `nID`  
 Die ID des Steuerelements ausgeblendet werden soll.  
  
### <a name="remarks"></a>Hinweise  
 Das Dialogfeld muss mit erstellt wurden die **OFN_EXPLORER** formatieren; andernfalls schlägt die Funktion mit einer Assertion fehl.  
  
##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode  
 Bestimmt, ob das aktuelle Dialogfeld im ordnerauswahlmodus.  
  
```  
BOOL IsPickFoldersMode() const;  
```  
  
### <a name="return-value"></a>Rückgabewert  
 `TRUE` Wenn das Dialogfeld im ordnerauswahlmodus ist. andernfalls `FALSE`.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="m_ofn"></a>  CFileDialog::m_ofn  
 `m_ofn` ist eine Struktur vom Typ `OPENFILENAME`. Die Daten in dieser Struktur entspricht dem aktuellen Zustand von der `CFileDialog`.  
  
### <a name="remarks"></a>Hinweise  
 Verwenden Sie diese Struktur initialisiert werden, die Darstellung von einer **Datei öffnen** oder **Datei speichern unter** Dialogfeld, wenn Sie es erstellt haben, aber bevor Sie ihn mit Anzeigen der [DoModal](#domodal) Methode. Sie können z. B. Festlegen der `lpstrTitle` Mitglied `m_ofn` auf die Beschriftung im Dialogfeld verfügen sollen.  
  
 Mit dem Windows Vista oder höher Stil der [CFileDialog](../../mfc/reference/cfiledialog-class.md), `m_ofn` entspricht nicht unbedingt immer den Status des Dialogfelds. Es wird mit dem Dialogfeld in früheren Versionen von Windows synchronisiert werden. Finden Sie unter [CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog) und [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog) für Weitere Informationen zum Synchronisieren der `m_ofn` Struktur und die `CFileDialog` Zustand unter Windows Vista oder höher ausgeführt.  
  
 Windows Vista oder höher Stil Dateidialogfeldern unterstützen keine bestimmte Elemente und die Flags der `CFileDialog`. Daher werden dies keine Auswirkungen haben.  
  
 Im folgenden finden eine Liste der Elemente, die nicht von Windows Vista oder höher unterstützt werden:  
  
- `lpstrCustomFilter`  
  
- `lpstrInitialDir`  
  
- `lCustData`  
  
- `lpfnHook`  
  
- `lpTemplateName`  
  
 Die folgenden Flags werden nicht unterstützt und daher wirken sich nicht bei der Verwendung der Windows Vista oder höher Stil der `CFileDialog`:  
  
-   OFN_ENABLEHOOK  
  
-   OFN_ENABLEINCLUDENOTIFY  
  
-   OFN_ENABLETEMPLATE  
  
-   OFN_ENABLETEMPLATEHANDLE  
  
-   OFN_EXPLORER  
  
-   OFN_EXTENSIONDIFFERENT  
  
-   OFN_HIDEREADONLY  
  
-   OFN_LONGNAMES - effektiv immer auf in Windows Vista oder höher  
  
-   OFN_NOLONGNAMES - deaktiviert effektiv immer, in Windows Vista oder höher  
  
-   OFN_NONETWORKBUTTON - effektiv immer auf in Windows Vista oder höher  
  
-   OFN_READONLY  
  
-   OFN_SHOWHELP  
  
 Weitere Informationen zu dieser Struktur finden Sie unter der [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur im Windows SDK.  
  
##  <a name="makeprominent"></a>  CFileDialog::MakeProminent  
 Stellen, damit er abhebt ein Steuerelements im Dialogfeld für andere Steuerelemente verglichen.  
  
```  
HRESULT MakeProminent(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Steuerelements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked  
 Wird aufgerufen, wenn die Schaltfläche geklickt wird.  
  
```  
virtual void OnButtonClicked(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID der Schaltfläche.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled  
 Wird aufgerufen, wenn Sie dieses Kontrollkästchen aktiviert oder deaktiviert wird.  
  
```  
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Kontrollkästchens.  
  
 `bChecked`  
 Aktiviert oder deaktiviert.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating  
 Wird aufgerufen, wenn das Steuerelement aktiviert ist.  
  
```  
virtual void OnControlActivating(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Steuerelements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange  
Überschreiben Sie diese Methode, wenn Sie behandeln möchten die `WM_NOTIFY` `CDN_SELCHANGE` Nachricht.  
  
```  
virtual void OnFileNameChange();
```  
  
### <a name="remarks"></a>Hinweise  
 Sendet das System die `CDN_SELCHANGE` Meldung, wenn der Benutzer eine neue Datei oder einen Ordner in der Dateiliste der wählt die **öffnen** oder **speichern unter** (Dialogfeld). Überschreiben Sie diese Methode, wenn Sie alle Aktionen als Reaktion auf diese Meldung ausführen möchten.  
  
 Das System sendet diese Nachricht nur, wenn das Dialogfeld mit dem Flag "OFN_EXPLORER" eingeschaltet erstellt wurde. Weitere Informationen zur Benachrichtigung finden Sie unter [CDN_SELCHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646865). Informationen über das Flag OFN_EXPLORER finden Sie unter der [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur und [öffnen und speichern Sie als Dialogfelder](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK  
 Überschreiben Sie diese Funktion nur, wenn Sie benutzerdefinierte Validierung des Dateinamen angeben, die in ein häufig verwendetes Dialogfeld für die Datei eingegeben werden soll.  
  
```  
virtual BOOL OnFileNameOK();
```  
  
### <a name="return-value"></a>Rückgabewert  
 1, wenn der Dateiname nicht um einen gültigen Dateinamen ist; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Mit dieser Funktion können Sie einen Dateinamen Einstellungsbereich anwendungsspezifische ablehnen. Normalerweise müssen Sie nicht diese Funktion verwenden, da das Framework standardüberprüfung von Dateinamen bietet und zeigt ein Meldungsfenster an, wenn ein ungültiger Dateiname eingegeben wird.  
  
 1 zurückgegeben wird, bleibt das Dialogfeld für den Benutzer zur Eingabe von einem anderen Dateinamen angezeigt. Die Dialogfeldprozedur schließt das Dialogfeld "ist der Rückgabewert 0. Andere ungleich NULL zurückgeben, Werte sind derzeit reserviert und sollte nicht verwendet werden.  
  
##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange  
 Überschreiben Sie diese Funktion behandelt die **WM_NOTIFYCDN_FOLDERCHANGE** Nachricht.  
  
```  
virtual void OnFolderChange();
```  
  
### <a name="remarks"></a>Hinweise  
 Die Benachrichtigung wird gesendet, beim Öffnen eines neuen Ordners im Dialogfeld Öffnen oder speichern.  
  
 Nur, wenn das Dialogfeld mit den OFN_EXPLORER-Stil erstellt wurde, wird die Benachrichtigung gesendet. Weitere Informationen zur Benachrichtigung finden Sie unter [CDN_FOLDERCHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646859). Informationen über das OFN_EXPLORER-Format finden Sie unter der [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur und [öffnen und speichern Sie als Dialogfelder](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
##  <a name="oninitdone"></a>  CFileDialog::OnInitDone  
 Überschreiben Sie diese Funktion behandelt die `WM_NOTIFY` `CDN_INITDONE` Nachricht.  
  
```  
virtual void OnInitDone();
```  
  
### <a name="remarks"></a>Hinweise  
 Wenn das System Anordnen von Steuerelementen in abgeschlossen ist, sendet das System diese Benachrichtigung der **öffnen** oder **speichern unter** (Dialogfeld), um Platz für die Steuerelemente im Dialogfeld untergeordneten bereitzustellen.  
  
 Das System sendet dies nur, wenn das Dialogfeld mit den OFN_EXPLORER-Stil erstellt wurde. Weitere Informationen zur Benachrichtigung finden Sie unter [CDN_INITDONE](http://msdn.microsoft.com/library/windows/desktop/ms646863). Informationen über das OFN_EXPLORER-Format finden Sie unter der [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur und [öffnen und speichern Sie als Dialogfelder](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
> [!NOTE]
> Diese Funktion wird in Windows Vista oder höher Stil Dateidialogfeldern nicht unterstützt. Bei dem Versuch, diese Funktion auf einem Windows Vista oder höher Stil Dialogfeld "Datei" verwenden, löst [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). 
  
##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected  
 Wird aufgerufen, wenn das Containerelement ausgewählt ist.  
  
```  
virtual void OnItemSelected(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Containersteuerelements.  
  
 `dwIDItem`  
 Die ID des Elements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify  
 Diese Funktion wird aufgerufen, wenn die aktuelle Auswahl in einem Listenfeld, das geändert wird.  
  
```  
virtual void OnLBSelChangedNotify(
    UINT nIDBox,  
    UINT iCurSel,  
    UINT nCode);
```  
  
### <a name="parameters"></a>Parameter  
 *nIDBox*  
 Die ID der im Listenfeld oder Kombinationsfeld, in dem die Markierung auftrat.  
  
 `iCurSel`  
 Der Index der aktuellen Auswahl.  
  
 `nCode`  
 Der Steuerungscode Benachrichtigung. Dieser Parameter muss einen der folgenden Werte aufweisen:  
  
- **CD_LBSELCHANGE** gibt `iCurSel` wird das ausgewählte Element in einem Listenfeld mit einfacher Auswahl.  
  
- **CD_LBSELSUB** gibt an, dass `iCurSel` nicht mehr in einem Listensteuerelement Listenfeld ausgewählt ist.  
  
- **CD_LBSELADD** gibt an, dass `iCurSel` in einem Listensteuerelement Listenfeld ausgewählt ist.  
  
- **CD_LBSELNOITEMS** gibt an, die in einem Listensteuerelement Listenfeld keine Auswahl vorhanden ist.  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion, um benutzerdefinierte Verarbeitung von Änderungen der Auswahl im Listenfeld bereitstellen. Beispielsweise verwenden Sie diese Funktion, um die Zugriffsrechte anzuzeigen, oder Datum-Last-modified der einzelnen Dateien der Benutzer auswählt.  
  
##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation  
 Überschreiben von dieser Funktion können Sie benutzerdefinierte Verarbeitung von Verletzungen der Freigabe bereitstellen.  
  
```  
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```  
  
### <a name="parameters"></a>Parameter  
 `lpszPathName`  
 Der Pfad der Datei auf der sich die Freigabe Verletzung auftrat.  
  
### <a name="return-value"></a>Rückgabewert  
 Einer der folgenden Werte:  
  
- **OFN_SHAREFALLTHROUGH** der Dateinamen aus dem Dialogfeld zurückgegeben wird.  
  
- **OFN_SHARENOWARN** keine weitere Aktion erforderlich.  
  
- **OFN_SHAREWARN** der Benutzer erhält die standard-Warnung für diesen Fehler.  
  
### <a name="remarks"></a>Hinweise  
 Normalerweise müssen Sie nicht diese Funktion verwenden, da das Framework bietet Standardeinstellungen, die Überprüfung von Verletzungen der Freigabe, und zeigt ein Meldungsfenster an, wenn eine Freigabe Verletzung auftritt.  
  
 Wenn Sie die Freigabe Verletzung Überprüfung deaktivieren möchten, verwenden Sie den bitweisen OR-Operator, um das Flag kombinieren **OFN_SHAREAWARE** mit `m_ofn.Flags`.  
  
##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange  
 Überschreiben Sie diese Funktion behandelt die **WM_NOTIFYCDN_TYPECHANGE** Nachricht.  
  
```  
virtual void OnTypeChange();
```  
  
### <a name="remarks"></a>Hinweise  
 Die Benachrichtigung wird gesendet, wenn der Benutzer einen neuen Dateityp aus der Liste der Dateitypen öffnen oder Speichern unter (Dialogfeld) auswählt.  
  
 Nur, wenn das Dialogfeld mit den OFN_EXPLORER-Stil erstellt wurde, wird die Benachrichtigung gesendet. Weitere Informationen zur Benachrichtigung finden Sie unter [CDN_TYPECHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646868). Informationen über das OFN_EXPLORER-Format finden Sie unter der [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Struktur und [öffnen und speichern Sie als Dialogfelder](http://msdn.microsoft.com/library/windows/desktop/ms646960).  
  
##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem  
 Entfernt ein Element aus einem Containersteuerelement im Dialogfeld "".  
  
```  
HRESULT RemoveControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Containersteuerelements auf das Element entfernt werden soll.  
  
 `dwIDItem`  
 Die ID des Elements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState  
 Legt den aktuellen Status der eine Schaltfläche "Überprüfen" (Kontrollkästchen) in das Dialogfeld "fest.  
  
```  
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Kontrollkästchens.  
  
 `bChecked`  
 Der Status des Kontrollkästchens. `TRUE` weist darauf hin überprüft. `FALSE` Unchecked angibt.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState  
 Legt den aktuellen Status eines Elements in einem Containersteuerelement im Dialogfeld "" gefunden.  
  
```  
HRESULT SetControlItemState(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    CDCONTROLSTATEF dwState);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Containersteuerelements.  
  
 `dwIDItem`  
 Die ID des Elements.  
  
 `dwState`  
 Eine oder mehrere Werte aus der CDCONTROLSTATE-Enumeration, die den neuen Zustand des Steuerelements angeben.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText  
 Legt den Text eines Steuerelements Elements fest. Beispielsweise der Text, der ein Optionsfeld oder ein Element in einem Menü begleitet.  
  
```  
HRESULT SetControlItemText(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Containersteuerelements.  
  
 `dwIDItem`  
 Die ID des Elements.  
  
 `strLabel`  
 Text des Elements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel  
 Legt den Text eines Steuerelements, wie z. B. Text oder eine Bezeichnung bearbeiten zugeordnet.  
  
```  
HRESULT SetControlLabel(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Steuerelements.  
  
 `strLabel`  
 Der Name des Steuerelements.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState  
 Legt die aktuelle Sichtbarkeit und aktivierte Status eines angegebenen Steuerelements.  
  
```  
HRESULT SetControlState(
    DWORD dwIDCtl,  
    CDCONTROLSTATEF dwState);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Steuerelements.  
  
 `dwState`  
 Eine oder mehrere Werte aus der CDCONTROLSTATE-Enumeration, die den aktuellen Status des Steuerelements angeben.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setcontroltext"></a>  CFileDialog::SetControlText  
 Rufen Sie diese Methode, um den Text für das angegebene Steuerelement in einem Explorer-ähnliche festlegen **öffnen** oder **speichern unter** (Dialogfeld).  
  
```  
void SetControlText(
    int nID,  
    LPCSTR lpsz);

 
void SetControlText(
    int nID,  
    const wchar_t *lpsz);
```  
  
### <a name="parameters"></a>Parameter  
 [in] `nID`  
 Die ID des Steuerelements für die den Text festgelegt.  
  
 [in] `lpsz`  
 Ein Zeiger auf die Zeichenfolge, die Text enthält, der für das Steuerelement festlegen.  
  
### <a name="remarks"></a>Hinweise  
 Beide Versionen dieser Funktion gelten für Anwendungen, die Unicode verwenden. Nur die Version mit dem Typ LPCSTR ist jedoch gültig für Anwendungen mit [!INCLUDE[vcpransi](../../atl-mfc-shared/reference/includes/vcpransi_md.md)].  
  
 Zur Verwendung dieser Methode müssen Sie das Dialogfeld mit den OFN_EXPLORER-Stil erstellen. Andernfalls schlägt die Funktion mit einer Assertion fehl.  
  
##  <a name="setdefext"></a>  CFileDialog::SetDefExt  
 Rufen Sie diese Funktion, um die standardmäßige Dateinamenerweiterung für eine Explorer-ähnliche öffnen oder Speichern unter Standarddialogfeld festgelegt.  
  
```  
void SetDefExt(LPCSTR lpsz);
```  
  
### <a name="parameters"></a>Parameter  
 `lpsz`  
 Ein Zeiger auf eine Zeichenfolge, enthält die standarderweiterung für die Dialogfeldobjekt verwendet. Diese Zeichenfolge muss nicht auf einen Punkt (.) enthalten.  
  
### <a name="remarks"></a>Hinweise  
 Das Dialogfeld muss mit erstellt wurden die **OFN_EXPLORER** formatieren; andernfalls schlägt die Funktion mit einer Assertion fehl.  
  
##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText  
 Legt den aktuellen Text in einem Bearbeitungssteuerelement.  
  
```  
HRESULT SetEditBoxText(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des im Bearbeitungsfeld.  
  
 `strText`  
 Der Textwert.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setproperties"></a>  CFileDialog::SetProperties  
 Bietet einen Eigenschaftenspeicher, der die Standardwerte definiert, die für das zu speichernde Element verwendet werden sollen.  
  
```  
BOOL SetProperties(LPCWSTR lpszPropList);
```  
  
### <a name="parameters"></a>Parameter  
 `lpszPropList`  
 Eine Liste der vordefinierten Eigenschaften, die durch ein ";" voneinander getrennt sind. Eine Liste der Flags finden Sie die `Flags` Abschnitt [OPENFILENAME](http://msdn.microsoft.com/en-us/8cecfd45-f7c1-4f8d-81a0-4e7fecc3b104).  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem  
 Legt den ausgewählten Zustand eines bestimmten Elements in eine Optionsgruppe-Schaltfläche oder ein Kombinationsfeld, die im Dialogfeld "" gefunden.  
  
```  
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID des Containersteuerelements.  
  
 `dwIDItem`  
 Die ID des Elements, das der Benutzer im Steuerelement ausgewählt.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="settemplate"></a>  CFileDialog::SetTemplate  
 Legt die Dialogfeldvorlage für die [CFileDialog](../../mfc/reference/cfiledialog-class.md) Objekt.  
  
```  
void SetTemplate(
    UINT nWin3ID,  
    UINT nWin4ID);

 
void SetTemplate(
    LPCTSTR lpWin3ID,  
    LPCTSTR lpWin4ID);
```  
  
### <a name="parameters"></a>Parameter  
 [in] `nWin3ID`  
 Enthält die ID der Dialogfeldvorlagen-Ressource für den Explorer `CFileDialog` Objekt. Diese Vorlage dient nur unter Windows NT 3.51 oder wenn das Format OFN_EXPLORER nicht vorhanden ist.  
  
 [in] `nWin4ID`  
 Enthält die ID der Dialogfeldvorlagen-Ressource für den Explorer `CFileDialog` Objekt. Diese Vorlage dient nur dazu [!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)] und höher, Windows 95 und höher, oder wenn das Format OFN_EXPLORER vorhanden ist.  
  
 [in] `lpWin3ID`  
 Enthält den Namen der Dialogfeldvorlagen-Ressource für den Explorer `CFileDialog` Objekt. Diese Vorlage dient nur unter Windows NT 3.51 oder wenn das Format OFN_EXPLORER nicht vorhanden ist.  
  
 [in] `lpWin4ID`  
 Enthält den Namen der Dialogfeldvorlagen-Ressource des Explorers `CFileDialog` Objekt. Diese Vorlage dient nur dazu [!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)] und höher, Windows 95 und höher, oder wenn das Format OFN_EXPLORER vorhanden ist.  
  
### <a name="remarks"></a>Hinweise  
 Vom System wird nur eine der angegebenen Vorlagen verwendet. Das System bestimmt, welche Vorlage verwendet basierend auf dem Vorhandensein der OFN_EXPLORER-Stil und das Betriebssystem, das die Anwendung ausgeführt wird. Durch Angeben einer nicht-Explorer und die Explorer-Formatvorlage, es ist einfach zur Unterstützung von Windows NT 3.51, [!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)] und höheren Versionen und Windows 95 und höher.  
  
> [!NOTE]
> Diese Funktion wird in Windows Vista oder höher Stil Dateidialogfelder nicht unterstützt. Bei dem Versuch, diese Funktion auf einem Windows Vista oder höher Stil Dateidialogfeld verwenden, löst [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Eine Alternative ist die Verwendung ein benutzerdefiniertes Dialogfelds. Weitere Informationen zum Verwenden eines benutzerdefiniertes `CFileDialog`, finden Sie unter [IFileDialogCustomize](http://msdn.microsoft.com/library/windows/desktop/bb775912).  
  
##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup  
 Deklariert eine visual Gruppe im Dialogfeld "". Nachfolgende Aufrufe an jede Methode "hinzufügen" Fügen Sie dieser Elemente zu dieser Gruppe hinzu.  
  
```  
HRESULT StartVisualGroup(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>Parameter  
 `dwIDCtl`  
 Die ID der Gruppe "visual".  
  
 `strLabel`  
 Der Gruppenname.  
  
### <a name="remarks"></a>Hinweise  
  
##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog  
 Updates der `m_ofn` Datenstruktur der [CFileDialog](../../mfc/reference/cfiledialog-class.md) basierend auf den aktuellen Zustand des internen Objekts.  
  
```  
void UpdateOFNFromShellDialog();
```  
  
### <a name="remarks"></a>Hinweise  
 In Versionen von Windows vor Windows Vista, das Mitglied [OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx) -Datenstruktur wurde mit dem Status der fortlaufend synchronisiert die `CFileDialog`. Alle Änderungen an der [M_ofn](#m_ofn) Membervariable direkt betroffen, den Status des Dialogfelds. Außerdem aktualisiert alle Änderungen in den Zustand des Dialogs sofort die Membervariable M_ofn.  
  
 In Windows Vista oder höher die `m_ofn` Datenstruktur wird nicht automatisch aktualisiert. Gewährleisten Sie die Genauigkeit der Daten in der `m_ofn` Membervariable, rufen Sie die `UpdateOFNFromShellDialog` Funktion vor dem Zugriff auf die Daten. Windows ruft diese Funktion bei der Verarbeitung von [IFileDialog::OnFileOK](http://msdn.microsoft.com/library/windows/desktop/bb775879).  
  
 Weitere Informationen zur Verwendung der `CFileDialog` Klasse, die unter Windows Vista oder höher finden Sie in [CFileDialog-Klasse](../../mfc/reference/cfiledialog-class.md).  
  
### <a name="example"></a>Beispiel  
 In diesem Beispiel aktualisiert die `CFileDialog` vor der Anzeige. Vor dem Aktualisieren der `m_ofn` Membervariable, müssen wir sie mit dem aktuellen Status des Dialogfelds zu synchronisieren.  
  
 [!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]  
  
## <a name="see-also"></a>Siehe auch  
 [CCommonDialog-Klasse](../../mfc/reference/ccommondialog-class.md)   
 [Hierarchiediagramm](../../mfc/hierarchy-chart.md)

