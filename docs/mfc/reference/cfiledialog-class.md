---
title: CFileDialog-Klasse
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: a7287b2e3011159573f44e9247e016d81d893491
ms.sourcegitcommit: c3bf94210bdb73be80527166264d49e33784152c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/06/2019
ms.locfileid: "68821071"
---
# <a name="cfiledialog-class"></a>CFileDialog-Klasse

Kapselt das allgemeine Dialogfeld, das zum Öffnen von Dateien oder zum Speichern von Dateien verwendet wird.

## <a name="syntax"></a>Syntax

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Member

### <a name="public-constructors"></a>Öffentliche Konstruktoren

|Name|Beschreibung|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|Erstellt ein `CFileDialog`-Objekt.|

### <a name="public-methods"></a>Öffentliche Methoden

|Name|Beschreibung|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|Fügt dem Dialogfeld eine Check Schaltfläche hinzu.|
|[CFileDialog::AddComboBox](#addcombobox)|Fügt dem Dialogfeld ein Kombinations Feld hinzu.|
|[CFileDialog::AddControlItem](#addcontrolitem)|Fügt einem Container Steuerelement im Dialogfeld ein Element hinzu.|
|[CFileDialog::AddEditBox](#addeditbox)|Fügt dem Dialogfeld ein Bearbeitungsfeld hinzu.|
|[CFileDialog::AddMenu](#addmenu)|Fügt ein Menü zum Dialog hinzu.|
|[CFileDialog::AddPlace](#addplace)|Überladen. Fügt der Liste der für den Benutzer verfügbaren Speicherorte einen Ordner hinzu, um Elemente zu öffnen oder zu speichern.|
|[CFileDialog::AddPushButton](#addpushbutton)|Fügt dem Dialogfeld eine Schaltfläche hinzu.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Fügt dem Dialogfeld eine Optionsfeld Gruppe (auch als Optionsfeld bezeichnet) hinzu.|
|[CFileDialog::AddSeparator](#addseparator)|Fügt dem Dialogfeld ein Trennzeichen hinzu.|
|[CFileDialog::AddText](#addtext)|Fügt Text Inhalt zum Dialog hinzu.|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Aktualisiert den Zustand von `CFileDialog` entsprechend den in der `m_ofn` Element Variablen gespeicherten Parametern und Flags.|
|[CFileDialog::DoModal](#domodal)|Zeigt das Dialogfeld an und ermöglicht es dem Benutzer, eine Auswahl vorzunehmen.|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Aktiviert eine Dropdown Liste im Dialogfeld mit der Schaltfläche " **Öffnen** " oder " **Speichern** ".|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Beendet das Hinzufügen von Elementen zu einer visuellen Gruppe im Dialogfeld.|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Ruft den aktuellen Zustand eines Kontrollkästchens (Kontrollkästchen) im Dialogfeld ab.|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Ruft den aktuellen Zustand eines Elements in einem Container Steuerelement ab, das im Dialogfeld gefunden wurde.|
|[CFileDialog::GetControlState](#getcontrolstate)|Ruft die aktuellen Sichtbarkeits-und aktivierten Zustände eines angegebenen Steuer Elements ab.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Ruft den aktuellen Text in einem Bearbeitungsfeld-Steuerelement ab.|
|[CFileDialog::GetFileExt](#getfileext)|Gibt die Erweiterung der ausgewählten Datei zurück.|
|[CFileDialog::GetFileName](#getfilename)|Gibt den Dateinamen der ausgewählten Datei zurück.|
|[CFileDialog::GetFileTitle](#getfiletitle)|Gibt den Titel der ausgewählten Datei zurück.|
|[CFileDialog::GetFolderPath](#getfolderpath)|Ruft den Pfad des aktuell geöffneten Ordners oder Verzeichnisses für ein Dialogfeld " **Öffnen** " oder " **als allgemein speichern** " im Explorer-Format ab.|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Ruft das interne com-Objekt für ein angepasstes `CFileDialog` Objekt ab.|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Ruft das interne com-Objekt für ein `CFileDialog` -Objekt ab, das als Dialogfeld zum **Öffnen** von Dateien verwendet wird.|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Ruft das interne com-Objekt für ein `CFileDialog` -Objekt ab, das als Dialogfeld zum **Speichern** von Dateien verwendet wird.|
|[CFileDialog::GetNextPathName](#getnextpathname)|Gibt den vollständigen Pfad der nächsten ausgewählten Datei zurück.|
|[CFileDialog::GetOFN](#getofn)|Ruft die `OPENFILENAME` Struktur `CFileDialog` des-Objekts ab.|
|[CFileDialog::GetPathName](#getpathname)|Gibt den vollständigen Pfad der ausgewählten Datei zurück.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Gibt den schreibgeschützten Status der ausgewählten Datei zurück.|
|[CFileDialog::GetResult](#getresult)|Ruft die Auswahl ab, die der Benutzer im Dialogfeld getroffen hat.|
|[CFileDialog::GetResults](#getresults)|Ruft die Auswahlmöglichkeiten eines Benutzers in einem Dialogfeld ab, das Mehrfachauswahl zulässt.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Ruft ein bestimmtes Element aus angegebenen Container Steuerelementen im Dialogfeld ab.|
|[CFileDialog::GetStartPosition](#getstartposition)|Gibt die Position des ersten Elements in der Liste der Dateinamen zurück.|
|[CFileDialog::HideControl](#hidecontrol)|Blendet das angegebene Steuerelement in einem Dialogfeld " **Öffnen** " oder " **als allgemein speichern** " im Explorer aus.|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Bestimmt, ob das aktuelle Dialogfeld im Ordner Auswahlmodus ist.|
|[CFileDialog::MakeProminent](#makeprominent)|Platziert ein Steuerelement im Dialogfeld, sodass es im Vergleich zu anderen hinzugefügten Steuerelementen angezeigt wird.|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Entfernt ein Element aus einem Container Steuerelement im Dialogfeld.|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Legt den aktuellen Zustand eines Kontrollkästchens (Kontrollkästchen) im Dialogfeld fest.|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Legt den aktuellen Zustand eines Elements in einem Container Steuerelement fest, das im Dialogfeld gefunden wurde.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Legt den Text eines Steuer Elements fest. Beispielsweise der Text, der ein Optionsfeld oder ein Element in einem Menü begleitet.|
|[CFileDialog::SetControlLabel](#setcontrollabel)|Legt den Text fest, der einem Steuerelement zugeordnet ist, z. b. Schaltflächen Text oder eine Bearbeitungsfeld Bezeichnung.|
|[CFileDialog::SetControlState](#setcontrolstate)|Legt die aktuelle Sichtbarkeit und den aktivierten Status eines angegebenen Steuer Elements fest.|
|[CFileDialog::SetControlText](#setcontroltext)|Legt den Text für das angegebene Steuerelement in einem Dialogfeld " **Öffnen** " oder " **als allgemein speichern** " im Explorer-Format fest.|
|[CFileDialog::SetDefExt](#setdefext)|Legt die standardmäßige Dateinamenerweiterung für ein Dialogfeld " **Öffnen** " oder " **als Standard speichern als** Standard" im Explorer fest.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Legt den aktuellen Text in einem Bearbeitungsfeld-Steuerelement fest.|
|[CFileDialog:: SetProperties](#setproperties)|Bietet einen Eigenschaftenspeicher, der die Standardwerte definiert, die für das zu speichernde Element verwendet werden sollen.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Legt den ausgewählten Zustand eines bestimmten Elements in einer Optionsfeld Gruppe oder einem Kombinations Feld im Dialogfeld fest.|
|[CFileDialog::SetTemplate](#settemplate)|Legt die Dialogfeld Vorlage für das `CFileDialog` -Objekt fest.|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Deklariert eine visuelle Gruppe im Dialogfeld. Nachfolgende Aufrufe einer "Add"-Methode fügen diese Elemente zu dieser Gruppe hinzu.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Aktualisiert die in der `m_ofn` Element Variablen gespeicherten Daten so, dass Sie mit dem aktuellen Status des Datei Dialogfelds abgeglichen werden.|

### <a name="protected-methods"></a>Geschützte Methoden

|Name|Beschreibung|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Wird aufgerufen, wenn auf die Schaltfläche geklickt wird.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Wird aufgerufen, wenn das Kontrollkästchen aktiviert oder deaktiviert ist.|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Wird aufgerufen, wenn das Steuerelement aktiv ist.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Behandelt die WM_NOTIFY CDN_SELCHANGE-Meldung.|
|[CFileDialog::OnFileNameOK](#onfilenameok)|Überprüft den im Dialogfeld eingegebenen Dateinamen.|
|[CFileDialog::OnFolderChange](#onfolderchange)|Behandelt die WM_NOTIFY CDN_FOLDERCHANGE-Meldung.|
|[CFileDialog::OnInitDone](#oninitdone)|Behandelt die WM_NOTIFY CDN_INITDONE-Meldung.|
|[CFileDialog::OnItemSelected](#onitemselected)|Wird aufgerufen, wenn das Containerelement ausgewählt wird.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Ermöglicht es Ihnen, benutzerdefinierte Aktionen auszuführen, wenn die Dateiauswahl geändert wird.|
|[CFileDialog::OnShareViolation](#onshareviolation)|Behandelt Freigabe Verletzungen.|
|[CFileDialog::OnTypeChange](#ontypechange)|Behandelt die WM_NOTIFY CDN_TYPECHANGE-Meldung.|

### <a name="public-data-members"></a>Öffentliche Datenmember

|Name|Beschreibung|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|Die Windows `OPENFILENAME` -Struktur. Bietet Zugriff auf Standardparameter für Datei Dialogfelder.|

## <a name="remarks"></a>Hinweise

Mit allgemeinen Datei Dialogfeldern können Sie Dateiauswahl Dialogfelder implementieren, z. b. **Datei öffnen** und **Speichern**unter, was mit Windows-Standards konsistent ist.

Sie können unverändert `CFileDialog` mit dem angegebenen Konstruktor verwenden, oder Sie können eine eigene Dialogfeld Klasse von `CFileDialog` ableiten und einen Konstruktor für Ihre Bedürfnisse schreiben. In beiden Fällen verhalten sich diese Dialogfelder wie Standard-MFC-Dialogfelder, da Sie von der [ccommondialog-Klasse](../../mfc/reference/ccommondialog-class.md)abgeleitet werden. `CFileDialog`basiert auf der kommdlg. DLL-Datei, die in Windows enthalten ist.

Sowohl die Darstellung als auch die Funktionalität des `CFileDialog` mit Windows Vista oder höher unterscheiden sich von früheren Versionen von Windows. Der Standard `CFileDialog` Wert verwendet automatisch den neuen Windows Vista-Stil oder höher ohne Codeänderungen, wenn ein Programm kompiliert wird und unter Windows Vista oder höher ausgeführt wird. Verwenden Sie den *bVistaStyle* -Parameter im Konstruktor, um diese automatische Aktualisierung manuell zu überschreiben. Die Ausnahme von "Automatisches Update" sind angepasste Dialogfelder. Sie werden nicht in den neuen Stil konvertiert. Weitere Informationen zum Konstruktor finden Sie unter [CFileDialog:: CFileDialog](#cfiledialog).

> [!NOTE]
>  Das Steuerelement-ID-System unterscheidet sich in Windows Vista oder höher von früheren Versionen von `CFileDialog`Windows, wenn Sie einen verwenden. Sie müssen alle Verweise auf Steuer `CFileDialog` Elemente im Code aktualisieren, bevor Sie das Projekt aus einer früheren Windows-Version portieren können.

Einige `CFileDialog` Methoden werden unter Windows Vista oder höher nicht unterstützt. Informationen dazu, ob die Methode unterstützt wird, finden Sie im Thema zu den einzelnen Methoden. Außerdem werden die folgenden geerbten Funktionen unter Windows Vista oder höher nicht unterstützt:

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

Die Windows-Meldungen für `CFileDialog` die-Klasse variieren je nach Betriebssystem, das Sie verwenden. Windows XP unterstützt z. b. [CDialog:: OnCancel](../../mfc/reference/cdialog-class.md#oncancel) und [CDialog:: OnOK](../../mfc/reference/cdialog-class.md#onok) nicht für `CFileDialog` die-Klasse. Windows Vista und spätere Betriebssysteme unterstützen diese jedoch nicht. Weitere Informationen zu den verschiedenen generierten Meldungen und der Reihenfolge, in der Sie empfangen werden, finden [Sie unter CFileDialog-Beispiel: Protokollierungs Ereignis](../../overview/visual-cpp-samples.md)Reihenfolge.

Um ein `CFileDialog` -Objekt zu verwenden, erstellen Sie zunächst das- `CFileDialog` Objekt mit dem-Konstruktor. Nachdem das Dialogfeld erstellt wurde, können Sie alle Werte in der [CFileDialog:: m_ofn](#m_ofn) -Struktur festlegen oder ändern, um die Werte oder Zustände der Dialogfeld-Steuerelemente zu initialisieren. Die `m_ofn` Struktur ist vom Typ `OPENFILENAME`. Weitere Informationen finden Sie in der [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) -Struktur in der Windows SDK.

Nachdem Sie die Dialogfeld Steuerelemente initialisiert haben, können Sie die [CFileDialog::D omodal](#domodal) -Methode aufrufen, um das Dialogfeld anzuzeigen, sodass der Benutzer den Pfad und den Dateinamen eingeben kann. `DoModal`Gibt zurück, ob der Benutzer auf die Schaltfläche OK (IDOK) oder Abbrechen (IDCANCEL) geklickt hat. Wenn `DoModal` IDOK zurückgibt, können Sie eine `CFileDialog` der öffentlichen Member-Funktionen verwenden, um die Informationen abzurufen, die vom Benutzer eingefügt werden.

> [!NOTE]
> Unter Windows Vista oder höher verursachen mehrere Aufrufe von [ifiledialog:: SetFileTypes](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) einen Fehler. Der zweite `SetFileTypes` -Vorgang für eine beliebige Instanz `CFileDialog` von gibt E_UNEXPECTED in Windows Vista oder höher zurück. Einige `CFileDialog` Methoden Funktionsaufrufe `SetFileTypes`. Beispielsweise generieren zwei Aufrufe `CFileDialog::DoModal` von für die gleiche Instanz von eine `CFileDialog` [Assert](diagnostic-services.md#assert)-Methode.

`CFileDialog`umfasst mehrere geschützte Member, mit denen Sie die benutzerdefinierte Behandlung von Freigabe Verstößen, Dateinamen Validierung und Listenfeld-Änderungs Benachrichtigung durchführen können. Diese geschützten Member sind Rückruf Funktionen, die von den meisten Anwendungen nicht verwendet werden müssen, da die Standardbehandlung automatisch erfolgt. Meldungs Zuordnungs Einträge für diese Funktionen sind nicht erforderlich, da es sich hierbei um virtuelle Standardfunktionen handelt.

Mit der Windows-Funktion [commdlgextendederror](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) können Sie feststellen, ob ein Fehler während der Initialisierung des Dialog Felds aufgetreten ist, und weitere Informationen zu diesem Fehler erhalten.

Die Zerstörung von `CFileDialog` Objekten wird automatisch durchgeführt. [CDialog:: EndDialog](../../mfc/reference/cdialog-class.md#enddialog)muss nicht aufgerufen werden.

Damit der Benutzer mehrere Dateien auswählen kann, legen Sie `DoModal`das OFN_ALLOWMULTISELECT-Flag vor dem-Befehl fest. Sie müssen ihren eigenen Dateinamen Puffer angeben, um die zurückgegebene Liste mehrerer Dateinamen aufzunehmen. Ersetzen `m_ofn.lpstrFile` Sie dies durch einen Zeiger auf einen Puffer, den Sie zugeordnet haben, nachdem Sie das `CFileDialog`erstellt haben, aber bevor `DoModal`Sie aufzurufen.

Außerdem müssen Sie festlegen `m_ofn.nMaxFile` , indem Sie die Anzahl der Zeichen im Puffer verwenden, auf die von `m_ofn.lpstrFile`verwiesen wird. Wenn Sie die maximale Anzahl von Dateien festlegen, die ausgewählt `n`werden sollen, ist `n * (_MAX_PATH + 1) + 1`die erforderliche Puffergröße. Das erste Element, das im Puffer zurückgegeben wird, ist der Pfad zu dem Ordner, in dem die Dateien ausgewählt wurden. Für Dialogfelder in Windows Vista oder höheren Versionen werden die Verzeichnis-und Dateinamen Zeichenfolgen auf NULL-terminierte Zeichen folgen mit einem zusätzlichen NULL-Zeichen nach dem letzten Dateinamen. Dieses Format ermöglicht es den Dialogfeldern im Explorer-Stil, lange Dateinamen zurückzugeben, die Leerzeichen enthalten. Für Dialogfelder im alten Stil werden die Verzeichnis-und Dateinamen Zeichenfolgen durch Leerzeichen getrennt, und die Funktion verwendet kurze Dateinamen für Dateinamen mit Leerzeichen.

Im folgenden Beispiel wird veranschaulicht, wie ein Puffer zum Abrufen und Auflisten mehrerer Dateinamen verwendet wird.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Zum Ändern der Puffergröße als Reaktion auf den Benutzer, der mehrere Dateinamen auswählt, müssen Sie eine neue `CFileDialog` Klasse von ableiten und die [CFileDialog:: onfileamechange](#onfilenamechange) -Methode außer Kraft setzen.

Wenn Sie eine neue Klasse von `CFileDialog`ableiten, können Sie eine Meldungs Zuordnung verwenden, um Nachrichten zu verarbeiten. Um die standardmäßige Nachrichten Behandlung zu erweitern, leiten Sie `CFileDialog`eine Klasse von ab, fügen Sie der neuen Klasse eine Meldungs Zuordnung hinzu, und stellen Sie Element Funktionen für die neuen Nachrichten bereit. Sie müssen keine Hook-Funktion bereitstellen, um das Dialogfeld anzupassen.

Um das Dialogfeld anzupassen, leiten Sie eine Klasse `CFileDialog`von ab, geben Sie eine benutzerdefinierte Dialogfeld Vorlage an, und fügen Sie eine Meldungs Zuordnung hinzu, um die Benachrichtigungs Meldungen der erweiterten Steuerelemente zu verarbeiten. Übergeben Sie alle nicht verarbeiteten Nachrichten an die Basisklasse. Sie müssen die Hook-Funktion nicht anpassen.

Wenn Sie den Stil von `CFileDialog`Windows Vista oder höher verwenden, können Sie keine Nachrichten Zuordnungen und Dialogfeld Vorlagen verwenden. Stattdessen müssen Sie die COM-Schnittstellen für ähnliche Funktionen verwenden.

Weitere Informationen zum verwenden `CFileDialog`von finden Sie unter [Allgemeine Dialog Klassen](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Vererbungshierarchie

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Anforderungen

**Header:** afxdlgs. h

##  <a name="addcheckbutton"></a>CFileDialog:: addcheckbutton

Fügt dem Dialogfeld eine Check Schaltfläche hinzu.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID der hinzu zufügenden Schaltfläche.

*strLabel*<br/>
Der Name der Check Schaltfläche.

*bChecked*<br/>
Ein boolescher Wert, der den aktuellen Zustand der Check Schaltfläche angibt. TRUE, wenn aktiviert; Andernfalls false

### <a name="remarks"></a>Hinweise

##  <a name="addcombobox"></a>CFileDialog:: AddComboBox

Fügt dem Dialogfeld ein Kombinations Feld hinzu.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des hinzu zufügenden Kombinations Felds.

### <a name="remarks"></a>Hinweise

##  <a name="addcontrolitem"></a>CFileDialog:: addcontrolitem

Fügt einem Container Steuerelement im Dialogfeld ein Element hinzu.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Container Steuer Elements, dem das Element hinzugefügt werden soll.

*dwIDItem*<br/>
Die ID des Elements.

*strLabel*<br/>
Der Text des Elements.

### <a name="remarks"></a>Hinweise

##  <a name="addeditbox"></a>CFileDialog:: addeditbox

Fügt dem Dialogfeld ein Bearbeitungsfeld hinzu.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des hinzu zufügenden Bearbeitungs Felds.

*strText*<br/>
Der Name des Bearbeitungs Felds.

### <a name="remarks"></a>Hinweise

##  <a name="addmenu"></a>CFileDialog:: AddMenu

Fügt ein Menü zum Dialog hinzu.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des hinzu zufügenden Menüs.

*strLabel*<br/>
Der Menüname.

### <a name="remarks"></a>Hinweise

##  <a name="addplace"></a>CFileDialog:: addplace

Fügt der Liste der für den Benutzer verfügbaren Speicherorte einen Ordner hinzu, um Elemente zu öffnen oder zu speichern.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Parameter

*lpszFolder*<br/>
Ein Pfad zu dem Ordner, der dem Benutzer zur Verfügung gestellt werden soll. Dabei kann es sich nur um einen Ordner handeln.

*fdap*<br/>
Gibt an, wo der Ordner in der Liste platziert wird.

*psi*<br/>
Ein Zeiger auf ein IShellItem-Element, das den Ordner darstellt, der dem Benutzer zur Verfügung gestellt werden soll. Dabei kann es sich nur um einen Ordner handeln.

### <a name="remarks"></a>Hinweise

##  <a name="addpushbutton"></a>CFileDialog:: addpushbutton

Fügt dem Dialogfeld eine Schaltfläche hinzu.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID der hinzu zufügenden Schaltfläche.

*strLabel*<br/>
Der Name der Schaltfläche.

### <a name="remarks"></a>Hinweise

##  <a name="addradiobuttonlist"></a>CFileDialog:: addradiobuttonlist

Fügt dem Dialogfeld eine Optionsfeld Gruppe (auch als Optionsfeld bezeichnet) hinzu.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID der Optionsfeld Gruppe, die hinzugefügt werden soll.

### <a name="remarks"></a>Hinweise

##  <a name="addseparator"></a>CFileDialog:: addSeparator

Fügt dem Dialogfeld ein Trennzeichen hinzu.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Trenn Zeichens, das hinzugefügt wird.

### <a name="remarks"></a>Hinweise

##  <a name="addtext"></a>CFileDialog:: AddText

Fügt dem Dialogfeld Text hinzu.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des hinzu zufügenden Texts.

*strText*<br/>
Der Textname.

### <a name="remarks"></a>Hinweise

##  <a name="applyofntoshelldialog"></a>CFileDialog:: applyofndeshelldialog

Aktualisiert den aktuellen Status des [CFileDialog](../../mfc/reference/cfiledialog-class.md) -Werts basierend auf den in der `m_ofn` Datenstruktur gespeicherten Werten.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Hinweise

In Windows-Versionen vor Windows Vista wurde die Datenstruktur des [OpenFileName](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) -Members fortlaufend mit dem Zustand von `CFileDialog`synchronisiert. Alle Änderungen an der [m_ofn](#m_ofn) -Member-Variable wurden sofort im Zustand des Dialog Felds widergespiegelt. Außerdem aktualisieren alle Änderungen am Zustand des Dialog Felds sofort die `m_ofn` Element Variable.

In Windows Vista oder höher werden die Werte in der `m_ofn` Element Variablen und im Zustand `CFileDialog` der nicht unbedingt synchronisiert. Diese Funktion erzwingt, dass der `CFileDialog` Zustand von entsprechend der `m_ofn` -Struktur aktualisiert wird. Diese Funktion wird von Windows während [CFileDialog::D omodal](#domodal)automatisch aufgerufen.

Weitere Informationen zur Verwendung der `CFileDialog` -Klasse unter Windows Vista oder höher finden Sie unter [CFileDialog-Klasse](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Beispiel

  Weitere Informationen finden Sie im Beispiel für [CFileDialog:: updateofnfromshelldialog](#updateofnfromshelldialog).

##  <a name="cfiledialog"></a>CFileDialog:: CFileDialog

Mit dieser Funktion können Sie ein Standard Dialogfeld für Windows-Dateien erstellen.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Parameter

*bOpenFileDialog*<br/>
in Der-Parameter, der den Typ des zu erstellenden Dialog Felds angibt. Legen Sie diese Einstellung auf true fest, um ein Dialogfeld zum **Öffnen von Dateien** zu erstellen Legen Sie diese Einstellung auf false fest, um das Dialogfeld **Datei speichern** unter zu erstellen.

*lpszDefExt*<br/>
in Die standardmäßige Dateinamenerweiterung. Wenn der Benutzer keine bekannte Erweiterung (einen, der eine Zuordnung auf dem Computer des Benutzers aufweist) im Feld Dateiname enthält, wird die von *lpszdefext* angegebene Erweiterung automatisch an den Dateinamen angehängt. Wenn dieser Parameter NULL ist, wird keine Erweiterung angefügt.

*lpszFileName*<br/>
in Der ursprüngliche Dateiname, der im Feld Dateiname angezeigt wird. Bei Null wird kein ursprünglicher Dateiname angezeigt.

*dwFlags*<br/>
in Eine Kombination aus einem oder mehreren Flags, die Sie verwenden können, um das Dialogfeld anzupassen. Eine Beschreibung dieser Flags finden Sie unter der [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) -Struktur in der Windows SDK. Wenn Sie den `m_ofn.Flags` Strukturmember ändern, verwenden Sie einen bitweisen OR-Operator in den Änderungen, um das Standardverhalten beizubehalten.

*lpszFilter*<br/>
in Eine Reihe von Zeichen folgen Paaren, die Filter angeben, die auf die Datei angewendet werden können. Wenn Sie Dateifilter angeben, werden nur Dateien, die den Filterkriterien entsprechen, in der Datei Liste angezeigt. Weitere Informationen zum Arbeiten mit Dateifiltern finden Sie im Abschnitt "Hinweise".

*pParentWnd*<br/>
in Ein Zeiger auf das übergeordnete Fenster oder Besitzer Fenster des Datei Dialogfelds.

*dwSize*<br/>
in Die Größe `OPENFILENAME` der-Struktur. Dieser Wert hängt von der Betriebssystemversion ab. MFC hat diesen Parameter verwendet, um die gewünschte Art von Dialogfeld zu bestimmen, die erstellt werden soll. Die Standardgröße 0 bedeutet, dass der MFC-Code anhand der Betriebssystemversion, auf der das Programm ausgeführt wird, die richtige Größe des Dialog Felds bestimmt.

*bVistaStyle*<br/>
in **Hinweis** Dieser Parameter ist in Visual Studio 2008 und höher verfügbar und bewirkt, dass das Dialogfeld "neuer Stil" nur verwendet wird, wenn Sie Windows Vista oder höher ausführen.

Der-Parameter, der den Stil des Datei Dialogfelds angibt. Legen Sie diese Einstellung auf "true" fest, um die neuen Dialogfelder im Stil von Vista Andernfalls wird der alte Stil von Dialogfeldern verwendet. Weitere Informationen zur Ausführung unter Vista finden Sie im Abschnitt "Hinweise".

### <a name="remarks"></a>Hinweise

Abhängig vom Wert von *bopenfiledialog*wird entweder das Dialogfeld " **Datei öffnen** " oder " **Datei speichern** unter" erstellt.

Das Angeben einer Standard Erweiterung mithilfe von *lpszdefext* erzeugt möglicherweise nicht das erwartete Verhalten, da es selten vorhersagbar ist, welche Erweiterungen über Dateizuordnungen auf dem Computer des Benutzers verfügen. Wenn Sie mehr Kontrolle über das Anfügen einer Standard Erweiterung benötigen, können Sie eine eigene Klasse von `CFileDialog`ableiten und die `CFileDialog::OnFileNameOK` -Methode überschreiben, um eine eigene Erweiterungs Behandlung durchzuführen.

Um dem Benutzer die Auswahl mehrerer Dateien zu ermöglichen, legen Sie das OFN_ALLOWMULTISELECT-Flag vor dem Abrufen von [DoModal](#domodal)fest. Sie müssen einen eigenen Dateinamen Puffer angeben, um die zurückgegebene Liste mehrerer Dateinamen zu speichern. Ersetzen `m_ofn.lpstrFile` Sie dies durch einen Zeiger auf einen Puffer, den Sie zugeordnet haben, nachdem Sie das [CFileDialog-Dialog](../../mfc/reference/cfiledialog-class.md)Feld erstellt haben `DoModal`, aber bevor Sie aufzurufen. Außerdem müssen Sie mit der `m_ofn.nMaxFile` Anzahl von Zeichen im Puffer festlegen, auf die von `m_ofn.lpstrFile`verwiesen wird. Wenn Sie die maximale Anzahl von Dateien, die ausgewählt werden sollen, auf *n*festlegen, ist `n`die erforderliche Puffergröße * (_MAX_PATH + 1) + 1. Beispiel:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Um dem Benutzer das Ändern der Größe eines Explorer-Dialog Felds mit der Maus oder der Tastatur zu ermöglichen, legen Sie das OFN_ENABLESIZING-Flag fest. Das Festlegen dieses Flags ist nur erforderlich, wenn Sie eine Hook-Prozedur oder eine benutzerdefinierte Vorlage bereitstellen. Das-Flag funktioniert nur mit einem Dialogfeld im Explorer-Format. die Größe von Dialogfeldern im alten Stil kann nicht geändert werden.

Der *lpszfilter* -Parameter wird verwendet, um den Dateityp zu bestimmen, den eine Datei in der Datei Liste enthalten muss. Die erste Zeichenfolge im Zeichen folgen paar beschreibt den Filter. die zweite Zeichenfolge gibt die zu verwendende Dateinamenerweiterung an. Mehrere Erweiterungen können mit einem Semikolon (";") als Trennzeichen angegeben werden. Die Zeichenfolge endet mit zwei&#124;' '-Zeichen, gefolgt von einem NULL-Zeichen. Sie können auch ein [CString](../../atl-mfc-shared/using-cstring.md) -Objekt für diesen Parameter verwenden.

Beispielsweise ermöglicht Microsoft Excel Benutzern das Öffnen von Dateien mit den Erweiterungen ". xlc" (Diagramm) oder ". xls" (Arbeitsblatt). Der Filter für Excel könnte wie folgt geschrieben werden:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

Wenn Sie jedoch beabsichtigen, diese Zeichenfolge zu verwenden, um die `OPENFILENAME` Struktur direkt zu aktualisieren, sollten Sie die Zeichen folgen mit dem NULL-Zeichen "\ 0" anstelle der vertikalen Balken ("&#124;") begrenzen.

Der *bVistaStyle* -Parameter gilt nur, wenn er unter Windows Vista oder höher ausgeführt wird. Unter früheren Versionen von Windows wird dieser Parameter ignoriert. Wenn *bVistaStyle* auf true festgelegt ist und Sie ein Programm mit Visual Studio 2008 oder höher kompilieren, wird das Dialog Feld neue Vista- **Format Datei** verwendet. Andernfalls wird das vorherige MFC- **Format Datei Dialogfeld** verwendet.

Dialog Vorlagen werden in Dialogfeldern, die auf *bVistaStyle* basieren, nicht unterstützt.

### <a name="example"></a>Beispiel

  Weitere Informationen finden Sie im Beispiel für [CFileDialog::D omodal](#domodal).

##  <a name="domodal"></a>CFileDialog::D omodal

Rufen Sie diese Funktion auf, um das Dialogfeld Windows common file anzuzeigen und dem Benutzer zu ermöglichen, Dateien und Verzeichnisse zu durchsuchen und einen Dateinamen einzugeben.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Rückgabewert

IDOK oder IDCANCEL. Wenn IDCANCEL zurückgegeben wird, rufen Sie die Windows-Funktion [commdlgextendederror](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) auf, um zu bestimmen, ob ein Fehler aufgetreten ist.

IDOK und IDCANCEL sind Konstanten, die angeben, ob der Benutzer die Schaltfläche OK oder Abbrechen ausgewählt hat.

### <a name="remarks"></a>Hinweise

Wenn Sie die verschiedenen Datei Dialogfeld-Optionen durch Festlegen der Elemente der `m_ofn` Struktur initialisieren möchten, sollten Sie dies vor dem Aufrufen `DoModal`von tun, nachdem das Dialogfeld Objekt erstellt wurde.

Wenn Sie z. b. dem Benutzer die Auswahl mehrerer Dateien gestatten möchten, legen Sie das OFN_ALLOWMULTISELECT-Flag `DoModal`vor dem Aufrufen von fest, wie im Codebeispiel in diesem Thema gezeigt.

Wenn der Benutzer auf die Schaltflächen OK oder Abbrechen des Dialog Felds klickt oder im Menü Steuerungs Menü des Dialog Felds die Option schließen auswählt, wird die Steuerung an die Anwendung zurückgegeben. Sie können dann andere Element Funktionen aufrufen, um die Einstellungen oder Informationen abzurufen, die der Benutzer in das Dialogfeld eingibt.

`DoModal`eine virtuelle Funktion, die von der- `CDialog`Klasse überschrieben wird.

### <a name="example"></a>Beispiel

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>CFileDialog:: enableopendropdown

Aktiviert eine Dropdown Liste im Dialogfeld mit der Schaltfläche "Öffnen" oder "Speichern".

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID der Dropdown Liste.

### <a name="remarks"></a>Hinweise

##  <a name="endvisualgroup"></a>CFileDialog:: endvisualgroup

Beendet das Hinzufügen von Elementen zu einer visuellen Gruppe im Dialogfeld.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Rückgabewert

Gibt S_OK zurück, wenn erfolgreich; andernfalls ein Fehlerwert.

### <a name="remarks"></a>Hinweise

##  <a name="getcheckbuttonstate"></a>CFileDialog:: getcheckbuttonstate

Ruft den aktuellen Zustand eines Kontrollkästchens (Kontrollkästchen) im Dialogfeld ab.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Kontrollkästchens.

*bChecked*<br/>
Der Zustand des Kontrollkästchens. TRUE gibt aktiviert an. FALSE weist auf nicht aktiviert hin.

### <a name="remarks"></a>Hinweise

##  <a name="getcontrolitemstate"></a>CFileDialog:: getcontrolitemstate

Ruft den aktuellen Zustand eines Elements in einem Container Steuerelement ab, das im Dialogfeld gefunden wurde.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Container Steuer Elements.

*dwIDItem*<br/>
Die ID des Elements.

*dwState*<br/>
Ein Verweis auf eine Variable, die einen von Mehrwerten aus der cdcontrolstate-Enumeration empfängt, der den aktuellen Zustand des Steuer Elements angibt.

### <a name="remarks"></a>Hinweise

##  <a name="getcontrolstate"></a>CFileDialog:: getcontrolstate

Ruft die aktuellen Sichtbarkeit und aktivierten Zustände eines angegebenen Steuer Elements ab.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Steuer Elements.

*dwState*<br/>
Ein Verweis auf eine Variable, die einen oder mehrere Werte aus der cdcontrolstate-Enumeration empfängt, die den aktuellen Zustand des Steuer Elements angibt.

### <a name="remarks"></a>Hinweise

##  <a name="geteditboxtext"></a>CFileDialog:: geteditboxtext

Ruft den aktuellen Text in einem Bearbeitungsfeld-Steuerelement ab.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Bearbeitungs Felds.

*strText*<br/>
Der Textwert.

### <a name="remarks"></a>Hinweise

##  <a name="getfileext"></a>CFileDialog:: getfileext

Rufen Sie diese Funktion auf, um die Erweiterung des Datei namens abzurufen, der in das Dialogfeld eingegeben wurde.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Rückgabewert

Die Erweiterung des Datei namens.

### <a name="remarks"></a>Hinweise

Wenn z. b. der Name der eingegebenen Datei Daten ist. `GetFileExt` Txt gibt "txt" zurück.

Wenn `m_ofn.Flags` das OFN_ALLOWMULTISELECT-Flag festgelegt ist, enthält diese Zeichenfolge eine Sequenz von null-terminierten Zeichen folgen, wobei die erste Zeichenfolge der Verzeichnispfad der ausgewählten Datei Gruppe ist, gefolgt von den Namen aller Dateien, die vom Benutzer ausgewählt wurden. Wenn Sie Datei Pfadnamen abrufen möchten, verwenden Sie die Member-Funktionen [GetStartPosition](#getstartposition) und [getnextpathname](#getnextpathname) .

##  <a name="getfilename"></a>CFileDialog:: GetFilename

Rufen Sie diese Funktion auf, um den Namen des Datei namens abzurufen, der im Dialogfeld eingegeben wurde.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Rückgabewert

Der Name der Datei.

### <a name="remarks"></a>Hinweise

Der Name der Datei enthält sowohl das Präfix als auch die Erweiterung. Gibt z `GetFileName` . b. "Text" zurück. DAT "für die Datei c:\dateien\text.Datei.

Wenn `m_ofn.Flags` das`OFN_ALLOWMULTISELECT` -Flag festgelegt ist, sollten Sie [GetStartPosition](#getstartposition) und [getnextpathname](#getnextpathname) aufrufen, um einen Datei Pfadnamen abzurufen.

##  <a name="getfiletitle"></a>CFileDialog:: GetFileTitle

Rufen Sie diese Funktion auf, um den Titel der im Dialogfeld eingegebenen Datei abzurufen.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Rückgabewert

Der Titel der Datei.

### <a name="remarks"></a>Hinweise

Der Titel der Datei enthält nur das Präfix ohne den Pfad oder die Erweiterung. Gibt z `GetFileTitle` . b. "Text" für die Datei "c:\dateien\text.dat" zurück.

Wenn `m_ofn.Flags` das OFN_ALLOWMULTISELECT-Flag festgelegt ist, enthält diese Zeichenfolge eine Sequenz von null-terminierten Zeichen folgen, wobei die erste Zeichenfolge der Verzeichnispfad der ausgewählten Datei Gruppe ist, gefolgt von den Namen aller Dateien, die vom Benutzer ausgewählt wurden. Verwenden Sie aus diesem Grund die Member-Funktionen [GetStartPosition](#getstartposition) und [getnextpathname](#getnextpathname) , um den nächsten Dateinamen in der Liste abzurufen.

### <a name="example"></a>Beispiel

  Weitere Informationen finden Sie im Beispiel für [CFileDialog::D omodal](#domodal).

##  <a name="getfolderpath"></a>CFileDialog:: GetFolderPath

Rufen Sie diese Member-Funktion auf, um den Pfad des aktuell geöffneten Ordners oder Verzeichnisses für ein Dialogfeld im Explorer-Stil öffnen oder speichern als allgemein abzurufen.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Rückgabewert

Ein [CString](../../atl-mfc-shared/reference/cstringt-class.md) -Objekt, das den aktuell geöffneten Ordner oder das aktuell geöffnete Verzeichnis enthält.

### <a name="remarks"></a>Hinweise

Das Dialogfeld muss mit dem OFN_EXPLORER-Stil erstellt worden sein. Andernfalls schlägt die Methode mit einer-Erklärung fehl.

Diese Methode kann nur aufgerufen werden, während das Dialogfeld angezeigt wird. Nachdem das Dialogfeld geschlossen wurde, funktioniert diese Funktion nicht mehr, und die Methode schlägt mit einer-Erklärung fehl.

##  <a name="getifiledialogcustomize"></a>CFileDialog:: getifiledialogcustomize

Ruft einen Zeiger auf das interne com-Objekt für ein bestimmtes [CFileDialog-Dialog](../../mfc/reference/cfiledialog-class.md)Feld ab.

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Rückgabewert

Der Zeiger auf das interne com-Objekt für `CFileDialog`das-Objekt. Es liegt in ihrer Verantwortung, diesen Zeiger entsprechend freizugeben.

### <a name="remarks"></a>Hinweise

Verwenden Sie diese Funktion nur unter Windows Vista oder höher mit einem Objekt, für das *bVistaStyle* auf true festgelegt ist. Wenn Sie diese Funktion verwenden, wenn *bVistaStyle* den Wert false hat, wird im Releasemodus NULL zurückgegeben und eine-Assertion im Debugmodus ausgelöst.

Weitere Informationen `IFileDialogCustomize` zur-Schnittstelle finden Sie unter [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Beispiel

In diesem Beispiel wird das interne com-Objekt abgerufen. Um dieses Codebeispiel ausführen zu können, müssen Sie es unter Windows Vista oder höher kompilieren.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>CFileDialog:: getifileopendialog

Ruft einen Zeiger auf das interne com-Objekt für einen angegebenen `CFileDialog`ab.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Rückgabewert

Der Zeiger auf das interne com-Objekt für `CFileDialog`das-Objekt. Es liegt in ihrer Verantwortung, diesen Zeiger entsprechend freizugeben.

### <a name="remarks"></a>Hinweise

Verwenden Sie diese Funktion nur unter Windows Vista oder höher mit einem Objekt, für das *bVistaStyle* auf true festgelegt ist. Diese Funktion gibt NULL zurück, `CFileDialog` wenn es sich nicht um ein **offenes** Dialogfeld handelt oder wenn *bVistaStyle* auf false festgelegt ist. In diesem abschließenden Fall gibt die Funktion nur NULL im Releasemodus zurück. im Debugmodus wird eine-Assertion ausgelöst.

Weitere Informationen `IFileOpenDialog` zur-Schnittstelle finden Sie unter [IFileOpenDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Beispiel

In diesem Beispiel wird das interne com-Objekt abgerufen. Zum Ausführen dieses Codes müssen Sie ihn unter Windows Vista oder höher kompilieren.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>CFileDialog:: getifilesavedialog

Ruft einen Zeiger auf das interne com-Objekt für einen angegebenen `CFileDialog`ab.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Rückgabewert

Der Zeiger auf das interne com-Objekt für `CFileDialog`das-Objekt. Es liegt in ihrer Verantwortung, diesen Zeiger entsprechend freizugeben.

### <a name="remarks"></a>Hinweise

Verwenden Sie diese Funktion nur unter Windows Vista oder höher mit einem Objekt, für das *bVistaStyle* auf true festgelegt ist. Diese Funktion gibt NULL zurück, wenn `CFileDialog` es sich nicht um ein **Speicher** Dialogfeld handelt oder wenn *bVistaStyle* auf false festgelegt ist. In diesem abschließenden Fall gibt die Funktion nur NULL im Releasemodus zurück. im Debugmodus wird eine-Assertion ausgelöst.

Weitere Informationen `IFileSaveDialog` zur-Schnittstelle finden Sie unter [IFileSaveDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Beispiel

In diesem Beispiel wird das interne com-Objekt abgerufen. Um dieses Codebeispiel ausführen zu können, müssen Sie es unter Windows Vista oder höher kompilieren.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>CFileDialog:: getnextpathname

Rufen Sie diese Funktion auf, um den nächsten Dateinamen aus der im Dialogfeld ausgewählten Gruppe abzurufen.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Parameter

*POS*<br/>
Ein Verweis auf einen Positionswert, der von einem `GetNextPathName` vorherigen `GetStartPosition` -oder-Funktionsbefehl zurückgegeben wurde. NULL, wenn das Ende der Liste erreicht wurde.

### <a name="return-value"></a>Rückgabewert

Der vollständige Pfad der Datei.

### <a name="remarks"></a>Hinweise

Der Pfad des Datei namens enthält den Titel der Datei sowie den gesamten Verzeichnispfad. Beispielsweise `GetNextPathName` wird "c:\dateien\text" zurückgegeben. DAT "für die Datei c:\dateien\text.Datei. Sie können in `GetNextPathName` einer Forward-Iterations Schleife verwenden, `GetStartPosition`Wenn Sie die ursprüngliche Position mit einem-Aufrufpunkt einrichten.

Wenn die Auswahl nur aus einer Datei besteht, wird der Dateiname zurückgegeben.

##  <a name="getofn"></a>CFileDialog:: gedefn

Ruft die `OPENFILENAME` zugeordnete-Struktur ab.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Rückgabewert

Eine [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) -Struktur.

### <a name="remarks"></a>Hinweise

Verwenden Sie die zweite Version dieser Funktion, um die Darstellung des Dialog Felds **Datei öffnen** oder **Datei speichern** unter zu initialisieren, nachdem Sie erstellt wurde, aber bevor Sie mit `DoModal` der Member-Funktion angezeigt wird. Beispielsweise können Sie den `lpstrTitle` Member von `m_ofn` auf die Beschriftung festlegen, die im Dialogfeld enthalten sein soll.

##  <a name="getpathname"></a>CFileDialog:: getPathname

Rufen Sie diese Funktion auf, um den vollständigen Pfad der Datei abzurufen, die im Dialogfeld eingegeben wurde.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Rückgabewert

Der vollständige Pfad der Datei.

### <a name="remarks"></a>Hinweise

Der Pfad des Datei namens enthält den Titel der Datei sowie den gesamten Verzeichnispfad. Beispielsweise `GetPathName` wird "c:\dateien\text" zurückgegeben. DAT "für die Datei c:\dateien\text.Datei.

Wenn `m_ofn.Flags` das OFN_ALLOWMULTISELECT-Flag festgelegt ist, enthält diese Zeichenfolge eine Sequenz von NULL-Zeichen folgen, wobei die erste Zeichenfolge der Verzeichnispfad der ausgewählten Datei Gruppe ist, gefolgt von den Namen aller Dateien, die vom Benutzer ausgewählt wurden. Verwenden Sie aus diesem Grund die Member-Funktionen [GetStartPosition](#getstartposition) und [getnextpathname](#getnextpathname) , um den nächsten Dateinamen in der Liste abzurufen.

### <a name="example"></a>Beispiel

  Weitere Informationen finden Sie im Beispiel für [CFileDialog::D omodal](#domodal).

##  <a name="getreadonlypref"></a>CFileDialog:: getreadonlypref

Mit dieser Funktion können Sie feststellen, ob das Kontrollkästchen Schreibgeschützt in den Dialogfeldern Windows-Standarddatei öffnen und Datei speichern unter ausgewählt wurde.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das Kontrollkästchen schreibgeschützt im Dialogfeld ausgewählt ist. andernfalls 0.

### <a name="remarks"></a>Hinweise

Sie können das Kontrollkästchen Schreibgeschützt ausblenden, indem Sie im `CFileDialog` Konstruktor den OFN_HIDEREADONLY-Stil festlegen.

> [!NOTE]
> Diese Funktion wird von Windows `CFileDialog` Vista-oder neueren Stil Objekten nicht unterstützt. Wenn Sie versuchen, diese Funktion in Windows Vista oder `CFileDialog` höher zu verwenden, wird [cnotsupportedexception](../../mfc/reference/cnotsupportedexception-class.md)ausgelöst.

##  <a name="getresult"></a>CFileDialog:: GetResult

Ruft die Auswahl ab, die der Benutzer im Dialogfeld getroffen hat.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf ein IShellItem-Element, das die Auswahl des Benutzers darstellt.

### <a name="remarks"></a>Hinweise

##  <a name="getresults"></a>CFileDialog:: GetResults

Ruft die Auswahlmöglichkeiten eines Benutzers in einem Dialogfeld ab, das Mehrfachauswahl zulässt.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf ein ishellitemarray, über das auf die im Dialogfeld ausgewählten Elemente zugegriffen werden kann.

### <a name="remarks"></a>Hinweise

##  <a name="getselectedcontrolitem"></a>CFileDialog:: getselectedcontrolitem

Ruft ein bestimmtes Element aus dem angegebenen Container Steuerelement im Dialogfeld ab.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Container Steuer Elements.

*dwIDItem*<br/>
Die ID des Elements, das der Benutzer im Steuerelement ausgewählt hat.

### <a name="remarks"></a>Hinweise

##  <a name="getstartposition"></a>CFileDialog:: GetStartPosition

Rufen Sie diese Member-Funktion auf, um die Position des ersten Datei Pfadnamens in der Liste `m_ofn.Flags` abzurufen, wenn das OFN_ALLOWMULTISELECT-Flag festgelegt ist.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Rückgabewert

Ein Positionswert, der für Iterationen verwendet werden kann. NULL, wenn die Liste leer ist.

##  <a name="hidecontrol"></a>CFileDialog:: hidecontrol

Mit dieser Member-Funktion können Sie das angegebene Steuerelement in einem Dialogfeld "Öffnen" oder "als allgemein speichern" im Explorer-Stil ausblenden.

```
void HideControl(int nID);
```

### <a name="parameters"></a>Parameter

*nID*<br/>
Die ID des auszublendenden Steuer Elements.

### <a name="remarks"></a>Hinweise

Das Dialogfeld muss mit dem OFN_EXPLORER-Stil erstellt worden sein. Andernfalls tritt bei der Funktion ein Fehler auf.

##  <a name="ispickfoldersmode"></a>CFileDialog:: ispickfoldersmode

Bestimmt, ob sich der aktuelle Dialog im Ordner Auswahlmodus befindet.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Rückgabewert

TRUE, wenn sich das Dialogfeld im Ordner Auswahlmodus befindet. andernfalls false.

### <a name="remarks"></a>Hinweise

##  <a name="m_ofn"></a>CFileDialog:: m_ofn

`m_ofn`ist eine Struktur vom Typ `OPENFILENAME`. Die Daten in dieser-Struktur repräsentieren den aktuellen Zustand von `CFileDialog`.

### <a name="remarks"></a>Hinweise

Verwenden Sie diese Struktur, um das Aussehen des Dialog Felds **Datei öffnen** oder **Datei speichern** unter zu initialisieren, nachdem Sie es erstellt haben, aber bevor Sie es mit der [DoModal](#domodal) -Methode anzeigen. Beispielsweise können Sie den *lpstretitle* -Member von `m_ofn` auf die Beschriftung festlegen, die im Dialogfeld enthalten sein soll.

Mit dem [CFileDialog](../../mfc/reference/cfiledialog-class.md)-Stil von Windows Vista oder höher `m_ofn` kann nicht garantiert werden, dass er immer dem Status des Dialog Felds entspricht. Sie wird mit dem Dialogfeld in früheren Versionen von Windows synchronisiert. Weitere Informationen zur Synchronisierung der `m_ofn` Struktur und des `CFileDialog` Zustands unter Windows Vista oder höher finden Sie unter [CFileDialog:: applyofndeshelldialog](#applyofntoshelldialog) und [CFileDialog:: updateofnfromshelldialog](#updateofnfromshelldialog) .

In den `CFileDialog`Dialogfeldern für Windows Vista oder spätere Formatvorlagen werden bestimmte Member und Flags von nicht unterstützt. Dies hat zur Folge, dass diese keine Auswirkung haben.

Im folgenden finden Sie eine Liste der Member, die von Windows Vista oder höher nicht unterstützt werden:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

Die folgenden Flags werden nicht unterstützt und haben daher keine Auswirkungen, wenn Sie Windows Vista oder `CFileDialog`höher verwenden:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES-effektives Always on in Windows Vista oder höher

- OFN_NOLONGNAMES-effektiv immer aus Windows Vista oder höher

- OFN_NONETWORKBUTTON-effektives Always on in Windows Vista oder höher

- OFN_READONLY

- OFN_SHOWHELP

Weitere Informationen zu dieser Struktur finden Sie unter der [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) -Struktur in der Windows SDK.

##  <a name="makeprominent"></a>CFileDialog:: makeprominent

Fügt ein Steuerelement in das Dialogfeld ein, sodass es im Vergleich zu anderen Steuerelementen angezeigt wird.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Steuer Elements.

### <a name="remarks"></a>Hinweise

##  <a name="onbuttonclicked"></a>CFileDialog:: onbuttongeklickt

Wird aufgerufen, wenn auf die Schaltfläche geklickt wird.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID der Schaltfläche.

### <a name="remarks"></a>Hinweise

##  <a name="oncheckbuttontoggled"></a>CFileDialog:: oncheckbuttondeggled

Wird aufgerufen, wenn das Kontrollkästchen aktiviert oder deaktiviert ist.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Kontrollkästchens.

*bChecked*<br/>
Aktiviert oder deaktiviert.

### <a name="remarks"></a>Hinweise

##  <a name="oncontrolactivating"></a>CFileDialog:: oncontrolactivating

Wird aufgerufen, wenn das Steuerelement aktiviert wird.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Steuer Elements.

### <a name="remarks"></a>Hinweise

##  <a name="onfilenamechange"></a>CFileDialog:: onfileamechange

Überschreiben Sie diese Methode, wenn Sie die WM_NOTIFY CDN_SELCHANGE-Meldung verarbeiten möchten.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Hinweise

Das System sendet die CDN_SELCHANGE-Nachricht, wenn der Benutzer eine neue Datei oder einen neuen Ordner in der Datei Liste des Dialog Felds **Öffnen** oder **Speichern** unter auswählt. Überschreiben Sie diese Methode, wenn Sie in Reaktion auf diese Nachricht Aktionen ausführen möchten.

Das System sendet diese Nachricht nur, wenn das Dialogfeld mit aktiviertem OFN_EXPLORER-Flag erstellt wurde. Weitere Informationen zur Benachrichtigung finden Sie unter [CDN_SELCHANGE](/windows/desktop/dlgbox/cdn-selchange). Weitere Informationen zum OFN_EXPLORER-Flag finden Sie in der [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) -Struktur und [in den Dialog Feldern "Öffnen" und "Speichern](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)unter".

##  <a name="onfilenameok"></a>CFileDialog:: onfileameok

Überschreiben Sie diese Funktion nur, wenn Sie eine benutzerdefinierte Validierung von Dateinamen bereitstellen möchten, die in einem gemeinsamen Datei Dialogfeld eingegeben werden.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Rückgabewert

1, wenn der Dateiname kein gültiger Dateiname ist. andernfalls 0.

### <a name="remarks"></a>Hinweise

Mit dieser Funktion können Sie einen Dateinamen für jeden anwendungsspezifischen Grund ablehnen. Normalerweise müssen Sie diese Funktion nicht verwenden, da das Framework standardmäßige Überprüfung von Dateinamen bereitstellt und ein Meldungs Feld anzeigt, wenn ein ungültiger Dateiname eingegeben wird.

Wenn 1 zurückgegeben wird, wird das Dialogfeld angezeigt, damit der Benutzer einen anderen Dateinamen eingeben kann. Die Dialogfeld Prozedur schließt das Dialogfeld, wenn die Rückgabe 0 (null) ist. Andere Rückgabewerte, die ungleich NULL sind, sind derzeit reserviert und sollten nicht verwendet werden.

##  <a name="onfolderchange"></a>CFileDialog:: onfolderchange

Überschreiben Sie diese Funktion, um die WM_NOTIFYCDN_FOLDERCHANGE-Nachricht zu verarbeiten.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Hinweise

Die Benachrichtigungs Meldung wird gesendet, wenn im Dialogfeld Öffnen oder speichern unter ein neuer Ordner geöffnet wird.

Die Benachrichtigung wird nur gesendet, wenn das Dialogfeld mit dem OFN_EXPLORER-Stil erstellt wurde. Weitere Informationen zur Benachrichtigung finden Sie unter [CDN_FOLDERCHANGE](/windows/desktop/dlgbox/cdn-folderchange). Weitere Informationen zum OFN_EXPLORER-Format finden Sie in der [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) -Struktur und [in den Dialog Feldern "Öffnen" und "Speichern](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)unter".

##  <a name="oninitdone"></a>CFileDialog:: oninitdone

Überschreiben Sie diese Funktion, um die WM_NOTIFY CDN_INITDONE-Meldung zu verarbeiten.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Hinweise

Das System sendet diese Benachrichtigungs Meldung, wenn das System das Anordnen von Steuerelementen im Dialogfeld **Öffnen** oder **Speichern** unter abgeschlossen hat, um Platz für die Steuerelemente des untergeordneten Dialog Felds zu schaffen.

Das System sendet dies nur, wenn das Dialogfeld mit dem OFN_EXPLORER-Stil erstellt wurde. Weitere Informationen zur Benachrichtigung finden Sie unter [CDN_INITDONE](/windows/desktop/dlgbox/cdn-initdone). Weitere Informationen zum OFN_EXPLORER-Format finden Sie in der [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) -Struktur und [in den Dialog Feldern "Öffnen" und "Speichern](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)unter".

> [!NOTE]
> Diese Funktion wird von den Dialogfeldern für Windows Vista oder spätere Formatvorlagen nicht unterstützt. Wenn Sie versuchen, diese Funktion in einem Dialogfeld für eine Formatvorlage in Windows Vista oder höher zu verwenden, wird [cnotsupportedexception](../../mfc/reference/cnotsupportedexception-class.md)ausgelöst.

##  <a name="onitemselected"></a>CFileDialog:: onitemselected

Wird aufgerufen, wenn das Containerelement ausgewählt wird.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Container Steuer Elements.

*dwIDItem*<br/>
Die ID des Elements.

### <a name="remarks"></a>Hinweise

##  <a name="onlbselchangednotify"></a>CFileDialog:: onlbselchangednotify

Diese Funktion wird immer dann aufgerufen, wenn die aktuelle Auswahl in einem Listenfeld gerade geändert wird.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Parameter

*nIDBox*<br/>
Die ID für das Listenfeld oder Kombinations Feld, in dem die Auswahl aufgetreten ist.

*iCurSel*<br/>
Der Index der aktuellen Auswahl.

*nCode*<br/>
Der Steuerelement-Benachrichtigungs Code. Dieser Parameter muss einen der folgenden Werte aufweisen:

- CD_LBSELCHANGE gibt an, dass *icurrsel* das ausgewählte Element in einem Listenfeld mit einfacher Auswahl ist.

- CD_LBSELSUB gibt an, dass *icurrsel* nicht mehr in einem Mehrfachauswahl-Listenfeld ausgewählt ist.

- CD_LBSELADD gibt an, dass *icurrsel* in einem Mehrfachauswahl-Listenfeld ausgewählt ist.

- CD_LBSELNOITEMS gibt an, dass in einem Mehrfachauswahl-Listenfeld keine Auswahl vorhanden ist.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, um die benutzerdefinierte Behandlung von Auswahl Änderungen im Listenfeld bereitzustellen. Beispielsweise können Sie diese Funktion verwenden, um die Zugriffsrechte oder das Datum der letzten Änderung der einzelnen Dateien anzuzeigen, die der Benutzer auswählt.

##  <a name="onshareviolation"></a>CFileDialog:: onshareverletzung

Überschreiben Sie diese Funktion, um die benutzerdefinierte Behandlung von Freigabe Verstößen bereitzustellen

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Parameter

*lpszPathName*<br/>
Der Pfad der Datei, in der die Freigabe Verletzung aufgetreten ist.

### <a name="return-value"></a>Rückgabewert

Einer der folgenden Werte:

- OFN_SHAREFALLTHROUGH der Dateiname wird im Dialogfeld zurückgegeben.

- OFN_SHARENOWARN es müssen keine weiteren Maßnahmen ergriffen werden.

- OFN_SHAREWARN der Benutzer erhält die Standard Warnmeldung für diesen Fehler.

### <a name="remarks"></a>Hinweise

Normalerweise müssen Sie diese Funktion nicht verwenden, da das Framework standardmäßige Überprüfungen von Freigabe Verstößen bietet und ein Meldungs Feld anzeigt, wenn eine Freigabe Verletzung auftritt.

Wenn Sie die Überprüfung der Freigabe Verletzungen deaktivieren möchten, verwenden Sie den bitweisen OR-Operator, um das `m_ofn.Flags`Flag OFN_SHAREAWARE mit zu kombinieren.

##  <a name="ontypechange"></a>CFileDialog:: ontypechange

Überschreiben Sie diese Funktion, um die WM_NOTIFYCDN_TYPECHANGE-Nachricht zu verarbeiten.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Hinweise

Die Benachrichtigungs Meldung wird gesendet, wenn der Benutzer einen neuen Dateityp aus der Liste der Dateitypen im Dialogfeld "Öffnen" oder "Speichern unter" auswählt.

Die Benachrichtigung wird nur gesendet, wenn das Dialogfeld mit dem OFN_EXPLORER-Stil erstellt wurde. Weitere Informationen zur Benachrichtigung finden Sie unter [CDN_TYPECHANGE](/windows/desktop/dlgbox/cdn-typechange). Weitere Informationen zum OFN_EXPLORER-Format finden Sie in der [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) -Struktur und [in den Dialog Feldern "Öffnen" und "Speichern](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)unter".

##  <a name="removecontrolitem"></a>CFileDialog:: removecontrolitem

Entfernt ein Element aus einem Container Steuerelement im Dialogfeld.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Container Steuer Elements, aus dem das Element entfernt werden soll.

*dwIDItem*<br/>
Die ID des Elements.

### <a name="remarks"></a>Hinweise

##  <a name="setcheckbuttonstate"></a>CFileDialog:: setcheckbuttonstate

Legt den aktuellen Zustand eines Kontrollkästchens (Kontrollkästchen) im Dialogfeld fest.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Kontrollkästchens.

*bChecked*<br/>
Der Zustand des Kontrollkästchens. TRUE gibt aktiviert an. FALSE weist auf nicht aktiviert hin.

### <a name="remarks"></a>Hinweise

##  <a name="setcontrolitemstate"></a>CFileDialog:: setcontrolitemstate

Legt den aktuellen Zustand eines Elements in einem Container Steuerelement fest, das im Dialogfeld gefunden wurde.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Container Steuer Elements.

*dwIDItem*<br/>
Die ID des Elements.

*dwState*<br/>
Ein oder mehrere Werte aus der cdcontrolstate-Enumeration, die den neuen Zustand des Steuer Elements angeben.

### <a name="remarks"></a>Hinweise

##  <a name="setcontrolitemtext"></a>CFileDialog:: setcontrolitemtext

Legt den Text eines Steuer Elements fest. Beispielsweise der Text, der ein Optionsfeld oder ein Element in einem Menü begleitet.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Container Steuer Elements.

*dwIDItem*<br/>
Die ID des Elements.

*strLabel*<br/>
Der Text des Elements.

### <a name="remarks"></a>Hinweise

##  <a name="setcontrollabel"></a>CFileDialog:: setcontrollabel

Legt den Text fest, der einem Steuerelement zugeordnet ist, z. b. Schaltflächen Text oder eine Bearbeitungsfeld Bezeichnung.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Steuer Elements.

*strLabel*<br/>
Der Name des Steuer Elements.

### <a name="remarks"></a>Hinweise

##  <a name="setcontrolstate"></a>CFileDialog:: setcontrolstate

Legt die aktuelle Sichtbarkeit und den aktivierten Status eines angegebenen Steuer Elements fest.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Steuer Elements.

*dwState*<br/>
Ein oder mehrere Werte aus der cdcontrolstate-Enumeration, die den aktuellen Zustand des Steuer Elements angeben.

### <a name="remarks"></a>Hinweise

##  <a name="setcontroltext"></a>CFileDialog:: setcontroltext

Ruft diese Methode auf, um den Text für das angegebene Steuerelement in einem Dialogfeld " **Öffnen** " oder " **Speichern** unter" im Explorer-Format festzulegen.

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Parameter

*nID*<br/>
in Die ID des Steuer Elements, für das der Text festgelegt werden soll.

*lpsz*<br/>
in Ein Zeiger auf die Zeichenfolge, die den Text enthält, der für das Steuerelement festgelegt werden soll.

### <a name="remarks"></a>Hinweise

Beide Versionen dieser Funktion sind für Anwendungen gültig, die Unicode verwenden. Allerdings ist nur die Version mit dem LPCSTR-Typ für Anwendungen gültig, die ANSI verwenden.

Um diese Methode verwenden zu können, müssen Sie das Dialogfeld mit dem OFN_EXPLORER-Stil erstellen. Andernfalls tritt bei der Funktion ein Fehler auf.

##  <a name="setdefext"></a>CFileDialog:: setdefext

Mit dieser Funktion können Sie die standardmäßige Dateinamenerweiterung für ein Dialogfeld "im Explorer-Format öffnen" oder "als Standard speichern" festlegen.

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Parameter

*lpsz*<br/>
Ein Zeiger auf eine Zeichenfolge, die die für das Dialogfeld Objekt zu verwendende Standard Erweiterung enthält. Diese Zeichenfolge darf keinen Zeitraum (.) enthalten.

### <a name="remarks"></a>Hinweise

Das Dialogfeld muss mit dem OFN_EXPLORER-Stil erstellt worden sein. Andernfalls tritt bei der Funktion ein Fehler auf.

##  <a name="seteditboxtext"></a>CFileDialog:: Einstellungs Text

Legt den aktuellen Text in einem Bearbeitungsfeld-Steuerelement fest.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Bearbeitungs Felds.

*strText*<br/>
Der Textwert.

### <a name="remarks"></a>Hinweise

##  <a name="setproperties"></a>CFileDialog:: SetProperties

Bietet einen Eigenschaftenspeicher, der die Standardwerte definiert, die für das zu speichernde Element verwendet werden sollen.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Parameter

*lpszPropList*<br/>
Eine Liste der vordefinierten Eigenschaften, die durch ein ";" voneinander getrennt sind. Eine Liste der Flags finden Sie im Abschnitt **Flags** von [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew).

### <a name="remarks"></a>Hinweise

##  <a name="setselectedcontrolitem"></a>CFileDialog:: setselectedcontrolitem

Legt den ausgewählten Zustand eines bestimmten Elements in einer Optionsfeld Gruppe oder einem Kombinations Feld im Dialogfeld fest.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Container Steuer Elements.

*dwIDItem*<br/>
Die ID des Elements, das der Benutzer im Steuerelement ausgewählt hat.

### <a name="remarks"></a>Hinweise

##  <a name="settemplate"></a>CFileDialog:: Server Plate

Legt die Dialogfeld Vorlage für das [CFileDialog](../../mfc/reference/cfiledialog-class.md) -Objekt fest.

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Parameter

*nWin3ID*<br/>
in Enthält die ID-Nummer der Vorlagen Ressource für das nicht-Explorer `CFileDialog` -Objekt. Diese Vorlage wird nur für Windows NT 3,51 oder für den Fall verwendet, dass der OFN_EXPLORER-Stil nicht vorhanden ist.

*nWin4ID*<br/>
in Enthält die ID-Nummer der Vorlagen Ressource für das Explorer `CFileDialog` -Objekt. Diese Vorlage wird nur für Windows NT 4,0 und höhere Versionen, Windows 95 und höhere Versionen oder wenn der OFN_EXPLORER-Stil vorhanden ist, verwendet.

*lpWin3ID*<br/>
in Enthält den Namen der Vorlagen Ressource für das nicht-Explorer `CFileDialog` -Objekt. Diese Vorlage wird nur für Windows NT 3,51 oder für den Fall verwendet, dass der OFN_EXPLORER-Stil nicht vorhanden ist.

*lpWin4ID*<br/>
in Enthält den Namen der Vorlagen Ressource des Explorer `CFileDialog` -Objekts. Diese Vorlage wird nur für Windows NT 4,0 und höhere Versionen, Windows 95 und höhere Versionen oder wenn der OFN_EXPLORER-Stil vorhanden ist, verwendet.

### <a name="remarks"></a>Hinweise

Das System verwendet nur eine der angegebenen Vorlagen. Das System bestimmt, welche Vorlage verwendet werden soll, basierend auf dem vorhanden sein des OFN_EXPLORER-Stils und dem Betriebssystem, auf dem die Anwendung ausgeführt wird. Wenn Sie sowohl eine nicht-Explorer-Vorlage als auch eine Explorer-Vorlage angeben, ist es einfach, Windows NT 3,51, Windows NT 4,0 und höhere Versionen und Windows 95 und höhere Versionen zu unterstützen.

> [!NOTE]
> Diese Funktion wird von den Dialogfeldern Windows Vista oder höher Formatierungs Datei nicht unterstützt. Wenn Sie versuchen, diese Funktion im Dialogfeld Format Datei in Windows Vista oder höher zu verwenden, wird [cnotsupportedexception](../../mfc/reference/cnotsupportedexception-class.md)ausgelöst. Eine Alternative ist die Verwendung eines angepassten Dialog Felds. Weitere Informationen zur Verwendung eines benutzerdefinierten `CFileDialog`finden Sie unter [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

##  <a name="startvisualgroup"></a>CFileDialog:: startvisualgroup

Deklariert eine visuelle Gruppe im Dialogfeld. Nachfolgende Aufrufe einer "Add"-Methode fügen diese Elemente zu dieser Gruppe hinzu.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID der visuellen Gruppe.

*strLabel*<br/>
Der Gruppenname.

### <a name="remarks"></a>Hinweise

##  <a name="updateofnfromshelldialog"></a>CFileDialog:: updateofnfromshelldialog

Aktualisiert die `m_ofn` Datenstruktur von [CFileDialog](../../mfc/reference/cfiledialog-class.md) basierend auf dem aktuellen Status des internen Objekts.

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Hinweise

In Windows-Versionen vor Windows Vista wurde die Datenstruktur des [OpenFileName](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) -Members fortlaufend mit dem Zustand von `CFileDialog`synchronisiert. Alle Änderungen an der [m_ofn](#m_ofn) -Member-Variable haben direkt Auswirkungen auf den Status des Dialog Felds. Außerdem wurde durch alle Änderungen am Zustand des Dialog Felds die m_ofn-Member-Variable sofort aktualisiert.

In Windows Vista oder höher wird die `m_ofn` Datenstruktur nicht automatisch aktualisiert. Um die Genauigkeit der Daten in der `m_ofn` Element Variablen sicherzustellen, sollten Sie die `UpdateOFNFromShellDialog` -Funktion aufrufen, bevor Sie auf die Daten zugreifen. Diese Funktion wird von Windows bei der Verarbeitung von [ifiledialog:: OnFileOk](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok)automatisch aufgerufen.

Weitere Informationen zur Verwendung der `CFileDialog` -Klasse unter Windows Vista oder höher finden Sie unter [CFileDialog-Klasse](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Beispiel

In diesem Beispiel wird `CFileDialog` das aktualisiert, bevor es angezeigt wird. Vor dem Aktualisieren `m_ofn` der Element Variablen muss Sie mit dem aktuellen Status des Dialog Felds synchronisiert werden.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>Siehe auch

[CCommonDialog-Klasse](../../mfc/reference/ccommondialog-class.md)<br/>
[Hierarchiediagramm](../../mfc/hierarchy-chart.md)
