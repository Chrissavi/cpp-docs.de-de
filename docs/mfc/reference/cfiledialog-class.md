---
title: CFileDialog-Klasse
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: 247072d815b660fcd2cc6c2a1291b618aa6ce2ab
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753141"
---
# <a name="cfiledialog-class"></a>CFileDialog-Klasse

Kapselt das allgemeine Dialogfeld, das für Dateiöffnungs- oder Dateispeichervorgänge verwendet wird.

## <a name="syntax"></a>Syntax

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Member

### <a name="public-constructors"></a>Öffentliche Konstruktoren

|Name|BESCHREIBUNG|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|Erstellt ein `CFileDialog`-Objekt.|

### <a name="public-methods"></a>Öffentliche Methoden

|Name|BESCHREIBUNG|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|Fügt dem Dialogfeld eine Häkchen-Schaltfläche hinzu.|
|[CFileDialog::AddComboBox](#addcombobox)|Fügt dem Dialogfeld ein Kombinationsfeld hinzu.|
|[CFileDialog::AddControlItem](#addcontrolitem)|Fügt einem Containersteuerelement im Dialogfeld ein Element hinzu.|
|[CFileDialog::AddEditBox](#addeditbox)|Fügt dem Dialogfeld ein Bearbeitungsfeld hinzu.|
|[CFileDialog::AddMenu](#addmenu)|Fügt dem Dialogfeld ein Menü hinzu.|
|[CFileDialog::AddPlace](#addplace)|Ist überladen. Fügt der Liste der Orte, die dem Benutzer zum Öffnen oder Speichern von Elementen zur Verfügung stehen, einen Ordner hinzu.|
|[CFileDialog::AddPushButton](#addpushbutton)|Fügt dem Dialogfeld eine Schaltfläche hinzu.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Fügt dem Dialogfeld eine Optionsschaltfläche (auch als Optionsfeld bezeichnet) hinzu.|
|[CFileDialog::AddSeparator](#addseparator)|Fügt dem Dialogfeld ein Trennzeichen hinzu.|
|[CFileDialog::AddText](#addtext)|Fügt dem Dialogfeld Textinhalt hinzu.|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Aktualisiert den Status `CFileDialog` des, um den Parametern und Flags zu entsprechen, die in der `m_ofn` Membervariablen gespeichert sind.|
|[CFileDialog::DoModal](#domodal)|Zeigt das Dialogfeld an und ermöglicht es dem Benutzer, eine Auswahl zu treffen.|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Aktiviert eine Dropdown-Liste auf der Schaltfläche **Öffnen** oder **Speichern** im Dialogfeld.|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Beendet das Hinzufügen von Elementen zu einer visuellen Gruppe im Dialogfeld.|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Ruft den aktuellen Status einer Kontrollkästchentaste (Kontrollkästchen) im Dialogfeld ab.|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Ruft den aktuellen Status eines Elements in einem Containersteuerelement ab, das im Dialogfeld gefunden wurde.|
|[CFileDialog::GetControlState](#getcontrolstate)|Ruft die aktuelle Sichtbarkeit und aktivierten Zustände eines bestimmten Steuerelements ab.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Ruft den aktuellen Text in einem Bearbeitungsfeldsteuerelement ab.|
|[CFileDialog::GetFileExt](#getfileext)|Gibt die Erweiterung der ausgewählten Datei zurück.|
|[CFileDialog::GetFileName](#getfilename)|Gibt den Dateinamen der ausgewählten Datei zurück.|
|[CFileDialog::GetFileTitle](#getfiletitle)|Gibt den Titel der ausgewählten Datei zurück.|
|[CFileDialog::GetFolderPath](#getfolderpath)|Ruft den Pfad des aktuell geöffneten Ordners oder Verzeichnisses für ein Dialogfeld **"Öffnen"** im Explorer-Stil oder "Als speichern **als speichern"** ab.|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Ruft das interne COM-Objekt `CFileDialog` für ein benutzerdefiniertes Objekt ab.|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Ruft das interne COM-Objekt für ein `CFileDialog` ab, das als Dialogfeld **"Datei öffnen"** verwendet wird.|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Ruft das interne COM-Objekt für ein `CFileDialog` ab, das als Dialogfeld Datei **speichern** verwendet wird.|
|[CFileDialog::GetNextPathName](#getnextpathname)|Gibt den vollständigen Pfad der nächsten ausgewählten Datei zurück.|
|[CFileDialog::GetOFN](#getofn)|Ruft die `OPENFILENAME` Struktur `CFileDialog` des Objekts ab.|
|[CFileDialog::GetPathName](#getpathname)|Gibt den vollständigen Pfad der ausgewählten Datei zurück.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Gibt den schreibgeschützten Status der ausgewählten Datei zurück.|
|[CFileDialog::GetResult](#getresult)|Ruft die Auswahl ab, die der Benutzer im Dialogfeld getroffen hat.|
|[CFileDialog::GetResults](#getresults)|Ruft die Auswahlmöglichkeiten des Benutzers in einem Dialogfeld ab, das eine Mehrfachauswahl zulässt.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Ruft ein bestimmtes Element aus angegebenen Containersteuerelementen im Dialogfeld ab.|
|[CFileDialog::GetStartPosition](#getstartposition)|Gibt die Position des ersten Elements der Dateinamenliste zurück.|
|[CFileDialog::HideControl](#hidecontrol)|Blendet das angegebene Steuerelement in einem dialogfeld **"Öffnen"** im Explorer- oder Speichern unter dem allgemeinen Dialogfeld **aus.**|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Bestimmt, ob das aktuelle Dialogfeld im Ordnerauswahlmodus angezeigt wird.|
|[CFileDialog::MakeProminent](#makeprominent)|Platziert ein Steuerelement im Dialogfeld, sodass es sich im Vergleich zu anderen hinzugefügten Steuerelementen abhebt.|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Entfernt ein Element aus einem Containersteuerelement im Dialogfeld.|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Legt den aktuellen Status einer Kontrollkästchentaste (Kontrollkästchen) im Dialogfeld fest.|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Legt den aktuellen Status eines Elements in einem Containersteuerelement fest, das im Dialogfeld gefunden wird.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Legt den Text eines Steuerelementelements fest. Beispielsweise der Text, der einem Optionsfeld oder einem Element in einem Menü beiliegt.|
|[CFileDialog::SetControlLabel](#setcontrollabel)|Legt den Text fest, der einem Steuerelement zugeordnet ist, z. B. Schaltflächentext oder eine Bearbeitungsfeldbeschriftung.|
|[CFileDialog::SetControlState](#setcontrolstate)|Legt die aktuelle Sichtbarkeit und aktivierten Zustände eines bestimmten Steuerelements fest.|
|[CFileDialog::SetControlText](#setcontroltext)|Legt den Text für das angegebene Steuerelement in einem Dialogfeld **"Öffnen"** im Explorer- oder **Speichern unter** dem gemeinsamen Dialogfeld fest.|
|[CFileDialog::SetDefExt](#setdefext)|Legt die Standarddateinamenerweiterung für ein dialogfeld **"Öffnen"** im Explorer-Stil oder **"Als speichern als speichern"** fest.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Legt den aktuellen Text in einem Bearbeitungsfeldsteuerelement fest.|
|[CFileDialog::SetProperties](#setproperties)|Bietet einen Eigenschaftenspeicher, der die Standardwerte definiert, die für das zu speichernde Element verwendet werden sollen.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Legt den ausgewählten Status eines bestimmten Elements in einer Optionsschaltflächengruppe oder einem Kombinationsfeld im Dialogfeld fest.|
|[CFileDialog::SetTemplate](#settemplate)|Legt die Dialogfeldvorlage `CFileDialog` für das Objekt fest.|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Deklariert eine visuelle Gruppe im Dialogfeld. Nachfolgende Aufrufe einer "add"-Methode fügen diese Elemente dieser Gruppe hinzu.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Aktualisiert die in `m_ofn` der Membervariablen gespeicherten Daten so, dass sie dem aktuellen Status des Dateidialogfelds entsprechen.|

### <a name="protected-methods"></a>Geschützte Methoden

|Name|BESCHREIBUNG|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Wird aufgerufen, wenn auf die Schaltfläche geklickt wird.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Wird aufgerufen, wenn das Kontrollkästchen aktiviert ist/ deaktiviert ist.|
|[CFileDialog::OnControlAktivaktivieren](#oncontrolactivating)|Wird aufgerufen, wenn das Steuerelement aktiv ist.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Behandelt die WM_NOTIFY CDN_SELCHANGE Nachricht.|
|[CFileDialog::OnFileNameOK](#onfilenameok)|Überprüft den im Dialogfeld eingegebenen Dateinamen.|
|[CFileDialog::OnFolderChange](#onfolderchange)|Behandelt die WM_NOTIFY CDN_FOLDERCHANGE Nachricht.|
|[CFileDialog::OnInitDone](#oninitdone)|Behandelt die WM_NOTIFY CDN_INITDONE Nachricht.|
|[CFileDialog::OnItemSelected](#onitemselected)|Wird aufgerufen, wenn das Containerelement ausgewählt wird.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Ermöglicht es Ihnen, benutzerdefinierte Aktionen auszuführen, wenn sich die Dateiauswahl ändert.|
|[CFileDialog::OnShareViolation](#onshareviolation)|Behandelt Freigabeverletzungen.|
|[CFileDialog::OnTypeChange](#ontypechange)|Behandelt die WM_NOTIFY CDN_TYPECHANGE Nachricht.|

### <a name="public-data-members"></a>Öffentliche Datenmember

|Name|BESCHREIBUNG|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|Die `OPENFILENAME` Windows-Struktur. Bietet Zugriff auf grundlegende Dateidialogfeldparameter.|

## <a name="remarks"></a>Bemerkungen

In allgemeinen Dateidialogfeldern können Sie Dialogfelder für die Dateiauswahl implementieren, z. B. **Datei öffnen** und **Speichern unter,** und das in übereinstimmung mit Windows-Standards.

Sie können `CFileDialog` wie mit dem bereitgestellten Konstruktor verwenden, oder Sie `CFileDialog` können Ihre eigene Dialogfeldklasse ableiten und einen Konstruktor entsprechend Ihren Anforderungen schreiben. In beiden Fällen verhalten sich diese Dialogfelder wie Standard-MFC-Dialogfelder, da sie von der [CCommonDialog-Klasse](../../mfc/reference/ccommondialog-class.md)abgeleitet sind. `CFileDialog`sich auf das COMMDLG verlässt. DLL-Datei, die in Windows enthalten ist.

Sowohl das Erscheinungsbild als `CFileDialog` auch die Funktionalität der mit Windows Vista oder höher unterscheiden sich von den früheren Versionen von Windows. Der `CFileDialog` Standardverwendet automatisch den neuen Windows Vista- oder höher-Stil ohne Codeänderungen, wenn ein Programm kompiliert und unter Windows Vista oder höher ausgeführt wird. Verwenden Sie den Parameter *bVistaStyle* im Konstruktor, um diese automatische Aktualisierung manuell zu überschreiben. Die Ausnahme von der automatischen Aktualisierung sind benutzerdefinierte Dialogfelder. Sie werden nicht in den neuen Stil konvertiert. Weitere Informationen zum Konstruktor finden Sie unter [CFileDialog::CFileDialog](#cfiledialog).

> [!NOTE]
> Das Steuerungs-ID-System unterscheidet sich in Windows Vista oder `CFileDialog`höher von früheren Windows-Versionen, wenn Sie eine verwenden. Sie müssen alle `CFileDialog` Verweise auf Steuerelemente im Code aktualisieren, bevor Sie Das Projekt von einer früheren Windows-Version portieren können.

Einige `CFileDialog` Methoden werden unter Windows Vista oder höher nicht unterstützt. Überprüfen Sie das einzelne Methodenthema, um Informationen darüber zu erhalten, ob die Methode unterstützt wird. Darüber hinaus werden die folgenden geerbten Funktionen unter Windows Vista oder höher nicht unterstützt:

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

Die Windows-Meldungen `CFileDialog` für die Klasse variieren je nach verwendetm Betriebssystem. Windows XP unterstützt z. B. [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel) und [CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok) für die `CFileDialog` Klasse nicht. Windows Vista und spätere Betriebssysteme unterstützen sie jedoch. Weitere Informationen zu den verschiedenen generierten Nachrichten und der Reihenfolge, in der sie empfangen werden, finden Sie unter [CFileDialog Sample: Logging Event Order](../../overview/visual-cpp-samples.md).

Um ein `CFileDialog` Objekt zu verwenden, erstellen `CFileDialog` Sie das Objekt zuerst mithilfe des Konstruktors. Nachdem das Dialogfeld erstellt wurde, können Sie beliebige Werte in der [CFileDialog::m_ofn-Struktur](#m_ofn) festlegen oder ändern, um die Werte oder Zustände der Dialogfeldsteuerelemente zu initialisieren. Die `m_ofn` Struktur ist `OPENFILENAME`vom Typ . Weitere Informationen finden Sie in der [OPENFILENAME-Struktur](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) im Windows SDK.

Nachdem Sie die Dialogfeldsteuerelemente initialisiert haben, rufen Sie die [CFileDialog::DoModal-Methode](#domodal) auf, um das Dialogfeld anzuzeigen, damit der Benutzer den Pfad und den Dateinamen eingeben kann. `DoModal`gibt an, ob der Benutzer auf die Schaltfläche OK (IDOK) oder Abbrechen (IDCANCEL) geklickt hat. Wenn `DoModal` IDOK zurückgegeben wird, können `CFileDialog` Sie eine der öffentlichen Memberfunktionen verwenden, um die vom Benutzer eingesendeten Informationen abzurufen.

> [!NOTE]
> Unter Windows Vista oder höher verursachen mehrere Aufrufe von [IFileDialog::SetFileTypes](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) einen Fehler. Der zweite `SetFileTypes` Aufruf für eine `CFileDialog` Instanz von a gibt E_UNEXPECTED in Windows Vista oder höher zurück. Einige `CFileDialog` Methodenfunktionen `SetFileTypes`rufen auf. Beispielsweise werden zwei `CFileDialog::DoModal` Aufrufe für dieselbe `CFileDialog` Instanz einer [generierten ASSERT](diagnostic-services.md#assert)durchgeführt.

`CFileDialog`enthält mehrere geschützte Member, mit denen Sie benutzerdefinierten Umgang mit Freigabeverletzungen, Dateinamenüberprüfung und Listenfeldänderungsbenachrichtigung ausführen können. Bei diesen geschützten Membern handelt es sich um Rückruffunktionen, die von den meisten Anwendungen nicht verwendet werden müssen, da die Standardbehandlung automatisch ausgeführt wird. Meldungszuordnungseinträge für diese Funktionen sind nicht erforderlich, da es sich um virtuelle Standardfunktionen handelt.

Sie können die Windows [CommDlgExtendedError-Funktion](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) verwenden, um zu ermitteln, ob während der Initialisierung des Dialogfelds ein Fehler aufgetreten ist, und um mehr über den Fehler zu erfahren.

Die Zerstörung `CFileDialog` von Objekten wird automatisch gehandhabt. Sie müssen [cDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog)nicht aufrufen.

Damit der Benutzer mehrere Dateien auswählen kann, `DoModal`legen Sie das OFN_ALLOWMULTISELECT-Flag fest, bevor Sie aufrufen. Sie müssen einen eigenen Dateinamenpuffer angeben, um die zurückgegebene Liste mehrerer Dateinamen aufzunehmen. Ersetzen Sie `m_ofn.lpstrFile` dies durch einen Zeiger auf einen Puffer, `CFileDialog`den Sie `DoModal`zugewiesen haben, nachdem Sie die erstellt haben, aber vor dem Aufruf .

Darüber hinaus müssen `m_ofn.nMaxFile` Sie die Anzahl der Zeichen im `m_ofn.lpstrFile`Puffer festlegen, auf die von verwiesen wird. Wenn Sie die maximale Anzahl der `n`auszuwählenden Dateien auf `n * (_MAX_PATH + 1) + 1`festlegen, ist die erforderliche Puffergröße . Das erste im Puffer zurückgegebene Element ist der Pfad zu dem Ordner, in dem die Dateien ausgewählt wurden. Für Dialogfelder in Windows Vista oder späteren Stilen werden die Verzeichnis- und Dateinamenzeichenfolgen null beendet, wobei ein zusätzliches Nullzeichen nach dem letzten Dateinamen angezeigt wird. Mit diesem Format können die Dialogfelder im Explorer-Stil lange Dateinamen zurückgeben, die Leerzeichen enthalten. Bei Dialogfeldern im alten Stil werden die Verzeichnis- und Dateinamenzeichenfolgen durch Leerzeichen getrennt, und die Funktion verwendet kurze Dateinamen für Dateinamen mit Leerzeichen.

Im folgenden Beispiel wird veranschaulicht, wie Sie einen Puffer zum Abrufen und Auflisten mehrerer Dateinamen verwenden.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Um die Puffergröße als Reaktion auf die Auswahl mehrerer Dateinamen durch `CFileDialog` den Benutzer zu ändern, müssen Sie eine neue Klasse von der [CFileDialog::OnFileNameChange-Methode](#onfilenamechange) ableiten und überschreiben.

Wenn Sie eine neue `CFileDialog`Klasse von ableiten, können Sie eine Nachrichtenzuordnung verwenden, um nachrichtenzubehandeln. Um die Standardnachrichtenbehandlung zu erweitern, `CFileDialog`leiten Sie eine Klasse von ab , fügen Sie der neuen Klasse eine Nachrichtenzuordnung hinzu, und stellen Sie Memberfunktionen für die neuen Nachrichten bereit. Sie müssen keine Hook-Funktion bereitstellen, um das Dialogfeld anzupassen.

Um das Dialogfeld anzupassen, leiten `CFileDialog`Sie eine Klasse von ab, stellen Sie eine benutzerdefinierte Dialogfeldvorlage bereit, und fügen Sie eine Meldungszuordnung hinzu, um die Benachrichtigungen aus den erweiterten Steuerelementen zu verarbeiten. Übergeben Sie alle nicht verarbeiteten Nachrichten an die Basisklasse. Sie müssen die Hook-Funktion nicht anpassen.

Wenn Sie den Windows Vista- oder `CFileDialog`höher-Stil der verwenden, können Sie keine Meldungszuordnungen und Dialogfeldvorlagen verwenden. Stattdessen müssen Sie die COM-Schnittstellen für ähnliche Funktionen verwenden.

Weitere Informationen zur Verwendung `CFileDialog`finden Sie unter [Allgemeine Dialogklassen](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Vererbungshierarchie

[Cobject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Requirements (Anforderungen)

**Kopf:** afxdlgs.h

## <a name="cfiledialogaddcheckbutton"></a><a name="addcheckbutton"></a>CFileDialog::AddCheckButton

Fügt dem Dialogfeld eine Häkchen-Schaltfläche hinzu.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID der hinzuzufügenden Prüfschaltfläche.

*strLabel*<br/>
Der Name der Schaltfläche "Check".

*bGeprüft*<br/>
Ein boolescher Wert, der den aktuellen Status der Prüfschaltfläche angibt. TRUE, wenn aktiviert; FALSE sonst

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogaddcombobox"></a><a name="addcombobox"></a>CFileDialog::AddComboBox

Fügt dem Dialogfeld ein Kombinationsfeld hinzu.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des hinzuzufügenden Kombinationsfelds.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogaddcontrolitem"></a><a name="addcontrolitem"></a>CFileDialog::AddControlItem

Fügt einem Containersteuerelement im Dialogfeld ein Element hinzu.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Containersteuerelements, dem das Element hinzugefügt werden soll.

*dwIDItem*<br/>
Die ID des Elements.

*strLabel*<br/>
Text des Elements.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogaddeditbox"></a><a name="addeditbox"></a>CFileDialog::AddEditBox

Fügt dem Dialogfeld ein Bearbeitungsfeld hinzu.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des hinzuzufügenden Bearbeitungsfelds.

*strText*<br/>
Der Name des Bearbeitungsfelds.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogaddmenu"></a><a name="addmenu"></a>CFileDialog::AddMenu

Fügt dem Dialogfeld ein Menü hinzu.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des hinzuzufügenden Menüs.

*strLabel*<br/>
Der Menüname.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogaddplace"></a><a name="addplace"></a>CFileDialog::AddPlace

Fügt der Liste der Orte, die dem Benutzer zum Öffnen oder Speichern von Elementen zur Verfügung stehen, einen Ordner hinzu.

```cpp
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Parameter

*lpszFolder*<br/>
Ein Pfad zum Ordner, der dem Benutzer zur Verfügung gestellt werden soll. Dies kann nur ein Ordner sein.

*fdap*<br/>
Gibt an, wo der Ordner in der Liste platziert wird.

*psi*<br/>
Ein Zeiger auf ein IShellItem, das den Ordner darstellt, der dem Benutzer zur Verfügung gestellt werden soll. Dies kann nur ein Ordner sein.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogaddpushbutton"></a><a name="addpushbutton"></a>CFileDialog::AddPushButton

Fügt dem Dialogfeld eine Schaltfläche hinzu.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID der hinzuzufügenden Schaltfläche.

*strLabel*<br/>
Der Schaltflächenname.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogaddradiobuttonlist"></a><a name="addradiobuttonlist"></a>CFileDialog::AddRadioButtonList

Fügt dem Dialogfeld eine Optionsschaltfläche (auch als Optionsfeld bezeichnet) hinzu.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID der hinzuzufügenden Optionsschaltflächengruppe.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogaddseparator"></a><a name="addseparator"></a>CFileDialog::AddSeparator

Fügt dem Dialogfeld ein Trennzeichen hinzu.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Trennzeichens add.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogaddtext"></a><a name="addtext"></a>CFileDialog::AddText

Fügt dem Dialogfeld Text hinzu.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des hinzuzufügenden Textes.

*strText*<br/>
Der Textname.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogapplyofntoshelldialog"></a><a name="applyofntoshelldialog"></a>CFileDialog::ApplyOFNToShellDialog

Aktualisiert den aktuellen Status des [CFileDialogs](../../mfc/reference/cfiledialog-class.md) basierend `m_ofn` auf den in der Datenstruktur gespeicherten Werten.

```cpp
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Bemerkungen

In Versionen von Windows vor Windows Vista wurde die [Element-OPENFILENAME-Datenstruktur](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) kontinuierlich mit dem Status der `CFileDialog`synchronisiert. Alle Änderungen [m_ofn](#m_ofn) an der m_ofn-Membervariablen wurden sofort im Status des Dialogfelds widergespiegelt. Außerdem aktualisieren alle Änderungen am Status des `m_ofn` Dialogfelds sofort die Membervariable.

In Windows Vista oder höher `m_ofn` `CFileDialog` werden die Werte in der Membervariablen und im Status des nicht garantiert synchronisiert. Diese Funktion erzwingt, `CFileDialog` dass der Status `m_ofn` des aktualisiert werden muss, um der Struktur zu entsprechen. Windows ruft diese Funktion während [CFileDialog::DoModal](#domodal)automatisch auf.

Weitere Informationen zur Verwendung `CFileDialog` der Klasse unter Windows Vista oder höher finden Sie unter [CFileDialog-Klasse](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Beispiel

  Siehe Beispiel für [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog).

## <a name="cfiledialogcfiledialog"></a><a name="cfiledialog"></a>CFileDialog::CFileDialog

Rufen Sie diese Funktion auf, um ein standardmäßiges Windows-Dateidialogfeld zu erstellen.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Parameter

*bOpenFileDialog*<br/>
[in] Der Parameter, der angibt, welcher Typ des zu erstellenden Dialogfelds erstellt werden soll. Legen Sie true fest, um ein Dialogfeld **"Datei geöffnet"** zu erstellen. Legen Sie false fest, um ein Dialogfeld **Datei speichern als** zu erstellen.

*lpszDefExt*<br/>
[in] Die Standarderweiterung des Dateinamens. Wenn der Benutzer keine bekannte Erweiterung (eine, die eine Zuordnung auf dem Computer des Benutzers hat) in das Feld Dateiname einfügt, wird die von *lpszDefExt* angegebene Erweiterung automatisch an den Dateinamen angehängt. Wenn dieser Parameter NULL ist, wird keine Erweiterung angehängt.

*lpszFileName*<br/>
[in] Der ursprüngliche Dateiname, der im Feld Dateiname angezeigt wird. Wenn NULL, wird kein ursprünglicher Dateiname angezeigt.

*dwFlags*<br/>
[in] Eine Kombination aus einem oder mehreren Flags, mit denen Sie das Dialogfeld anpassen können. Eine Beschreibung dieser Flags finden Sie in der [OPENFILENAME-Struktur](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) im Windows SDK. Wenn Sie `m_ofn.Flags` das Strukturelement ändern, verwenden Sie in Ihren Änderungen einen bitweisen ODER-Operator, um das Standardverhalten intakt zu halten.

*lpszFilter*<br/>
[in] Eine Reihe von Zeichenfolgenpaaren, die Filter angeben, die Sie auf die Datei anwenden können. Wenn Sie Dateifilter angeben, werden nur Dateien angezeigt, die den Filterkriterien entsprechen, und die Liste "Dateien" werden angezeigt. Weitere Informationen zum Arbeiten mit Dateifiltern finden Sie im Abschnitt "Hinweise".

*pParentWnd*<br/>
[in] Ein Zeiger auf das übergeordnete oder Besitzerfenster des Dateidialogfelds.

*dwSize*<br/>
[in] Die Größe `OPENFILENAME` der Struktur. Dieser Wert hängt von der Betriebssystemversion ab. MFC verwendete diesen Parameter, um die geeignete Art von Dialogfeld zu bestimmen, das erstellt werden soll. Die Standardgröße von 0 bedeutet, dass der MFC-Code die richtige Dialogfeldgröße bestimmt, die basierend auf der Betriebssystemversion verwendet werden soll, auf der das Programm ausgeführt wird.

*bVistaStyle*<br/>
[in] **Hinweis** Dieser Parameter ist in Visual Studio 2008 und höher verfügbar und bewirkt, dass das Dialogfeld im neuen Stil nur verwendet wird, wenn Sie in Windows Vista oder höher ausgeführt werden.

Der Parameter, der den Stil des Dateidialogs angibt. Legen Sie true fest, um die neuen Dateidialogfelder im Vista-Stil zu verwenden. Andernfalls wird der alte Stil der Dialogfelder verwendet. Weitere Informationen zum Ausführen unter Vista finden Sie im Abschnitt "Bemerkungen".

### <a name="remarks"></a>Bemerkungen

Je nach Wert von *bOpenFileDialog*wird entweder ein Dialogfeld **Datei öffnen** oder Datei **speichern als** erstellt.

Das Angeben einer Standarderweiterung mit *lpszDefExt* führt möglicherweise nicht zu dem erwarteten Verhalten, da selten vorhersagbar ist, welche Erweiterungen Dateizuordnungen auf dem Computer des Benutzers aufweisen. Wenn Sie mehr Kontrolle über das Anfügen einer Standarderweiterung benötigen, `CFileDialog`können Sie `CFileDialog::OnFileNameOK` Ihre eigene Klasse von ableiten und die Methode überschreiben, um eine eigene Erweiterungsbehandlung auszuführen.

Damit der Benutzer mehrere Dateien auswählen kann, legen Sie das OFN_ALLOWMULTISELECT-Flag fest, bevor Sie [DoModal](#domodal)aufrufen. Sie müssen einen eigenen Dateinamenpuffer angeben, um die zurückgegebene Liste mehrerer Dateinamen zu speichern. Ersetzen Sie `m_ofn.lpstrFile` dies durch einen Zeiger auf einen Puffer, den Sie zugewiesen haben, nachdem Sie den [CFileDialog](../../mfc/reference/cfiledialog-class.md)erstellt haben, aber bevor Sie aufrufen. `DoModal` Darüber hinaus müssen `m_ofn.nMaxFile` Sie die Anzahl der Zeichen `m_ofn.lpstrFile`im Puffer festlegen, auf die von verwiesen wird. Wenn Sie die maximale Anzahl der *n*auszuwählenden Dateien auf `n`n festlegen, beträgt die erforderliche Puffergröße *(_MAX_PATH + 1) + 1. Beispiel:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Damit der Benutzer die Größe eines Dialogfelds im Explorer-Stil mithilfe der Maus oder der Tastatur ändern kann, legen Sie das OFN_ENABLESIZING-Flag fest. Das Festlegen dieses Flags ist nur erforderlich, wenn Sie eine Hook-Prozedur oder eine benutzerdefinierte Vorlage bereitstellen. Das Flag funktioniert nur mit einem Dialogfeld im Explorer-Stil. Die Größe der Dialogfelder im alten Stil kann nicht geändert werden.

Der Parameter *lpszFilter* wird verwendet, um den Dateinamentyp zu bestimmen, den eine Datei in der Dateiliste anzeigen muss. Die erste Zeichenfolge im Zeichenfolgenpaar beschreibt den Filter. Die zweite Zeichenfolge gibt die zu verwendende Dateinamenerweiterung an. Mehrere Erweiterungen können mit einem Semikolon (dem Zeichen ';') als Trennzeichen angegeben werden. Die Zeichenfolge endet mit zwei "&#124;"-Zeichen, gefolgt von einem NULL-Zeichen. Sie können auch ein [CString-Objekt](../../atl-mfc-shared/using-cstring.md) für diesen Parameter verwenden.

Microsoft Excel ermöglicht es Benutzern beispielsweise, Dateien zu öffnen, die unter anderem die Erweiterungen .xlc (Diagramm) oder .xls (Arbeitsblatt) haben. Der Filter für Excel könnte wie folgende geschrieben werden:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

Wenn Sie jedoch diese Zeichenfolge verwenden möchten, um die `OPENFILENAME` Struktur direkt zu aktualisieren, sollten Sie die Zeichenfolgen durch das Nullzeichen ''''''''' anstelle der vertikalen Balken ('&#124;') begrenzen.

Der *Parameter bVistaStyle* ist nur anwendbar, wenn er unter Windows Vista oder höher ausgeführt wird. In früheren Versionen von Windows wird dieser Parameter ignoriert. Wenn *bVistaStyle* auf TRUE festgelegt ist, wird beim Kompilieren eines Programms mit Visual Studio 2008 oder höher der neue **Dateidialog** im Vista-Stil verwendet. Andernfalls wird der vorherige MFC-Stil **Dateidialog** verwendet.

Dialogvorlagen werden in Dialogfeldern, die auf *bVistaStyle basieren,* nicht unterstützt.

### <a name="example"></a>Beispiel

  Siehe Beispiel für [CFileDialog::DoModal](#domodal).

## <a name="cfiledialogdomodal"></a><a name="domodal"></a>CFileDialog::DoModal

Rufen Sie diese Funktion auf, um das allgemeine Windows-Dateidialogfeld anzuzeigen und dem Benutzer das Durchsuchen von Dateien und Verzeichnissen und das Eingeben eines Dateinamens zu ermöglichen.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Rückgabewert

IDOK oder IDCANCEL. Wenn IDCANCEL zurückgegeben wird, rufen Sie die Windows [CommDlgExtendedError-Funktion](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) auf, um zu ermitteln, ob ein Fehler aufgetreten ist.

IDOK und IDCANCEL sind Konstanten, die angeben, ob der Benutzer die Schaltfläche OK oder Abbrechen ausgewählt hat.

### <a name="remarks"></a>Bemerkungen

Wenn Sie die verschiedenen Dateidialogfeldoptionen initialisieren möchten, `m_ofn` indem Sie Member der `DoModal`Struktur festlegen, sollten Sie dies vor dem Aufruf tun, jedoch nachdem das Dialogobjekt erstellt wurde.

Wenn Sie dem Benutzer beispielsweise erlauben möchten, mehrere Dateien auszuwählen, `DoModal`legen Sie das OFN_ALLOWMULTISELECT-Flag fest, bevor Sie aufrufen, wie im Codebeispiel in diesem Thema gezeigt.

Wenn der Benutzer auf die Schaltflächen OK oder Abbrechen des Dialogfelds klickt oder die Option Schließen im Steuerelementmenü des Dialogfelds auswählt, wird das Steuerelement an die Anwendung zurückgegeben. Sie können dann andere Memberfunktionen aufrufen, um die Einstellungen oder Informationen, die der Benutzer eingibt, in das Dialogfeld abzurufen.

`DoModal`ist eine virtuelle Funktion, `CDialog`die von der Klasse überschrieben wird.

### <a name="example"></a>Beispiel

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

## <a name="cfiledialogenableopendropdown"></a><a name="enableopendropdown"></a>CFileDialog::EnableOpenDropDown

Aktiviert eine Dropdown-Liste auf der Schaltfläche Öffnen oder Speichern im Dialogfeld.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID der Dropdownliste.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogendvisualgroup"></a><a name="endvisualgroup"></a>CFileDialog::EndVisualGroup

Beendet das Hinzufügen von Elementen zu einer visuellen Gruppe im Dialogfeld.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Rückgabewert

Gibt S_OK zurück, wenn erfolgreich; andernfalls einen Fehlerwert.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialoggetcheckbuttonstate"></a><a name="getcheckbuttonstate"></a>CFileDialog::GetCheckButtonState

Ruft den aktuellen Status einer Kontrollkästchentaste (Kontrollkästchen) im Dialogfeld ab.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Kontrollkästchens.

*bGeprüft*<br/>
Der Status des Kontrollkästchens. TRUE gibt überprüft an; FALSE zeigt ungeprüft an.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialoggetcontrolitemstate"></a><a name="getcontrolitemstate"></a>CFileDialog::GetControlItemState

Ruft den aktuellen Status eines Elements in einem Containersteuerelement im Dialogfeld ab.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Containersteuerelements.

*dwIDItem*<br/>
Die ID des Elements.

*dwState*<br/>
Ein Verweis auf eine Variable, die einen von mehreren Werten aus der CDCONTROLSTATE-Enumeration empfängt, die den aktuellen Status des Steuerelements angibt.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialoggetcontrolstate"></a><a name="getcontrolstate"></a>CFileDialog::GetControlState

Ruft die aktuelle Sichtbarkeit und aktivierten Zustände eines bestimmten Steuerelements ab.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Steuerelements.

*dwState*<br/>
Ein Verweis auf eine Variable, die einen oder mehrere Werte von der CDCONTROLSTATE-Enumeration empfängt, die den aktuellen Status des Steuerelements angibt.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialoggeteditboxtext"></a><a name="geteditboxtext"></a>CFileDialog::GetEditBoxText

Ruft den aktuellen Text in einem Bearbeitungsfeldsteuerelement ab.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Bearbeitungsfelds.

*strText*<br/>
Der Textwert.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialoggetfileext"></a><a name="getfileext"></a>CFileDialog::GetFileExt

Rufen Sie diese Funktion auf, um die Erweiterung des Dateinamens abzurufen, der in das Dialogfeld eingegeben wurde.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Rückgabewert

Die Erweiterung des Dateinamens.

### <a name="remarks"></a>Bemerkungen

Wenn der Name der eingegebenen Datei beispielsweise DATA lautet. TXT, `GetFileExt` gibt "TXT" zurück.

Wenn `m_ofn.Flags` das OFN_ALLOWMULTISELECT-Flag festgelegt ist, enthält diese Zeichenfolge eine Sequenz von null-terminierten Zeichenfolgen, wobei die erste Zeichenfolge der Verzeichnispfad der ausgewählten Dateigruppe ist, gefolgt von den Namen aller vom Benutzer ausgewählten Dateien. Um Dateipfadnamen abzurufen, verwenden Sie die Mitgliedsfunktionen [GetStartPosition](#getstartposition) und [GetNextPathName.](#getnextpathname)

## <a name="cfiledialoggetfilename"></a><a name="getfilename"></a>CFileDialog::GetFileName

Rufen Sie diese Funktion auf, um den Namen des dateinamens abzurufen, der im Dialogfeld eingegeben wurde.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Rückgabewert

Der Name der Datei.

### <a name="remarks"></a>Bemerkungen

Der Name der Datei enthält sowohl das Präfix als auch die Erweiterung. Gibt z. `GetFileName` B. "TEXT. DAT" für die Datei C:-FILES-TEXT.DAT.

Wenn `m_ofn.Flags` das `OFN_ALLOWMULTISELECT` Flag festgelegt ist, sollten Sie [GetStartPosition](#getstartposition) und [GetNextPathName](#getnextpathname) aufrufen, um einen Dateipfadnamen abzurufen.

## <a name="cfiledialoggetfiletitle"></a><a name="getfiletitle"></a>CFileDialog::GetFileTitle

Rufen Sie diese Funktion auf, um den Titel der im Dialogfeld eingegebenen Datei abzurufen.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Rückgabewert

Der Titel der Datei.

### <a name="remarks"></a>Bemerkungen

Der Titel der Datei enthält nur das Präfix, ohne den Pfad oder die Erweiterung. Gibt z. `GetFileTitle` B. "TEXT" für die Datei C:-FILES-TEXT.DAT zurück.

Wenn `m_ofn.Flags` das OFN_ALLOWMULTISELECT-Flag festgelegt ist, enthält diese Zeichenfolge eine Sequenz von null-terminierten Zeichenfolgen, wobei die erste Zeichenfolge der Verzeichnispfad der ausgewählten Dateigruppe ist, gefolgt von den Namen aller vom Benutzer ausgewählten Dateien. Verwenden Sie daher die Mitgliedsfunktionen [GetStartPosition](#getstartposition) und [GetNextPathName,](#getnextpathname) um den nächsten Dateinamen in der Liste abzurufen.

### <a name="example"></a>Beispiel

  Siehe Beispiel für [CFileDialog::DoModal](#domodal).

## <a name="cfiledialoggetfolderpath"></a><a name="getfolderpath"></a>CFileDialog::GetFolderPath

Rufen Sie diese Memberfunktion auf, um den Pfad des aktuell geöffneten Ordners oder Verzeichnisses für ein Dialogfeld "Öffnen" oder "Als "Als speichern" im Explorer-Stil abzurufen.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Rückgabewert

Ein [CString-Objekt,](../../atl-mfc-shared/reference/cstringt-class.md) das den aktuell geöffneten Ordner oder das Verzeichnis enthält.

### <a name="remarks"></a>Bemerkungen

Das Dialogfeld muss mit dem Stil OFN_EXPLORER erstellt worden sein. Andernfalls schlägt die Methode mit einer Assertion fehl.

Sie können diese Methode nur aufrufen, wenn das Dialogfeld angezeigt wird. Nachdem das Dialogfeld geschlossen wurde, funktioniert diese Funktion nicht mehr, und die Methode schlägt mit einer Assertion fehl.

## <a name="cfiledialoggetifiledialogcustomize"></a><a name="getifiledialogcustomize"></a>CFileDialog::GetIFileDialogCustomize

Ruft einen Zeiger auf das interne COM-Objekt für einen bestimmten [CFileDialog](../../mfc/reference/cfiledialog-class.md)ab.

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Rückgabewert

Der Zeiger auf das interne `CFileDialog`COM-Objekt für die . Es liegt in Ihrer Verantwortung, diesen Zeiger entsprechend freizugeben.

### <a name="remarks"></a>Bemerkungen

Verwenden Sie diese Funktion nur unter Windows Vista oder höher mit einem Objekt, für das *bVistaStyle* auf TRUE festgelegt ist. Wenn Sie diese Funktion verwenden, wenn *bVistaStyle* FALSE ist, gibt sie NULL im Freigabemodus zurück und wirft eine Assertion im Debugmodus aus.

Weitere Informationen zur `IFileDialogCustomize` Schnittstelle finden Sie unter [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Beispiel

In diesem Beispiel wird das interne COM-Objekt abgerufen. Um dieses Codebeispiel auszuführen, müssen Sie es unter Windows Vista oder höher kompilieren.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

## <a name="cfiledialoggetifileopendialog"></a><a name="getifileopendialog"></a>CFileDialog::GetIFileOpenDialog

Ruft einen Zeiger auf das interne COM-Objekt für eine bestimmte `CFileDialog`ab.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Rückgabewert

Der Zeiger auf das interne `CFileDialog`COM-Objekt für die . Es liegt in Ihrer Verantwortung, diesen Zeiger entsprechend freizugeben.

### <a name="remarks"></a>Bemerkungen

Verwenden Sie diese Funktion nur unter Windows Vista oder höher mit einem Objekt, für das *bVistaStyle* auf TRUE festgelegt ist. Diese Funktion gibt `CFileDialog` NULL zurück, wenn es sich nicht um ein **Dialogfeld "Öffnen"** handelt oder wenn *bVistaStyle* auf FALSE festgelegt ist. In diesem letzten Fall gibt die Funktion nur NULL im Release-Modus zurück - im Debugmodus wird eine Assertion ausgeworfen.

Weitere Informationen zur `IFileOpenDialog` Schnittstelle finden Sie unter [IFileOpenDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Beispiel

In diesem Beispiel wird das interne COM-Objekt abgerufen. Um diesen Code auszuführen, müssen Sie ihn unter Windows Vista oder höher kompilieren.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

## <a name="cfiledialoggetifilesavedialog"></a><a name="getifilesavedialog"></a>CFileDialog::GetIFileSaveDialog

Ruft einen Zeiger auf das interne COM-Objekt für eine bestimmte `CFileDialog`ab.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Rückgabewert

Der Zeiger auf das interne `CFileDialog`COM-Objekt für die . Es liegt in Ihrer Verantwortung, diesen Zeiger entsprechend freizugeben.

### <a name="remarks"></a>Bemerkungen

Verwenden Sie diese Funktion nur unter Windows Vista oder höher mit einem Objekt, für das *bVistaStyle* auf TRUE festgelegt ist. Diese Funktion gibt NULL `CFileDialog` zurück, wenn es sich nicht um ein **Dialogfeld Speichern** handelt oder wenn *bVistaStyle* auf FALSE festgelegt ist. In diesem letzten Fall gibt die Funktion nur NULL im Release-Modus zurück - im Debugmodus wird eine Assertion ausgeworfen.

Weitere Informationen zur `IFileSaveDialog` Schnittstelle finden Sie unter [IFileSaveDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Beispiel

In diesem Beispiel wird das interne COM-Objekt abgerufen. Um dieses Codebeispiel auszuführen, müssen Sie es unter Windows Vista oder höher kompilieren.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

## <a name="cfiledialoggetnextpathname"></a><a name="getnextpathname"></a>CFileDialog::GetNextPathName

Rufen Sie diese Funktion auf, um den nächsten Dateinamen aus der im Dialogfeld ausgewählten Gruppe abzurufen.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Parameter

*Pos*<br/>
Ein Verweis auf einen POSITION-Wert, der von einem vorherigen `GetNextPathName` oder `GetStartPosition` Funktionsaufruf zurückgegeben wird. NULL, wenn das Ende der Liste erreicht wurde.

### <a name="return-value"></a>Rückgabewert

Der vollständige Pfad der Datei.

### <a name="remarks"></a>Bemerkungen

Der Pfad des Dateinamens enthält den Titel der Datei sowie den gesamten Verzeichnispfad. Gibt z. `GetNextPathName` B. "C:-FILES-TEXT" zurück. DAT" für die Datei C:-FILES-TEXT.DAT. Sie können `GetNextPathName` in einer Vorwärtsiterationsschleife verwendet werden, `GetStartPosition`wenn Sie die Ausgangsposition mit einem Aufruf von festlegen.

Wenn die Auswahl nur aus einer Datei besteht, wird dieser Dateiname zurückgegeben.

## <a name="cfiledialoggetofn"></a><a name="getofn"></a>CFileDialog::GetOFN

Ruft die `OPENFILENAME` zugeordnete Struktur ab.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Rückgabewert

Eine [OPENFILENAME-Struktur.](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)

### <a name="remarks"></a>Bemerkungen

Verwenden Sie die zweite Version dieser Funktion, um die Darstellung eines Dialogfelds **"Datei öffnen"** `DoModal` oder **"Datei speichern als"** zu initialisieren, nachdem es erstellt wurde, aber bevor es mit der Memberfunktion angezeigt wird. Sie können z. `lpstrTitle` B. `m_ofn` das Element von auf die Beschriftung festlegen, die das Dialogfeld haben soll.

## <a name="cfiledialoggetpathname"></a><a name="getpathname"></a>CFileDialog::GetPathName

Rufen Sie diese Funktion auf, um den vollständigen Pfad der im Dialogfeld eingegebenen Datei abzurufen.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Rückgabewert

Der vollständige Pfad der Datei.

### <a name="remarks"></a>Bemerkungen

Der Pfad des Dateinamens enthält den Titel der Datei sowie den gesamten Verzeichnispfad. Gibt z. `GetPathName` B. "C:-FILES-TEXT" zurück. DAT" für die Datei C:-FILES-TEXT.DAT.

Wenn `m_ofn.Flags` das OFN_ALLOWMULTISELECT-Flag festgelegt ist, enthält diese Zeichenfolge eine Sequenz von Null-Teminat-Zeichenfolgen, wobei die erste Zeichenfolge der Verzeichnispfad der ausgewählten Dateigruppe ist, gefolgt von den Namen aller vom Benutzer ausgewählten Dateien. Verwenden Sie daher die Mitgliedsfunktionen [GetStartPosition](#getstartposition) und [GetNextPathName,](#getnextpathname) um den nächsten Dateinamen in der Liste abzurufen.

### <a name="example"></a>Beispiel

  Siehe Beispiel für [CFileDialog::DoModal](#domodal).

## <a name="cfiledialoggetreadonlypref"></a><a name="getreadonlypref"></a>CFileDialog::GetReadOnlyPref

Rufen Sie diese Funktion auf, um zu bestimmen, ob das Kontrollkästchen Nur lesen in den Dialogfeldern Windows-Standarddatei öffnen und Speichern von Dateien als aktiviert wurde.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn das Kontrollkästchen Nur lesen im Dialogfeld aktiviert ist; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Sie können das Kontrollkästchen Nur lesen ausblenden, indem Sie den Stil OFN_HIDEREADONLY im `CFileDialog` Konstruktor festlegen.

> [!NOTE]
> Windows Vista- `CFileDialog` oder höherformativer Objekte unterstützen diese Funktion nicht. Wenn Sie versuchen, diese Funktion in `CFileDialog` einem Windows Vista- oder höher-Stil zu verwenden, wird [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)ausgelöst.

## <a name="cfiledialoggetresult"></a><a name="getresult"></a>CFileDialog::GetResult

Ruft die Auswahl ab, die der Benutzer im Dialogfeld getroffen hat.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf ein IShellItem, das die Auswahl des Benutzers darstellt.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialoggetresults"></a><a name="getresults"></a>CFileDialog::GetResults

Ruft die Auswahlmöglichkeiten des Benutzers in einem Dialogfeld ab, das eine Mehrfachauswahl zulässt.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf ein IShellItemArray, über das auf die im Dialogfeld ausgewählten Elemente zugegriffen werden kann.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialoggetselectedcontrolitem"></a><a name="getselectedcontrolitem"></a>CFileDialog::GetSelectedControlItem

Ruft ein bestimmtes Element aus dem angegebenen Containersteuerelement im Dialogfeld ab.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Containersteuerelements.

*dwIDItem*<br/>
Die ID des Elements, das der Benutzer im Steuerelement ausgewählt hat.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialoggetstartposition"></a><a name="getstartposition"></a>CFileDialog::GetStartPosition

Rufen Sie diese Memberfunktion auf, um die Position des `m_ofn.Flags` ersten Dateipfadnamens in der Liste abzurufen, wenn das OFN_ALLOWMULTISELECT-Flag festgelegt ist.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Rückgabewert

Ein POSITION-Wert, der für die Iteration verwendet werden kann; NULL, wenn die Liste leer ist.

## <a name="cfiledialoghidecontrol"></a><a name="hidecontrol"></a>CFileDialog::HideControl

Rufen Sie diese Memberfunktion auf, um das angegebene Steuerelement in einem Dialogfeld "Öffnen" im Explorer- oder Speichern unter allgemeinen Funktionen auszublenden.

```cpp
void HideControl(int nID);
```

### <a name="parameters"></a>Parameter

*nID*<br/>
Die ID des auszublendenden Steuerelements.

### <a name="remarks"></a>Bemerkungen

Das Dialogfeld muss mit dem Stil OFN_EXPLORER erstellt worden sein. Andernfalls schlägt die Funktion mit einer Assertion fehl.

## <a name="cfiledialogispickfoldersmode"></a><a name="ispickfoldersmode"></a>CFileDialog::IsPickFoldersMode

Bestimmt, ob sich das aktuelle Dialogfeld im Ordnerauswahlmodus befindet.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Rückgabewert

TRUE, wenn sich das Dialogfeld im Ordnerauswahlmodus befindet; andernfalls FALSE.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogm_ofn"></a><a name="m_ofn"></a>CFileDialog::m_ofn

`m_ofn`ist eine Struktur `OPENFILENAME`des Typs . Die Daten in dieser Struktur stellen `CFileDialog`den aktuellen Status der dar.

### <a name="remarks"></a>Bemerkungen

Verwenden Sie diese Struktur, um die Darstellung eines Dialogfelds **"Datei öffnen"** oder **"Datei speichern als"** zu initialisieren, nachdem Sie es erstellt haben, aber bevor Sie es mit der [DoModal-Methode](#domodal) anzeigen. Sie können z. B. das `m_ofn` *lpstrTitle-Member* von auf die Beschriftung festlegen, die das Dialogfeld haben soll.

Mit dem Windows Vista- oder höher-Stil von [CFileDialog](../../mfc/reference/cfiledialog-class.md)ist es nicht garantiert, `m_ofn` dass er immer mit dem Status des Dialogfelds übereinstimmt. Es wird mit dem Dialogfeld in früheren Versionen von Windows synchronisiert. Weitere Informationen zum Synchronisieren der Struktur und des `m_ofn` `CFileDialog` Status unter Windows Vista oder höher finden Sie unter [CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog) und [CFileDialog::UpdateOFNFromShellDialog.](#updateofnfromshelldialog)

Dateidialogfelder mit Windows Vista oder höher unterstützen `CFileDialog`bestimmte Member und Flags der nicht. Infolgedessen werden diese keine Auswirkungen haben.

Im Folgenden finden Sie eine Liste der Mitglieder, die von Windows Vista oder höher nicht unterstützt werden:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

Die folgenden Flags werden nicht unterstützt und haben daher keine Auswirkungen, wenn Sie den Windows Vista- oder höher-Stil von: `CFileDialog`

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES - effektiv immer in Windows Vista oder höher

- OFN_NOLONGNAMES - in Windows Vista oder höher praktisch immer aus

- OFN_NONETWORKBUTTON - effektiv immer in Windows Vista oder höher

- OFN_READONLY

- OFN_SHOWHELP

Weitere Informationen zu dieser Struktur finden Sie in der [OPENFILENAME-Struktur](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) im Windows SDK.

## <a name="cfiledialogmakeprominent"></a><a name="makeprominent"></a>CFileDialog::MakeProminent

Platziert ein Steuerelement im Dialogfeld, sodass es sich im Vergleich zu anderen Steuerelementen abhebt.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Steuerelements.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogonbuttonclicked"></a><a name="onbuttonclicked"></a>CFileDialog::OnButtonClicked

Wird aufgerufen, wenn auf die Schaltfläche geklickt wird.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID der Schaltfläche.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogoncheckbuttontoggled"></a><a name="oncheckbuttontoggled"></a>CFileDialog::OnCheckButtonToggled

Wird aufgerufen, wenn das Kontrollkästchen aktiviert oder deaktiviert ist.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Kontrollkästchens.

*bGeprüft*<br/>
aktiviert oder deaktiviert.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogoncontrolactivating"></a><a name="oncontrolactivating"></a>CFileDialog::OnControlAktivaktivieren

Wird aufgerufen, wenn das Steuerelement aktiviert ist.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Steuerelements.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogonfilenamechange"></a><a name="onfilenamechange"></a>CFileDialog::OnFileNameChange

Überschreiben Sie diese Methode, wenn Sie die WM_NOTIFY CDN_SELCHANGE-Nachricht verarbeiten möchten.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Bemerkungen

Das System sendet die CDN_SELCHANGE Nachricht, wenn der Benutzer eine neue Datei oder einen neuen Ordner in der Dateiliste des Dialogfelds **Öffnen** oder **Speichern unter** wählt. Überschreiben Sie diese Methode, wenn Sie Aktionen als Reaktion auf diese Nachricht ausführen möchten.

Das System sendet diese Nachricht nur, wenn das Dialogfeld mit aktiviertem OFN_EXPLORER-Flag erstellt wurde. Weitere Informationen zur Benachrichtigung finden Sie [unter CDN_SELCHANGE](/windows/win32/dlgbox/cdn-selchange). Informationen zum OFN_EXPLORER-Flag finden Sie in der [OPENFILENAME-Struktur](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) und [In Dialogfeldern öffnen und speichern](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

## <a name="cfiledialogonfilenameok"></a><a name="onfilenameok"></a>CFileDialog::OnFileNameOK

Überschreiben Sie diese Funktion nur, wenn Sie eine benutzerdefinierte Validierung von Dateinamen bereitstellen möchten, die in ein allgemeines Dateidialogfeld eingegeben werden.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Rückgabewert

1, wenn der Dateiname kein gültiger Dateiname ist; andernfalls 0.

### <a name="remarks"></a>Bemerkungen

Mit dieser Funktion können Sie einen Dateinamen aus anwendungsspezifischen Gründen ablehnen. Normalerweise müssen Sie diese Funktion nicht verwenden, da das Framework die Standardüberprüfung von Dateinamen bereitstellt und ein Meldungsfeld anzeigt, wenn ein ungültiger Dateiname eingegeben wird.

Wenn 1 zurückgegeben wird, wird das Dialogfeld weiterhin angezeigt, damit der Benutzer einen anderen Dateinamen eingeben kann. Die Dialogverfahren schließen das Dialogfeld, wenn die Rückgabe 0 ist. Andere Rückgabewerte ungleich Null sind derzeit reserviert und sollten nicht verwendet werden.

## <a name="cfiledialogonfolderchange"></a><a name="onfolderchange"></a>CFileDialog::OnFolderChange

Überschreiben Sie diese Funktion, um die WM_NOTIFYCDN_FOLDERCHANGE Nachricht zu verarbeiten.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Bemerkungen

Die Benachrichtigung wird gesendet, wenn ein neuer Ordner im Dialogfeld Öffnen oder Speichern unter geöffnet wird.

Benachrichtigung wird nur gesendet, wenn das Dialogfeld mit dem Format OFN_EXPLORER erstellt wurde. Weitere Informationen zur Benachrichtigung finden Sie [unter CDN_FOLDERCHANGE](/windows/win32/dlgbox/cdn-folderchange). Informationen zum OFN_EXPLORER-Stil finden Sie in der [OPENFILENAME-Struktur](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) und [In Dialogfeldern öffnen und speichern](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

## <a name="cfiledialogoninitdone"></a><a name="oninitdone"></a>CFileDialog::OnInitDone

Überschreiben Sie diese Funktion, um die WM_NOTIFY CDN_INITDONE Nachricht zu behandeln.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Bemerkungen

Das System sendet diese Benachrichtigung, wenn das System die Anordnung von Steuerelementen im Dialogfeld **Öffnen** oder **Speichern** unter abgeschlossen hat, um Platz für die Steuerelemente des untergeordneten Dialogfelds zu schaffen.

Das System sendet dies nur, wenn das Dialogfeld mit dem OFN_EXPLORER-Stil erstellt wurde. Weitere Informationen zur Benachrichtigung finden Sie unter [CDN_INITDONE](/windows/win32/dlgbox/cdn-initdone). Informationen zum OFN_EXPLORER-Stil finden Sie in der [OPENFILENAME-Struktur](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) und [In Dialogfeldern öffnen und speichern](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

> [!NOTE]
> Dateidialogfelder mit Windows Vista oder höher unterstützen diese Funktion nicht. Wenn Sie versuchen, diese Funktion in einem Windows Vista- oder höherformatienformatieren Dateidialogfeld zu verwenden, wird [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)ausgelöst.

## <a name="cfiledialogonitemselected"></a><a name="onitemselected"></a>CFileDialog::OnItemSelected

Wird aufgerufen, wenn das Containerelement ausgewählt ist.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Containersteuerelements.

*dwIDItem*<br/>
Die ID des Elements.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogonlbselchangednotify"></a><a name="onlbselchangednotify"></a>CFileDialog::OnLBSelChangedNotify

Diese Funktion wird aufgerufen, wenn sich die aktuelle Auswahl in einem Listenfeld ändern wird.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Parameter

*nIDBox*<br/>
Die ID des Listen- oder Kombinationsfelds, in dem die Auswahl erfolgt ist.

*iCurSel*<br/>
Der Index der aktuellen Auswahl.

*nCode*<br/>
Der Steuerbenachrichtigungscode. Dieser Parameter muss einen der folgenden Werte aufweisen:

- CD_LBSELCHANGE Gibt *an, dass iCurSel* das ausgewählte Element in einem Listenfeld mit einer Auswahl ist.

- CD_LBSELSUB Gibt an, dass *iCurSel* nicht mehr in einem Listenfeld für Mehrfachauswahl ausgewählt ist.

- CD_LBSELADD Gibt an, dass *iCurSel* in einem Listenfeld für mehrere Auswahlen ausgewählt ist.

- CD_LBSELNOITEMS Gibt an, dass in einem Listenfeld für mehrere Auswahlen keine Auswahl vorhanden ist.

### <a name="remarks"></a>Bemerkungen

Überschreiben Sie diese Funktion, um eine benutzerdefinierte Behandlung von Auswahländerungen im Listenfeld bereitzustellen. Mit dieser Funktion können Sie beispielsweise die Zugriffsrechte oder die Datumsänderung jeder Vom Benutzer ausgewählten Datei anzeigen.

## <a name="cfiledialogonshareviolation"></a><a name="onshareviolation"></a>CFileDialog::OnShareViolation

Überschreiben Sie diese Funktion, um eine benutzerdefinierte Behandlung von Freigabeverletzungen bereitzustellen.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Parameter

*lpszPathName*<br/>
Der Pfad der Datei, in der die Freigabeverletzung aufgetreten ist.

### <a name="return-value"></a>Rückgabewert

Einer der folgenden Werte:

- OFN_SHAREFALLTHROUGH Der Dateiname wird aus dem Dialogfeld zurückgegeben.

- OFN_SHARENOWARN Es sind keine weiteren Maßnahmen erforderlich.

- OFN_SHAREWARN Der Benutzer erhält die Standardwarnung für diesen Fehler.

### <a name="remarks"></a>Bemerkungen

Normalerweise müssen Sie diese Funktion nicht verwenden, da das Framework standardmäßig die Überprüfung von Freigabeverletzungen bereitstellt und ein Meldungsfeld anzeigt, wenn eine Freigabeverletzung auftritt.

Wenn Sie die Freigabeverletzungsprüfung deaktivieren möchten, verwenden Sie den `m_ofn.Flags`bitweisen ODER-Operator, um das Flag OFN_SHAREAWARE mit zu kombinieren.

## <a name="cfiledialogontypechange"></a><a name="ontypechange"></a>CFileDialog::OnTypeChange

Überschreiben Sie diese Funktion, um die WM_NOTIFYCDN_TYPECHANGE Nachricht zu verarbeiten.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Bemerkungen

Die Benachrichtigung wird gesendet, wenn der Benutzer einen neuen Dateityp aus der Liste der Dateitypen im Dialogfeld Öffnen oder Speichern unter auswählt.

Benachrichtigung wird nur gesendet, wenn das Dialogfeld mit dem Format OFN_EXPLORER erstellt wurde. Weitere Informationen zur Benachrichtigung finden Sie [unter CDN_TYPECHANGE](/windows/win32/dlgbox/cdn-typechange). Informationen zum OFN_EXPLORER-Stil finden Sie in der [OPENFILENAME-Struktur](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) und [In Dialogfeldern öffnen und speichern](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

## <a name="cfiledialogremovecontrolitem"></a><a name="removecontrolitem"></a>CFileDialog::RemoveControlItem

Entfernt ein Element aus einem Containersteuerelement im Dialogfeld.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Containersteuerelements, aus dem das Element entfernt werden soll.

*dwIDItem*<br/>
Die ID des Elements.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogsetcheckbuttonstate"></a><a name="setcheckbuttonstate"></a>CFileDialog::SetCheckButtonState

Legt den aktuellen Status einer Kontrollkästchentaste (Kontrollkästchen) im Dialogfeld fest.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Kontrollkästchens.

*bGeprüft*<br/>
Der Status des Kontrollkästchens. TRUE gibt überprüft an; FALSE gibt Ungeprüft an.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogsetcontrolitemstate"></a><a name="setcontrolitemstate"></a>CFileDialog::SetControlItemState

Legt den aktuellen Status eines Elements in einem Containersteuerelement fest, das im Dialogfeld gefunden wird.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Containersteuerelements.

*dwIDItem*<br/>
Die ID des Elements.

*dwState*<br/>
Mindestens ein Wert aus der CDCONTROLSTATE-Enumeration, die den neuen Status des Steuerelements angeben.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogsetcontrolitemtext"></a><a name="setcontrolitemtext"></a>CFileDialog::SetControlItemText

Legt den Text eines Steuerelementelements fest. Beispielsweise der Text, der einem Optionsfeld oder einem Element in einem Menü beiliegt.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Containersteuerelements.

*dwIDItem*<br/>
Die ID des Elements.

*strLabel*<br/>
Text des Elements.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogsetcontrollabel"></a><a name="setcontrollabel"></a>CFileDialog::SetControlLabel

Legt den Text fest, der einem Steuerelement zugeordnet ist, z. B. Schaltflächentext oder eine Bearbeitungsfeldbeschriftung.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Steuerelements.

*strLabel*<br/>
Der Name des Steuerelements.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogsetcontrolstate"></a><a name="setcontrolstate"></a>CFileDialog::SetControlState

Legt die aktuelle Sichtbarkeit und aktivierten Zustände eines bestimmten Steuerelements fest.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Steuerelements.

*dwState*<br/>
Mindestens ein Wert aus der CDCONTROLSTATE-Enumeration, die den aktuellen Status des Steuerelements angeben.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogsetcontroltext"></a><a name="setcontroltext"></a>CFileDialog::SetControlText

Rufen Sie diese Methode auf, um den Text für das angegebene Steuerelement in einem Dialogfeld **"Öffnen"** oder **"Als speichern"** im Explorer-Stil festzulegen.

```cpp
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Parameter

*nID*<br/>
[in] Die ID des Steuerelements, für das der Text festgelegt werden soll.

*lpsz*<br/>
[in] Ein Zeiger auf die Zeichenfolge, die den für das Steuerelement festzulegenden Text enthält.

### <a name="remarks"></a>Bemerkungen

Beide Versionen dieser Funktion sind für Anwendungen gültig, die Unicode verwenden. Für Anwendungen, die ANSI verwenden, ist jedoch nur die Version mit dem Typ LPCSTR gültig.

Um diese Methode zu verwenden, müssen Sie das Dialogfeld mit dem Stil OFN_EXPLORER erstellen. Andernfalls schlägt die Funktion mit einer Assertion fehl.

## <a name="cfiledialogsetdefext"></a><a name="setdefext"></a>CFileDialog::SetDefExt

Rufen Sie diese Funktion auf, um die Standarddateinamenerweiterung für ein Dialogfeld im Explorer-Stil Öffnen oder Speichern als festzulegen.

```cpp
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Parameter

*lpsz*<br/>
Ein Zeiger auf eine Zeichenfolge, die die Standarderweiterung enthält, die für das Dialogfeldobjekt verwendet werden soll. Diese Zeichenfolge darf keinen Punkt (.) enthalten.

### <a name="remarks"></a>Bemerkungen

Das Dialogfeld muss mit dem Stil OFN_EXPLORER erstellt worden sein. Andernfalls schlägt die Funktion mit einer Assertion fehl.

## <a name="cfiledialogseteditboxtext"></a><a name="seteditboxtext"></a>CFileDialog::SetEditBoxText

Legt den aktuellen Text in einem Bearbeitungsfeldsteuerelement fest.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Bearbeitungsfelds.

*strText*<br/>
Der Textwert.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogsetproperties"></a><a name="setproperties"></a>CFileDialog::SetProperties

Bietet einen Eigenschaftenspeicher, der die Standardwerte definiert, die für das zu speichernde Element verwendet werden sollen.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Parameter

*lpszPropList*<br/>
Eine Liste der vordefinierten Eigenschaften, die durch ein ";" voneinander getrennt sind. Eine Liste der Flags finden Sie im Abschnitt **Flags** von [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew).

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogsetselectedcontrolitem"></a><a name="setselectedcontrolitem"></a>CFileDialog::SetSelectedControlItem

Legt den ausgewählten Status eines bestimmten Elements in einer Optionsschaltflächengruppe oder einem Kombinationsfeld im Dialogfeld fest.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID des Containersteuerelements.

*dwIDItem*<br/>
Die ID des Elements, das der Benutzer im Steuerelement ausgewählt hat.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogsettemplate"></a><a name="settemplate"></a>CFileDialog::SetTemplate

Legt die Dialogfeldvorlage für das [CFileDialog-Objekt](../../mfc/reference/cfiledialog-class.md) fest.

```cpp
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Parameter

*nWin3ID*<br/>
[in] Enthält die ID-Nummer der Vorlagenressource `CFileDialog` für das Nicht-Explorer-Objekt. Diese Vorlage wird nur unter Windows NT 3.51 verwendet, oder wenn der OFN_EXPLORER-Stil nicht vorhanden ist.

*nWin4ID*<br/>
[in] Enthält die ID-Nummer der Vorlagenressource für das Explorer-Objekt. `CFileDialog` Diese Vorlage wird nur für Windows NT 4.0 und neuere Versionen, Windows 95 und neuere Versionen oder wenn der OFN_EXPLORER-Stil vorhanden ist.

*lpWin3ID*<br/>
[in] Enthält den Namen der Vorlagenressource für `CFileDialog` das Nicht-Explorer-Objekt. Diese Vorlage wird nur unter Windows NT 3.51 verwendet, oder wenn der OFN_EXPLORER-Stil nicht vorhanden ist.

*lpWin4ID*<br/>
[in] Enthält den Namen der Vorlagenressource `CFileDialog` des Explorer-Objekts. Diese Vorlage wird nur für Windows NT 4.0 und neuere Versionen, Windows 95 und neuere Versionen oder wenn der OFN_EXPLORER-Stil vorhanden ist.

### <a name="remarks"></a>Bemerkungen

Das System verwendet nur eine der angegebenen Vorlagen. Das System bestimmt, welche Vorlage basierend auf dem Vorhandensein des OFN_EXPLORER-Stils und des Betriebssystems verwendet werden soll, auf dem die Anwendung ausgeführt wird. Durch Die Angabe einer Vorlage im Nicht-Explorer- und Explorer-Stil ist es einfach, Windows NT 3.51, Windows NT 4.0 und neuere Versionen sowie Windows 95- und neuere Versionen zu unterstützen.

> [!NOTE]
> Windows Vista- oder höherformativer Dateidialogfelder unterstützen diese Funktion nicht. Wenn Sie versuchen, diese Funktion in einem Windows Vista- oder höherformatienformatiums-Dateidialogfeld zu verwenden, wird [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)ausgelöst. Eine Alternative besteht darin, ein benutzerdefiniertes Dialogfeld zu verwenden. Weitere Informationen zur Verwendung `CFileDialog`einer benutzerdefinierten , finden Sie unter [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

## <a name="cfiledialogstartvisualgroup"></a><a name="startvisualgroup"></a>CFileDialog::StartVisualGroup

Deklariert eine visuelle Gruppe im Dialogfeld. Nachfolgende Aufrufe einer "add"-Methode fügen diese Elemente dieser Gruppe hinzu.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parameter

*dwIDCtl*<br/>
Die ID der visuellen Gruppe.

*strLabel*<br/>
Der Gruppenname.

### <a name="remarks"></a>Bemerkungen

## <a name="cfiledialogupdateofnfromshelldialog"></a><a name="updateofnfromshelldialog"></a>CFileDialog::UpdateOFNFromShellDialog

Aktualisiert `m_ofn` die Datenstruktur des [CFileDialogs](../../mfc/reference/cfiledialog-class.md) basierend auf dem aktuellen Status des internen Objekts.

```cpp
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Bemerkungen

In Versionen von Windows vor Windows Vista wurde die [Element-OPENFILENAME-Datenstruktur](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) kontinuierlich mit dem Status der `CFileDialog`synchronisiert. Alle Änderungen [m_ofn](#m_ofn) an der m_ofn-Membervariablen wirkten sich direkt auf den Status des Dialogfelds aus. Außerdem wurden alle Änderungen am Status des Dialogfelds sofort die m_ofn Membervariable aktualisiert.

In Windows Vista oder `m_ofn` höher wird die Datenstruktur nicht automatisch aktualisiert. Um die Genauigkeit der Daten `m_ofn` in der Membervariablen `UpdateOFNFromShellDialog` zu gewährleisten, sollten Sie die Funktion aufrufen, bevor Sie auf die Daten zugreifen. Windows ruft diese Funktion während der Verarbeitung von [IFileDialog::OnFileOK](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok)automatisch auf.

Weitere Informationen zur Verwendung `CFileDialog` der Klasse unter Windows Vista oder höher finden Sie unter [CFileDialog-Klasse](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Beispiel

In diesem `CFileDialog` Beispiel wird die vor der Anzeige aktualisiert. Bevor Wir `m_ofn` die Membervariable aktualisieren, müssen wir sie mit dem aktuellen Status des Dialogfelds synchronisieren.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>Weitere Informationen

[CCommonDialog-Klasse](../../mfc/reference/ccommondialog-class.md)<br/>
[Hierarchiediagramm](../../mfc/hierarchy-chart.md)
