---
title: COleControl-Klasse | Microsoft-Dokumentation
ms.custom: ''
ms.date: 08/27/2018
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 160d9857097c4cac1912d2ca44b0433905c238f5
ms.sourcegitcommit: d3c41b16bf05af2149090e996d8e71cd6cd55c7a
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/09/2018
ms.locfileid: "48890867"
---
# <a name="colecontrol-class"></a>COleControl-Klasse

Eine leistungsstarke Basisklasse zum Entwickeln von OLE-Steuerelementen.

## <a name="syntax"></a>Syntax

```
class COleControl : public CWnd
```

## <a name="members"></a>Member

### <a name="public-constructors"></a>Öffentliche Konstruktoren

|Name|Beschreibung|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Erstellt ein `COleControl`-Objekt.|

### <a name="public-methods"></a>Öffentliche Methoden

|Name|Beschreibung|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Ruft die aktuelle Darstellung des Steuerelements ab.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Gibt den Wert der ambient BackColor-Eigenschaft.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Gibt den Namen des Steuerelements gemäß den Container zurück.|
|[COleControl::AmbientFont](#ambientfont)|Gibt den Wert der ambient-Schriftart-Eigenschaft.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Gibt den Wert der ambient ForeColor-Eigenschaft.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Gibt den Container Gebietsschema-ID zurück.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Gibt den Typ der Einheiten, die vom Container verwendeten zurück.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Bestimmt, ob der Ziehpunkte angezeigt werden soll.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Bestimmt, ob Schraffur angezeigt werden soll.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Gibt den Typ der Ausrichtung des Texts innerhalb des Containers zurück.|
|[COleControl::AmbientUIDead](#ambientuidead)|Bestimmt, ob das Steuerelement zu UI-Aktionen reagieren soll.|
|[COleControl::AmbientUserMode](#ambientusermode)|Bestimmt den Modus des Containers.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Benachrichtigt den Container an, dass eine gebundene Eigenschaft geändert wurde.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Fordert die Berechtigung zum Bearbeiten des Eigenschaftenwerts.|
|[COleControl::ClientToParent](#clienttoparent)|Übersetzt einen Punkt relativ zum Ursprung des Steuerelements, auf einen Zeitpunkt relativ zum Ursprung des zugehörigen Containers an.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Passt ein Rechteck der Einfügemarke, wenn er von einem Steuerelement überlappt wird.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Rufen Sie diese Funktion nach einer Änderung der Satz von mnemonischen Zeichen vom Steuerelement gehandhabt.|
|[COleControl::DisplayError](#displayerror)|Zeigt Ereignisse für Fehler im vordefinierten des Steuerelements Benutzer an.|
|[COleControl::DoClick](#doclick)|Implementierung der Aktie `DoClick` Methode.|
|[COleControl::DoPropExchange](#dopropexchange)|Serialisiert die Eigenschaften einer `COleControl` Objekt.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Zeichnet ein OLE-Steuerelement, das von einem Windows-Steuerelement erstellt wurde.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Ermöglicht die einfache Frame-Unterstützung für ein Steuerelement.|
|[COleControl::ExchangeExtent](#exchangeextent)|Serialisiert die Breite und Höhe des Steuerelements.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serialisiert die vordefinierten Eigenschaften des Steuerelements.|
|[COleControl::ExchangeVersion](#exchangeversion)|Serialisiert die Versionsnummer des Steuerelements.|
|[COleControl::FireClick](#fireclick)|Wird ausgelöst, die Aktie `Click` Ereignis.|
|[COleControl::FireDblClick](#firedblclick)|Wird ausgelöst, die Aktie `DblClick` Ereignis.|
|[COleControl::FireError](#fireerror)|Wird ausgelöst, die Aktie `Error` Ereignis.|
|[COleControl::FireEvent](#fireevent)|Löst ein benutzerdefiniertes Ereignis.|
|[COleControl::FireKeyDown](#firekeydown)|Wird ausgelöst, die Aktie `KeyDown` Ereignis.|
|[COleControl::FireKeyPress](#firekeypress)|Wird ausgelöst, die Aktie `KeyPress` Ereignis.|
|[COleControl::FireKeyUp](#firekeyup)|Wird ausgelöst, die Aktie `KeyUp` Ereignis.|
|[COleControl::FireMouseDown](#firemousedown)|Wird ausgelöst, die Aktie `MouseDown` Ereignis.|
|[COleControl::FireMouseMove](#firemousemove)|Wird ausgelöst, die Aktie `MouseMove` Ereignis.|
|[COleControl::FireMouseUp](#firemouseup)|Wird ausgelöst, die Aktie `MouseUp` Ereignis.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Löst ein Ereignis, wenn das Steuerelement den Status "bereit" ändert.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Ändert das Standardverhalten für die Aktivierung eines Steuerelements, das unterstützt die `IPointerInactive` Schnittstelle.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Gibt den Wert der angegebenen ambient-Eigenschaft.|
|[COleControl::GetAppearance](#getappearance)|Gibt den Wert der Systemeigenschaft Darstellung zurück.|
|[COleControl::GetBackColor](#getbackcolor)|Gibt den Wert der vordefinierten BackColor-Eigenschaft.|
|[COleControl::GetBorderStyle](#getborderstyle)|Gibt den Wert der Systemeigenschaft BorderStyle zurück.|
|[COleControl::GetCapture](#getcapture)|Bestimmt, ob ein Objekt fensterlose, aktivierte Steuerelement die mausaufzeichnung verfügen.|
|[COleControl::GetClassID](#getclassid)|Ruft die OLE-Klassen-ID des Steuerelements ab.|
|[COleControl::GetClientOffset](#getclientoffset)|Ruft den Unterschied zwischen der oberen linken Ecke des rechteckigen Bereichs des Steuerelements "und" der oberen linken Ecke seines Clientbereichs ab.|
|[COleControl::GetClientRect](#getclientrect)|Ruft die Größe des Clientbereichs des Steuerelements ab.|
|[COleControl::GetClientSite](#getclientsite)|Fragt ein Objekt für den Zeiger auf die aktuelle Client-Website in dessen Container ab.|
|[COleControl::GetControlFlags](#getcontrolflags)|Ruft die Einstellungen für das Steuerelement ab.|
|[COleControl::GetControlSize](#getcontrolsize)|Gibt die Position und Größe des OLE-Steuerelements.|
|[COleControl::GetDC](#getdc)|Bietet eine Möglichkeit für ein fensterloses Steuerelement um einen Gerätekontext aus seinem Container zu erhalten.|
|[COleControl::GetEnabled](#getenabled)|Gibt den Wert der Aktie Enabled-Eigenschaft.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Ruft einen Zeiger auf ein erweitertes Steuerelement-Objekt, das in den Container gehört.|
|[COleControl::GetFocus](#getfocus)|Bestimmt, ob das Steuerelement den Fokus besitzt.|
|[COleControl::GetFont](#getfont)|Der Wert, der die vordefinierte Schriftarteigenschaft zurückgegeben.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Gibt zurück, die Metriken für eine `CFontHolder` Objekt.|
|[COleControl::GetForeColor](#getforecolor)|Gibt den Wert der vordefinierten ForeColor-Eigenschaft.|
|[COleControl::GetHwnd](#gethwnd)|Gibt den Wert der vordefinierten hWnd-Eigenschaft.|
|[COleControl::GetMessageString](#getmessagestring)|Stellt den Text der Statusleiste für ein Menüelement bereit.|
|[COleControl::GetNotSupported](#getnotsupported)|Verhindert den Zugriff auf den Wert eines Steuerelements Eigenschaft durch den Benutzer.|
|[COleControl::GetReadyState](#getreadystate)|Gibt den Zustand des Steuerelements Bereitschaft zurück.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Gibt das Rechteck des Steuerelements relativ zu seinem Container zurück.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Gibt die Metriken für die vordefinierte Schriftarteigenschaft zurück.|
|[COleControl::GetText](#gettext)|Gibt den Wert der vordefinierten Text- oder Caption-Eigenschaft.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Außer Kraft setzen Sie, um ein fensterloses Steuerelement das Ziel des Drag und drop-Vorgänge zu ermöglichen.|
|[COleControl::InitializeIIDs](#initializeiids)|Informiert die Basisklasse von die IIDs, die das Steuerelement verwendet.|
|[COleControl::InternalGetFont](#internalgetfont)|Gibt eine `CFontHolder` -Objekt für die vordefinierte Schriftarteigenschaft.|
|[COleControl::InternalGetText](#internalgettext)|Ruft ab, die vordefinierte Beschriftung oder den Text-Eigenschaft.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Legt den Zustand des Steuerelements Bereitschaft und löst das Ereignis statusänderung bereit.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Erklärt einen Bereich des Steuerelements angezeigt, sodass es neu gezeichnet wird.|
|[COleControl::InvalidateRgn](#invalidatergn)|Macht Sie in der Clientbereich des Fensters der Container in der angegebenen Region ungültig. Kann verwendet werden, um Fensterlose Steuerelemente in der Region neu zu zeichnen.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Ermöglicht spezielle Laden eines OLE-Steuerelements.|
|[COleControl::IsModified](#ismodified)|Bestimmt, ob der Zustand des Steuerelements geändert hat.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Gibt an, ob der Container optimiertes Zeichnen für den aktuellen Zeichenvorgang unterstützt.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Wird aufgerufen, um festzustellen, ob die steuern, die Unterklassen der Steuerelemente einen Windows.|
|[COleControl::Load](#load)|Setzt alle vorherigen asynchrone Daten und ein erneutes Laden des asynchrone Eigenschaft des Steuerelements initiiert.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Bestimmt, ob das Steuerelement vom Container deaktiviert werden kann.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Wird aufgerufen, wenn eine Ambiente-Eigenschaft geändert wird.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Wird aufgerufen, wenn die vordefinierte Appearance-Eigenschaft geändert wird.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Wird aufgerufen, wenn die vordefinierte BackColor-Eigenschaft geändert wird.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Wird aufgerufen, wenn der BorderStyle-Systemeigenschaft geändert wird.|
|[COleControl::OnClick](#onclick)|Wird aufgerufen, um das Auslösen des Bestand auf Ereignis.|
|[COleControl::OnClose](#onclose)|Benachrichtigt das Steuerelement, `IOleControl::Close` aufgerufen wurde.|
|[COleControl::OnDoVerb](#ondoverb)|Wird aufgerufen, nachdem ein Steuerelement Verb ausgeführt wurde.|
|[COleControl::OnDraw](#ondraw)|Wird aufgerufen, wenn ein Steuerelement angefordert wird, sich selbst neu zeichnet.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Wird vom Container aufgerufen, wenn ein Steuerelement gezeichnet mithilfe einer Metadatei-Gerätekontexts angefordert wird.|
|[COleControl::OnEdit](#onedit)|Aufgerufen vom Container zum Aktivieren der Benutzeroberfläche ein OLE-Steuerelements.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Aufgerufen, wenn die Aktie Enabled-Eigenschaft geändert wird.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Wird aufgerufen, durch den Container, die Verben des Steuerelements auszuwerten.|
|[COleControl::OnEventAdvise](#oneventadvise)|Wird aufgerufen, wenn Ereignishandler verbunden oder von einem Steuerelement getrennt werden.|
|[COleControl::OnFontChanged](#onfontchanged)|Wird aufgerufen, wenn die vordefinierte Schriftarteigenschaft geändert wird.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Wird aufgerufen, wenn die vordefinierte ForeColor-Eigenschaft geändert wird.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Wird aufgerufen, wenn es sich bei den Ereignissen eines Steuerelements nicht fixiert ist oder gesperrt sind.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Benachrichtigt das Steuerelement, `IOleObject::GetColorSet` aufgerufen wurde.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Stellt mnemonische Informationen für den Container.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Wird aufgerufen, um eine Zeichenfolge zur Darstellung eines Eigenschaftswerts zu erhalten.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Fordert das Handle für das Menü des Steuerelements, das zusammengeführt werden über das Menü "Container".|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Außer Kraft setzen Sie, um die Größe des Steuerelements anzeigen, die die vorgeschlagene Größe und Umfang-Modus am nächsten abzurufen.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Gibt die Zeichenfolgen, die möglichen Werte für eine Eigenschaft zurück.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Gibt den Wert für eine vordefinierte Zeichenfolge zurück.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Überschreiben Sie, um die Größe des Steuerelements anzeigen Bereiche abrufen (dienen zur Darstellung zwei Durchgängen aktivieren).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Überschreiben Sie, um die Größe des Steuerelements in einem Rechteck ab, die an einer bestimmten Position zu konvertieren.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Überschreiben Sie, um das Anzeigen des Status des Steuerelements abzurufen.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Wird vom Container aufgerufen, wenn das Steuerelement der Benutzeroberfläche deaktiviert wird.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Außer Kraft setzen Sie, dass den Container für die Inaktives Steuerelement unter der Mauszeiger WM_MOUSEMOVE-Dispatchmeldungen an das Steuerelement.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Außer Kraft setzen Sie, dass den Container für die Inaktives Steuerelement unter der Mauszeiger WM_SETCURSOR-Dispatchmeldungen an das Steuerelement.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Aufgerufen, nachdem das vordefinierte KeyDown-Ereignis ausgelöst wurde.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Aufgerufen, nachdem die vordefinierte KeyPress-Ereignis ausgelöst wurde.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Aufgerufen, nachdem die vordefinierte KeyUp-Ereignis ausgelöst wurde.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Gibt an, die Eigenschaftenseite für die Bearbeitung einer Eigenschaft verwenden.|
|[COleControl::OnMnemonic](#onmnemonic)|Wird aufgerufen, wenn eine mnemonische Taste des Steuerelements gedrückt wurde.|
|[COleControl::OnProperties](#onproperties)|Wird aufgerufen, wenn dem Steuerelement "Eigenschaften" Verb aufgerufen wurde.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Außer Kraft setzen Sie, Abfrage, ob die Anzeige eines Steuerelements einen angegebenen Punkt überschneiden.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Außer Kraft setzen Sie, Abfrage, ob die Anzeige eines Steuerelements mit einem beliebigen Zeitpunkt in einem angegebenen Rechteck überschneidet.|
|[COleControl::OnRenderData](#onrenderdata)|Wird aufgerufen, durch das Framework zum Abrufen von Daten im angegebenen Format.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Wird aufgerufen, durch das Framework zum Abrufen von Daten aus einer Datei im angegebenen Format.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Wird aufgerufen, durch das Framework zum Abrufen von Daten aus dem globalen Speicher im angegebenen Format.|
|[COleControl::OnResetState](#onresetstate)|Eigenschaften eines Steuerelements zurückgesetzt auf die Standardwerte.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Benachrichtigt das Steuerelement, `IOleControl::SetClientSite` aufgerufen wurde.|
|[COleControl::OnSetData](#onsetdata)|Ersetzt die Daten des Steuerelements durch einen anderen Wert an.|
|[COleControl::OnSetExtent](#onsetextent)|Wird aufgerufen, nachdem die Daten des Steuerelements geändert wurde.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Aufgerufen, nachdem des Steuerelements Dimensionen geändert wurden.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Aufgerufen, wenn das Steuerelement Benutzeroberfläche aktiviert wurde.|
|[COleControl::OnTextChanged](#ontextchanged)|Aufgerufen, wenn die Stock Text oder die Eigenschaft "Beschriftung" geändert wird.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Verarbeitet Windows-Meldungen (mit Ausnahme des Tastatur- und Nachrichten) für fensterlose Steuerelemente.|
|[COleControl::ParentToClient](#parenttoclient)|Übersetzt einen Punkt relativ zum Ursprung des Containers, auf einen Zeitpunkt relativ zum Ursprung des Steuerelements.|
|[COleControl::PostModalDialog](#postmodaldialog)|Benachrichtigt den Container an, dass ein modales Dialogfeld geschlossen wurde.|
|[COleControl::PreModalDialog](#premodaldialog)|Benachrichtigt den Container, die ein modales Dialogfeld angezeigt werden soll.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Zerstört und neu erstellt das Fenster des Steuerelements.|
|[COleControl::Refresh](#refresh)|Erzwingt das Neuzeichnen der Darstellung eines Steuerelements.|
|[COleControl::ReleaseCapture](#releasecapture)|Gibt die Erfassung von Mauseingaben frei.|
|[COleControl::ReleaseDC](#releasedc)|Gibt die Anzeigegerätekontext, der ein Container mit einem fensterlosen Steuerelement frei.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Setzt das übergeordnete Element des Steuerelementfensters zurück.|
|[COleControl::ResetStockProps](#resetstockprops)|Initialisiert `COleControl` vordefinierte Eigenschaften auf ihre Standardwerte zurück.|
|[COleControl::ResetVersion](#resetversion)|Initialisiert die Versionsnummer auf einen angegebenen Wert.|
|[COleControl::ScrollWindow](#scrollwindow)|Ermöglicht ein fensterloses Steuerelement um einen Bereich innerhalb der in direkt aktiven Bildes auf der Anzeige zu scrollen.|
|[COleControl::SelectFontObject](#selectfontobject)|Wählt eine benutzerdefinierte Schriftarteigenschaft für einen Gerätekontext.|
|[COleControl::SelectStockFont](#selectstockfont)|Wählt die vordefinierte Schriftarteigenschaft einen Gerätekontext.|
|[COleControl::SerializeExtent](#serializeextent)|Serialisiert bzw. den Anzeigebereich des Steuerelements initialisiert.|
|[COleControl::SerializeStockProps](#serializestockprops)|Serialisiert bzw. initialisiert die `COleControl` Basiseigenschaften.|
|[COleControl::SerializeVersion](#serializeversion)|Serialisiert bzw. des Steuerelements Versionsinformationen initialisiert.|
|[COleControl::SetAppearance](#setappearance)|Legt den Wert der vordefinierten Appearance-Eigenschaft.|
|[COleControl::SetBackColor](#setbackcolor)|Legt den Wert der vordefinierten BackColor-Eigenschaft.|
|[COleControl::SetBorderStyle](#setborderstyle)|Legt den Wert der BorderStyle-Systemeigenschaft fest.|
|[COleControl::SetCapture](#setcapture)|Bewirkt, dass das Fenster des Steuerelements Container des Steuerelements im Auftrag besitzt das Erfassen von Mauseingaben zu.|
|[COleControl::SetControlSize](#setcontrolsize)|Legt fest, die Position und Größe des OLE-Steuerelements.|
|[COleControl::SetEnabled](#setenabled)|Legt den Wert der Aktie Enabled-Eigenschaft.|
|[COleControl::SetFocus](#setfocus)|Bewirkt, dass das Fenster des Steuerelements Container des Steuerelements im Auftrag zu den Eingabefokus besitzt.|
|[COleControl::SetFont](#setfont)|Legt den Wert, der die vordefinierte Schriftarteigenschaft.|
|[COleControl::SetForeColor](#setforecolor)|Legt den Wert der vordefinierten ForeColor-Eigenschaft.|
|[COleControl::SetInitialSize](#setinitialsize)|Legt die Größe eines OLE-Steuerelements, wenn in einem Container zuerst angezeigt.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Ändert den geänderten Zustand eines Steuerelements.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Gibt an, dass eine bearbeitungsanforderung fehlgeschlagen ist.|
|[COleControl::SetNotSupported](#setnotsupported)|Verhindert, dass Änderungen an den Wert eines Steuerelements Eigenschaft durch den Benutzer.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Legt fest, das Rechteck des Steuerelements relativ zu seinem Container.|
|[COleControl::SetText](#settext)|Legt den Wert der vordefinierten Text- oder Caption-Eigenschaft.|
|[COleControl::ThrowError](#throwerror)|Signalisiert, die in einem OLE-Steuerelement ein Fehler aufgetreten ist.|
|[COleControl::TransformCoords](#transformcoords)|Transformationen Koordinatenwerte zwischen einem Container und das Steuerelement an.|
|[COleControl::TranslateColor](#translatecolor)|Konvertiert einen OLE_COLOR-Wert in eine COLORREF-Wert.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Bestimmt, ob die Ambiente-Eigenschaften das nächste Mal zur Verfügung stehen, die das Steuerelement geladen wird.|
|[COleControl::WindowProc](#windowproc)|Enthält ein Windows-Verfahren für eine `COleControl` Objekt.|

### <a name="protected-methods"></a>Geschützte Methoden

|Name|Beschreibung|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Vom Framework aufgerufen, wenn die Darstellung des Steuerelements muss aktualisiert werden.|
|[COleControl::DrawMetafile](#drawmetafile)|Vom Framework aufgerufen, wenn die Metadatei-Gerätekontexts verwendet wird.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Ermöglicht die Automatisierung-Methodenaufruf.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Wird aufgerufen, durch das Framework zum Initialisieren der Liste der Datenformate, die vom Steuerelement unterstützt wird.|

## <a name="remarks"></a>Hinweise

Abgeleitet von `CWnd`, diese Klasse erbt die gesamte Funktionalität von einem Windows-Fensterobjekt und zusätzliche Funktionen für OLE, wie z. B. das Auslösen von Ereignissen und die Fähigkeit zur Unterstützung von Methoden und Eigenschaften.

OLE-Steuerelemente in OLE-containeranwendungen eingefügt werden können und die Kommunikation mit dem Container mit einer bidirektionalen Auslösen von Ereignissen und Methoden und Eigenschaften in den Container verfügbar gemacht. Beachten Sie, dass der standard OLE-Container unterstützen nur die grundlegende Funktionalität eines OLE-Steuerelements. Sie können keine erweiterten Funktionen von OLE-Steuerelements unterstützen. Auslösen von Ereignissen tritt auf, wenn Ereignisse in den Container durch bestimmte Aktionen in das Steuerelement gesendet werden. Im Gegenzug kommuniziert der Container mit dem Steuerelement über einen verfügbar gemachten Gruppe von Methoden und Eigenschaften, die analog zu den Memberfunktionen und Datenmember einer C++-Klasse. Dieser Ansatz ermöglicht den Entwickler, die Darstellung des Steuerelements zu steuern und den Container zu benachrichtigen, wenn bestimmte Aktionen ausgeführt werden.

## <a name="windowless-controls"></a>Fensterlose Steuerelemente

OLE-Steuerelemente können ohne ein Fenster verwendete in-Place-aktiv sein. Fensterlose Steuerelemente haben erhebliche Vorteile:

- Fensterlose Steuerelemente können transparent und nicht rechteckige sein.

- Fensterlose Steuerelemente Amortisationszeit Instanz Größe und die Erstellung des Objekts

Steuerelemente ist nicht erforderlich, ein Fenster. Dienste, die ein Fenster bietet können problemlos über ein einziges freigegebenen Fenster (normalerweise des Containers) und ein paar Codezeilen Verteilung bereitgestellt werden. Ein Fenster ist größtenteils eine unnötige Komplikation für das Objekt.

Wenn fensterloser Aktivierung verwendet wird, ist der Container (der ein Fenster) für die Bereitstellung von Diensten, die andernfalls durch das Fenster des Steuerelements bereitgestellt würden verantwortlich. Wenn das Steuerelement muss den Tastaturfokus abzufragen, die Erfassung von Mauseingaben Abfragen oder einen Gerätekontext zu erhalten, werden diese Vorgänge z.B. vom Container verwaltet. Die `COleControl` fensterlose Vorgang Memberfunktionen rufen Sie diese Vorgänge für den Container.

Wenn fensterloser Aktivierung aktiviert ist, die Container-Delegaten Eingabenachrichten des Steuerelements `IOleInPlaceObjectWindowless` Schnittstelle (eine Erweiterung der [IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject) fensterlose Support). `COleControl`die Implementierung dieser Schnittstelle werden diese Nachrichten über die meldungszuordnung Ihres Steuerelements, senden, nachdem entsprechend-die Maus anpassen Koordinaten. Diese Meldungen wie normale Windows-Meldungen, kann durch Hinzufügen der entsprechenden Einträge in die nachrichtenzuordnung verarbeitet werden.

Sie sollten immer verwenden, in einem fensterlosen Steuerelement, das `COleControl` Memberfunktionen anstelle der entsprechenden `CWnd` Memberfunktionen oder ihre zugehörigen Windows-API-Funktionen.

OLE-Steuerelement-Objekte können auch ein Fenster erstellen, nur, wenn sie aktiv ist, werden jedoch die Menge der Arbeit, die erforderlich sind, für den inaktiven / aktiv-Übergang steigt und die Geschwindigkeit des Übergangs ausfällt. Es gibt Fälle, in denen dieses Problem auftritt: berücksichtigen Sie beispielsweise ein Raster mit Textfeldern. Wenn Einfügemarke mit Bildlauf verschieben nach oben und unten durch die Spalte, jedes Steuerelement direktes muss aktiviert und anschließend deaktiviert. Die Geschwindigkeit des Übergangs inaktiv/aktiv-wirkt sich direkt auf die Geschwindigkeit des Bildlaufs aus.

Weitere Informationen zum Entwickeln von einer OLE-Steuerelement-Framework finden Sie in den Artikeln [MFC-ActiveX-Steuerelemente](../../mfc/mfc-activex-controls.md) und [Übersicht: Erstellen einer MFC-ActiveX-Steuerelement-Programm](../../mfc/reference/mfc-activex-control-wizard.md). Informationen zum Optimieren der OLE-Steuerelemente, einschließlich fensterlose und flimmerfreie-Steuerelemente finden Sie unter [MFC-ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Vererbungshierarchie

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Anforderungen

**Header:** afxctl.h

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

Gibt den Wert der ambient BackColor-Eigenschaft.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Rückgabewert

Der aktuelle Wert des Containers ambient BackColor-Eigenschaft, sofern vorhanden. Wenn die Eigenschaft nicht unterstützt wird, gibt diese Funktion den systemdefinierten Windows die Farbe des Hintergrunds zurück.

### <a name="remarks"></a>Hinweise

Die Ambiente-BackColor-Eigenschaft ist für alle Steuerelemente verfügbar und wird durch den Container definiert. Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützt.

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

Der Namen, die, den der Container dem Steuerelement zugewiesen hat, kann in dem Benutzer angezeigten Fehlermeldungen verwendet werden.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Rückgabewert

Der Name des OLE-Steuerelements. Der Standardwert ist eine Zeichenfolge der Länge 0 (null).

### <a name="remarks"></a>Hinweise

Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützt.

##  <a name="ambientfont"></a>  COleControl::AmbientFont

Gibt den Wert der ambient-Schriftart-Eigenschaft.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf des Containers ambient-Schriftart-Dispatch-Schnittstellen. Der Standardwert ist NULL. Wenn die Rückgabe nicht gleich NULL ist, sind Sie verantwortlich für die Freigabe der Schriftartformats durch Aufrufen der [IUnknown:: Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) Member-Funktion.

### <a name="remarks"></a>Hinweise

Die Ambiente-Schriftart-Eigenschaft wird vom Container definiert und verfügbar sind, für alle Steuerelemente. Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützt.

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

Gibt den Wert der ambient ForeColor-Eigenschaft.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Rückgabewert

Der aktuelle Wert des Containers ambient ForeColor-Eigenschaft, sofern vorhanden. Wenn nicht unterstützt, gibt diese Funktion die systemeigenen Windows-Textfarbe zurück.

### <a name="remarks"></a>Hinweise

Die Ambiente-Vordergrundfarbe-Eigenschaft ist für alle Steuerelemente verfügbar und wird durch den Container definiert. Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützt.

##  <a name="ambientlocaleid"></a>  COleControl:: AmbientLocaleID

Gibt den Container Gebietsschema-ID zurück.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Rückgabewert

Der Wert der Gebietsschema-ID des Containers-Eigenschaft, sofern vorhanden. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion 0 zurück.

### <a name="remarks"></a>Hinweise

Der LocaleID-Wert können das Steuerelement der Benutzeroberfläche für die verschiedenen Gebietsschemas angepasst werden kann. Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützt.

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

Ruft die aktuelle Darstellung-Einstellung für das Steuerelementobjekt ab.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Rückgabewert

Die Darstellung des Steuerelements:

- **0** Flatfile-Darstellung

- **1** 3D-Darstellung

### <a name="remarks"></a>Hinweise

Rufen Sie diese Funktion zum Abrufen des aktuellen Werts der DISPID_AMBIENT_APPEARANCE-Eigenschaft für das Steuerelement.

##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits

Gibt den Typ der Einheiten, die vom Container verwendeten zurück.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Rückgabewert

Eine Zeichenfolge mit dem ambient "ScaleUnits" des Containers. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion eine Zeichenfolge der Länge 0 (null) zurück.

### <a name="remarks"></a>Hinweise

Des Containers "ScaleUnits" Umgebungseigenschaft kann verwendet werden, zum Anzeigen von Positionen oder Dimensionen, die mit der Bezeichnung der ausgewählten Einheit, z. B. Twips oder Zentimeter. Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützt.

##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles

Bestimmt, ob der Container das Steuerelement zum Anzeigen der Ziehpunkte für sich selbst beim active zulässt.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Rückgabewert

Ungleich NULL Wenn Ziehpunkte angezeigt werden soll; andernfalls 0. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion ungleich NULL zurück.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützt.

##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching

Bestimmt, ob der Container das Steuerelement, sich mit einem schraffierten anzuzeigen, kann Muster, wenn UI aktiv.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn die Schraffurmuster angezeigt werden soll; andernfalls 0. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion ungleich NULL zurück.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützt.

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

Bestimmt die ambient-textausrichtung vom dem Steuerelementcontainer bevorzugt wird.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Rückgabewert

Der Status des Containers TextAlign Umgebungseigenschaft. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion 0 zurück.

Im folgenden finden eine Liste von gültigen Werten:

|Rückgabewert|Bedeutung|
|------------------|-------------|
|0|Allgemeine Ausrichtung (Zahlen auf den richtigen, Text auf der linken Seite).|
|1|Linksbündig ausrichten|
|2|Center |
|3|Rechtsbündig|

### <a name="remarks"></a>Hinweise

Diese Eigenschaft ist für alle eingebetteten Steuerelementen verfügbar und wird durch den Container definiert. Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützt.

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

Bestimmt, ob der Container das Steuerelement auf der Benutzeroberfläche Aktionen reagieren möchte.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn das Steuerelement zu UI-Aktionen reagieren soll; andernfalls 0. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion 0 zurück.

### <a name="remarks"></a>Hinweise

Z. B. ein Container möglicherweise legen Sie diese Einstellung auf "true", im Entwurfsmodus befindet.

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

Bestimmt, ob der Container im Entwurfsmodus oder User-Modus befindet.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Rückgabewert

Ungleich NULL ist, wenn der Container im Benutzermodus ist; Andernfalls wird 0 (im Entwurfsmodus). Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion TRUE zurück.

### <a name="remarks"></a>Hinweise

Z. B. ein Container möglicherweise legen Sie diese Einstellung auf "false", im Entwurfsmodus befindet.

##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged

Signalisiert, die den Wert der gebundenen Eigenschaft geändert wurde.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parameter

*DISPID*<br/>
Die Dispatch-ID einer gebundenen Eigenschaft des Steuerelements.

### <a name="remarks"></a>Hinweise

Dies muss aufgerufen werden jedes Mal, wenn der Wert der Eigenschaft ändert, sogar in Fällen, in dem die Änderung nicht über die Eigenschaft vorgenommen wurde, Methode festgelegt. Achten Sie besonders gebundenen Eigenschaften, die Membervariablen zugeordnet sind. Jedes Mal, dass solche ein Variable ändert, `BoundPropertyChanged` muss aufgerufen werden.

##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit

Fordert die Berechtigung aus dem `IPropertyNotifySink` Schnittstelle so ändern Sie einen gebundenen Eigenschaft-Wert, der vom Steuerelement bereitgestellt werden.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parameter

*DISPID*<br/>
Die Dispatch-ID einer gebundenen Eigenschaft des Steuerelements.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn die Änderung zulässig ist; andernfalls 0. Standardmäßig ist der Wert ist ungleich NULL.

### <a name="remarks"></a>Hinweise

Wenn die Berechtigung verweigert wird, muss das Steuerelement nicht den Wert der Eigenschaftenänderung können. Dies kann erfolgen, wird ignoriert, oder Fehler bei der Aktion, die versucht, den Wert der Eigenschaft zu ändern.

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

Übersetzt die Koordinaten der *pPoint* in übergeordneten Koordinaten.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parameter

*lprcBounds*<br/>
Zeiger auf die Grenzen des OLE-Steuerelements innerhalb des Containers. Nicht in den Clientbereich jedoch den Bereich des gesamten Steuerelements einschließlich der Rahmen und Scrollleisten.

*pPoint*<br/>
Zeiger auf die OLE-Clientzugriffspunkt Bereich in die Koordinaten des übergeordneten Elements (Container) übersetzt werden.

### <a name="remarks"></a>Hinweise

Bei der Eingabe *pPoint* ist relativ zum Ursprung des Clientbereichs des OLE-Steuerelements (oberen linken Ecke des Clientbereichs des Steuerelements). Bei der Ausgabe *pPoint* ist relativ zum Ursprung des übergeordneten Elements (oberen linken Ecke des Containers).

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

Passt ein Rechteck der Einfügemarke, wenn es vollständig oder teilweise durch Überschneidung nicht transparenter Objekte abgedeckt wird.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parameter

*lpRect*<br/>
Bei Eingabe einen Zeiger auf eine [RECT](../../mfc/reference/rect-structure1.md) -Struktur, enthält der Bereich "Einfügemarke" angepasst werden. Klicken Sie auf Ausgabe Bereich angepasste Einfügemarke oder NULL, wenn das Caretzeichen Rechteck vollständig abgedeckt wird.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Ein Caretzeichen ist eine blinkende Linie, blockieren oder Bitmap, die in der Regel gibt an, in denen Text oder Grafiken eingefügt wird.

Fensterloses Objekt kann nicht sicher ein Caretzeichen angezeigt, ohne zuerst prüfen, ob die Einfügemarke teilweise oder vollständig ausgeblendet ist, indem überlappende Objekte. Um, die möglich ist, können ein Objekt `ClipCaretRect` erhalten die Einfügemarke angepasst (reduziert) um sicherzustellen, dass es sich in den Ausschneidebereich einfügt.

Objekte erstellen ein Caretzeichen sollten das Caretzeichen Rechteck senden `ClipCaretRect` und verwenden Sie das angepasste Rechteck für die Einfügemarke. Wenn die Einfügemarke vollständig ausgeblendet ist, diese Methode gibt FALSE zurück, und das Caretzeichen nicht angezeigt werden soll auf allen in diesem Fall.

##  <a name="colecontrol"></a>  COleControl::COleControl

Erstellt ein `COleControl`-Objekt.

```
COleControl();
```

### <a name="remarks"></a>Hinweise

Diese Funktion ist normalerweise nicht direkt aufgerufen werden. Stattdessen wird der OLE-Steuerelements in der Regel von Klassenfactory erstellt.

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

Rufen Sie diese Funktion, wenn der Satz von mnemonischen Zeichen vom Steuerelement unterstützt geändert hat.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Hinweise

Beim Empfang dieser Benachrichtigung im Container des Steuerelements, erhält Sie den neuen Satz von mnemonischen Code des von einem Aufruf an [IOleControl::GetControlInfo](/windows/desktop/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Beachten Sie, dass der Container nicht erforderlich ist, um auf diese Benachrichtigung zu reagieren.

##  <a name="displayerror"></a>  COleControl::DisplayError

Vom Framework aufgerufen, nachdem die vordefinierte Error-Ereignis verarbeitet wurde (es sei denn, der Ereignishandler die Anzeige des Fehlers unterdrückt wurde).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parameter

*scode*<br/>
Der Statuswert des Codes gemeldet werden. Eine vollständige Liste der möglichen Fehlercodes, finden Sie im Artikel [ActiveX-Steuerelemente: Weiterführende Themen](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Die Beschreibung des Fehlers gemeldet wird.

*lpszSource*<br/>
Der Name des Moduls, die den Fehler (in der Regel der Name des OLE-Steuerelement-Moduls) generiert.

*lpszHelpFile*<br/>
Der Name der Hilfedatei, die eine Beschreibung des Fehlers enthält.

*nHelpID*<br/>
Die Hilfe-Kontext-ID des gemeldeten Fehlers.

### <a name="remarks"></a>Hinweise

Das Standardverhalten zeigt ein Meldungsfeld mit der Beschreibung des Fehlers, der in enthaltenen *LpszDescription*.

Überschreiben Sie diese Funktion anpassen, wie Fehler angezeigt werden.

##  <a name="doclick"></a>  COleControl::DoClick

Simuliert eine Maus klicken Sie auf die Aktion des Steuerelements.

```
void DoClick();
```

### <a name="remarks"></a>Hinweise

Die überschreibbare `COleControl::OnClick` Member-Funktion wird aufgerufen, und eine Aktie auf Ereignis ausgelöst wird, wenn das Steuerelement unterstützt.

Diese Funktion wird von unterstützt die `COleControl` Basisklasse als eine vordefinierte Methode namens DoClick. Weitere Informationen finden Sie im Artikel [ActiveX-Steuerelemente: Methoden](../../mfc/mfc-activex-controls-methods.md).

##  <a name="dopropexchange"></a>  COleControl:: DoPropExchange

Wird aufgerufen, durch das Framework beim Laden und speichern ein Steuerelement aus einer Darstellung beständigen Speicher benötigen, z.B. ein Satz Stream oder eine Eigenschaft.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parameter

*pPX*<br/>
Ein Zeiger auf ein `CPropExchange` -Objekt. Das Framework stellt dieses Objekt aus, um den Kontext der Exchange-Eigenschaft, darunter seine Richtung einzurichten.

### <a name="remarks"></a>Hinweise

Diese Funktion führt normalerweise Aufrufe an die **PX_** Funktionsreihe zum Laden oder Speichern von spezifischen, benutzerdefinierten Eigenschaften eines OLE-Steuerelements.

Wenn der Steuerelement-Assistent zum Erstellen des Projekts der OLE-Steuerelement verwendet wurde, wird die überschriebene Version dieser Funktion die vordefinierten Eigenschaften, die von unterstützt Serialisieren `COleControl` durch einen Aufruf der Funktion der Basisklasse `COleControl::DoPropExchange`. Hinzufügen von benutzerdefinierten Eigenschaften zu Ihrem OLE-Steuerelement müssen Sie diese Funktion zum Serialisieren der neuen Eigenschaften zu ändern. Weitere Informationen zur Serialisierung finden Sie im Artikel [ActiveX-Steuerelemente: Serialisierung](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint

Zeichnet ein OLE-Steuerelement, das von einem Windows-Steuerelement erstellt wurde.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Ein Zeiger auf den Gerätekontext, der dem Steuerelementcontainer.

*rcBounds*<br/>
Der Bereich, in dem das Steuerelement ist, gezeichnet werden soll.

### <a name="remarks"></a>Hinweise

Mit dieser Funktion können Sie ordnungsgemäß für das Zeichnen eines inaktiven OLE-Steuerelements. Diese Funktion sollte nur verwendet werden, wenn das OLE Unterklassen ein Windows-Steuerelements zu steuern und soll, in aufgerufen werden der `OnDraw` Funktion des Steuerelements.

Weitere Informationen zu dieser Funktion und Erstellen von Unterklassen für ein Windows-Steuerelement, finden Sie im Artikel [ActiveX-Steuerelemente: Erstellen von Unterklassen für ein Windows-Steuerelement](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

##  <a name="drawcontent"></a>  COleControl::DrawContent

Vom Framework aufgerufen, wenn die Darstellung des Steuerelements muss aktualisiert werden.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Zeiger auf den Gerätekontext.

*RC*<br/>
Rechteckige Bereich, gezeichnet werden soll.

### <a name="remarks"></a>Hinweise

Diese Funktion ruft direkt die überschreibbare `OnDraw` Funktion.

##  <a name="drawmetafile"></a>  COleControl::DrawMetafile

Vom Framework aufgerufen, wenn die Metadatei-Gerätekontexts verwendet wird.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Zeiger auf die Metadatei-Gerätekontexts.

*RC*<br/>
Rechteckige Bereich, gezeichnet werden soll.

##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame

Ermöglicht das einfache Frame-Merkmal für OLE-Steuerelements.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Hinweise

Dieses Merkmal ermöglicht einem Steuerelement visual Kapselung von anderen Steuerelementen, aber nicht "true" OLE-Kapselung zu unterstützen. Ein Beispiel wäre ein Gruppenfeld in mehrere Steuerelemente. Diese Steuerelemente sind keine OLE enthalten, aber sie sind im gleichen Gruppe.

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

Serialisiert bzw. initialisiert den Zustand des Steuerelements Blocks (die Dimensionen in HIMETRIC-Einheiten).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parameter

*pPX*<br/>
Ein Zeiger auf eine [CPropExchange](../../mfc/reference/cpropexchange-class.md) Objekt. Das Framework stellt dieses Objekt aus, um den Kontext der Exchange-Eigenschaft, darunter seine Richtung einzurichten.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn die Funktion erfolgreich war; andernfalls 0.

### <a name="remarks"></a>Hinweise

Diese Funktion wird normalerweise aufgerufen, indem Sie die standardmäßige Implementierung des `COleControl::DoPropExchange`.

##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps

Serialisiert bzw. initialisiert den Zustand der vordefinierten Eigenschaften des Steuerelements.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parameter

*pPX*<br/>
Ein Zeiger auf eine [CPropExchange](../../mfc/reference/cpropexchange-class.md) Objekt. Das Framework stellt dieses Objekt aus, um den Kontext der Exchange-Eigenschaft, darunter seine Richtung einzurichten.

### <a name="remarks"></a>Hinweise

Diese Funktion wird normalerweise aufgerufen, indem Sie die standardmäßige Implementierung des `COleControl::DoPropExchange`.

##  <a name="exchangeversion"></a>  COleControl:: ExchangeVersion

Serialisiert bzw. initialisiert den Zustand der Versionsinformationen eines Steuerelements.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parameter

*pPX*<br/>
Ein Zeiger auf ein `CPropExchange` -Objekt. Das Framework stellt dieses Objekt aus, um den Kontext der Exchange-Eigenschaft, darunter seine Richtung einzurichten.

*dwVersionDefault*<br/>
Die aktuelle Versionsnummer des Steuerelements.

*bConvert*<br/>
Gibt an, ob die persistente Daten konvertiert werden sollen, in das aktuelle Format, wenn gespeichert oder verwaltet werden, im gleichen Format, das geladen wurde.

### <a name="return-value"></a>Rückgabewert

Ungleich null der die Funktion erfolgreich ausgeführt wird; andernfalls 0.

### <a name="remarks"></a>Hinweise

Diese werden in der Regel die erste Funktion eines Steuerelements Überschreiben der azurenode `COleControl::DoPropExchange`. Beim Laden, diese Funktion liest die Versionsnummer der permanenten Daten und wird das Versionsattribut des der [CPropExchange](../../mfc/reference/cpropexchange-class.md) -Objekt entsprechend. Beim Speichern, schreibt diese Funktion die Versionsnummer der permanenten Daten.

Weitere Informationen zu Persistenz und versionsverwaltung, finden Sie im Artikel [ActiveX-Steuerelemente: Serialisierung](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="fireclick"></a>  COleControl::FireClick

Wird vom Framework aufgerufen, wenn die Maus über ein aktives Steuerelement geklickt wird.

```
void FireClick();
```

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wenn das Ereignis ausgelöst wird.

Automatisches Auslösen von ein Click-Ereignis auftritt, des Steuerelements ereigniszuordnung benötigen eine Aktie auf Ereignis definiert.

##  <a name="firedblclick"></a>  COleControl::FireDblClick

Wird vom Framework aufgerufen, wenn die Maus über ein aktives Steuerelement doppelgeklickt wird.

```
void FireDblClick();
```

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wenn das Ereignis ausgelöst wird.

Für automatische Auslösen eines Ereignisses DblClick auftreten, müssen die ereigniszuordnung des Steuerelements ein DblClick Ereignis definiert.

##  <a name="fireerror"></a>  COleControl:: FireError

Wird ausgelöst, die vordefinierte Error-Ereignis.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parameter

*scode*<br/>
Der Statuswert des Codes gemeldet werden. Eine vollständige Liste der möglichen Fehlercodes, finden Sie im Artikel [ActiveX-Steuerelemente: Weiterführende Themen](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Die Beschreibung des Fehlers gemeldet wird.

*nHelpID*<br/>
Die Hilfe-ID des Fehlers gemeldet wird.

### <a name="remarks"></a>Hinweise

Dieses Ereignis bietet eine Möglichkeit zum Angeben sein können, auf den entsprechenden Stellen in Ihrem Code, dass ein Fehler, in Ihrer Hand aufgetreten ist. Im Gegensatz zu anderen vordefinierten Ereignissen, z. B. Klicken Sie auf "oder" MouseMove wird der Fehler nicht vom Framework ausgelöst.

Aufrufen, um Fehler zu melden, die während einer Property-Get-Funktion, Eigenschaft Set-Funktion oder Automatisierungsmethode auftritt, [ThrowError](#throwerror).

Die Implementierung der Stock-Fehlerereignis eines OLE-Steuerelements verwendet einen SCODE-Wert. Wenn das Steuerelement dieses Ereignisses und in Visual Basic 4.0 verwendet werden soll, erhalten Sie Fehlermeldungen, da der Wert SCODE in Visual Basic nicht unterstützt wird.

Um dieses Problem zu beheben, müssen Sie manuell ändern Sie den SCODE-Parameter im des Steuerelements. ODL-Datei, die eine **lange**. Darüber hinaus bewirkt, dass alle benutzerdefinierten Ereignisse, die Methode oder die Eigenschaft, die einen SCODE-Parameter verwendet auch das gleiche Problem.

##  <a name="fireevent"></a>  COleControl::

Wird ausgelöst, ein benutzerdefiniertes Ereignis über das Steuerelement mit einer beliebigen Anzahl optionaler Argumente.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parameter

*DISPID*<br/>
Die Dispatch-ID des Ereignisses ausgelöst werden soll.

*pbParams*<br/>
Ein Deskriptor für die Parametertypen des Ereignisses.

### <a name="remarks"></a>Hinweise

In der Regel sollte diese Funktion nicht direkt aufgerufen werden. Stattdessen werden Sie die Ereignisse auslösen-Funktionen im Ereignis Map-Abschnitt der Klassendeklaration des Steuerelements aufrufen.

Die *PbParams* Argument ist eine durch Leerzeichen getrennte Liste von **VTS_**. Einer oder mehrere dieser Werte, durch Leerzeichen (nicht Kommas) getrennt, gibt bzw. geben die Parameterliste der Funktion an. Folgende Werte sind möglich:

|Symbol|Parametertyp|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  Für alle variant-Typen, mit Ausnahme von VTS_FONT und VTS_PICTURE, wurden zusätzliche variant Konstanten definiert, die einen Zeiger auf die Konstante variant-Daten bereitstellen. Diese Konstanten werden mit dem Namen mit den **VTS_P** `constantname` Konvention. VTS_PCOLOR ist z. B. ein Zeiger auf eine VTS_COLOR-Konstante.

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

Vom Framework aufgerufen, wenn eine Taste gedrückt wird, während das Steuerelement-Benutzeroberfläche aktiv ist.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parameter

*pnChar*<br/>
Zeiger auf den virtueller Tastencode-Wert, der die gedrückte Taste. Eine Liste der standardmäßige virtuelle Tastencodes finden Sie in der Winuser.h

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE gedrückt wurde während der Aktion gedrückt.

- Während der Aktion wurde die CTRL_MASK die STRG-Taste gedrückt.

- ALT_MASK die ALT-Taste wurde während der Aktion gedrückt.

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wenn das Ereignis ausgelöst wird.

Für automatische Auslösen von ein KeyDown-Ereignis auftritt, müssen die ereigniszuordnung des Steuerelements ein vordefinierten KeyDown-Ereignis definiert.

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

Wird vom Framework aufgerufen, wenn eine Taste gedrückt und losgelassen wird, während das benutzerdefinierte Steuerelement im Container UI-aktiv ist.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parameter

*pnChar*<br/>
Ein Zeiger auf den Zeichenwert, der die gedrückte Taste.

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wenn das Ereignis ausgelöst wird.

Der Empfänger des Ereignisses darf ändern *PnChar*, z. B. alle Kleinbuchstaben in Großbuchstaben konvertieren. Wenn Sie das geänderte Zeichen untersuchen möchten, überschreiben `OnKeyPressEvent`.

Für automatische Auslösen von ein KeyPress-Ereignis auftritt, müssen die ereigniszuordnung des Steuerelements ein vordefinierten KeyPress-Ereignis definiert.

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

Vom Framework aufgerufen, wenn eine Taste losgelassen wird, während das benutzerdefinierte Steuerelement im Container UI-aktiv ist.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parameter

*pnChar*<br/>
Zeiger auf den virtueller Tastencode-Wert, der den freigegebenen Schlüssel. Eine Liste der standardmäßige virtuelle Tastencodes finden Sie in der Winuser.h

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE gedrückt wurde während der Aktion gedrückt.

- Während der Aktion wurde die CTRL_MASK die STRG-Taste gedrückt.

- ALT_MASK die ALT-Taste wurde während der Aktion gedrückt.

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wenn das Ereignis ausgelöst wird.

Für automatische Auslösen von einem KeyUp-Ereignis auftritt, müssen die ereigniszuordnung des Steuerelements ein vordefiniertes KeyUp-Ereignis definiert.

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

Vom Framework aufgerufen, wenn eine Maustaste über ein aktives benutzerdefinierte Steuerelement gedrückt wird.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parameter

*Nschaltfläche*<br/>
Der numerische Wert in der Maustaste gedrückt wird. Sie können eine der folgenden Werte enthalten:

- LEFT_BUTTON die linke Maustaste wurde gedrückt.

- MIDDLE_BUTTON der mittleren Maustaste wurde gedrückt.

- RIGHT_BUTTON die rechte Maustaste wurde gedrückt.

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE gedrückt wurde während der Aktion gedrückt.

- Während der Aktion wurde die CTRL_MASK die STRG-Taste gedrückt.

- ALT_MASK die ALT-Taste wurde während der Aktion gedrückt.

*w*<br/>
Die X-Koordinate der Cursor, wenn eine Maustaste gedrückt wurde. Die Koordinate ist relativ zur oberen linken Ecke des Steuerelementfensters.

*y*<br/>
Die y-Koordinate der Cursor, wenn eine Maustaste gedrückt wurde. Die Koordinate ist relativ zur oberen linken Ecke des Steuerelementfensters.

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wenn das Ereignis ausgelöst wird.

Für automatische Auslösen von einem MouseDown-Ereignis auftritt, müssen die ereigniszuordnung des Steuerelements ein vordefiniertes MouseDown-Ereignis definiert.

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

Vom Framework aufgerufen, wenn der Cursor über ein aktives benutzerdefinierte Steuerelement bewegt wird.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parameter

*Nschaltfläche*<br/>
Der numerische Wert der Maustasten gedrückt. Enthält eine Kombination der folgenden Werte an:

- LEFT_BUTTON die linke Maustaste gedrückt wurde während der Aktion gedrückt.

- MIDDLE_BUTTON die mittlere Maustaste gedrückt wurde während der Aktion gedrückt.

- RIGHT_BUTTON die rechte Maustaste gedrückt wurde während der Aktion gedrückt.

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE gedrückt wurde während der Aktion gedrückt.

- Während der Aktion wurde die CTRL_MASK die STRG-Taste gedrückt.

- ALT_MASK die ALT-Taste wurde während der Aktion gedrückt.

*w*<br/>
Die X-Koordinate des Cursors. Die Koordinate ist relativ zur oberen linken Ecke des Steuerelementfensters.

*y*<br/>
Die y-Koordinate des Cursors. Die Koordinate ist relativ zur oberen linken Ecke des Steuerelementfensters.

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wenn das Ereignis ausgelöst wird.

Für automatische Auslösen von einem MouseMove-Ereignis auftritt, müssen die ereigniszuordnung des Steuerelements ein vordefiniertes MouseMove-Ereignis definiert.

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

Wird vom Framework aufgerufen, wenn eine Maustaste, über ein aktives benutzerdefinierte Steuerelement losgelassen wird.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parameter

*Nschaltfläche*<br/>
Der numerische Wert, der die Maustaste freigegeben werden soll. Es kann einen der folgenden Werte aufweisen:

- LEFT_BUTTON, die die linke Maustaste losgelassen wurde.

- MIDDLE_BUTTON, die die mittlere Maustaste losgelassen wurde.

- RIGHT_BUTTON, die die rechte Maustaste losgelassen wurde.

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE gedrückt wurde während der Aktion gedrückt.

- Während der Aktion wurde die CTRL_MASK die STRG-Taste gedrückt.

- ALT_MASK die ALT-Taste wurde während der Aktion gedrückt.

*w*<br/>
Die X-Koordinate des Cursors, wenn eine Maustaste losgelassen wurde. Die Koordinate ist relativ zur oberen linken Ecke des Steuerelementfensters.

*y*<br/>
Die y-Koordinate eines Cursors, wenn eine Maustaste losgelassen wurde. Die Koordinate ist relativ zur oberen linken Ecke des Steuerelementfensters.

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wenn das Ereignis ausgelöst wird.

Für die automatische Auslösung ein MouseUp-Ereignis auftritt, müssen die ereigniszuordnung des Steuerelements ein vordefiniertes MouseUp-Ereignis definiert.

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

Löst ein Ereignis mit den aktuellen Wert der Zustand des Steuerelements "bereit".

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Hinweise

Status "bereit" die folgenden Werte sind möglich:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Standard-Initialisierungszustand|
|READYSTATE_LOADING|Steuerelement lädt seine Eigenschaften derzeit|
|READYSTATE_LOADED|Steuerelement wurde initialisiert.|
|READYSTATE_INTERACTIVE|Das Steuerelement genügend Daten für die interaktive werden jedoch nicht alle asynchrone Daten werden noch geladen.|
|READYSTATE_COMPLETE|Steuerelement verfügt über alle darin enthaltenen Daten|

Verwendung [GetReadyState abrufbar](#getreadystate) um aktuelle Bereitschaft des Steuerelements zu bestimmen.

[InternalSetReadyState beispielsweise](#internalsetreadystate) ändert sich der Status "bereit" mit dem angegebenen Wert, und ruft dann `FireReadyStateChange`.

##  <a name="getactivationpolicy"></a>  COleControl:: GetActivationPolicy

Ändert das Standardverhalten für die Aktivierung eines Steuerelements, das unterstützt die `IPointerInactive` Schnittstelle.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Rückgabewert

Eine Kombination von Flags aus der POINTERINACTIVE-Enumeration. Mögliche Flags sind:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|Das Objekt sollte direkt aktiviert werden, wenn der Mauszeiger während eines Verschiebevorgangs Maus bewegt.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|Das Objekt sollte deaktiviert werden, wenn der Mauszeiger das Objekt während eines Verschiebevorgangs Maus verlässt.|
|POINTERINACTIVE_ACTIVATEONDRAG|Das Objekt sollte direkt aktiviert, wenn der Mauszeiger während eines Ziehvorgangs darüber gezogen wird, und drop-Vorgangs.|

### <a name="remarks"></a>Hinweise

Wenn die `IPointerInactive` Schnittstelle aktiviert ist, wird der Container WM_SETCURSOR und WM_MOUSEMOVE-Nachrichten an diese delegiert. `COleControl`die Implementierung dieser Schnittstelle werden diese Nachrichten über die meldungszuordnung Ihres Steuerelements, senden, nachdem entsprechend-die Maus anpassen Koordinaten.

Jedes Mal, wenn der Container eine WM_SETCURSOR- oder WM_MOUSEMOVE-Meldung mit dem Mauszeiger über einem inaktiven Objekt Unterstützung empfängt `IPointerInactive`, sie sollten Aufrufen `GetActivationPolicy` auf die Schnittstelle und die Rückgabe von Flags aus der POINTERINACTIVE-Enumeration.

Diese Meldungen genau wie normale Windows-Meldungen, kann durch Hinzufügen der entsprechenden Einträge in die nachrichtenzuordnung verarbeitet werden. Verwenden Sie in Ihre Handler, der `m_hWnd` Membervariable (oder alle Memberfunktionen, die es verwendet) ohne zuerst stellt sicher, dass der Wert ungleich NULL ist.

Ein Objekt, das mehr als legen Sie den Mauszeiger bzw. ein MouseMove-Ereignis, z. B. ausgelöst soll spezielle visuelles Feedback, das Flag POINTERINACTIVE_ACTIVATEONENTRY und soll zeichnen das Feedback nur, wenn Sie aktiv. Wenn dieses Flag in das Objekt zurückgegeben wird, der Container direkt sofort aktivieren und anschließend weiterleiten, dieselbe Nachricht, die den Aufruf von ausgelöst sollten `GetActivationPolicy`.

Wenn sowohl die POINTERINACTIVE_DEACTIVATEONLEAVE die POINTERINACTIVE_ACTIVATEONENTRY Flags zurückgegeben werden, wird das Objekt nur aktiviert, wenn der Mauszeiger das Objekt befindet. Wenn nur das Flag POINTERINACTIVE_ACTIVATEONENTRY zurückgegeben wird, wird das Objekt nur aktiviert, sobald bei die Maus auf das Objekt gibt.

Sie sollten auch ein Inaktives Steuerelement nicht das Ziel einer OLE-Drag und drop-Vorgangs. Dies erfordert, aktivieren das Steuerelement zum Zeitpunkt der Benutzer ein Objekt auf, bewegt, damit das Fenster des Steuerelements als Dropziel registriert werden kann. Geben Sie damit Aktivierung während eines Ziehvorgangs ausgeführt wird, das Flag POINTERINACTIVE_ACTIVATEONDRAG zurück:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Die Informationen übermittelt werden, indem `GetActivationPolicy` sollten nicht von einem Container zwischengespeichert werden. Stattdessen sollten diese Methode aufgerufen werden, jedes Mal, wenn die Maus in einem inaktiven Objekt eintritt.

Wenn einem inaktiven Objekt nicht direkt aktiviert, wenn der Mauszeiger wechselt Sie in anfordert, sollte der Container durch Aufrufen von nachfolgenden WM_SETCURSOR-Nachrichten an dieses Objekt senden [OnInactiveSetCursor](#oninactivesetcursor) solange der Mauszeiger bleiben über das Objekt.

Aktivieren der `IPointerInactive` Schnittstelle in der Regel bedeutet, dass das Steuerelement kann mausmeldungen jederzeit verarbeiten soll. Um dieses Problem in einem Container zu erhalten, die nicht unterstützt die `IPointerInactive` -Schnittstelle, Sie müssen das Steuerelement immer aktiviert, wenn sichtbar ist, was bedeutet, dass das Steuerelement das Flag OLEMISC_ACTIVATEWHENVISIBLE zwischen verschiedenen Flags haben sollte. Um zu verhindern, dass dieses Flag aus wirksam in einem Container, die unterstützt jedoch `IPointerInactive`, Sie können auch das Flag OLEMISC_IGNOREACTIVATEWHENVISIBLE angeben:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl:: GetAmbientProperty

Ruft den Wert der ambient-Eigenschaft des Containers ab.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parameter

*dwDispid*<br/>
Die Dispatch-ID der gewünschte ambient-Eigenschaft.

*vtProp*<br/>
Ein variant-Typ-Tag, der angibt, der Typ des Werts im zurückzugebenden *PvProp*.

*pvProp*<br/>
Ein Zeiger auf die Adresse der Variablen, die den Wert der Eigenschaft empfangen wird oder den Rückgabewert. Der tatsächliche Typ des this-Zeigers muss den vom angegebenen Typ übereinstimmen *VtProp*.

|vtProp|Typ des pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|DEN WERT VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn die Ambiente-Eigenschaft unterstützt wird; andernfalls 0.

### <a name="remarks"></a>Hinweise

Bei Verwendung von `GetAmbientProperty` legen Sie zum Abrufen der ambient-Eigenschaften "DisplayName" und "ScaleUnits" *VtProp* auf VT_BSTR und *PvProp* zu `CString*`. Wenn Sie die Ambiente-Schriftart-Eigenschaft abrufen, festlegen *VtProp* zu VT_FONT und *PvProp* zu LPFONTDISP *.

Beachten Sie, dass Funktionen wie z. B. bereits häufig Umgebungseigenschaften, bereitgestellt worden sind [AmbientBackColor](#ambientbackcolor) und [AmbientFont](#ambientfont).

##  <a name="getappearance"></a>  COleControl::GetAppearance

Implementiert die Get-Funktion der vordefinierten Appearance-Eigenschaft des Steuerelements an.

```
short GetAppearance ();
```

### <a name="return-value"></a>Rückgabewert

Der Rückgabewert gibt die aktuelle Einstellung der Darstellung als eine **kurze** (VT_I2)-Wert, wenn erfolgreich. Dieser Wert ist 0 (null), wenn die Darstellung des Steuerelements Flatfile und 1 ist, ist die Darstellung des Steuerelements 3D.

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

Implementiert die Get-Funktion der vordefinierten BackColor-Eigenschaft des Steuerelements an.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Rückgabewert

Der Rückgabewert gibt die aktuelle Hintergrundfarbe als OLE_COLOR-Wert an, ob erfolgreich. Dieser Wert auf einen Wert COLORREF übersetzt werden kann, mit einem Aufruf von `TranslateColor`.

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

Implementiert die Get-Funktion der vordefinierten BorderStyle-Eigenschaft des Steuerelements an.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Rückgabewert

1, wenn das Steuerelement einen normalen Rahmen hat; 0, wenn das Steuerelement keinen Rahmen hat.

##  <a name="getcapture"></a>  COleControl::GetCapture

Bestimmt, ob die `COleControl` Objekt hat die Mausauswahl.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Rückgabewert

Gibt zurück, wenn das Steuerelement aktiviert und eine fensterlose, **dies** , wenn das Steuerelement verfügt derzeit über die Maus erfassen (wie durch den Container des Steuerelements festgelegt) oder NULL, wenn sie nicht über die Erfassung verfügt.

Andernfalls die `CWnd` -Objekt, das die mausaufzeichnung verfügen (wie `CWnd::GetCapture`).

### <a name="remarks"></a>Hinweise

Ein aktiviertes fensterloses Steuerelement empfängt die Maus erfassen, wenn [SetCapture](#setcapture) aufgerufen wird.

##  <a name="getclassid"></a>  COleControl::GetClassID

Wird aufgerufen, durch das Framework, um die OLE-Klassen-ID des Steuerelements abzurufen.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parameter

*pclsid*<br/>
Zeiger auf den Speicherort der Klasse-ID.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL ist, wenn der Aufruf nicht erfolgreich war; andernfalls 0.

### <a name="remarks"></a>Hinweise

In der Regel implementiert, indem die [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

Ruft den Unterschied zwischen der oberen linken Ecke des rechteckigen Bereichs des Steuerelements "und" der oberen linken Ecke seines Clientbereichs ab.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parameter

*pdxOffset*<br/>
Zeiger auf den horizontalen Offset des Clientbereichs des OLE-Steuerelements.

*pdyOffset*<br/>
Zeiger auf den vertikalen Offset des Clientbereichs des OLE-Steuerelements.

### <a name="remarks"></a>Hinweise

Der OLE-Steuerelements verfügt über einen rechteckigen Bereich innerhalb des Containers. Das den Clientbereich des Steuerelements ist das Ausschließen von Rahmen und Bildlaufleisten Steuerelementbereich. Der Offset abgerufen werden, indem `GetClientOffset` ist der Unterschied zwischen der oberen linken Ecke des rechteckigen Bereichs des Steuerelements "und" der oberen linken Ecke seines Clientbereichs. Wenn das Steuerelement nicht-Client-Elemente als die standardmäßige Rahmen und Bildlaufleisten verfügt, überschreiben Sie diese Memberfunktion um den Offset anzugeben.

##  <a name="getclientrect"></a>  COleControl::GetClientRect

Ruft die Größe des Clientbereichs des Steuerelements ab.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parameter

*lpRect*<br/>
Zeiger auf eine `RECT` Struktur, die die Abmessungen des Clientbereichs der fensterloses Steuerelement enthält, d. h. die Größe des Steuerelements minus Fensterrahmen, Frames, Bildlaufleisten und So weiter. Die *LpRect* Parameter gibt die Größe des Clientrechteck des Steuerelements nicht seine Position.

##  <a name="getclientsite"></a>  COleControl::GetClientSite

Fragt ein Objekt für den Zeiger auf die aktuelle Client-Website in dessen Container ab.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf aktuelle Clientsite des Steuerelements in seinem Container.

### <a name="remarks"></a>Hinweise

Der zurückgegebene Zeiger verweist auf eine Instanz von `IOleClientSite`. Die `IOleClientSite` -Schnittstelle, von Containern implementiert ist, des Objekts anzeigen seines Kontexts: an, wo es im Dokument, in den Speicher, Benutzeroberfläche und anderen Ressourcen wird verankert ist.

##  <a name="getcontrolflags"></a>  COleControl:: GetControlFlags

Ruft die Einstellungen für das Steuerelement ab.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Rückgabewert

Eine ORed Kombination der Flags in der Enumeration ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Hinweise

In der Standardeinstellung `GetControlFlags` gibt `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Wenn festgelegt, verwendet eine Begin-Paint-Funktion anstelle von OLE-Steuerelemente zugeschnitten sind die ["BeginPaint"](/windows/desktop/api/winuser/nf-winuser-beginpaint) API (standardmäßig festgelegt).|
|`clipPaintDC`|Wenn nicht festgelegt, deaktiviert den Aufruf von `IntersectClipRect` vom `COleControl` und einen geringen Leistungsvorteil erzielt. Wenn Sie fensterlosen Aktivierung verwenden, hat das Flag keine Auswirkungen.|
|`pointerInactive`|Wenn festgelegt ist, bietet Mausinteraktion, während das Steuerelement durch Aktivieren der inaktiv ist `COleControl`die Implementierung der `IPointerInactive` -Schnittstelle, die standardmäßig deaktiviert ist.|
|`noFlickerActivate`|Wenn festgelegt, entfallen zusätzliche Zeichenvorgänge und die damit verbundene Flimmern. Wird verwendet, wenn das Steuerelement selbst im inaktive und aktive Zustand identisch zeichnet. Wenn Sie fensterlosen Aktivierung verwenden, hat das Flag keine Auswirkungen.|
|`windowlessActivate`|Wenn festgelegt ist, gibt an, das Steuerelement verwendet fensterlosen Aktivierung.|
|`canOptimizeDraw`|Wenn festgelegt ist, gibt an, dass das Steuerelement optimiertes zeichnen, ausgeführt werden, wenn der Container unterstützt.|

Weitere Informationen zu `GetControlFlags` und andere Optimierungen der OLE-Steuerelemente finden Sie unter [ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

Ruft die Größe der Fenster des OLE-Steuerelements ab.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parameter

*pcx*<br/>
Gibt die Breite des Steuerelements in Pixel an.

*pcy*<br/>
Gibt die Höhe des Steuerelements in Pixel an.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass alle Koordinaten für steuerelementfenstern relativ zu der oberen linken Ecke des Steuerelements.

##  <a name="getdc"></a>  COleControl::GetDC

Stellt Sie bereit für ein fensterloses Objekt Gerätekontext Get einen Bildschirm (oder kompatible) von seinem Container an.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parameter

*lprcRect*<br/>
Ein Zeiger auf das Rechteck das fensterloses Steuerelement möchte, in Clientkoordinaten des Steuerelements neu zu zeichnen. NULL bedeutet, dass der vollständige Wertebereich des Objekts.

*dwFlags*<br/>
Zeichnen die Attribute des Gerätekontexts. Optionen sind:

- OLEDC_NODRAW gibt an, die den Gerätekontext nicht ausführen alle zeichnen jedoch nur zum Abrufen von Informationen über das Anzeigegerät des Objekts verwenden. Der Container sollten einfach des Fensters DC übergeben, ohne weitere Verarbeitung.

- OLEDC_PAINTBKGND fordert an, dass es sich bei der Container der Hintergrund gezeichnet wird, vor der Rückgabe des DC. Ein Objekt sollten dieses Flag verwenden, wenn sie einen Domänencontroller für das Neuzeichnen eines Bereichs mit transparentem Hintergrund anfordert.

- OLEDC_OFFSCREEN informiert den Container, den möchte, dass das Objekt in einer Offscreen-Bitmap gerendert werden soll, die Sie dann auf dem Bildschirm kopiert werden sollen. Ein Objekt sollten dieses Flag verwenden, wenn die Zeichenoperation ausführen, um viele Flimmern generiert. Der Container kann diese Anforderung oder nicht berücksichtigt. Aber wenn dieses Flag nicht festgelegt ist, der Container muss übergeben wieder einem auf dem Bildschirm DC. Dadurch können Objekte zum Ausführen von direkten Bildschirm Vorgängen wie z.B. das Anzeigen einer Auswahl (über eine **XOR** Vorgang).

### <a name="return-value"></a>Rückgabewert

Zeiger auf das Gerät Anzeigekontext für den Container `CWnd` Clientbereich, wenn erfolgreich; andernfalls NULL zurückgegeben wird. Die Anzeigegerätekontext kann in nachfolgenden GDI-Funktionen verwendet werden, um in den Clientbereich des Fensters für den Container zu zeichnen.

### <a name="remarks"></a>Hinweise

Die [ReleaseDC](#releasedc) Memberfunktion aufgerufen werden, um den Kontext nach dem Zeichnen freizugeben. Beim Aufrufen von `GetDC`, Objekte übergeben, das Rechteck, das sie in ihren eigenen Clientkoordinaten in zeichnen möchten. `GetDC` übersetzt diese in die Koordinaten des Clientbereichs Container. Das Objekt muss eine gewünschte Zeichenrechtecks, die größer als einen eigenen Bereich Clientrechteck, deren Größe abgerufen werden kann, mit nicht anfordern [GetClientRect](#getclientrect). Dadurch wird verhindert, dass Objekte versehentlich zeichnen, in denen nicht auf für Sie bestimmt sind.

##  <a name="getenabled"></a>  COleControl::GetEnabled

Implementiert die Get-Funktion des Steuerelements vordefinierter Enabled-Eigenschaft.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn das Steuerelement aktiviert ist; andernfalls 0.

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

Erhält einen Zeiger auf ein Objekt, das verwaltet werden, indem Sie den Container, der das Steuerelement über einen erweiterten Satz von Eigenschaften darstellt.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf den Container dem Control-Objekt erweitert werden. Wenn kein Objekt vorhanden ist, ist der Wert NULL.

Dieses Objekt kann bearbeitet werden, über die `IDispatch` Schnittstelle. Sie können auch `QueryInterface` zum Abrufen anderer verfügbaren Schnittstellen, die vom Objekt bereitgestellt werden. Das Objekt ist jedoch nicht erforderlich, um einen bestimmten Satz von Schnittstellen zu unterstützen. Beachten Sie, dass der vertrauenden Seite, auf welche Funktionen für erweiterte Steuerelementobjekt des Containers die Portabilität des Steuerelements in andere beliebige Container beschränkt.

### <a name="remarks"></a>Hinweise

Die Funktion, die diese Funktion ruft ist verantwortlich für die Freigabe des Zeigers, wenn das Objekt abgeschlossen. Beachten Sie, dass der Container nicht erforderlich ist, um dieses Objekt zu unterstützen.

##  <a name="getfocus"></a>  COleControl::GetFocus

Bestimmt, ob die `COleControl` Objekt den Fokus besitzt.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Rückgabewert

Gibt zurück, wenn das Steuerelement aktiviert und eine fensterlose, **dies** , wenn das Steuerelement verfügt derzeit über die Tastatur zu konzentrieren (wie durch den Container des Steuerelements festgelegt) oder NULL, wenn sie nicht den Fokus verfügt.

Andernfalls die `CWnd` -Objekt, das den Fokus hat (identisch mit `CWnd::GetFocus`).

### <a name="remarks"></a>Hinweise

Ein aktiviertes fensterloses Steuerelement den Fokus erhält, wenn [SetFocus](#setfocus) aufgerufen wird.

##  <a name="getfont"></a>  COleControl::GetFont

Implementiert die Get-Funktion, der die vordefinierte Schriftarteigenschaft an.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf die Dispatchschnittstelle der Schriftart des Steuerelements vordefinierter Font-Eigenschaft.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass das Objekt nach Abschluss der Aufrufer freigegeben werden muss. Verwenden Sie in der Implementierung des Steuerelements, `InternalGetFont` des Steuerelements stock Font-Objekt auf. Weitere Informationen zur Verwendung von Schriftarten steuern, finden Sie im Artikel [ActiveX-Steuerelemente: Verwenden von Schriftarten in einem ActiveX-Steuerelement](../../mfc/mfc-activex-controls-using-fonts.md).

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

Misst die Text-Metriken für jeden `CFontHolder` Objekt, dessen Besitzer des Steuerelements.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parameter

*lptm*<br/>
Zeiger auf eine [TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica) Struktur.

*fontHolder*<br/>
Ein Verweis auf eine [CFontHolder](../../mfc/reference/cfontholder-class.md) Objekt.

### <a name="remarks"></a>Hinweise

Eine solche Schriftart ausgewählt werden kann, mit der [COleControl::SelectFontObject](#selectfontobject) Funktion. `GetFontTextMetrics` Initialisiert die `TEXTMETRIC` Struktur verweist *Lptm* mit gültigen metrikinformationen `fontHolder`Schriftart bei erfolgreicher Ausführung des oder die Struktur mit Nullen gefüllt wird, wenn nicht erfolgreich. Verwenden Sie diese Funktion statt des [GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics) beim Zeichnen des Steuerelements aus, da Steuerelemente, wie Sie eingebettete OLE-Objekt möglicherweise erforderlich sind selbst in einer Metadatei zu rendern.

Die `TEXTMETRIC` -Struktur für die Standardschriftart ist aktualisiert, wenn die [SelectFontObject](#selectfontobject) -Funktion aufgerufen wird. Rufen Sie `GetFontTextMetrics` nur nach der Auswahl der vordefinierten Schriftarteigenschaft, um die Informationen zu gewährleisten, es bietet, gültig ist.

##  <a name="getforecolor"></a>  COleControl::GetForeColor

Implementiert die Get-Funktion der vordefinierten ForeColor-Eigenschaft.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Rückgabewert

Der Rückgabewert gibt die aktuelle Vordergrundfarbe als OLE_COLOR-Wert an, ob erfolgreich. Dieser Wert übersetzt werden kann, um eine [COLORREF](/windows/desktop/gdi/colorref) Wert durch einen Aufruf von `TranslateColor`.

##  <a name="gethwnd"></a>  COleControl::GetHwnd

Implementiert die Get-Funktion der vordefinierten hWnd-Eigenschaft.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Rückgabewert

Die OLE Fensterhandle des Steuerelements, sofern vorhanden; andernfalls NULL.

##  <a name="getmessagestring"></a>  COleControl::GetMessageString

Aufgerufen, um eine kurze Zeichenfolge abzurufen, die den Zweck des Menüelements identifizierte beschreibt *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parameter

*nID*<br/>
Ein Menü-Element-ID.

*rMessage*<br/>
Ein Verweis auf eine [CString](../../atl-mfc-shared/reference/cstringt-class.md) -Objekt über die eine Zeichenfolge zurückgegeben wird.

### <a name="remarks"></a>Hinweise

Dies kann verwendet werden, um eine Nachricht für die Anzeige in einer Statusleiste zu erhalten, während das Menüelement hervorgehoben ist. Die Standardimplementierung lädt eine Zeichenfolgenressource identifizierte *nID*.

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

Verhindert den Zugriff auf den Wert eines Steuerelements Eigenschaft durch den Benutzer.

```
void GetNotSupported();
```

### <a name="remarks"></a>Hinweise

Mit dieser Funktion werden anstelle der Get-Funktion, einer beliebigen Eigenschaft, in dem Abrufen der Eigenschaft durch Benutzer des Steuerelements wird nicht unterstützt wird. Ein Beispiel wäre eine Eigenschaft, die Zugriffsart Nur Schreiben gilt.

##  <a name="getreadystate"></a>  COleControl::GetReadyState

Gibt den Bereitschaftsstatus des Steuerelements zurück.

```
long GetReadyState();
```

### <a name="return-value"></a>Rückgabewert

Der Bereitschaftsstatus des Steuerelements, einer der folgenden Werte:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Standard-Initialisierungszustand|
|READYSTATE_LOADING|Steuerelement lädt seine Eigenschaften derzeit|
|READYSTATE_LOADED|Steuerelement wurde initialisiert.|
|READYSTATE_INTERACTIVE|Das Steuerelement genügend Daten für die interaktive werden jedoch nicht alle asynchrone Daten werden noch geladen.|
|READYSTATE_COMPLETE|Steuerelement verfügt über alle darin enthaltenen Daten|

### <a name="remarks"></a>Hinweise

Die meisten einfache Steuerelemente müssen nie LOADED- und interaktiv unterscheiden. Allerdings Steuerelemente, die Daten Pfadeigenschaften unterstützen möglicherweise nicht zur interaktiven gestellt werden, bis mindestens einige Daten asynchron empfangen werden. Ein Steuerelement sollten versuchen, interaktive so bald wie möglich sind.

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

Ruft die Koordinaten der das Rechteck des Steuerelements relativ zu dem Container, ausgedrückt in Geräteeinheiten ab.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parameter

*lpRect*<br/>
Ein Zeiger auf das Rectangle-Struktur, die in die Koordinaten des Steuerelements kopiert werden.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL ist, wenn das Steuerelement direkt aktiv ist; andernfalls 0.

### <a name="remarks"></a>Hinweise

Das Rechteck ist nur gültig, wenn das Steuerelement direkt aktiv ist.

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

Misst die Text-Metriken für des Steuerelements stock Font-Eigenschaft, die mit ausgewählt werden können die [SelectStockFont](#selectstockfont) Funktion.

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parameter

*lptm*<br/>
Ein Zeiger auf eine [TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica) Struktur.

### <a name="remarks"></a>Hinweise

Die `GetStockTextMetrics` Funktion initialisiert den `TEXTMETRIC` Struktur verweist *Lptm* mit gültigen metrikinformationen im Erfolgsfall oder füllen Sie die Struktur mit Nullen aufgefüllt, wenn nicht erfolgreich. Verwenden Sie diese Funktion anstelle von [GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics) beim Zeichnen des Steuerelements aus, da Steuerelemente, wie Sie eingebettete OLE-Objekt möglicherweise erforderlich sind selbst in einer Metadatei zu rendern.

Die `TEXTMETRIC` -Struktur für die Standardschriftart ist aktualisiert, wenn die `SelectStockFont` -Funktion aufgerufen wird. Sie sollten diese Funktion aufrufen, nur nach dem Auswählen der vordefinierten Schriftart aus, um die Informationen zu gewährleisten, bereitgestellte gültig ist.

##  <a name="gettext"></a>  COleControl::GetText

Implementiert die Get-Funktion, der die vordefinierte Text- oder Caption-Eigenschaft.

```
BSTR GetText();
```

### <a name="return-value"></a>Rückgabewert

Der aktuelle Wert, der die Text-Zeichenfolge oder eine Zeichenfolge der Länge 0 (null), wenn keine Zeichenfolge vorhanden ist.

> [!NOTE]
>  Weitere Informationen zu den BSTR-Datentyp, finden Sie unter [Datentypen](../../mfc/reference/data-types-mfc.md) im Abschnitt Makros und Globals.

### <a name="remarks"></a>Hinweise

Beachten Sie, die der Aufrufer dieser Funktion aufrufen muss `SysFreeString` in der Zeichenfolge zurückgegeben, um kostenlos die Ressource. Verwenden Sie in der Implementierung des Steuerelements, `InternalGetText` Zugriff auf vordefinierte Text- oder Caption-Eigenschaft des Steuerelements.

##  <a name="getwindowlessdroptarget"></a>  COleControl:: GetWindowlessDropTarget

Außer Kraft setzen `GetWindowlessDropTarget` soll ein fensterloses Steuerelement, das Ziel ein OLE Drag & drop-Vorgangs.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Rückgabewert

Zeiger auf das Objekt des `IDropTarget` Schnittstelle. Fensterloses Objekt kann nicht registriert werden, da sie nicht über ein Fenster verfügt, ein `IDropTarget` Schnittstelle. Allerdings zur Teilnahme an Drag & Drop fensterloses Objekt immer noch die Schnittstelle implementieren und zurückgeben kann in `GetWindowlessDropTarget`.

### <a name="remarks"></a>Hinweise

Normalerweise erfordert dies, dass das Fenster des Steuerelements als Dropziel registriert werden. Aber da es sich bei dem Steuerelement kein eigenes Fenster ist, verwendet der Container ein eigenen Fenster als Drop-Ziel. Das Steuerelement muss lediglich eine Implementierung bereitstellen der `IDropTarget` Schnittstelle, zu denen der Container Aufrufe zum richtigen Zeitpunkt delegieren kann. Zum Beispiel:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>  COleControl::InitializeIIDs

Informiert die Basisklasse von die IIDs, die das Steuerelement verwendet.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parameter

*piidPrimary*<br/>
Zeiger auf die Schnittstellen-ID der primäre Dispatchschnittstelle des Steuerelements.

*piidEvents*<br/>
Zeiger auf die Schnittstellen-ID des Steuerelements Senkenereignis-Schnittstelle.

### <a name="remarks"></a>Hinweise

Rufen Sie diese Funktion im Konstruktor des Steuerelements, um die Basisklasse die Schnittstellen-IDs zu informieren, die das Steuerelement verwendet wird.

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

Greift auf die vordefinierte Schriftarteigenschaft des Steuerelements

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Rückgabewert

Ein Verweis auf eine [CFontHolder](../../mfc/reference/cfontholder-class.md) -Objekt, das stock Font-Objekt enthält.

##  <a name="internalgettext"></a>  COleControl::InternalGetText

Greift auf die vordefinierte Text- oder Caption-Eigenschaft des Steuerelements.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Rückgabewert

Ein Verweis auf die Text-Zeichenfolge.

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

Legt den Bereitschaftsstatus des Steuerelements fest.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parameter

*lNewReadyState*<br/>
Dem Bereitschaftsstatus für das Steuerelement, einer der folgenden Werte festgelegt:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Standard-Initialisierungszustand|
|READYSTATE_LOADING|Steuerelement lädt seine Eigenschaften derzeit|
|READYSTATE_LOADED|Steuerelement wurde initialisiert.|
|READYSTATE_INTERACTIVE|Das Steuerelement genügend Daten für die interaktive werden jedoch nicht alle asynchrone Daten werden noch geladen.|
|READYSTATE_COMPLETE|Steuerelement verfügt über alle darin enthaltenen Daten|

### <a name="remarks"></a>Hinweise

Die meisten einfache Steuerelemente müssen nie LOADED- und interaktiv unterscheiden. Allerdings Steuerelemente, die Daten Pfadeigenschaften unterstützen möglicherweise nicht zur interaktiven gestellt werden, bis mindestens einige Daten asynchron empfangen werden. Ein Steuerelement sollten versuchen, interaktive so bald wie möglich sind.

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

Erzwingt, dass das Steuerelement selbst neu zeichnet.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parameter

*lpRect*<br/>
Ein Zeiger auf den Bereich des Steuerelements für ungültig erklärt werden.

*bErase*<br/>
Gibt an, ob der Hintergrund im Aktualisierungsbereich gelöscht werden soll, wenn dem Aktualisierungsbereich verarbeitet wird.

### <a name="remarks"></a>Hinweise

Wenn *LpRect* verfügt über einen Nullwert, wird das gesamte Steuerelement neu gezeichnet werden. Wenn *LpRect* ist nicht NULL ist, dies weist darauf hin, der Teil für das Rechteck des Steuerelements, die für ungültig erklärt werden. In Fällen, in dem das Steuerelement verfügt über kein Fenster oder ist nicht aktiviert, das Rechteck wird ignoriert, und ein Aufruf erfolgt, an des Client-Standorts [IAdviseSink::OnViewChange](/windows/desktop/api/objidl/nf-objidl-iadvisesink-onviewchange) Member-Funktion. Verwenden Sie diese Funktion anstelle von `CWnd::InvalidateRect` oder `InvalidateRect`.

##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn

Macht Sie in der Clientbereich des Fensters der Container in der angegebenen Region ungültig.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parameter

*PRNG*<br/>
Ein Zeiger auf eine [CRgn](../../mfc/reference/crgn-class.md) Objekt, das den Anzeigebereich des OLE-Objekts, in Clientkoordinaten des übergeordneten Fensters ungültig gemacht werden, identifiziert. Wenn dieser Parameter NULL ist, wird das Ausmaß des gesamten Objekts.

*bErase*<br/>
Gibt an, ob der Hintergrund des innerhalb der Region ungültig ist, gelöscht werden sollen. Wenn TRUE, wird der Hintergrund gelöscht. False gibt an, bleibt der Hintergrund unverändert.

### <a name="remarks"></a>Hinweise

Dies kann zum Neuzeichnen Fensterlose Steuerelemente innerhalb des Containers verwendet werden. Die für ungültig erklärt Region, zusammen mit allen anderen Bereichen in den Aktualisierungsbereich wird gekennzeichnet, für das Zeichen, wenn die nächste [WM_PAINT](/windows/desktop/gdi/wm-paint) Nachricht gesendet wird.

Wenn *bErase* ist "true", für einen beliebigen Teil der Aktualisierungsbereich Hintergrund in der gesamten Region nicht nur im angegebenen Teil gelöscht wird.

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

Ermöglicht spezielle Laden eines OLE-Steuerelements.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn das Steuerelement konvertiert wird; andernfalls 0.

### <a name="remarks"></a>Hinweise

Beim Konvertieren eines Formulars, das verwendet der VBX, einer, die OLE-Steuerelemente verwendet Steuerelemente, kann der spezielle Laden von Code für die OLE-Steuerelemente erforderlich sein. Z. B. Wenn Sie eine Instanz des Steuerelements OLE laden, müssen Sie möglicherweise einen Aufruf von [PX_Font](persistence-of-ole-controls.md#px_font) in Ihre `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Allerdings VBX-Steuerelementen ein Schriftartobjekt keine; Jede Schriftarteigenschaft wurde einzeln gespeichert. In diesem Fall würden Sie verwenden `IsConvertingVBX` zur Unterscheidung zwischen diesen beiden Fällen:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Ein weiterer Fall wäre, wenn das VBX-Steuerelement proprietäre binäre Daten (in seinem VBM_SAVEPROPERTY-Meldungshandler gespeichert) und das OLE-Steuerelement die Binärdaten in einem anderen Format speichert. Wenn Sie Ihre OLE-Steuerelements sein soll abwärtskompatibel mit dem VBX-Steuerelement, Sie können sowohl die alten und neuen Formate Lesen der `IsConvertingVBX` Funktion unterscheiden, ob das Laden der VBX-Steuerelement oder das OLE-Steuerelement.

Des Steuerelements `DoPropExchange` -Funktion, Sie können diese Bedingung überprüft und bei "true", führen Sie die Load-Code, die speziell für diese Konvertierung (z. B. den vorherigen Beispielen). Wenn das Steuerelement nicht konvertiert wird, können Sie normaler Last Code ausführen. Diese Funktion gilt nur für Steuerelemente, die von der VBX-Entsprechungen konvertiert wird.

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

Ermöglicht die Automatisierung-Methodenaufruf.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn das Steuerelement initialisiert wurde; andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Framework Implementierung von `IDispatch::Invoke` Aufrufe `IsInvokeAllowed` bestimmen, ob eine bestimmte Funktion (identifizierte `dispid`) aufgerufen werden kann. Das Standardverhalten für OLE-Steuerelements ist zum Zulassen von Automatisierungsmethoden, die aufgerufen werden, nur dann, wenn das Steuerelement initialisiert wurde. allerdings `IsInvokeAllowed` ist eine virtuelle Funktion, und kann überschrieben werden, bei Bedarf (z. B., wenn das Steuerelement als Automatisierungsserver verwendet wird).

##  <a name="ismodified"></a>  COleControl::IsModified

Bestimmt, ob der Zustand des Steuerelements geändert wurde.

```
BOOL IsModified();
```

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn der Zustand des Steuerelements geändert wurde, seit es zuletzt gespeichert wurde; andernfalls 0.

### <a name="remarks"></a>Hinweise

Der Zustand eines Steuerelements wird geändert, wenn eine Eigenschaft ändert.

##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw

Bestimmt, ob der Container optimiertes Zeichnen für den aktuellen Zeichenvorgang unterstützt.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Rückgabewert

True, wenn der Container optimiertes Zeichnen für den aktuellen Zeichenvorgang unterstützt. andernfalls "false".

### <a name="remarks"></a>Hinweise

Wenn optimiertes Zeichnen unterstützt wird, muss wählen Sie dann das Steuerelement nicht alte-Objekte (Stifte, Pinsel, Schriftarten, usw.) in den Gerätekontext Wenn Zeichnung abgeschlossen ist.

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

Wird aufgerufen, durch das Framework, um festzustellen, ob die steuern, die Unterklassen der Steuerelemente einen Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn das Steuerelement als Unterklasse definiert ist; andernfalls 0.

### <a name="remarks"></a>Hinweise

Sie überschreiben Sie diese Funktion und "true" zurück, wenn es sich bei Ihrem OLE Unterklassen ein Windows-Steuerelements steuern.

##  <a name="load"></a>  COleControl::Load

Setzt alle vorherigen Daten asynchron geladen und initialisiert eine neue Laden des asynchrone Eigenschaft des Steuerelements.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parameter

*strNewPath*<br/>
Ein Zeiger auf eine Zeichenfolge, die mit dem Pfad, der die absolute Position der Steuerelementeigenschaft, asynchrone verweist.

*Prop*<br/>
Ein [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) Objekt implementiert eine asynchrone Steuerelementeigenschaft.

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

Verhindert, dass den Container das Steuerelement deaktiviert.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parameter

*bLock*<br/>
True, wenn der direkten aktiven Status des Steuerelements gesperrt werden soll. "False", wenn es entsperrt werden soll.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn die Sperre erfolgreich war; andernfalls 0.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass alle Sperren des Steuerelements muss ein Entsperren des Steuerelements zugeordnet werden nach. Sie sollten das Steuerelement nur für einen kurzen Zeitraum, wie z. B. sperren, beim Auslösen eines Ereignisses.

##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange

Vom Framework aufgerufen, wenn eine Ambiente-Eigenschaft des Containers Wert geändert wurde.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parameter

*dispID*<br/>
Die Dispatch-ID der ambient-Eigenschaft, die geändert oder DISPID_UNKNOWN, wenn mehrere Eigenschaften geändert haben.

##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged

Vom Framework aufgerufen, wenn die vordefinierte Appearance-Eigenschaftswert geändert wurde.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn die Benachrichtigung nach der Änderung dieser Eigenschaft werden soll. Die Standardimplementierung ruft `InvalidateControl`.

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

Vom Framework aufgerufen, wenn die vordefinierte BackColor-Eigenschaftswert geändert wurde.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn die Benachrichtigung nach der Änderung dieser Eigenschaft werden soll. Die Standardimplementierung ruft `InvalidateControl`.

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

Vom Framework aufgerufen, wenn die vordefinierte BorderStyle-Eigenschaftswert geändert wurde.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Hinweise

Die Standardimplementierung ruft `InvalidateControl`.

Überschreiben Sie diese Funktion, wenn die Benachrichtigung nach der Änderung dieser Eigenschaft werden soll.

##  <a name="onclick"></a>  COleControl::OnClick

Vom Framework aufgerufen, wenn eine Maustaste geklickt oder die vordefinierte DoClick-Methode wurde aufgerufen.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parameter

*iButton*<br/>
Der Index der zweite Mausklick. Dabei kann es sich um einen der folgenden Werte aufweisen:

- LEFT_BUTTON der linken Maustaste geklickt wurde.

- MIDDLE_BUTTON der mittleren Maustaste geklickt wurde.

- RIGHT_BUTTON der rechten Maustaste geklickt wurde.

### <a name="remarks"></a>Hinweise

Die Standardimplementierung ruft `COleControl::FireClick`.

Überschreiben Sie diese Memberfunktion zum Ändern oder erweitern die Standardbehandlung verwendet.

##  <a name="onclose"></a>  COleControl::OnClose

Vom Framework aufgerufen, wenn der Container des Steuerelements aufgerufen hat `IOleControl::Close` Funktion.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parameter

*dwSaveOption*<br/>
Flag, die angibt, ob das Objekt vor dem Laden gespeichert werden soll. Gültige Werte sind:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Hinweise

In der Standardeinstellung `OnClose` speichert das Steuerelementobjekt, wenn es geändert wurde und *DwSaveOption* ist OLECLOSE_SAVEIFDIRTY oder OLECLOSE_PROMPTSAVE.

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

Vom Framework aufgerufen, wenn der Container Ruft die `IOleObject::DoVerb` Member-Funktion.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parameter

*iVerb*<br/>
Der Index des dem kontrollverb aufgerufen werden.

*lpMsg*<br/>
Ein Zeiger auf die Windows-Meldung, die das Verb aufgerufen werden verursacht hat.

*hWndParent*<br/>
Das Handle für das übergeordnete Fenster des Steuerelements. Wenn die Ausführung des Verbs ein Fenster (oder Windows), erstellt *hWndParent* als das übergeordnete Element verwendet werden soll.

*lpRect*<br/>
Ein Zeiger auf eine RECT-Struktur, die in die die Koordinaten des Steuerelements relativ zu dem Container, kopiert werden.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL ist, wenn der Aufruf erfolgreich war; andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Standardimplementierung verwendet die Meldungszuordnungseinträge ON_OLEVERB und ON_STDOLEVERB, um die ordnungsgemäße Funktion zu bestimmen.

Überschreiben Sie diese Funktion, um die Standardbehandlung des Verbs zu ändern.

##  <a name="ondraw"></a>  COleControl:: OnDraw aufgerufen

Wird aufgerufen, durch das Framework die OLE-Steuerelements im angegebenen umschließenden Rechteck mit den angegebenen Gerätekontext gezeichnet werden soll.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Der Gerätekontext, in dem das Zeichnen auftritt.

*rcBounds*<br/>
Der rechteckige Bereich des Steuerelements, einschließlich des Rahmens.

*rcInvalid*<br/>
Der rechteckige Bereich des Steuerelements, das ungültig ist.

### <a name="remarks"></a>Hinweise

`OnDraw` wird in der Regel aufgerufen werden, für die Bildschirmanzeige, übergeben einen Bildschirm Gerätekontext als *pDC*. Die *RcBounds* Parameter identifiziert das Rechteck in die Ziel-Gerätekontext (in Bezug auf die aktuelle Zuordnungsmodus). Die *RcInvalid* Parameter ist das tatsächliche Rechteck, das ungültig ist. In einigen Fällen wird dies sein, einen kleineren Bereich als *RcBounds*.

##  <a name="ondrawmetafile"></a>  OnDrawMetafile

Wird aufgerufen, durch das Framework das OLE-Steuerelement im angegebenen umschließenden Rechteck mit der angegebenen Metadatei-Gerätekontexts gezeichnet.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Der Gerätekontext, in dem das Zeichnen auftritt.

*rcBounds*<br/>
Der rechteckige Bereich des Steuerelements, einschließlich des Rahmens.

### <a name="remarks"></a>Hinweise

Die Standardimplementierung Ruft die [OnDraw](#ondraw) Funktion.

##  <a name="onedit"></a>  COleControl::OnEdit

Bewirkt, dass das Steuerelement, das die UI aktiviert werden.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parameter

*lpMsg*<br/>
Ein Zeiger auf die Windows-Meldung, die das Verb aufgerufen hat.

*hWndParent*<br/>
Ein Handle für das übergeordnete Fenster des Steuerelements.

*lpRect*<br/>
Ein Zeiger auf das Rechteck, das vom Steuerelement im Container verwendet werden soll.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn der Aufruf erfolgreich ist; andernfalls 0.

### <a name="remarks"></a>Hinweise

Dies hat dieselbe Wirkung wie das Aufrufen des Steuerelements OLEIVERB_UIACTIVATE Verb.

Diese Funktion wird in der Regel als die Handlerfunktion für einen Eintrag für die Zuordnung von Nachrichten in ON_OLEVERB verwendet. Dies stellt ein Verb "Bearbeiten" auf das Menü des Steuerelements "Object" zur Verfügung. Zum Beispiel:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged

Vom Framework aufgerufen, wenn die Aktie Enabled-Eigenschaftswert geändert wurde.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn die Benachrichtigung nach der Änderung dieser Eigenschaft werden soll. Die Standardimplementierung ruft [InvalidateControl](#invalidatecontrol).

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

Vom Framework aufgerufen, wenn der Container Ruft die `IOleObject::EnumVerbs` Member-Funktion.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parameter

*ppenumOleVerb*<br/>
Ein Zeiger auf die `IEnumOLEVERB` -Objekt, das Listet die Verben des Steuerelements.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL ist, wenn die Verben verfügbar sind; andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Standardimplementierung Listet die ON_OLEVERB-Einträge in der meldungszuordnung.

Überschreiben Sie diese Funktion zum Ändern der standardmäßigen Aufzählen von Verben.

##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise

Vom Framework aufgerufen, wenn ein Ereignishandler verbunden oder von einem OLE-Steuerelement getrennt ist.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parameter

*bAdvise*<br/>
TRUE gibt an, dass ein Ereignishandler für das Steuerelement verbunden wurde. FALSE gibt an, dass das Steuerelement ein Ereignishandler getrennt wurde.

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

Vom Framework aufgerufen, wenn der stock Font-Eigenschaftswert geändert wurde.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Hinweise

Die Standardimplementierung ruft `COleControl::InvalidateControl`. Wenn das Steuerelement ein Windows-Steuerelement Unterklassen ist, sendet die standardmäßige Implementierung auch eine WM_SETFONT-Nachricht an das Fenster des Steuerelements ein.

Überschreiben Sie diese Funktion, wenn die Benachrichtigung nach der Änderung dieser Eigenschaft werden soll.

### <a name="example"></a>Beispiel

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

Vom Framework aufgerufen, wenn die vordefinierte ForeColor-Eigenschaftswert geändert wurde.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Hinweise

Die Standardimplementierung ruft `InvalidateControl`.

Überschreiben Sie diese Funktion, wenn die Benachrichtigung nach der Änderung dieser Eigenschaft werden soll.

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

Vom Framework aufgerufen, nachdem der Container ruft `IOleControl::FreezeEvents`.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parameter

*bFreeze*<br/>
TRUE, wenn des Steuerelements für die Behandlung von Ereignissen ist fixiert. andernfalls "false".

### <a name="remarks"></a>Hinweise

Bei der Standardimplementierung wird keine Aktion ausgeführt.

Überschreiben Sie diese Funktion, wenn bei der Behandlung von Ereignissen nicht fixiert ist oder fixiert ist zusätzliches Verhalten soll.

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

Vom Framework aufgerufen, wenn der Container Ruft die `IViewObject::GetColorSet` Member-Funktion.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parameter

*ptd*<br/>
Verweist auf das Zielgerät für das das Bild gerendert werden soll. Wenn dieser Wert NULL ist, sollte das Bild für ein Standard-Zielgerät, in der Regel ein Anzeigegerät gerendert werden.

*hicTargetDev*<br/>
Gibt die Informationen über den Kontext an, auf dem Zielgerät erkennbar *Ptd*. Dieser Parameter kann einen Gerätekontext, jedoch ist keiner unbedingt. Wenn *Ptd* NULL ist, *HicTargetDev* sollte auch NULL sein.

*ppColorSet*<br/>
Ein Zeiger auf den Speicherort in dem der Satz von Farben, die verwendet werden kopiert werden soll. Wenn die Funktion nicht die Farbpalette zurückgibt, wird NULL zurückgegeben.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn eine gültige Farbe zurückgegeben wird; andernfalls 0.

### <a name="remarks"></a>Hinweise

Der Container ruft diese Funktion, um die Farben, die zum Zeichnen des OLE-Steuerelements zu erhalten. Container können die Farbe Sätze in Verbindung mit den Farben, die Sie die allgemeine Farben-Palette festgelegt muss. Die Standardimplementierung gibt "false" zurück.

Überschreiben Sie diese Funktion dazu spezielle Verarbeitung dieser Anforderung.

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

Vom Framework aufgerufen, wenn der Container des Steuerelements Informationen über das Steuerelement angefordert hat.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parameter

*pControlInfo*<br/>
Zeiger auf eine [CONTROLINFO](/windows/desktop/api/ocidl/ns-ocidl-tagcontrolinfo) Struktur gefüllt werden soll.

### <a name="remarks"></a>Hinweise

Diese Informationen wird in erster Linie eine Beschreibung des Steuerelements mnemonischen Tasten bestehen. Die standardmäßige Implementierung füllt *pControlInfo* mit Standardinformationen.

Überschreiben Sie diese Funktion, wenn das Steuerelement mnemonische Tasten muss.

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

Aufgerufen, um eine Zeichenfolge abzurufen, die den aktuellen Wert der Eigenschaft identifizierte darstellt *Dispid*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parameter

*DISPID*<br/>
Die Verteiler-ID einer Eigenschaft des Steuerelements.

*strValue gespeichert*<br/>
Ein Verweis auf eine [CString](../../atl-mfc-shared/reference/cstringt-class.md) -Objekt über die eine Zeichenfolge zurückgegeben wird.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn eine Zeichenfolge, im zurückgegeben wurde *strValue gespeichert;* andernfalls 0.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn das Steuerelement verfügt über eine Eigenschaft, deren Wert direkt in eine Zeichenfolge konvertiert werden kann, und den Wert der Eigenschaft, die in einem Container bereitgestellten Eigenschaftenbrowser angezeigt werden soll.

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

Vom Framework aufgerufen, wenn das Steuerelement Benutzeroberfläche aktiviert, damit erhalten Sie im Menü des Containers vorhandenen Menü zusammengeführt werden sollen.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Rückgabewert

Das Handle des Steuerelements im Menü oder NULL, wenn das Steuerelement keine verfügt. Die Standardimplementierung gibt NULL zurück.

### <a name="remarks"></a>Hinweise

Weitere Informationen für das Zusammenführen von OLE-Ressourcen finden Sie im Artikel [Menüs und Ressourcen (OLE)](../../mfc/menus-and-resources-ole.md).

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

Wird aufgerufen, durch das Framework als Reaktion auf eines Containers des `IViewObjectEx::GetNaturalExtent` Anforderung.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parameter

*dwAspect*<br/>
Gibt an, wie das Objekt dargestellt werden soll. Darstellungen enthalten Inhalt, ein Symbol, eine Miniaturansicht oder einem gedruckten Dokument. Gültige Werte stammen aus der Enumeration [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) oder DVASPECT2.

*lindex*<br/>
Der Teil des Objekts, das von Interesse ist. Derzeit wird nur-1 ist gültig.

*ptd*<br/>
Verweist auf die [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) Struktur definiert, das Zielgerät für die die Größe des Objekts zurückgegeben werden sollen.

*hicTargetDev*<br/>
Gibt an, die Informationen über den Kontext für das Zielgerät, angegeben durch die *Ptd* Parameter aus dem das Objekt Gerätemetrik abrufen und Funktionen des Geräts prüfen kann. Wenn *Ptd* NULL ist, das Objekt den Wert in ignorieren soll die *HicTargetDev* Parameter.

*pExtentInfo*<br/>
Verweist auf die `DVEXTENTINFO` Struktur, die Größenänderung von Daten angibt. Die `DVEXTENTINFO` Struktur ist:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Der Strukturmember `dwExtentMode` kann einen von zwei Werten annehmen:

- DVEXTENT_CONTENT "Inquire", wie groß das Steuerelement sein sollte, um genau Inhalt (Snap-in-Größe)

- DVEXTENT_INTEGRAL beim Ändern der Größe, übergeben Sie die vorgeschlagene Größe an Steuerelement

*psizel*<br/>
Verweist auf die Größe der Daten, die vom Steuerelement zurückgegeben. Die der zurückgegebenen Größenänderungsdaten werden auf-1 für eine bestimmte Dimension festgelegt, die nicht angepasst wurde.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL ist, wenn er erfolgreich zurückgegeben oder die Größe passt; andernfalls 0.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, um die Größe des Objekts anzeigen, die die vorgeschlagene Größe und Umfang-Modus in am nächsten zurückzugeben, die `DVEXTENTINFO` Struktur. Die Standardimplementierung gibt FALSE zurück und macht keine Anpassungen vor, um die Größe.

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

Vom Framework aufgerufen wird, erhalten eine Reihe von vordefinierten Zeichenfolgen, die die möglichen Werte für eine Eigenschaft darstellt.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parameter

*DISPID*<br/>
Die Verteiler-ID einer Eigenschaft des Steuerelements.

*pStringArray*<br/>
Ein Zeichenfolgenarray mit gefüllt werden soll, geben Werte zurück.

*pCookieArray*<br/>
Ein DWORD-Array mit gefüllt werden soll, geben Werte zurück.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn Elemente hinzugefügt wurden *pStringArray* und *pCookieArray*.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn das Steuerelement eine Eigenschaft mit einem Satz möglicher Werte verfügt, die durch Zeichenfolgen dargestellt werden können. Für jedes hinzugefügte Element *pStringArray*, sollten Sie ein entsprechendes "Cookie"-Element, um hinzufügen *pCookieArray.* Diese "Cookie"-Werte können später übergeben werden, indem das Framework die `COleControl::OnGetPredefinedValue` Funktion.

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

Wird aufgerufen, durch das Framework zum Abrufen des Werts für eine der vordefinierten Zeichenfolgen durch eine Überschreibung der zuvor zurückgegeben `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parameter

*DISPID*<br/>
Die Verteiler-ID einer Eigenschaft des Steuerelements.

*dwCookie*<br/>
Ein zuvor durch eine Überschreibung der zurückgegebene Cookiewert `COleControl::OnGetPredefinedStrings`.

*lpvarOut*<br/>
Zeiger auf eine `VARIANT` Struktur über die ein Eigenschaftswert zurückgegeben wird.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn ein Wert zurückgegeben wurden *LpvarOut*, andernfalls 0.

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

Wird aufgerufen, durch das Framework als Reaktion auf eines Containers des [IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) Anforderung.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parameter

*dwDrawAspect*<br/>
DWORD, welche Form oder einen Aspekt, der ein Objekt beschreibt, besteht darin, angezeigt werden soll. Gültige Werte stammen aus der Enumeration [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) oder DVASPECT2.

*lindex*<br/>
Der Teil des Objekts, das von Interesse ist. Derzeit wird nur-1 ist gültig.

*ptd*<br/>
Verweist auf die [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) Struktur definiert, das Zielgerät für die die Größe des Objekts zurückgegeben werden sollen.

*lpsizel*<br/>
Verweist auf den Speicherort, an die Größe des Objekts zurückgegeben wird.

### <a name="return-value"></a>Rückgabewert

Legen Sie ungleich NULL, wenn es sich bei Block erfolgreich zurückgegeben werden; andernfalls 0.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion aus, wenn das Steuerelement zwei Durchgängen Zeichnen verwendet, und weisen unterschiedliche Dimensionen auf die nicht transparenten und transparente Teile.

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

Wird aufgerufen, durch das Framework als Reaktion auf eines Containers des `IViewObjectEx::GetRect` Anforderung.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parameter

*dwAspect*<br/>
DWORD, welche Form oder einen Aspekt, der ein Objekt beschreibt, besteht darin, angezeigt werden soll. Gültige Werte stammen aus der Enumeration [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) oder DVASPECT2:

- DVASPECT_CONTENT umschließende Rechteck für das gesamte Objekt. Oben links auf den Ursprung und den Umfang von zurückgegebene Größe des Objekts `GetViewExtent` *.*

- Dieses Rechteck zurück DVASPECT_OPAQUE Objekte mit einem rechteckigen nicht transparenten Bereich Andere Benutzer ein Fehler auf.

- Für alle Teile von transparenten oder unregelmäßige DVASPECT_TRANSPARENT-Rechteck.

*pRect*<br/>
Verweist auf die [RECTL](https://msdn.microsoft.com/library/windows/desktop/dd162907) -Struktur gibt das Rechteck, in dem das Objekt gezeichnet werden soll. Dieser Parameter steuert die Positionierung und Strecken des Objekts.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn das Rechteck, das angepasst wird, auf das Objekt erfolgreich zurückgegeben wird; andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Größe des Objekts wird konvertiert, indem `OnGetViewRect` in ein Rechteck ab, die an einer bestimmten Position (der Standardwert ist der oberen linken Ecke der Anzeige). Überschreiben Sie diese Funktion aus, wenn das Steuerelement zwei Durchgängen Zeichnen verwendet, und weisen unterschiedliche Dimensionen auf die nicht transparenten und transparente Teile.

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

Wird aufgerufen, durch das Framework als Reaktion auf eines Containers des `IViewObjectEx::GetViewStatus` Anforderung.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Rückgabewert

Einer der Werte der Enumeration VIEWSTATUS bei erfolgreicher Ausführung; andernfalls 0. Mögliche Werte sind eine beliebige Kombination der folgenden:

|||
|-|-|
|VIEWSTATUS_OPAQUE|Objekt ist nicht vollständig transparent. Wenn dieses Bit nicht festgelegt ist, enthält das Objekt die transparenten Teile. Dieses Bit gilt nur für den Content-bezogenen Aspekte und nicht für DVASPECT_ICON oder DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Objekt verfügt über eine Volltonfarbe für den Hintergrund (mit in einer Volltonfarbe, nicht in einem Pinselmuster). Dieses Bit ist sinnvoll, nur, wenn VIEWSTATUS_OPAQUE festgelegt und nur für den Content-bezogenen Aspekte und nicht auf DVASPECT_ICON oder DVASPECT_DOCPRINT gilt.|
|VIEWSTATUS_DVASPECTOPAQUE|Objekt unterstützt DVASPECT_OPAQUE. Alle IViewObjectEx-Methoden, die eine Zeichenaspekt akzeptieren, wie ein Parameter mit diesem Aspekt aufgerufen werden kann.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Objekt unterstützt DVASPECT_TRANSPARENT. Alle `IViewObjectEx` Methoden, die eine Zeichenaspekt akzeptieren, wie ein Parameter mit diesem Aspekt aufgerufen werden kann.|

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn das Steuerelement Darstellung zwei Durchgängen verwendet. Die Standardimplementierung gibt VIEWSTATUS_OPAQUE zurück.

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

Wird vom Framework aufgerufen, wenn das Steuerelement der Benutzeroberfläche deaktiviert wird.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Hinweise

Die Implementierung sollten alle Symbolleisten angezeigt werden, indem ausblenden `OnShowToolbars`.

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

Wird aufgerufen, durch den Container für die inaktiven Objekt unter dem Mauszeiger auf den Empfang von eine WM_MOUSEMOVE-Meldung.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parameter

*lprcBounds*<br/>
Das Objekt, das umschließende Rechteck, in Clientkoordinaten des übergeordneten Fensters. Teilt dem Objekt die genaue Position und Größe auf dem Bildschirm, wenn die WM_MOUSEMOVE-Meldung empfangen wurde.

*w*<br/>
Die X-Koordinate der die Position des Mauszeigers in Clientkoordinaten des übergeordneten Fensters.

*y*<br/>
Die y-Koordinate der die Position des Mauszeigers in Clientkoordinaten des übergeordneten Fensters.

*dwKeyState*<br/>
Gibt den aktuellen Zustand der Tastatur Zusatztasten der Tastatur. Gültige Werte sind eine Kombination der Flags MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON und MK_RBUTTON möglich.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass Clients umgewandelt (in Pixel) verwendet werden, um die Position des Mauszeigers zu übergeben. Dies wird ermöglicht durch und übergibt das umschließende Rechteck des Objekts im gleichen-Koordinatensystem.

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

Wird aufgerufen, durch den Container für die inaktiven Objekt unter dem Mauszeiger auf den Empfang einer WM_SETCURSOR-Nachricht.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parameter

*lprcBounds*<br/>
Das Objekt, das umschließende Rechteck, in Clientkoordinaten des übergeordneten Fensters. Teilt dem Objekt die genaue Position und Größe auf dem Bildschirm, wenn die WM_SETCURSOR-Nachricht empfangen wurde.

*w*<br/>
Die X-Koordinate der die Position des Mauszeigers in Clientkoordinaten des übergeordneten Fensters.

*y*<br/>
Die y-Koordinate der die Position des Mauszeigers in Clientkoordinaten des übergeordneten Fensters.

*dwMouseMsg*<br/>
Der Bezeichner der Maus Nachricht für die einer WM_SETCURSOR aufgetreten ist.

*bSetAlways*<br/>
Gibt an, und zwar unabhängig davon, ob das Objekt des Cursors festgelegt werden muss. Wenn "true", muss das Objekt den Cursor festlegen. False gibt an, wird der Cursor ist nicht verpflichtet, die der Cursor festgelegt, und S_FALSE in diesem Fall sollte zurückgegeben werden.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Beachten Sie, dass Clients umgewandelt (in Pixel) verwendet werden, um die Position des Mauszeigers zu übergeben. Dies wird ermöglicht durch und übergibt das umschließende Rechteck des Objekts im gleichen-Koordinatensystem.

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

Vom Framework aufgerufen, nachdem ein vordefiniertes KeyDown-Ereignis verarbeitet wurde.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parameter

*NChar*<br/>
Der virtueller Tastencode-Wert, der die gedrückte Taste. Eine Liste der standardmäßige virtuelle Tastencodes finden Sie in der Winuser.h

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE gedrückt wurde während der Aktion gedrückt.

- Während der Aktion wurde die CTRL_MASK die STRG-Taste gedrückt.

- ALT_MASK die ALT-Taste wurde während der Aktion gedrückt.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion aus, wenn das Steuerelement benötigt Zugriff auf die Schlüsselinformationen aus, nachdem das Ereignis ausgelöst wurde.

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

Vom Framework aufgerufen, nachdem die Stock, die KeyPress-Ereignis ausgelöst wurde.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parameter

*NChar*<br/>
Enthält den Wert virtueller Tastencode der Taste gedrückt. Eine Liste der standardmäßige virtuelle Tastencodes finden Sie in der Winuser.h

### <a name="remarks"></a>Hinweise

Beachten Sie, dass die *nChar* Wert möglicherweise vom Container geändert wurde.

Überschreiben Sie diese Funktion, wenn Sie die Benachrichtigung möchten, nachdem dieses Ereignis tritt auf.

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

Vom Framework aufgerufen, nachdem ein vordefiniertes KeyDown-Ereignis verarbeitet wurde.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parameter

*NChar*<br/>
Der virtueller Tastencode-Wert, der die gedrückte Taste. Eine Liste der standardmäßige virtuelle Tastencodes finden Sie in der Winuser.h

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE gedrückt wurde während der Aktion gedrückt.

- Während der Aktion wurde die CTRL_MASK die STRG-Taste gedrückt.

- ALT_MASK die ALT-Taste wurde während der Aktion gedrückt.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion aus, wenn das Steuerelement benötigt Zugriff auf die Schlüsselinformationen aus, nachdem das Ereignis ausgelöst wurde.

##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage

Wird aufgerufen, durch das Framework, um die Klassen-ID einer Eigenschaftenseite zu erhalten, die implementiert, der angegebenen Eigenschaft bearbeiten.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parameter

*DISPID*<br/>
Die Verteiler-ID einer Eigenschaft des Steuerelements.

*lpclsid*<br/>
Zeiger auf eine `CLSID` Struktur über die eine Klassen-ID zurückgegeben wird.

*pbPageOptional*<br/>
Gibt einen Indikator dafür, ob für die Verwendung der angegebenen Seite optional ist.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn eine Klassen-ID zurückgegeben wurden *Lpclsid*, andernfalls 0.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, um eine Möglichkeit zum Aufrufen des Steuerelements Eigenschaftenseiten von Eigenschaftenbrowser des Containers bereitstellen.

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

Vom Framework aufgerufen, wenn der Container erkannt hat, dass eine mnemonische Taste des OLE-Steuerelements gedrückt wurde.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parameter

*pMsg*<br/>
Ein Zeiger auf die durch Drücken einer mnemonischen Taste generierte Windows-Meldung.

##  <a name="onproperties"></a>  COleControl::OnProperties

Wird vom Framework aufgerufen, wenn Sie Eigenschaftenverb des Steuerelements vom Container aufgerufen wurde.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parameter

*lpMsg*<br/>
Ein Zeiger auf die Windows-Meldung, die das Verb aufgerufen hat.

*hWndParent*<br/>
Ein Handle für das übergeordnete Fenster des Steuerelements.

*lpRect*<br/>
Ein Zeiger auf das Rechteck, das vom Steuerelement im Container verwendet werden soll.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn der Aufruf erfolgreich ist; andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Standardimplementierung zeigt ein modales Dialogfeld an.

Dieser Funktion können auch dazu führen, dass die Anzeige der Eigenschaftenseiten des Steuerelements. Rufen Sie die `OnProperties` Funktion auf und übergibt das Handle des Steuerelements übergeordnete Element in der *hWndParent* Parameter. In diesem Fall die Werte der *LpMsg* und *LpRect* Parameter werden ignoriert.

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

Wird aufgerufen, durch das Framework als Reaktion auf eines Containers des `IViewObjectEx::QueryHitPoint` Anforderung.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parameter

*dwAspect*<br/>
Gibt an, wie das Objekt dargestellt wird. Gültige Werte stammen aus der Enumeration [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) oder DVASPECT2.

*pRectBounds*<br/>
Zeiger auf eine `RECT` -Struktur, die das umschließende Rechteck des Clientbereichs OLE-Steuerelement angibt.

*ptlLoc*<br/>
Zeiger auf die `POINT` -Struktur gibt den Punkt an einem Treffer überprüft werden soll. Der Punkt wird im OLE-Bereich Clientkoordinaten angegeben.

*lCloseHint*<br/>
Der Abstand, der definiert, "Schließen" auf den Punkt auf einem Treffer überprüft.

*pHitResult*<br/>
Zeiger auf das Ergebnis der Abfrage klicken. Einer der folgenden Werte:

- HITRESULT_OUTSIDE *PtlLoc* ist außerhalb des OLE-Objekt, und schließen Sie nicht.

- HITRESULT_TRANSPARENT *PtlLoc* innerhalb der Grenzen des OLE-Objekts, aber nicht in der Nähe der Abbildung. Beispielsweise kann ein Punkt in der Mitte eines Kreises transparent HITRESULT_TRANSPARENT sein.

- HITRESULT_CLOSE *PtlLoc* ist innerhalb oder außerhalb der OLE-Objekt, aber schließen Sie genug, um das Objekt, das in berücksichtigt werden. Kleine, schlanke oder ausführliche Objekte können diesen Wert verwenden. Auch wenn ein Punkt, aus dem umgebenden ist Rechtecks eines Objekts wird möglicherweise auch gering sein (Dies ist für kleine Objekte erreichen erforderlich).

- HITRESULT_HIT *PtlLoc* befindet sich im Bild des Objekts.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn ein Treffer Ergebnis erfolgreich zurückgegeben wird; andernfalls 0. Ein Treffer ist eine Überlappung mit den Anzeigebereich des OLE-Steuerelements.

### <a name="remarks"></a>Hinweise

Fragt ab, ob das Anzeigerechteck eines Objekts mit den angegebenen Punkt überschneidet (den Punkt erreicht). `QueryHitPoint` kann überschrieben werden, um Treffer für nicht rechteckige Objekte zu testen.

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

Wird aufgerufen, durch das Framework als Reaktion auf eines Containers des `IViewObjectEx::QueryHitRect` Anforderung.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parameter

*dwAspect*<br/>
Gibt an, wie das Objekt dargestellt werden soll. Gültige Werte stammen aus der Enumeration [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) oder DVASPECT2.

*pRectBounds*<br/>
Zeiger auf eine `RECT` -Struktur, die das umschließende Rechteck des Clientbereichs OLE-Steuerelement angibt.

*prcLoc*<br/>
Zeiger auf die `RECT` -Struktur gibt das Rechteck an einem Treffer (Überschneidung mit dem Objekt Rechteck), relativ zu der oberen linken Ecke des Objekts überprüft werden soll.

*lCloseHint*<br/>
Nicht verwendet.

*pHitResult*<br/>
Zeiger auf das Ergebnis der Abfrage klicken. Einer der folgenden Werte:

- HITRESULT_OUTSIDE, die keinen Sinn, das Rechteck von OLE-Objekts betroffen ist.

- HITRESULT_HIT mindestens ein Punkt in dem Rechteck wäre ein Treffer für das Objekt.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn ein Treffer Ergebnis erfolgreich zurückgegeben wird; andernfalls 0.

### <a name="remarks"></a>Hinweise

Fragt ab, ob eines Objekts Anzeigerechteck überschneidet sich mit einem beliebigen Zeitpunkt im angegebenen Rechteck (trifft das Rechteck). `QueryHitRect` kann überschrieben werden, um Treffer für nicht rechteckige Objekte zu testen.

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

Wird aufgerufen, durch das Framework zum Abrufen von Daten im angegebenen Format.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parameter

*lpFormatEtc*<br/>
Verweist auf die [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Struktur, die das Format, in dem Informationen angefordert, angibt.

*lpStgMedium*<br/>
Verweist auf eine [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) Struktur, in dem die Daten zurückgegeben werden soll.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Das angegebene Format ist eines der zuvor in das Steuerelement mit platziert die [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) oder [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) Memberfunktionen für verzögertes rendering. Ruft die standardmäßige Implementierung dieser Funktion `OnRenderFileData` oder `OnRenderGlobalData`, wenn das angegebene Speichermedium eine Datei oder einen Speicher ist. Wenn das angeforderte Format CF_METAFILEPICT oder das Format der permanenten Eigenschaft Satz ist, wird die standardmäßige Implementierung rendert die entsprechenden Daten und ungleich NULL zurückgibt. Andernfalls wird 0 zurückgegeben und führt keine Aktion aus.

Wenn *LpStgMedium -> Tymed* TYMED_NULL, ist der STGMEDIUM zugeordnet, und laut gefüllt werden soll *LpFormatEtc -> Tymed*. Wenn dies nicht der TYMED_NULL, der STGMEDIUM mit Daten gefüllt werden.

Überschreiben Sie diese Funktion, um Ihre Daten in das angeforderte Format und das Medium angeben. Abhängig von Ihren Daten empfiehlt es sich um eine der anderen Versionen dieser Funktion stattdessen zu überschreiben. Wenn Ihre Daten kleine und fester Größe ist, überschreiben `OnRenderGlobalData`. Wenn Ihre Daten in einer Datei oder variabler Größe ist, überschreiben `OnRenderFileData`.

Weitere Informationen finden Sie unter den `FORMATETC` und `STGMEDIUM` Strukturen im Windows SDK.

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

Wird aufgerufen, durch das Framework zum Abrufen von Daten im angegebenen Format, wenn das Speichermedium eine Datei ist.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parameter

*lpFormatEtc*<br/>
Verweist auf die [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Struktur, die das Format, in dem Informationen angefordert, angibt.

*pFile-Datei*<br/>
Verweist auf eine [CFile](../../mfc/reference/cfile-class.md) Objekt, in dem die Daten gerendert werden soll.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Das angegebene Format ist eines der zuvor in das Steuerelement mit platziert die [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) Member-Funktion für das verzögerte Rendering. Die Standardimplementierung dieser Funktion gibt einfach "false" zurück.

Überschreiben Sie diese Funktion, um Ihre Daten in das angeforderte Format und das Medium angeben. Abhängig von Ihren Daten empfiehlt es sich um eine der anderen Versionen dieser Funktion stattdessen zu überschreiben. Wenn Sie mehrere Speichermedien behandeln möchten, überschreiben `OnRenderData`. Wenn Ihre Daten in einer Datei oder variabler Größe ist, überschreiben `OnRenderFileData`.

Weitere Informationen finden Sie unter den `FORMATETC` Struktur im Windows SDK.

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

Wird aufgerufen, durch das Framework zum Abrufen von Daten im angegebenen Format, wenn das angegebene Speichermedium globaler Speicher ist.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parameter

*lpFormatEtc*<br/>
Verweist auf die [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Struktur, die das Format, in dem Informationen angefordert, angibt.

*phGlobal*<br/>
Verweist auf ein Handle für den globalen Arbeitsspeicher, die in der die Daten sind, zurückgegeben werden. Wenn kein Arbeitsspeicher zugewiesen wurde, kann dieser Parameter NULL sein.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Das angegebene Format ist eines der zuvor in das Steuerelement mit platziert die [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) Member-Funktion für das verzögerte Rendering. Die Standardimplementierung dieser Funktion gibt einfach "false" zurück.

Wenn *PhGlobal* NULL ist, und klicken Sie dann eine neue HGLOBAL zugeordnet und in zurückgegeben werden soll *PhGlobal*. Andernfalls anhand der HGLOBAL *PhGlobal* mit Daten gefüllt werden soll. Die Menge der Daten, die in der HGLOBAL platziert darf die aktuelle Größe des Speicherblocks nicht überschreiten. Darüber hinaus kann nicht der Block auf einen größeren verschoben werden.

Überschreiben Sie diese Funktion, um Ihre Daten in das angeforderte Format und das Medium angeben. Abhängig von Ihren Daten empfiehlt es sich um eine der anderen Versionen dieser Funktion stattdessen zu überschreiben. Wenn Sie mehrere Speichermedien behandeln möchten, überschreiben `OnRenderData`. Wenn Ihre Daten in einer Datei oder variabler Größe ist, überschreiben `OnRenderFileData`.

Weitere Informationen finden Sie unter den `FORMATETC` Struktur im Windows SDK.

##  <a name="onresetstate"></a>  COleControl:: OnResetState ein

Vom Framework aufgerufen, wenn die Eigenschaften des Steuerelements auf ihre Standardwerte festgelegt werden soll.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Hinweise

Die Standardimplementierung ruft [DoPropExchange](#dopropexchange), und übergeben Sie einen `CPropExchange` -Objekt, das bewirkt, dass Eigenschaften auf ihre Standardwerte festgelegt werden.

Der Steuerelement-Writer kann Initialisierungscode für das OLE-Steuerelement einfügen, in diesem überschreibbar. Diese Funktion wird aufgerufen, wenn [IPersistStream:: Load](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) oder [IPersistStorage](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load) ein Fehler auftritt, oder [IPersistStreamInit:: InitNew](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) oder [IPersistStorage: : InitNew](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-initnew) aufgerufen wird, ohne zuerst entweder `IPersistStream::Load` oder `IPersistStorage::Load`.

##  <a name="onsetclientsite"></a>  COleControl:: OnSetClientSite

Vom Framework aufgerufen, wenn der Container des Steuerelements aufgerufen hat `IOleControl::SetClientSite` Funktion.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Hinweise

In der Standardeinstellung `OnSetClientSite` überprüft, ob die Pfadeigenschaften Daten geladen werden und, wenn dies der Fall, ruft `DoDataPathPropExchange`.

Überschreiben Sie diese Funktion, um spezielle Verarbeitung dieser Benachrichtigung sind. Insbesondere sollten die Außerkraftsetzungen für diese Funktion die Basisklasse aufrufen.

##  <a name="onsetdata"></a>  COleControl::OnSetData

Wird aufgerufen, durch das Framework, um die Daten des Steuerelements mit den angegebenen Daten zu ersetzen.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parameter

*lpFormatEtc*<br/>
Zeiger auf eine [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Struktur, die das Format der Daten angibt.

*lpStgMedium*<br/>
Zeiger auf eine [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) Struktur, in dem sich die Daten befindet.

*bRelease*<br/>
True, wenn das Steuerelement, das Speichermedium freigeben sollte. "False", falls das Steuerelement das Speichermedium nicht freigegeben werden soll.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Wenn die Daten in der permanenten Eigenschaft Format festgelegt ist, wird die standardmäßige Implementierung den Zustand des Steuerelements entsprechend geändert. Andernfalls hat die standardmäßige Implementierung keine Auswirkungen. Wenn *bRelease* ist "true", und klicken Sie dann auf einen Aufruf von `ReleaseStgMedium` erfolgt; andernfalls nicht.

Überschreiben Sie diese Funktion, um die Daten des Steuerelements durch die angegebenen Daten zu ersetzen.

Weitere Informationen finden Sie unter den `FORMATETC` und `STGMEDIUM` Strukturen im Windows SDK.

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

Vom Framework aufgerufen, wenn die Daten des Steuerelements werden, aufgrund eines Aufrufs von geändert muss [IOleObject:: SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parameter

*lpSizeL*<br/>
Ein Zeiger auf die `SIZEL` -Struktur, die von langen ganzen Zahlen verwendet wird, um die Breite und Höhe des Steuerelements, ausgedrückt in HIMETRIC-Einheiten darstellen.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL ist, wenn die Größenänderung akzeptiert wurde, andernfalls 0.

### <a name="remarks"></a>Hinweise

Die standardmäßige Implementierung behandelt, die Größe von den Daten des Steuerelements ändern. Wenn das Steuerelement direkt aktiv, einen Aufruf des Containers ist `OnPosRectChanged` erfolgt, klicken Sie dann.

Überschreiben Sie diese Funktion, um die Standardeinstellung ändern der Größe des Steuerelements zu ändern.

##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects

Wird aufgerufen, durch das Framework zum Implementieren von eines Aufrufs von [IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parameter

*lpRectPos*<br/>
Ein Zeiger auf eine `RECT` -Struktur, die neue Position und Größe relativ zu dem Container des Steuerelements angibt.

*lpRectClip*<br/>
Ein Zeiger auf eine `RECT` -Struktur, die einen rechteckigen Bereich, der das Steuerelement ist, für das Ausschneiden, angibt.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL ist, wenn die neupositionierung akzeptiert wurde, andernfalls 0.

### <a name="remarks"></a>Hinweise

Die standardmäßige Implementierung automatisch übernimmt die Neupositionieren und Ändern der Größe des Steuerelementfensters und gibt TRUE zurück.

Überschreiben Sie diese Funktion, um das Standardverhalten dieser Funktion ändern.

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

Vom Framework aufgerufen, wenn das Steuerelement Benutzeroberfläche aktiviert wurde.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Hinweise

Bei der Standardimplementierung wird keine Aktion ausgeführt.

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

Vom Framework aufgerufen, wenn die vordefinierte Wert der Beschriftung oder den Text-Eigenschaft geändert wurde.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Hinweise

Die Standardimplementierung ruft `InvalidateControl`.

Überschreiben Sie diese Funktion, wenn die Benachrichtigung nach der Änderung dieser Eigenschaft werden soll.

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

Wird aufgerufen, durch das Framework als Reaktion auf eines Containers des `IOleInPlaceObjectWindowless::OnWindowMessage` Anforderung.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parameter

*Meldung*<br/>
Nachrichten-ID von Windows zu übergeben.

*wParam-Parameter*<br/>
Von Windows zu übergeben. Gibt zusätzliche meldungsspezifische Informationen. Der Inhalt dieses Parameters ist hängt von den Wert des der *msg* Parameter.

*lParam*<br/>
Von Windows zu übergeben. Gibt zusätzliche meldungsspezifische Informationen. Der Inhalt dieses Parameters ist hängt von den Wert des der *msg* Parameter.

*plResult*<br/>
Windows-Ergebniscode. Gibt das Ergebnis der Nachrichtenverarbeitung und hängt von der gesendeten Nachricht.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Verarbeitet Windows-Meldungen für fensterlose Steuerelemente. `COleControl`die `OnWindowlessMessage` für fenstermeldungen als Maus und tastaturnachrichten verwendet werden soll. `COleControl` bietet [SetCapture](#setcapture) und [SetFocus](#setfocus) speziell für die Maus erfassen und Tastatur-Fokus für fensterlose OLE-Objekte zu erhalten.

Da fensterlose Objekte nicht über ein Fenster verfügen, benötigen sie einen Mechanismus, um die Container-Dispatchmeldungen Ihnen zu ermöglichen. Ein fensterloses OLE-Objekt ruft Nachrichten aus den Container über die `OnWindowMessage` Methode für die `IOleInPlaceObjectWindowless` Schnittstelle (eine Erweiterung der [IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject) fensterlose Support). `OnWindowMessage` nimmt kein `HWND` Parameter.

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

Übersetzt die Koordinaten der *pPoint* in Clientkoordinaten.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parameter

*lprcBounds*<br/>
Zeiger auf die Grenzen des OLE-Steuerelements innerhalb des Containers. Nicht in den Clientbereich jedoch den Bereich des gesamten Steuerelements einschließlich der Rahmen und Scrollleisten.

*pPoint*<br/>
Zeiger auf das übergeordnete Element (Container) zeigen Sie auf die in die Koordinaten des Clientbereichs des Steuerelements übersetzt werden.

*bHitTest*<br/>
Gibt an, ob Treffertests ist auf dem Zeitpunkt ausgeführt werden.

### <a name="return-value"></a>Rückgabewert

Wenn *bHitTest* ist "false" ist, wird der HTNOWHERE. Wenn *bHitTest* ist "true" gibt der Speicherort, in dem das übergeordnete Element (Container) zeigen Sie, im Clientbereich des OLE-Steuerelements abgerufen und ist eine der folgenden Maus Treffertests Werte:

- HTBORDER im Rahmen eines Fensters, das nicht mit einen Rahmen besitzt.

- HTBOTTOM In den horizontalen unteren Rand des Fensters.

- HTBOTTOMLEFT In der unteren linken Ecke des Fensterrahmens.

- HTBOTTOMRIGHT In der unteren rechten Ecke des Fensterrahmens.

- HTCAPTION In einem Bereich Titelleiste.

- HTCLIENT In einem Clientbereich.

- HTERROR klicken Sie auf dem Bildschirmhintergrund oder auf eine Trennlinie zwischen Fenstern (identisch mit HTNOWHERE außer den Daten der `DefWndProc` Windows-Funktion generiert einen Signalton zur Anzeige eines Fehlers).

- HTGROWBOX In einem Größeneinstellungsfeld.

- HTHSCROLL In der horizontalen Bildlaufleiste.

- HTLEFT In den linken Rand des Fensters.

- HTMAXBUTTON In ein Maximieren-Schaltfläche.

- HTMENU In einem Menübereich im.

- HTMINBUTTON In ein Minimieren-Schaltfläche.

- HTNOWHERE klicken Sie auf dem Bildschirmhintergrund oder auf eine Trennlinie zwischen Fenstern.

- HTREDUCE In ein Minimieren-Schaltfläche.

- HTRIGHT In den rechten Rand des Fensters.

- HTSIZE In einem Feld der Größe (identisch mit HTGROWBOX).

- Menü HTSYSMENU In ein Steuerelement oder in eine Schaltfläche "Schließen" in einem untergeordneten Fenster.

- HTTOP In der oberen horizontale Rahmenlinie des Fensters.

- HTTOPLEFT In der oberen linken Ecke des Fensterrahmens.

- HTTOPRIGHT In der oberen rechten Ecke des Fensterrahmens.

- HTTRANSPARENT In einem Fenster, die derzeit von einem anderen Fenster behandelt.

- HTVSCROLL In der vertikalen Bildlaufleiste.

- HTZOOM In ein Maximieren-Schaltfläche.

### <a name="remarks"></a>Hinweise

Bei der Eingabe *pPoint* ist relativ zum Ursprung des übergeordneten Elements (oberen linken Ecke des Containers). Bei der Ausgabe *pPoint* ist relativ zum Ursprung des Clientbereichs des OLE-Steuerelements (oberen linken Ecke des Clientbereichs des Steuerelements).

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

Benachrichtigt den Container an, dass ein modales Dialogfeld geschlossen wurde.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parameter

*hWndParent*<br/>
Handle für das übergeordnete Fenster das modale Dialogfeld.

### <a name="remarks"></a>Hinweise

Rufen Sie diese Funktion nach jeder modales Dialogfeld angezeigt. Damit alle Fenster auf oberster Ebene deaktiviert, indem der Container bereitgestellt werden kann, rufen Sie diese Funktion muss `PreModalDialog`. Diese Funktion sollte mit einem Aufruf von gekoppelt werden `PreModalDialog`.

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

Benachrichtigt den Container, die ein modales Dialogfeld angezeigt werden soll.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parameter

*hWndParent*<br/>
Handle für das übergeordnete Fenster das modale Dialogfeld.

### <a name="remarks"></a>Hinweise

Rufen Sie diese Funktion, bevor alle modales Dialogfeld angezeigt. Sie müssen diese Funktion aufrufen, damit, dass der Container alle seine Fenster auf oberster Ebene deaktivieren kann. Nachdem das modale Dialogfeld angezeigt wurde, klicken Sie dann aufrufen `PostModalDialog`.

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

Zerstört und neu erstellt das Fenster des Steuerelements.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Hinweise

Dies ist möglicherweise erforderlich, wenn Sie Stilbits des Fensters ändern möchten.

##  <a name="refresh"></a>  COleControl::Refresh

Erzwingt das Neuzeichnen des OLE-Steuerelements.

```
void Refresh();
```

### <a name="remarks"></a>Hinweise

Diese Funktion wird von unterstützt die `COleControl` Basisklasse als eine vordefinierte Methode namens aktualisieren. Dadurch können Benutzer Ihre OLE-Steuerelements das Steuerelement zu einem bestimmten Zeitpunkt neu zu zeichnen. Weitere Informationen zu dieser Methode finden Sie im Artikel [ActiveX-Steuerelemente: Methoden](../../mfc/mfc-activex-controls-methods.md).

##  <a name="releasecapture"></a>  COleControl::ReleaseCapture

Gibt die Erfassung von Mauseingaben frei.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Wenn das Steuerelement gerade das Erfassen von Mauseingaben verfügt, wird die Erfassung freigegeben. Andernfalls hat diese Funktion keine Auswirkungen.

##  <a name="releasedc"></a>  COleControl::ReleaseDC

Gibt die Anzeigegerätekontext, der ein Container mit einem fensterlosen Steuerelement, das den Gerätekontext für die Verwendung von anderen Anwendungen freigeben.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Gibt den Gerätekontext für Container freigegeben werden.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Muss die Anwendung aufrufen `ReleaseDC` für jeden Aufruf von [GetDC](#getdc).

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

Legt das übergeordnete Element des Steuerelements fest.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parameter

*hWndOuter*<br/>
Das Handle des Steuerelementfensters.

*hWndParent*<br/>
Das Handle des neuen übergeordneten Fensters.

### <a name="remarks"></a>Hinweise

Rufen Sie diese Funktion, um das übergeordnete Element des Steuerelementfensters zurücksetzen.

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

Initialisiert den Zustand des der `COleControl` vordefinierte Eigenschaften auf ihre Standardwerte zurück.

```
void ResetStockProps();
```

### <a name="remarks"></a>Hinweise

Die Eigenschaften sind: Darstellung, Hintergrundfarbe, BorderStyle, Beschriftung, aktiviert, Schriftart, ForeColor, hWnd und Text. Eine Beschreibung der vordefinierten Eigenschaften, finden Sie unter [ActiveX-Steuerelemente: Hinzufügen von Basiseigenschaften](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Können Sie eines Steuerelements binäre Initialisierung Leistung verbessern, mithilfe von `ResetStockProps` und `ResetVersion` überschreiben `COleControl::OnResetState`. Siehe das unten aufgeführte Beispiel. Weitere Informationen zum Optimieren der Initialisierung finden Sie [ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Beispiel

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

Initialisiert die Versionsnummer auf den angegebenen Wert.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parameter

*dwVersionDefault*<br/>
Die Versionsnummer des Steuerelements zugewiesen werden.

### <a name="remarks"></a>Hinweise

Können Sie eines Steuerelements binäre Initialisierung Leistung verbessern, mithilfe von `ResetVersion` und `ResetStockProps` überschreiben `COleControl::OnResetState`. Siehe das Beispiel unter [ResetStockProps](#resetstockprops). Weitere Informationen zum Optimieren der Initialisierung finden Sie [ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

Ermöglicht ein fensterloses OLE-Objekt in dessen in direkt aktiven Bildes auf dem Bildschirm einen Bereich einen Bildlauf durchführen.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parameter

*xAmount*<br/>
Gibt die Menge in Geräteeinheiten, der horizontale Bildlauffunktion an. Dieser Parameter muss einen negativen Wert auf der linken Seite einen Bildlauf durchführen.

*yAmount*<br/>
Gibt die Menge in Geräteeinheiten, der einen vertikalen Bildlauf ausführen. Dieser Parameter muss ein negativer Wert einen Bildlauf nach oben durchführen.

*lpRect*<br/>
Verweist auf eine [CRect](../../atl-mfc-shared/reference/crect-class.md) Objekt oder die RECT-Struktur, die Teil des Clientbereichs des OLE-Objekts, des Bildlaufs in Clientkoordinaten des übergeordneten Fensters angibt. Wenn *LpRect* NULL ist, das gesamte OLE-Objekt den Clientbereich ein Bildlauf durchgeführt wird.

*lpClipRect*<br/>
Verweist auf eine `CRect` Objekt oder `RECT` Struktur, die das Rechteck auf Zuschneiden angibt. Nur Pixel innerhalb des Rechtecks werden durchgeführt. Bits außerhalb des Rechtecks sind nicht betroffen, selbst wenn sie sich in befinden die *LpRect* Rechteck. Wenn *LpClipRect* NULL ist, ohne Clipping für das Bildlaufrechteck ausgeführt wird.

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

Wählt eine Schriftart für einen Gerätekontext.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Zeiger auf ein Gerät Context-Objekt.

*fontHolder*<br/>
Ein Verweis auf die [CFontHolder](../../mfc/reference/cfontholder-class.md) Objekt, das die Schriftart, die ausgewählt werden darstellt.

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf die zuvor ausgewählte Schriftart. Wenn der Aufrufer verfügt über alle Zeichenoperationen, mit denen abgeschlossen *FontHolder,* sollten Befehl wieder auszuwählen die zuvor ausgewählte Schriftart durch Übergabe als Parameter an [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject).

##  <a name="selectstockfont"></a>  COleControl:: SelectStockFont

Wählt die vordefinierte Schriftarteigenschaft einen Gerätekontext.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Der Gerätekontext, die in dem Schriftart ausgewählt wird.

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf die zuvor ausgewählte `CFont` Objekt. Verwenden Sie [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject) diese Schriftart zurück im Gerätekontext auswählen, wenn Sie fertig sind.

##  <a name="serializeextent"></a>  COleControl::SerializeExtent

Serialisiert bzw. initialisiert den Zustand des Speicherplatzes für das Steuerelement vorgesehene anzeigen.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parameter

*ar*<br/>
Ein `CArchive` zu zu oder von zu serialisierenden Objekts.

### <a name="remarks"></a>Hinweise

Können Sie eines Steuerelements binäre Persistenz-Leistung verbessern, mithilfe von `SerializeExtent`, `SerializeStockProps`, und `SerializeVersion` überschreiben `COleControl::Serialize`. Siehe das unten aufgeführte Beispiel. Weitere Informationen zum Optimieren der Initialisierung finden Sie [ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Beispiel

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

Serialisiert bzw. initialisiert den Zustand des der `COleControl` Basiseigenschaften: Darstellung, Hintergrundfarbe, BorderStyle, Beschriftung, aktiviert, Schriftart, ForeColor und Text.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parameter

*ar*<br/>
Ein `CArchive` zu zu oder von zu serialisierenden Objekts.

### <a name="remarks"></a>Hinweise

Eine Beschreibung der vordefinierten Eigenschaften, finden Sie unter [ActiveX-Steuerelemente: Hinzufügen von Basiseigenschaften](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Können Sie eines Steuerelements binäre Persistenz-Leistung verbessern, mithilfe von `SerializeStockProps`, `SerializeExtent`, und `SerializeVersion` überschreiben `COleControl::Serialize`. Ein Beispiel finden Sie in den Code am [SerializeExtent](#serializeextent). Weitere Informationen zum Optimieren der Initialisierung finden Sie [ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

Serialisiert bzw. initialisiert den Zustand der Versionsinformationen eines Steuerelements.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parameter

*ar*<br/>
Ein `CArchive` zu zu oder von zu serialisierenden Objekts.

*dwVersionDefault*<br/>
Die aktuelle Versionsnummer des Steuerelements.

*bConvert*<br/>
Gibt an, ob die Daten dauerhafte in das aktuelle Format konvertiert werden sollen, wenn es gespeichert wird, oder im selben Format verwaltet ist, dass es hätte, wenn es geladen wurde.

### <a name="return-value"></a>Rückgabewert

Die Versionsnummer des Steuerelements. Wenn die angegebene Archivdatei geladen wird, `SerializeVersion` gibt die Version, die aus diesem Archiv geladen. Andernfalls wird die derzeit geladene Version zurückgegeben.

### <a name="remarks"></a>Hinweise

Können Sie eines Steuerelements binäre Persistenz-Leistung verbessern, mithilfe von `SerializeVersion`, `SerializeExtent`, und `SerializeStockProps` überschreiben `COleControl::Serialize`. Ein Beispiel finden Sie in den Code am [SerializeExtent](#serializeextent). Weitere Informationen zum Optimieren der Initialisierung finden Sie [ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="setappearance"></a>  COleControl::SetAppearance

Legt die vordefinierten Appearance-Eigenschaftswert des Steuerelements fest.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parameter

*sAppearance*<br/>
Ein **kurze** (VT_I2)-Wert, der für die Darstellung des Steuerelements verwendet werden. Den Wert 0 (null) wird die Darstellung des Steuerelements auf Flatfiles, und den Wert 1 wird die Darstellung des Steuerelements auf 3D.

### <a name="remarks"></a>Hinweise

Weitere Informationen über Basiseigenschaften, finden Sie unter [ActiveX-Steuerelemente: Eigenschaften](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

Legt den vordefinierten BackColor-Eigenschaftswert des Steuerelements fest.

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parameter

*dwBackColor*<br/>
Ein OLE_COLOR-Wert für den Hintergrund des Steuerelements Zeichnen verwendet werden.

### <a name="remarks"></a>Hinweise

Weitere Informationen zur Verwendung dieser Eigenschaft und andere Eigenschaften beziehen, finden Sie im Artikel [ActiveX-Steuerelemente: Eigenschaften](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

Legt den vordefinierten BorderStyle-Eigenschaftswert des Steuerelements fest.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parameter

*sBorderStyle*<br/>
Die neue Rahmenart für das Steuerelement; 0 gibt an, keinen Rahmen, und 1 gibt einen normalen Rahmen an.

### <a name="remarks"></a>Hinweise

Das Fenster des Steuerelements wird dann neu erstellt werden und `OnBorderStyleChanged` aufgerufen.

##  <a name="setcapture"></a>  COleControl::SetCapture

Bewirkt, dass das Fenster des Steuerelements Container des Steuerelements im Auftrag besitzt das Erfassen von Mauseingaben zu.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf die `CWnd` Window-Objekt, die zuvor Mauseingabe empfangen.

### <a name="remarks"></a>Hinweise

Wenn das Steuerelement aktiviert und eine fensterlose ist, wird diese Funktion des Steuerelements Fenster "Container" des Steuerelements im Auftrag besitzt die mausaufzeichnung zu. Andernfalls wird diese Funktion für das Steuerelement selbst besitzt das Erfassen von Mauseingaben wird (identisch mit `CWnd::SetCapture`).

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

Legt die Größe der Fenster des OLE-Steuerelements fest, und benachrichtigt den Container, den die Website des Steuerelements geändert wird.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parameter

*CX*<br/>
Gibt die neue Breite des Steuerelements in Pixel an.

*CY*<br/>
Gibt die neue Höhe des Steuerelements in Pixel an.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn der Aufruf erfolgreich war; andernfalls 0.

### <a name="remarks"></a>Hinweise

Diese Funktion sollte nicht im Konstruktor Ihrer Steuerelements verwendet werden.

Beachten Sie, dass alle Koordinaten für steuerelementfenstern relativ zu der oberen linken Ecke des Steuerelements.

##  <a name="setenabled"></a>  COleControl::SetEnabled

Legt die Aktie Enabled-Eigenschaftswert des Steuerelements fest.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parameter

*bAktiviert*<br/>
True, wenn das Steuerelement aktiviert werden. andernfalls "false".

### <a name="remarks"></a>Hinweise

Nach dem Festlegen dieser Eigenschaft `OnEnabledChange` aufgerufen wird.

##  <a name="setfocus"></a>  COleControl::SetFocus

Bewirkt, dass das Fenster des Steuerelements Container des Steuerelements im Auftrag zu den Eingabefokus besitzt.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf die `CWnd` Window-Objekt, die zuvor die Eingabe konzentrieren oder NULL hatten, wenn kein solches Fenster vorhanden ist.

### <a name="remarks"></a>Hinweise

Wenn das Steuerelement aktiviert und eine fensterlose ist, wird diese Funktion des Steuerelements Fenster "Container" zu den Eingabefokus besitzt des Steuerelements im Auftrag. Der Eingabefokus weist Tastatureingaben an den Container-Fenster aus, und der Container verteilt alle nachfolgenden tastaturmeldungen auf die OLE-Objekt, das Aufrufe `SetFocus`. Ein Fenster, die bisher den Eingabefokus verliert er.

Wenn das Steuerelement nicht fensterlos sein, diese Funktion bewirkt, dass das Steuerelement selbst zu den Eingabefokus besitzt (wie `CWnd::SetFocus`).

##  <a name="setfont"></a>  COleControl::SetFont

Legt fest, die vordefinierte Schriftarteigenschaft des Steuerelements.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parameter

*pFontDisp*<br/>
Ein Zeiger auf eine Schriftart Dispatch-Schnittstelle.

##  <a name="setforecolor"></a>  COleControl::SetForeColor

Legt den vordefinierten ForeColor-Eigenschaftswert des Steuerelements fest.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parameter

*dwForeColor*<br/>
Ein OLE_COLOR-Wert für den Vordergrund Zeichnen des Steuerelements verwendet werden soll.

### <a name="remarks"></a>Hinweise

Weitere Informationen zur Verwendung dieser Eigenschaft und andere Eigenschaften beziehen, finden Sie im Artikel [ActiveX-Steuerelemente: Eigenschaften](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats

Wird aufgerufen, durch das Framework zum Initialisieren der Liste der Datenformate, die vom Steuerelement unterstützt wird.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Hinweise

Die Standardimplementierung gibt zwei Formate an: CF_METAFILEPICT und die permanenten Eigenschaft festgelegt.

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

Legt die Größe eines OLE-Steuerelements, wenn in einem Container zuerst angezeigt.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parameter

*CX*<br/>
Die Ausgangsbreite des OLE-Steuerelements in Pixel.

*CY*<br/>
Die Ausgangshöhe des OLE-Steuerelements in Pixel.

### <a name="remarks"></a>Hinweise

Rufen Sie diese Funktion im Konstruktor die Anfangsgröße des Steuerelements festlegen. Die ursprüngliche Größe wird in Geräteeinheiten oder Pixel gemessen. Es wird empfohlen, dass dieser Aufruf im Konstruktor Ihrer Steuerelements vorgenommen werden.

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

Ändert den geänderten Zustand eines Steuerelements.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parameter

*bModified*<br/>
Der neue Wert für das Steuerelement des Flags geändert werden. TRUE gibt an, dass der Zustand des Steuerelements geändert wurde; FALSE gibt an, dass der Zustand des Steuerelements gerade gespeichert wurde.

### <a name="remarks"></a>Hinweise

Aufruf, dass diese Funktion, wenn eine Änderung vorgenommen wird, der persistente Zustand des Steuerelements auswirken würde. Z. B. wenn der Wert einer permanenten Eigenschaft ändert, rufen Sie diese Funktion mit *bModified* **"true"**.

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

Gibt an, dass eine bearbeitungsanforderung fehlgeschlagen ist.

```
void SetNotPermitted();
```

### <a name="remarks"></a>Hinweise

Mit dieser Funktion wird bei der `BoundPropertyRequestEdit` ein Fehler auftritt. Diese Funktion löst eine Ausnahme vom Typ `COleDispScodeException` um anzugeben, dass die Set-Vorgang nicht zugelassen wurde.

##  <a name="setnotsupported"></a>  COleControl::SetNotSupported

Verhindert, dass Änderungen an den Wert eines Steuerelements Eigenschaft durch den Benutzer.

```
void SetNotSupported();
```

### <a name="remarks"></a>Hinweise

Mit dieser Funktion werden anstelle der Set-Funktion, einer beliebigen Eigenschaft, in dem Änderung des Eigenschaftswerts von dem Benutzer des Steuerelements wird nicht unterstützt wird. Ein Beispiel wäre eine Eigenschaft, die schreibgeschützt ist.

##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer

Legt die Koordinaten der das Rechteck des Steuerelements relativ zu dem Container, in Geräteeinheiten ausgedrückt.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parameter

*lpRect*<br/>
Ein Zeiger auf ein Rechteck mit dem Steuerelement neue Koordinaten relativ zu dem Container.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn der Aufruf erfolgreich war; andernfalls 0.

### <a name="remarks"></a>Hinweise

Wenn das Steuerelement geöffnet ist, wird es angepasst. andernfalls des Containers `OnPosRectChanged` -Funktion aufgerufen wird.

##  <a name="settext"></a>  COleControl::SetText

Legt den Wert der vordefinierten Beschriftung oder den Text-Eigenschaft des Steuerelements.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parameter

*pszText*<br/>
Ein Zeiger auf eine Zeichenfolge.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass sowohl die vordefinierten Eigenschaften für Titel und Text auf den gleichen Wert zugeordnet sind. Dies bedeutet, dass alle Änderungen an einer der Eigenschaften beide Eigenschaften automatisch geändert werden. Im Allgemeinen sollte ein Steuerelement die Aktie Beschriftung oder Text-Eigenschaft, aber nicht beide unterstützen.

##  <a name="throwerror"></a>  ThrowError

Signalisiert das Auftreten eines Fehlers in das Steuerelement an.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);


void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parameter

*SC*<br/>
Der Statuswert des Codes gemeldet werden. Eine vollständige Liste der möglichen Fehlercodes, finden Sie im Artikel [ActiveX-Steuerelemente: Weiterführende Themen](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
Die Zeichenfolgenressource-ID der Ausnahme gemeldet werden.

*nHelpID*<br/>
Die Hilfe-ID des Themas auf gemeldet werden.

*pszDescription*<br/>
Eine Zeichenfolge mit einer Beschreibung der Ausnahme gemeldet werden.

### <a name="remarks"></a>Hinweise

Diese Funktion sollte nur von innerhalb einer Get- oder Set-Funktion für eine OLE-Eigenschaft oder die Implementierung einer OLE-Automatisierung-Methode aufgerufen werden. Wenn Sie Fehler darauf hinweisen, die zu anderen Zeiten auftreten müssen, sollten Sie die vordefinierte Error-Ereignis ausgelöst.

##  <a name="transformcoords"></a>  COleControl::TransformCoords

Transformationen-Koordinatenwerte zwischen HIMETRIC-Einheiten und native Einheiten des Containers.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parameter

*lpptlHimetric*<br/>
Zeiger auf eine `POINTL` -Struktur mit Koordinaten in HIMETRIC-Einheiten.

*lpptfContainer*<br/>
Zeiger auf eine `POINTF` Struktur, die Koordinaten in der Größe des Containers enthält.

*flags*<br/>
Eine Kombination der folgenden Werte:

- XFORMCOORDS_POSITION eine Position im Container.

- XFORMCOORDS_SIZE eine Größe im Container.

- XFORMCOORDS_HIMETRICTOCONTAINER transformieren HIMETRIC-Einheiten des Containers Einheiten.

- XFORMCOORDS_CONTAINERTOHIMETRIC Transformieren des Containers Einheiten HIMETRIC-Einheiten.

### <a name="remarks"></a>Hinweise

Die ersten beiden Flags, XFORMCOORDS_POSITION und XFORMCOORDS_SIZE, angeben, ob es sich bei die Koordinaten als eine Position oder Größe behandelt werden soll. Die verbleibenden zwei Flags geben an, die Richtung der Transformation wird.

##  <a name="translatecolor"></a>  Memberfunktion COleControl:: TranslateColor

Konvertiert einen Farbwert aus den OLE_COLOR-Datentyp in der [COLORREF](/windows/desktop/gdi/colorref) -Datentyp.

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parameter

*clrColor*<br/>
Ein OLE_COLOR-Datentyp. Weitere Informationen finden Sie in der Windows [OleTranslateColor](/windows/desktop/api/olectl/nf-olectl-oletranslatecolor) Funktion.

*hpal*<br/>
Ein Handle für eine optionale palette NULL kann sein.

### <a name="return-value"></a>Rückgabewert

Ein RGB (Rot, Grün, Blau)-32-Bit-Farben-Wert, der dem stabilen definiert Farbe am nächsten liegt die *ClrColor* -Wert, der das Gerät darstellen kann.

### <a name="remarks"></a>Hinweise

Diese Funktion ist nützlich, um die Vordergrundfarbe und Hintergrundfarbe Basiseigenschaften COLORREF Typen ein, die übersetzt [CDC](../../mfc/reference/cdc-class.md) Memberfunktionen.

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

Bestimmt, ob das Steuerelement die Werte der ambient-Eigenschaften als Standardwerte verwenden soll, wenn es anschließend aus den persistente Zustand geladen wird.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Rückgabewert

Nonzero gibt an, dass die Ambiente-Eigenschaften gültig sein soll; Andernfalls werden die Ambiente-Eigenschaften nicht gültig sein.

### <a name="remarks"></a>Hinweise

In einige Container, das Steuerelement möglicherweise keinen Zugriff auf die ambient-Eigenschaften beim ersten Aufruf die Überschreibung der `COleControl::DoPropExchange`. Dies ist der Fall, wenn der Container ruft [IPersistStreamInit::Load](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-load) oder [IPersistStorage](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load) vor dem Aufruf [IOleObject:: SetClientSite](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setclientsite) (d.h., wenn dies nicht der Fall Berücksichtigen Sie das OLEMISC_SETCLIENTSITEFIRST-Status-Bit).

##  <a name="windowproc"></a>  COleControl::WindowProc

Enthält ein Windows-Verfahren für eine `COleControl` Objekt.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parameter

*message*<br/>
Gibt die Windows-Meldung verarbeitet werden.

*wParam-Parameter*<br/>
Enthält zusätzliche Informationen, die beim Verarbeiten der Nachricht verwendet. Der Wert des Parameters hängt von der Nachricht ab.

*lParam*<br/>
Enthält zusätzliche Informationen, die beim Verarbeiten der Nachricht verwendet. Der Wert des Parameters hängt von der Nachricht ab.

### <a name="return-value"></a>Rückgabewert

Der Rückgabewert der Nachricht gesendet werden soll.

### <a name="remarks"></a>Hinweise

Rufen Sie diese Funktion, um bestimmte Nachrichten über die meldungszuordnung des Steuerelements zu senden.

## <a name="see-also"></a>Siehe auch

[MFC-Beispiel CIRC3](../../visual-cpp-samples.md)<br/>
[MFC-Beispiel TESTHELP](../../visual-cpp-samples.md)<br/>
[COlePropertyPage-Klasse](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd-Klasse](../../mfc/reference/cwnd-class.md)<br/>
[Hierarchiediagramm](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder-Klasse](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder-Klasse](../../mfc/reference/cpictureholder-class.md)<br/>
